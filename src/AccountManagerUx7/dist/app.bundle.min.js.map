{
  "version": 3,
  "sources": ["app.temp.js"],
  "sourcesContent": ["\n;/* === client/am7client.js === */\n\r\n (function(){\r\n\t\r\n\tif(!window.uwm){\r\n\t\tvar cache = {};\r\n\t\tvar principal = 0;\r\n\t\tvar sCurrentOrganization = 0;\r\n\t\tvar sBase = g_application_path + \"/rest\";\r\n\t\tvar sCache = sBase + \"/cache\";\r\n\t\tvar sResource = sBase + \"/resource\";\r\n\t\tvar sModelSvc = sBase + \"/model\";\r\n\t\tvar sPrincipal = sBase + \"/principal\";\r\n\t\tvar sSearch = sBase + \"/search\";\r\n\t\tvar sPathSvc = sBase + \"/path\";\r\n\t\tvar sMake = sBase + \"/make\";\r\n\t\tvar sList = sBase + \"/list\";\r\n\t\tvar sStreamSvc = sBase + \"/stream\";\r\n\t\tvar sAuthZ = sBase + \"/authorization\";\r\n\t\tvar sComm = sBase + \"/community\";\r\n\t\tvar sCred = sBase + \"/credential\";\r\n\t\tvar sPol = sBase + \"/policy\";\r\n\t\tvar sCtl = sBase + \"/control\";\r\n\t\tvar sReq = sBase + \"/request\";\r\n\t\tvar sToken = sBase + \"/token\";\r\n\t\tvar sAppr = sBase + \"/approval\";\r\n\t\tvar sScr = sBase + \"/script\";\r\n\t\tvar sTagSvc = sBase +\"/tag\";\r\n\t\twindow.uwm = {\r\n\t\t\tconsoleMode : 0,\r\n\t\t\tdeveloperMode : 0,\t\r\n\t\t\tdebugMode : 1,\r\n\t\t\tshowDescription : 0,\r\n\t\t\t\r\n\t\t\tgetUser : function(){\r\n\t\t\t\treturn getPrincipal();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tlogin : function(o, u, p, v2, fH){\r\n\t\t\t\tvar vParms = (v2 ? v2 : {});\r\n\t\t\t\tam7client.loginWithPassword(o, u, p, function(b){\r\n\t\t\t\t\tif(b){\r\n\t\t\t\t\t\tam7client.clearCache(0,1);\r\n\t\t\t\t\t\twindow.uwm.getUser().then((oU2)=>{\r\n\t\t\t\t\t\t\tif(uwm.altFlushSession) uwm.altFlushSession();\r\n\t\t\t\t\t\t\tvParms.user = oU2;\r\n\t\t\t\t\t\t\tif(fH) fH(oU2);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tconsole.log(\"Login: \" + b);\r\n\t\t\t\t\t\tvParms.user = 0;\r\n\t\t\t\t\t\tif(fH) fH(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn 1;\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tlogout : async function(){\r\n\t\t\t\treturn am7client.logout().then((b)=>{\r\n\t\t\t\t\treturn b;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tgetApiTypeView : function(sType){\r\n\t\t\t\treturn g_application_path + \"\";\r\n\t\t\t},\r\n\t\t\tgetDefaultParentForType : function(sType, vDef){\r\n\t\t\t\tif(uwm.defaultParentProvider){\r\n\t\t\t\t\treturn uwm.defaultParentProvider(sType,vDef);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(vDef);\r\n\t\t\t},\r\n\t\t\tbase64Encode : function(a){\r\n\t\t\t\treturn Base64.encode(a);\r\n\t\t\t},\r\n\t\t\tbase64Decode : function(a){\r\n\t\t\t\treturn Base64.decode(a);\r\n\t\t\t},\r\n\t\t\tstrToBin : function(s){\r\n\t\t\t\tvar a = [];\r\n\t\t\t\tfor(var i = 0; i < s.length;) a.push(s.charCodeAt(i++));\r\n\t\t\t\treturn a;\r\n\t\t\t},\r\n\t\t\tbinToStr : function(a){\r\n\t\t\t\tvar s = [];\r\n\t\t\t\tif(!a) return s;\r\n\t\t\t\tfor(var i = 0; i < a.length;) s.push(String.fromCharCode(a[i++]));\r\n\t\t\t\treturn s.join(\"\");\r\n\t\t\t},\r\n\t\t\tguid : function(){\r\n\t\t\t\treturn page.uid();\r\n\t\t\t},\r\n\t\t\t/// sKey and sIv in Base64 string format\r\n\t\t\t///\r\n\t\t\tencipher : function(sText, sKey, sIv){\r\n\t\t\t var enc = slowAES.encrypt(uwm.strToBin(sText),\r\n\t        \t\tslowAES.modeOfOperation.CBC,\r\n\t        \t\tslowAES.padding.PKCS7,\r\n\t                uwm.strToBin(uwm.base64Decode(sKey)),\r\n\t                uwm.strToBin(uwm.base64Decode(sIv))\r\n\t          );\r\n\t          return enc.cipher;\r\n\r\n\t\t\t},\r\n\t\t\tdecipher : function(sText, sKey, sIv){\r\n\t        \r\n\t        \treturn slowAES.decrypt(uwm.strToBin(uwm.base64Decode(sText)),\r\n\t        \t\t\tslowAES.modeOfOperation.CBC,\r\n\t        \t\t\tslowAES.padding.PKCS7,\r\n\t        \t\t\tuwm.strToBin(uwm.base64Decode(sKey)),\r\n\t        \t\t\tuwm.strToBin(uwm.base64Decode(sIv))\r\n\t        \t);\r\n\t\t\t},\r\n\r\n\t\t\thandlers : {\r\n\t\t\t\tload : [],\r\n\t\t\t\tunload : []\r\n\t\t\t},\r\n\t\t\taddPageLoadHandler : function(f){\r\n\t\t\t\tuwm.handlers.load.push(f);\r\n\t\t\t},\r\n\t\t\tprocessLoadHandlers : function(){\r\n\t\t\t\tvar aH = uwm.handlers.load, i = 0;\r\n\t\t\t\tfor(; i < aH.length;) aH[i++]();\r\n\t\t\t\taH.length = 0;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\r\n\tfunction getCache(){\r\n\t\treturn cache;\r\n\t}\r\n\r\n\tfunction cleanup(fH){\r\n\t\treturn get(sModelSvc + \"/cleanup\",fH);\r\n\t}\r\n\r\n\tfunction clearCache(vType, bLocalOnly, fH){\r\n\t\tvar sType = vType, oObj;\r\n\t\tif(vType != null && typeof vType == \"object\"){\r\n\t\t\tsType = vType[am7model.jsonModelKey];\r\n\t\t\toObj = vType;\r\n\t\t\treturn removeFromCache(sType, vType.objectId);\r\n\t\t}\r\n\t\tif(!sType){\r\n\t\t\tcache = {};\r\n\t\t\treturn (bLocalOnly ? Promise.resolve(true) : get(sCache + \"/clearAll\",fH));\r\n\t\t}\r\n\t\telse{\r\n\t\t\tdelete cache[sType];\r\n\t\t\tif(sType.match(/^(project|lifecycle)$/gi)) delete cache[\"GROUP\"];\r\n\t\t\tdelete cache[\"COUNT\"];\r\n\t\t\treturn (bLocalOnly ? Promise.resolve(true) : get(sCache + \"/clear/\" + sType,fH));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction removeFromCache(vType, sObjId){\r\n\t\tvar sType = vType;\r\n\t\tif(typeof vType == \"object\"){\r\n\t\t\tsType = vType[am7model.jsonModelKey];\r\n\t\t\tif(!sObjId) sObjId = vType.objectId;\r\n\t\t}\r\n\t\tif(!cache[sType]) return;\r\n\t\tfor(var s in cache[sType]){\r\n\t\t\tdelete cache[sType][s][sObjId];\r\n\t\t}\r\n\t}\r\n\tfunction getFromCache(sType, sAct, sObjId){\r\n\t\tif(!cache[sType]) return 0;\r\n\t\tif(!cache[sType][sAct]) return 0;\r\n\t\tif(typeof cache[sType][sAct][sObjId]==\"undefined\") return 0;\r\n\t\treturn cache[sType][sAct][sObjId];\r\n\t}\r\n\tfunction addToCache(sType, sAct, sId, vObj){\r\n\t\tif(!cache[sType]) cache[sType] = {};\r\n\t\tif(!cache[sType][sAct]) cache[sType][sAct] = {};\r\n\t\tcache[sType][sAct][sId]=vObj;\r\n\t\t\r\n\t}\r\n\tfunction newPrimaryCredential(sType, sObjId, oAuthN, fH){\r\n\t\treturn post(sCred + \"/\" + sType + \"/\" + sObjId, oAuthN, fH);\r\n\t}\r\n\r\n\tfunction deleteObject(sType,sObjId, fH){\r\n\t\tdelete cache[sType];\r\n\r\n\t\treturn del(sModelSvc + \"/\" + sType + \"/\" + sObjId,fH);\r\n\t}\r\n\t\r\n\tfunction patchObject(sType, oObj, fH){\r\n\t   delete cache[sType];\r\n\t   // console.log(oObj);\r\n\t   return patch(sModelSvc, oObj, fH);\r\n\t}\r\n\t\r\n\tfunction create(sType,oObj, fH){\r\n\t\tdelete cache[sType];\r\n\t   return post(sModelSvc, oObj, fH);\r\n\t}\r\n\r\n\tfunction updateBulk(sType,aObj, fH){\r\n\t\tconsole.error(\"REFACTOR: updateBulk\");\r\n\t\tdelete cache[sType];\r\n\t   //return Hemi.xml.postJSON(sResource + \"/\" + sType + \"/bulk\", aObj,fH,(fH ? 1 : 0));\r\n\t}\r\n\t\r\n\tfunction evaluate(oObj, fH){\r\n\t\tconsole.error(\"REFACTOR: evaluate\");\r\n\t\t// return Hemi.xml.postJSON(sPol + \"/evaluate\",oObj,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction executeScript(urn, fH){\r\n\t\tconsole.error(\"REFACTOR: execute\");\r\n\t\t// return Hemi.xml.getJSON(sScr + \"/execurn/\" + urn,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction executeScriptById(sObjectId, fH){\r\n\t\tconsole.error(\"REFACTOR: executeScriptById\");\r\n\t\t//return Hemi.xml.getJSON(sScr + \"/execid/\" + sObjectId,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction define(sObjectId, fH){\r\n\t\tconsole.error(\"REFACTOR: define\");\r\n\t   //return Hemi.xml.getJSON(sPol + \"/define/\" + sObjectId,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction searchCount(q, fH){\r\n\t\treturn search(q, fH, 1);\r\n\t}\r\n\tlet compLabel = {\r\n\t\tless_than: \"<\",\r\n\t\tless_than_or_equals: \"<=\",\r\n\t\tequals: \"=\",\r\n\t\tgreater_than: \">\",\r\n\t\tgreater_than_or_equals: \">=\",\r\n\t\tgroup_and: \"&&\",\r\n\t\tgroup_or: \"||\"\r\n\t};\r\n\r\n\r\n\tfunction newQuery(m){\r\n\t\tlet q = {\r\n\t\t\tentity : {\r\n\t\t\t\tschema: \"io.query\",\r\n\t\t\t\ttype: m,\r\n\t\t\t\tfields: [],\r\n\t\t\t\torder: 'ascending',\r\n\t\t\t\tcomparator: \"group_and\",\r\n\t\t\t\trecordCount: 10,\r\n\t\t\t\tcache: true,\r\n\t\t\t\trequest: am7model\r\n\t\t\t\t\t.inheritsFrom(m)\r\n\t\t\t\t\t.filter(m => m.query)\r\n\t\t\t\t\t.map(m => m.query)\r\n\t\t\t\t\t.flat(1)\r\n\t\t\t\t\t.filter( (v, i, z) => z.indexOf(v) == i)\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tq.cache = (b) => {\r\n\t\t\tq.entity.cache = b;\r\n\t\t};\r\n\t\t\r\n\t\tq.range = function(s, c){\r\n\t\t\tq.entity.startRecord = parseInt(s);\r\n\t\t\tq.entity.recordCount = parseInt(c);\r\n\t\t};\r\n\r\n\t\tq.sort = function(s){\r\n\t\t\tif(s != undefined){\r\n\t\t\t\tq.entity.sortField = s;\r\n\t\t\t}\r\n\t\t\treturn s;\r\n\t\t}\r\n\t\tq.order = function(o){\r\n\t\t\tif(o != undefined){\r\n\t\t\t\tq.entity.order = o;\r\n\t\t\t}\r\n\t\t\treturn q.entity.order;\r\n\t\t};\r\n\t\tq.field = function(name, value){\r\n\t\t\tlet fld = {\r\n\t\t\t\tcomparator: \"equals\",\r\n\t\t\t\tname,\r\n\t\t\t\tvalue\r\n\t\t\t};\r\n\t\t\tq.entity.fields.push(fld);\r\n\t\t\treturn fld;\r\n\t\t};\r\n\t\tq.keyField = function(afs){\r\n\t\t\treturn \"(\" + afs.map(f =>  f.fields ? q.keyField(f.fields) : f.name + \" \" + compLabel[f.comparator] + \" \" + f.value).join(\", \") + \")\";\r\n\t\t};\r\n\r\n\t\tq.key = function(){\r\n\t\t\tlet r = q.entity.request.join(\",\");\r\n\t\t\tif(!r.length) r = \"*\";\r\n\t\t\tlet k = [\r\n\t\t\t\tq.entity.type,\r\n\t\t\t\tq.entity.order,\r\n\t\t\t\tq.entity.limit || false,\r\n\t\t\t\tq.entity.sortField || \"id\",\r\n\t\t\t\tq.entity.startRecord || 0,\r\n\t\t\t\tq.entity.recordCount || 10,\r\n\t\t\t\tpage?.user?.objectId || \"000\",\r\n\t\t\t\tq.keyField(q.entity.fields)\r\n\t\t\t];\r\n\t\t\treturn k.join(\"-\");\r\n\t\t};\r\n\t\treturn q;\r\n\t}\r\n\t/*\r\n\tfunction query(m, f){\r\n\t\tlet r = [];\r\n\t\tlet r1 = am7model.queryFields(m);\r\n\t\tlet request = (f || r1).filter( (v, i, z) => z.indexOf(v) == i);\r\n\t\treturn {\r\n\t\t\ttype: m,\r\n\t\t\tcomparator: \"group_and\",\r\n\t\t\tfields: [\r\n\t\t\t\t{\r\n\t\t\t  \t\t\"comparator\" : \"equals\",\r\n\t\t\t  \t\t\"name\" : \"organizationId\",\r\n\t\t\t  \t\t\"value\" : page?.user?.organizationId\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\torder: 'ascending',\r\n\t\t\trecordCount: 10,\r\n\t\t\trequest\r\n\r\n\t\t};\r\n\t}\r\n\t*/\r\n\r\n\tfunction search(q, fH, bCount){\r\n\t\t\r\n\t\tvar sKey = q.key();\r\n\t\tlet type = (q.entity.type + (bCount ? \"-Count\" : \"\"));\r\n\t\tif(q.entity.cache){\r\n\t\t\tvar o = getFromCache(type, \"GET\", sKey);\r\n\t\t\tif(o){\r\n\t\t\t\tif(fH) fH(o);\r\n\t\t\t\treturn o;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(q.entity.cache && typeof v != \"undefined\" && v != null){addToCache(type,\"GET\",sKey,v);} if(f) f(v);};\r\n\t\treturn post(sModelSvc + \"/search\" + (bCount ? \"/count\" : \"\"), q.entity, fc);\r\n\t}\r\n\tfunction trace( bEnable, fH){\r\n\t\tif(typeof bEnable != \"boolean\") bEnable = true;\r\n\t\treturn get(sAuthZ + \"/unknown/trace/\" + bEnable, fH);\r\n\t}\r\n\tfunction member(sObjectType, sObjectId, sField, sActorType, sActorId, bEnable, fH){\r\n\t\treturn get(sAuthZ + \"/\" + sObjectType + \"/\" + sObjectId + \"/member/\" + sField + \"/\" + sActorType + \"/\" + sActorId + \"/\" + bEnable, fH);\r\n\t}\r\n\tfunction getApplicationProfile(fH){\r\n\t\treturn get(sPrincipal + \"/application\", fH);\r\n\t}\r\n\tfunction getPrincipal(fH){\r\n\t\treturn get(sPrincipal + \"/\", fH);\r\n\t}\r\n\tfunction getImageTags(sObjectId, fH){\r\n\t\tif(!sObjectId){\r\n\t\t\tconsole.error(\"Invalid objectId (\" + sObjectId + \")\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet sType = \"data.data\";\r\n\t\tvar o = getFromCache(sType, \"GET\", sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"GET\",sObjectId,v);} if(f) f(v);};\r\n\t    return get(sTagSvc + \"/\" + sObjectId, fc);\r\n\t}\r\n\tfunction applyImageTags(sObjectId, fH){\r\n\t\tif(!sObjectId){\r\n\t\t\tconsole.error(\"Invalid objectId (\" + sObjectId + \")\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet sType = \"data.data\";\r\n\t\tvar o = getFromCache(sType, \"GET\", sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"GET\",sObjectId,v);} if(f) f(v);};\r\n\t    return get(sTagSvc + \"/apply/\" + sObjectId, fc);\r\n\t}\r\n\tfunction getByObjectId(sType,sObjectId, fH){\r\n\t\tif(!sType || !sObjectId){\r\n\t\t\tconsole.error(\"Invalid type (\" + sType + \") or objectId (\" + sObjectId + \")\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar o = getFromCache(sType, \"GET\", sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"GET\",sObjectId,v);} if(f) f(v);};\r\n\t    return get(sModelSvc + \"/\" + sType + \"/\" + sObjectId, fc);\r\n\t}\r\n\tfunction getFullByObjectId(sType, sObjectId){\r\n\t\treturn get(sModelSvc + \"/\" + sType + \"/\" + sObjectId + \"/full\");\r\n\t}\r\n\tfunction getByUrn(sType, urn, fH){\r\n\t\tvar sKey = sType + \"-\" + urn;\r\n\t\tvar o = getFromCache(sType, \"GET\", sKey);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType, \"GET\", sKey, v);} if(f) f(v);};\r\n\t\tconsole.error(\"REFACTOR: getByUrn\");\r\n\t}\r\n\r\n\tfunction getByName(sType,sObjectId,sName,fH, bParent){\r\n\t\tvar sKey = sObjectId + \"-\" + sName;\r\n\t\t//console.log(\"Get by name\", sName);\r\n\t\tvar o = getFromCache(sType, \"GET\", sKey);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"GET\",sKey,v);} if(f) f(v);};\r\n\t\treturn get(sModelSvc + \"/\" + sType + \"/\" + (bParent ? \"parent/\" : \"\") + sObjectId + \"/\" + sName,fc);\r\n\t}\r\n\tfunction getByNameInGroupParent(sType,sObjectId,sName,fH){\r\n\t\tconsole.warn(\"REFACTOR: getByNameInGroupParent\");\r\n\t\treturn getByName(sType, sObjectId, sName, fH, 1);\r\n\t}\r\n\r\n    function stream(sObjectId, i, l, fH){\r\n\t    return get(sStreamSvc + \"/\" + sObjectId + \"/\" + i + \"/\" + (l || 0), fH);\r\n\t}\r\n\r\n\tfunction count(sType,sObjectId,fH){\r\n\t\tvar o = getFromCache(sType, \"COUNT\", sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"COUNT\",sObjectId,v);} if(f) f(v);};\r\n\t\t//console.error(\"REFACTOR: count\");\r\n\t    return get(sList + \"/\" + sType + \"/\" + sObjectId + \"/count\",fc);\r\n\t}\r\n\t/*\r\n\tfunction countInParent(sType,sObjectId,fH){\r\n\t\tvar o = getFromCache(sType, \"COUNT\", sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"COUNT\",sObjectId,v);} if(f) f(v);};\r\n\t   return get(sList + \"/\" + sType + \"/parent/\" + sObjectId + \"/count\",fc);\r\n\t}\r\n\t*/\r\n\tfunction list(sType, sObjectId, sFields, iStart, iLength, fH){\r\n\t\tvar sK = \"LIST-\" + sType + \"-\" + (sObjectId ? sObjectId : \"0\") + \"-\" + sFields + \"-\" + iStart + \"-\" + iLength;\r\n\t\tvar o = getFromCache(sType, sK, sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,sK,sObjectId,v);} if(f) f(v);};\r\n\t\treturn get(sList + \"/\" + sType + \"/\" + sObjectId + \"/\" + (sFields ? sFields + \"/\" : \"\") + iStart + \"/\" + iLength,fc);\r\n\t}\r\n\t/*\r\n\tfunction listInParent(sType, sObjectId, iStart, sFields, iLength, fH){\r\n\t\t\r\n\t\tvar sK = \"LIST-\" + sType + \"-\" + (sObjectId ? sObjectId : \"0\") + \"-\" + sFields + \"-\" + iStart + \"-\" + iLength;\r\n\t\tvar o = getFromCache(sType, sK, sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,sK,sObjectId,v);} if(f) f(v);};\r\n\t\treturn get(sList + \"/\" + sType + \"/parent/\" + sObjectId + \"/\" + iStart + \"/\" + iLength,fc);\r\n\t}\r\n\t*/\r\n\tfunction findTags(sType, sObjId, fH){\r\n\t\tconsole.error(\"REFACTOR: findTags\");\r\n\t\t// return Hemi.xml.getJSON(sSearch + \"/\" + sType + \"/tags/\" + sObjId,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction findBy(sType, sObjId, oSearch, fH){\r\n\t\tconsole.error(\"REFACTOR: findBy\");\r\n\t\t// return Hemi.xml.postJSON(sSearch + \"/\" + sType + \"/\" + sObjId,oSearch,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction findByTag(sType, oSearch, fH){\r\n\t\tconsole.error(\"REFACTOR: findByTag\");\r\n\t\t// return Hemi.xml.postJSON(sSearch + \"/\" + sType + \"/tags\",oSearch,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction countByTag(sType, oSearch, fH){\r\n\t\tconsole.error(\"REFACTOR: countByTag\");\r\n\t\t// return Hemi.xml.postJSON(sSearch + \"/\" + sType + \"/tags/count\",oSearch,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction find(sType,sObjType,sPath,fH){\r\n\t\t// console.error(\"REFACTOR: find\");\r\n\t\treturn makeFind(sType,sObjType,sPath,0,fH);\r\n\t}\r\n\tfunction make(sType,sObjType,sPath,fH){\r\n\t\t// console.error(\"REFACTOR: make\");\r\n\t\treturn makeFind(sType,sObjType,sPath,1,fH);\r\n\t}\r\n\r\n\tfunction makeFind(sType, sObjType, sPath, bMake,fH){\r\n\t\tvar sK = \"FIND-\" + sObjType;\r\n\r\n\t\t/// Band-aid - need to better encode these\r\n\t\t///\r\n\t\tif(sPath.match(/^\\//) || sPath.match(/\\./)){\r\n\t\t\tsPath = \"B64-\" + uwm.base64Encode(sPath).replace(/=/gi,\"%3D\");\r\n\t\t}\r\n\t\tvar o = getFromCache(sType, sK, sPath);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,sK,sPath,v);} if(f) f(v);};\r\n\r\n\t\treturn get(sPathSvc + (bMake ? \"/make/\" : \"/find/\") + sType + \"/\" + sObjType + \"/\" + sPath,fc);\r\n\t}\r\n\t\r\n\tfunction getDotPath(path, sAlt){\r\n\t\tif(!path){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn path.replace(/^\\//,\"\").replace(/\\//gi,(sAlt ? sAlt : \".\"));\r\n\t}\r\n\t\r\n\tfunction logout(fH){\r\n\t\tvar f = fH;\r\n\t\tam7client.currentOrganization = sCurrentOrganization = 0;\r\n\t\tam7client.clearCache(0,1);\r\n\t\treturn get(g_application_path + \"/rest/logout\").then((b) => {\r\n\t\t\tif(f){\r\n\t\t\t\tf(b);\r\n\t\t\t}\r\n\t\t\treturn b;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction loginWithPassword(sOrg, sName, sCred, fH){\r\n\t\tlet cred = {\r\n\t\t\tschema: \"auth.credential\",\r\n\t\t\tname: sName,\r\n\t\t\tcredential: Base64.encode(sCred),\r\n\t\t\torganizationPath: sOrg,\r\n\t\t\ttype: \"hashed_password\"\r\n\t\t};\r\n\t\treturn login(cred, fH);\r\n\t}\r\n\r\n\tfunction get(url, fH){\r\n\t\treturn m.request({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl,\r\n\t\t\twithCredentials: true\r\n\t\t}).then((x) => {\r\n\t\t\tif(fH){\r\n\t\t\t\tfH(x);\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t}).catch((x) =>{\r\n\t\t\tconsole.error(\"Failed to get \" + url);\r\n\t\t\tif(fH){\r\n\t\t\t\tfH();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction del(url, fH){\r\n\t\treturn m.request({\r\n\t\t\tmethod: 'DELETE',\r\n\t\t\turl,\r\n\t\t\twithCredentials: true\r\n\t\t}).then((x) => {\r\n\t\t\tif(fH){\r\n\t\t\t\tfH(x);\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction post(url, data, fH){\r\n\t\treturn m.request({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl,\r\n\t\t\twithCredentials: true,\r\n\t\t\tbody: data\r\n\t\t}).then((x) => {\r\n\t\t\tif(fH){\r\n\t\t\t\tfH(x);\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t}).catch((x) =>{\r\n\t\t\tconsole.error(\"Failed to post \" + url, x);\r\n\t\t\tif(fH){\r\n\t\t\t\tfH();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction patch(url, data, fH){\r\n\t\treturn m.request({\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\turl,\r\n\t\t\twithCredentials: true,\r\n\t\t\tbody: data\r\n\t\t}).then((x) => {\r\n\t\t\tif(fH){\r\n\t\t\t\tfH(x);\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction login(cred, fH){\r\n\t\tam7client.currentOrganization = sCurrentOrganization = cred.organizationPath;\r\n\t\treturn post(g_application_path + \"/rest/login\", cred, fH);\r\n\t}\r\n\t\r\n\tfunction getObjectAuthorization(sType, sObjectId, fH){\r\n\t\tvar sK = sObjectId + \" Authorization\";\r\n\t\tvar o = getFromCache(sType, \"GET\", sK);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(\"\", o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,\"GET\",sK, v);} if(f) f(v);};\r\n\t\tconsole.error(\"REFACTOR: getObjectAuthorization\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/\" + sType + \"/system/\" + sObjectId,fc,(fH ? 1 : 0));\r\n\t}\r\n\tfunction listSystemPermissions(fH){\r\n\t\tvar sK = sCurrentOrganization + \" SystemPermissions\";\r\n\t\tvar o = getFromCache(\"PERMISSION\", \"GET\", sK);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(\"PERMISSION\",\"GET\",sK,v);} if(f) f(v);};\r\n\t\tconsole.error(\"REFACTOR: listSystemPermissions - moved to ApplicationProfile\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/PERMISSION/systemPermissions\",fc,(fH ? 1 : 0));\r\n\t}\r\n\tfunction listSystemRoles(fH){\r\n\t\tvar sK = sCurrentOrganization + \" SystemRoles\";\r\n\t\tvar o = getFromCache(\"ROLE\", \"GET\", sK);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(\"ROLE\",\"GET\",sK,v);} if(f) f(v);};\r\n\t\tconsole.error(\"REFACTOR: listSystemRoles - moved to ApplicationProfile\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/ROLE/systemRoles\",fc,(fH ? 1 : 0));\r\n\t}\r\n\tfunction listSystemPolicies(fH){\r\n\t\tvar sK = sCurrentOrganization + \" SystemPolicies\";\r\n\t\tvar o = getFromCache(\"POLICY\", \"GET\", sK);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(\"POLICY\",\"GET\",sK,v);} if(f) f(v);};\r\n\t\tconsole.error(\"REFACTOR: listSystemPolicies\");\r\n\t\t//return Hemi.xml.getJSON(sAuthZ + \"/ROLE/systemPolicies\",fc,(fH ? 1 : 0));\r\n\t}\r\n\r\n\tfunction permitSystem(sType, sObjectId, sActorType, sActorId, bView, bEdit, bDelete, bCreate, fH){\r\n\t\tconsole.error(\"REFACTOR: permitSystem\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/\" + sType + \"/\" + sObjectId + \"/permit/\" + sActorType + \"/\" + sActorId + \"/\" + bView + \"/\" + bEdit + \"/\" + bDelete + \"/\" + bCreate,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction permit(sType, sObjectId, sActorType, sActorId, sPermId, bEnable, fH){\r\n\t\tconsole.error(\"REFACTOR: permit\");\r\n\t\t//return Hemi.xml.getJSON(sAuthZ + \"/\" + sType + \"/\" + sObjectId + \"/permit/\" + sActorType + \"/\" + sActorId + \"/\" + sPermId + \"/\" + bEnable,fH,(fH ? 1 : 0));\r\n\t}\r\n\tfunction listMembers(sType, sObjectId, sActorType, iStart, iCount, fH){\r\n\t\tvar sK = \"LIST-\" + sType + \"-\" + (sObjectId ? sObjectId : \"0\") + \"-\" + sActorType + \"-\" + iStart + \"-\" + iCount;\r\n\t\tvar o = getFromCache(sType, sK, sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,sK,sObjectId,v);} if(f) f(v);};\r\n\t\treturn get(sAuthZ + \"/\" + sType + \"/\" + sObjectId + \"/\" + sActorType + \"/\" + iStart + \"/\" + iCount, fc);\t\r\n\t}\r\n\tfunction countMembers(sType, sObjectId, sActorType, fH){\r\n\t\tvar sK = \"COUNT-\" + sType + \"-\" + (sObjectId ? sObjectId : \"0\") + \"-\" + sActorType;\r\n\t\tvar o = getFromCache(sType, sK, sObjectId);\r\n\t\tif(o){\r\n\t\t\tif(fH) fH(o);\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tvar f = fH;\r\n\t\tvar fc = function(v){if(typeof v != \"undefined\" && v != null){addToCache(sType,sK,sObjectId,v);} if(f) f(v);};\r\n\t\treturn get(sAuthZ + \"/\" + sType + \"/\" + sObjectId + \"/\" + sActorType + \"/count\",fc);\t\r\n\t}\r\n\t\r\n\tfunction getUserPersonObject(sId,fH){\r\n\t\treturn new Promise((res, rej) => {\r\n\t\t\tif(!sId){\r\n\t\t\t\tgetPrincipal().then((o)=>{\r\n\t\t\t\t\tvar o = getPrincipal();\r\n\t\t\t\t\tif(o) sId = o.objectId;\r\n\t\t\t\t\tget(sPrincipal + \"/person\" + (sId ? \"/\" + sId : \"\")).then((x)=>{\r\n\t\t\t\t\t\tif(fH) fH(\"\",x);\r\n\t\t\t\t\t\tres(x);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse get(sPrincipal + \"/person\" + (sId ? \"/\" + sId : \"\"),fH).then((x)=>{\r\n\t\t\t\tif(fH) fH(\"\",x);\r\n\t\t\t\tres(x);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getUserObject(sType,sOType,fH){\r\n\t\tif(!sType && !sOType) return getPrincipal(fH);\r\n\t\treturn get(sModelSvc + \"/\" + sType + \"/user/\" + sOType,fH);\r\n\t}\r\n\r\n\tfunction listUserRoles(sObjId, fH){\r\n\t\tif(!sObjId) sObjId = null;\r\n\t\tconsole.error(\"REFACTOR: listUserRoles\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/USER/roles/\" + sObjId,fH,(fH ? 1 : 0));\r\n\t}\r\n\r\n\tfunction listEntitlementsForType(sType, sObjId, fH){\r\n\t\tif(!sObjId) sObjId = null;\r\n\t\tconsole.error(\"REFACTOR: listEntitlementsForType\");\r\n\t\t// return Hemi.xml.getJSON(sAuthZ + \"/\" + sType + \"/entitlements/\" + sObjId,fH,(fH ? 1 : 0));\r\n\t}\r\n\r\n\r\n\tfunction mediaDataPath(oObj, bThumb){\r\n\t\treturn g_application_path + \"/\" + (bThumb ? \"thumbnail\" : \"media\") + \"/\" + am7client.dotPath(o.organizationPath) + \"/data.data\" + o.groupPath + \"/\" + o.name + (bThumb ? \"/100x100\" : \"\");\r\n\t}\r\n\t\r\n\tfunction getIsRequestable(sType,sId,fH){\r\n\t\tif(!sType || !sId) return 0;\r\n\t\tconsole.error(\"REFACTOR: getIsRequestable\");\r\n\t\t// return Hemi.xml.getJSON(sAppr + \"/requestable/\" + sType + \"/\" + sId,fH,(fH ? 1 : 0));\r\n\t}\r\n\t\r\n\tfunction getOwnerApprovalPolicy(fH){\r\n\t\tconsole.error(\"REFACTOR: getOwnerApprovalPolicy\");\r\n\t\t// return Hemi.xml.getJSON(sAppr + \"/policy/owner\",fH,(fH ? 1 : 0));\r\n\t}\r\n\t\r\n\tfunction attachPolicy(sType,sId,sPid,fH){\r\n\t\tif(!sType || !sId || !sPid) return 0;\r\n\t\tconsole.error(\"REFACTOR: attachPolicy\");\r\n\t\t// return Hemi.xml.getJSON(sAppr + \"/policy/attach/\" + sType + \"/\" + sId + \"/\" + sPid,fH,(fH ? 1 : 0));\r\n\t}\r\n\r\n\twindow.am7client = {\r\n\t\texecuteScript : executeScript,\r\n\t\texecuteScriptById : executeScriptById,\r\n\t\tdotPath : getDotPath,\r\n\t\tdefine : define,\r\n\t\tmember,\r\n\t\tevaluate : evaluate,\r\n\t\tfind : find,\r\n\t\townerApprovalPolicy : getOwnerApprovalPolicy,\r\n\t\tisRequestable : getIsRequestable,\r\n\t\tattachPolicy : attachPolicy,\r\n\t\tfindByTag : findByTag,\r\n\t\tfindBy : findBy,\r\n\t\tsearch : search,\r\n\t\t// query : query,\r\n\t\tnewQuery : newQuery,\r\n\t\tsearchCount : searchCount,\r\n\t\tcountByTag : countByTag,\r\n\t\tfindTags : findTags,\r\n\t\tmake : make,\r\n\t\tmediaDataPath : mediaDataPath,\r\n\t\t/*\r\n\t\tlistInParent : listInParent,\r\n\t\tcountInParent : countInParent,\r\n\t\t*/\r\n\t\tlist : list,\r\n\t\tcount: count,\r\n\t\tstream: stream,\r\n\t\tget : getByObjectId,\r\n\t\tgetFull: getFullByObjectId,\r\n\t\tgetByUrn: getByUrn,\r\n\t\tgetByName : getByName,\r\n\t\tgetByNameInGroupParent : getByNameInGroupParent,\r\n\t\tpatch: patchObject,\r\n\t\tcreate,\r\n\t\tupdateBulk : updateBulk,\r\n\t\tdelete : deleteObject,\r\n\t\tcache : getCache,\r\n\t\tgetCache: getFromCache,\r\n\t\tprincipal : getPrincipal,\r\n\t\tentitlements : listEntitlementsForType,\r\n\t\tuserRoles : listUserRoles,\r\n\t\tauthorization : getObjectAuthorization,\r\n\t\tpermit : permit,\r\n\t\tpermitSystem : permitSystem,\r\n\t\tmembers : listMembers,\r\n\t\tcountMembers,\r\n\t\tsystemRoles : listSystemRoles,\r\n\t\tsystemPolicies : listSystemPolicies,\r\n\t\tsystemPermissions : listSystemPermissions,\r\n\t\tuser: getUserObject,\r\n\t\tapplication : getApplicationProfile,\r\n\t\tuserPerson : getUserPersonObject,\r\n\t\tnewPrimaryCredential : newPrimaryCredential,\r\n\t\tclearCache,\r\n\t\tcleanup,\r\n\t\ttrace,\r\n\t\tclearAuthorizationCache : function(fH){\r\n\t\t\treturn get(sCache + \"/clearAuthorization\",fH);\r\n\t\t},\r\n\t\tpatchAttribute: async function(o, n, v){\r\n\t\t\tlet a = am7client.getAttribute(o, n);\r\n\t\t\tif(!a){\r\n\t\t\t\ta = am7client.addAttribute(o, n, v);\r\n\t\t\t\tawait create(a[am7model.jsonModelKey], a);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\ta[am7model.jsonModelKey] = \"common.attribute\";\r\n\t\t\t\ta.value = v;\r\n\t\t\t\tawait patchObject(a[am7model.jsonModelKey], a);\r\n\t\t\t}\r\n\t\t\treturn a;\t\t\t\r\n\t\t},\r\n\t\tgetAttribute : function(o,n){\r\n\t\t\tif(!o || o == null || !o.attributes){\r\n                return null;\r\n            }\r\n            let r = o.attributes.filter(a => {if(a.name === n) return a;});\r\n            return (r ? r[0] : null);\r\n\t\t},\r\n\t\tgetAttributeValue : function(o,n,d){\r\n\t\t\tvar a = am7client.getAttribute(o,n);\r\n\t\t\tif(!a) return d;\r\n\t\t\treturn a.value;\r\n\t\t},\r\n\t\taddAttribute : function(o,s,v){\r\n\t\t\tif(!o.attributes) o.attributes = [];\r\n\t\t\tlet a = am7client.newAttribute(s,v);\r\n\t\t\ta.referenceModel = o[am7model.jsonModelKey];\r\n\t\t\ta.referenceId = o.id || 0;\r\n\t\t\to.attributes.push(a);\r\n\t\t\treturn a;\r\n\t\t},\r\n\t\tnewAttribute : function(s, v){\r\n\t\t\tvar a = am7model.newPrimitive(\"common.attribute\"),x=null;\r\n\t\t\ta.valueType = \"string\";\r\n\t\t\ta.name = s;\r\n\t\t\t\r\n\t\t\tif(typeof v == \"string\") x = v;\r\n\t\t\telse if(typeof v == \"number\"){\r\n\t\t\t\tlet vs = \"\" + v;\r\n\t\t\t\tif(vs.match(/\\./)) a.valueType = 'double';\r\n\t\t\t\telse a.valueType = 'int';\r\n\t\t\t\tx = v;\r\n\t\t\t}\r\n\t\t\telse if(typeof v == \"object\" && v instanceof Array) x = v;\r\n\t\t\telse console.warn(\"Expected string or array object for value\");\r\n\t\t\ta.value = x;\r\n\t\t\treturn a;\r\n\t\t},\r\n\t\tremoveAttribute : function(o, n){\r\n\t\t\tif(!o.attributes || o.attributes == null) return 0;\r\n\t\t\tfor(var i = 0; i < o.attributes.length; i++){\r\n\t\t\t\tif(o.attributes[i].name == n){\r\n\t\t\t\t\to.attributes.splice(i,1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tlogin : login,\r\n\t\tloginWithPassword : loginWithPassword,\r\n\t\tlogout : logout,\r\n\t\tbase:function(){\r\n\t\t\treturn sBase;\r\n\t\t},\r\n\t\tgetImageTags,\r\n\t\tapplyImageTags\r\n\t};\r\n\r\n\t\r\n}());\r\n\r\n\n\n;/* === common/base64.js === */\n(function(){\r\n/**\r\n*\r\n*  Base64 encode / decode\r\n*  http://www.webtoolkit.info/\r\n*\r\n**/\r\n\r\n    var Base64 = {\r\n    \r\n        // private property\r\n        _keyStr : \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n    \r\n        // public method for encoding\r\n        encode : function (input) {\r\n            var output = \"\";\r\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\r\n            var i = 0;\r\n    \r\n            //input = Base64._utf8_encode(input);\r\n    \r\n            while (i < input.length) {\r\n    \r\n                chr1 = input.charCodeAt(i++);\r\n                chr2 = input.charCodeAt(i++);\r\n                chr3 = input.charCodeAt(i++);\r\n    \r\n                enc1 = chr1 >> 2;\r\n                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\r\n                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\r\n                enc4 = chr3 & 63;\r\n    \r\n                if (isNaN(chr2)) {\r\n                    enc3 = enc4 = 64;\r\n                } else if (isNaN(chr3)) {\r\n                    enc4 = 64;\r\n                }\r\n    \r\n                output = output +\r\n                this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +\r\n                this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);\r\n    \r\n            }\r\n    \r\n            return output;\r\n        },\r\n    \r\n        // public method for decoding\r\n        decode : function (input) {\r\n            var output = \"\";\r\n            var chr1, chr2, chr3;\r\n            var enc1, enc2, enc3, enc4;\r\n            var i = 0;\r\n    \r\n            input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n    \r\n            while (i < input.length) {\r\n    \r\n                enc1 = this._keyStr.indexOf(input.charAt(i++));\r\n                enc2 = this._keyStr.indexOf(input.charAt(i++));\r\n                enc3 = this._keyStr.indexOf(input.charAt(i++));\r\n                enc4 = this._keyStr.indexOf(input.charAt(i++));\r\n    \r\n                chr1 = (enc1 << 2) | (enc2 >> 4);\r\n                chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\r\n                chr3 = ((enc3 & 3) << 6) | enc4;\r\n    \r\n                output = output + String.fromCharCode(chr1);\r\n    \r\n                if (enc3 != 64) {\r\n                    output = output + String.fromCharCode(chr2);\r\n                }\r\n                if (enc4 != 64) {\r\n                    output = output + String.fromCharCode(chr3);\r\n                }\r\n    \r\n            }\r\n    \r\n            //output = Base64._utf8_decode(output);\r\n    \r\n            return output;\r\n    \r\n        },\r\n    \r\n        // private method for UTF-8 encoding\r\n        _utf8_encode : function (string) {\r\n            string = string.replace(/\\r\\n/g,\"\\n\");\r\n            var utftext = \"\";\r\n    \r\n            for (var n = 0; n < string.length; n++) {\r\n    \r\n                var c = string.charCodeAt(n);\r\n    \r\n                if (c < 128) {\r\n                    utftext += String.fromCharCode(c);\r\n                }\r\n                else if((c > 127) && (c < 2048)) {\r\n                    utftext += String.fromCharCode((c >> 6) | 192);\r\n                    utftext += String.fromCharCode((c & 63) | 128);\r\n                }\r\n                else {\r\n                    utftext += String.fromCharCode((c >> 12) | 224);\r\n                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n                    utftext += String.fromCharCode((c & 63) | 128);\r\n                }\r\n    \r\n            }\r\n    \r\n            return utftext;\r\n        },\r\n    \r\n        // private method for UTF-8 decoding\r\n        _utf8_decode : function (utftext) {\r\n            var string = \"\";\r\n            var i = 0;\r\n            var c = c1 = c2 = 0;\r\n    \r\n            while ( i < utftext.length ) {\r\n    \r\n                c = utftext.charCodeAt(i);\r\n    \r\n                if (c < 128) {\r\n                    string += String.fromCharCode(c);\r\n                    i++;\r\n                }\r\n                else if((c > 191) && (c < 224)) {\r\n                    c2 = utftext.charCodeAt(i+1);\r\n                    string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\r\n                    i += 2;\r\n                }\r\n                else {\r\n                    c2 = utftext.charCodeAt(i+1);\r\n                    c3 = utftext.charCodeAt(i+2);\r\n                    string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n                    i += 3;\r\n                }\r\n    \r\n            }\r\n    \r\n            return string;\r\n        }\r\n    \r\n    };\r\n    if(typeof module == \"undefined\"){\r\n        window.Base64 = Base64;\r\n    }\r\n    else{\r\n        module.exports = Base64;\r\n    }\r\n}());\n\n;/* === model/modelDef.js === */\n(function () {\r\n  /// Generated by http://localhost:8080/AccountManagerService7/rest/schema\r\n\r\n  let am7model = {\r\n  \"jsonModelKey\": \"schema\",\r\n  \"categories\": [\r\n    {\r\n      \"schema\": \"system.modelCategory\",\r\n      \"name\": \"identity\",\r\n      \"label\": \"Identity\",\r\n      \"icon\": \"account_tree\",\r\n      \"order\": [\r\n        \"system.user\",\r\n        \"identity.person\",\r\n        \"identity.account\",\r\n        \"auth.role\",\r\n        \"auth.permission\",\r\n        \"identity.contact\",\r\n        \"identity.address\"\r\n      ],\r\n      \"prototypes\": [\r\n        {\r\n          \"schema\": \"system.modelCategory\",\r\n          \"name\": \"application\",\r\n          \"pathName\": \"Applications\",\r\n          \"prototype\": true,\r\n          \"type\": \"group\",\r\n          \"limit\": [\r\n            \"data.data\",\r\n            \"auth.group\",\r\n            \"auth.permission\",\r\n            \"identity.account\"\r\n          ],\r\n          \"icon\": \"web_asset\",\r\n          \"order\": [\r\n            \"identity.account\",\r\n            \"auth.group\",\r\n            \"auth.permission\",\r\n            \"data.data\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"schema\": \"system.modelCategory\",\r\n      \"label\": \"Assets\",\r\n      \"name\": \"asset\",\r\n      \"order\": [\r\n        \"identity.application\",\r\n        \"gallery\",\r\n        \"article\",\r\n        \"data.data\",\r\n        \"data.note\",\r\n        \"auth.group\",\r\n        \"data.tag\"\r\n      ],\r\n      \"icon\": \"emoji_objects\",\r\n      \"prototypes\": [\r\n        {\r\n          \"schema\": \"system.modelCategory\",\r\n          \"name\": \"gallery\",\r\n          \"prototype\": true,\r\n          \"group\": \"Gallery\",\r\n          \"label\": \"Gallery\",\r\n          \"limit\": [\r\n            \"data.data\",\r\n            \"auth.group\"\r\n          ],\r\n          \"type\": \"group\",\r\n          \"icon\": \"collections\",\r\n          \"order\": [\r\n            \"auth.group\",\r\n            \"data.data\"\r\n          ]\r\n        },\r\n        {\r\n          \"schema\": \"system.modelCategory\",\r\n          \"name\": \"article\",\r\n          \"prototype\": true,\r\n          \"group\": \"Articles\",\r\n          \"limit\": [\r\n            \"data.data\",\r\n            \"auth.group\"\r\n          ],\r\n          \"type\": \"auth.group\",\r\n          \"icon\": \"article\",\r\n          \"label\": \"Articles\",\r\n          \"order\": [\r\n            \"auth.group\",\r\n            \"data.data\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"schema\": \"system.modelCategory\",\r\n      \"name\": \"process\",\r\n      \"label\": \"Process\",\r\n      \"order\": [\r\n        \"access.accessRequest\",\r\n        \"methodology\",\r\n        \"process\",\r\n        \"processstep\"\r\n      ],\r\n      \"icon\": \"insights\"\r\n    },\r\n     {\r\n        \"schema\": \"system.modelCategory\",\r\n        \"name\": \"event\",\r\n        \"label\": \"Event\",\r\n        \"order\": [\r\n          /*\r\n          \"message.spool\",\r\n          \"data.geoLocation\",\r\n          \"olio.event\",\r\n          \"data.trait\"\r\n          */\r\n          \"olio.charPerson\",\r\n          \"identity.voice\",\r\n          \"olio.llm.chatConfig\",\r\n          \"olio.llm.promptConfig\",\r\n          \"olio.llm.openai.openaiRequest\",\r\n          \"olio.apparel\",\r\n          \"olio.wearable\",\r\n          \"olio.item\"\r\n        ],\r\n        \"icon\": \"event_note\"\r\n      },\r\n    {\r\n      \"schema\": \"system.modelCategory\",\r\n      \"name\": \"policy\",\r\n      \"label\": \"Policy\",\r\n      \"order\": [\r\n        \"policy.policy\",\r\n        \"policy.rule\",\r\n        \"policy.pattern\",\r\n        \"policy.fact\",\r\n        \"policy.operation\",\r\n        \"policy.function\"\r\n      ],\r\n      \"icon\": \"policy\"\r\n    },\r\n    {\r\n      \"schema\": \"system.modelCategory\",\r\n      \"name\": \"form\",\r\n      \"label\": \"Forms\",\r\n      \"order\": [\r\n        \"form\",\r\n        \"formelement\",\r\n        \"policy.validationrule\"\r\n      ],\r\n      \"icon\": \"dynamic_form\"\r\n    }\r\n  ],\r\n  \"enums\": {\r\n    \"fieldEnumType\": [\r\n      \"BLOB\",\r\n      \"BOOLEAN\",\r\n      \"BYTE\",\r\n      \"CALENDAR\",\r\n      \"DOUBLE\",\r\n      \"ENUM\",\r\n      \"FLEX\",\r\n      \"INT\",\r\n      \"LIST\",\r\n      \"LONG\",\r\n      \"MODEL\",\r\n      \"STRING\",\r\n      \"TIMESTAMP\",\r\n      \"ZONETIME\",\r\n      \"VECTOR\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"systemPermissionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"CREATE\",\r\n      \"READ\",\r\n      \"UPDATE\",\r\n      \"DELETE\",\r\n      \"EXECUTE\"\r\n    ],\r\n    \"accountEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GUEST\",\r\n      \"SYSTEM\",\r\n      \"NORMAL\",\r\n      \"DEVELOPMENT\"\r\n    ],\r\n    \"accountStatusEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"UNREGISTERED\",\r\n      \"NORMAL\",\r\n      \"RESTRICTED\",\r\n      \"REGISTERED\",\r\n      \"DISABLED\"\r\n    ],\r\n    \"actionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ADD\",\r\n      \"EXECUTE\",\r\n      \"DELETE\",\r\n      \"MODIFY\",\r\n      \"PATCH\",\r\n      \"READ\",\r\n      \"REQUEST\",\r\n      \"RESPONSE\",\r\n      \"GRANT\",\r\n      \"DENY\",\r\n      \"REJECT\",\r\n      \"APPROVE\",\r\n      \"AUTHENTICATE\",\r\n      \"AUTHORIZE\",\r\n      \"CLOSE\",\r\n      \"OPEN\",\r\n      \"REOPEN\",\r\n      \"VECTORIZE\"\r\n    ],\r\n    \"approvalEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PRIVILEGED_ACCESS\",\r\n      \"APPLICATION\",\r\n      \"ACCESS\",\r\n      \"FEDERAL\",\r\n      \"OWNER\"\r\n    ],\r\n    \"approvalResponseEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"APPROVE\",\r\n      \"DENY\",\r\n      \"REMOVE\",\r\n      \"CERTIFIED\",\r\n      \"PENDING\",\r\n      \"DUPLICATE\",\r\n      \"REQUEST\"\r\n    ],\r\n    \"approverEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GROUP\",\r\n      \"PERSON\",\r\n      \"APPLICATION\",\r\n      \"PERMISSION\",\r\n      \"ACCOUNT\",\r\n      \"USER\",\r\n      \"ROLE\"\r\n    ],\r\n    \"authenticationResponseEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"AUTHENTICATED\",\r\n      \"NOT_AUTHENTICATED\",\r\n      \"STEP_UP_REQUIRED\"\r\n    ],\r\n    \"comparatorEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ANY\",\r\n      \"NOT_ANY\",\r\n      \"EQUALS\",\r\n      \"NOT_EQUALS\",\r\n      \"BETWEEN\",\r\n      \"LESS_THAN\",\r\n      \"LESS_THAN_OR_EQUALS\",\r\n      \"GREATER_THAN\",\r\n      \"GREATER_THAN_OR_EQUALS\",\r\n      \"NOT_IN\",\r\n      \"IN\",\r\n      \"NOT_NULL\",\r\n      \"IS_NULL\",\r\n      \"IS_NULL_EQUALS\",\r\n      \"IS_NULL_NOT_EQUALS\",\r\n      \"LIKE\",\r\n      \"ILIKE\",\r\n      \"GROUP_AND\",\r\n      \"GROUP_OR\"\r\n    ],\r\n    \"compressionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"NONE\",\r\n      \"GZIP\"\r\n    ],\r\n    \"conditionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ALL\",\r\n      \"ANY\",\r\n      \"NONE\",\r\n      \"LESS_THAN\",\r\n      \"LESS_THAN_OR_EQUALS\",\r\n      \"GREATER_THAN\",\r\n      \"GREATER_THAN_OR_EQUALS\"\r\n    ],\r\n    \"connectionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"POSTGRE\",\r\n      \"H2\"\r\n    ],\r\n    \"contactEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PHONE\",\r\n      \"EMAIL\",\r\n      \"WEB\",\r\n      \"OTHER\",\r\n      \"PROFILE\"\r\n    ],\r\n    \"contactInformationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"INDIVIDUAL\",\r\n      \"GROUP\",\r\n      \"ORGANIZATION\",\r\n      \"COMPANY\",\r\n      \"ACCOUNT\",\r\n      \"USER\",\r\n      \"PERSON\"\r\n    ],\r\n    \"controlActionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ACCESS\",\r\n      \"READ\",\r\n      \"WRITE\",\r\n      \"DELETE\",\r\n      \"UPDATE\",\r\n      \"EXECUTE\",\r\n      \"ANY\"\r\n    ],\r\n    \"controlEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"POLICY\"\r\n    ],\r\n    \"credentialEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"LEGACY_PASSWORD\",\r\n      \"HASHED_PASSWORD\",\r\n      \"SALT\",\r\n      \"ENCRYPTED_PASSWORD\",\r\n      \"ENCRYPTED_IDENTITY\",\r\n      \"TOKEN\",\r\n      \"CERTIFICATE\",\r\n      \"SIGNATURE\",\r\n      \"SESSION\",\r\n      \"KEY\",\r\n      \"KNOWLEDGE\"\r\n    ],\r\n    \"effectEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GRANT_PERMISSION\",\r\n      \"DENY_PERMISSION\",\r\n      \"AGGREGATE\"\r\n    ],\r\n    \"factEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GROUP\",\r\n      \"ROLE\",\r\n      \"PERMISSION\",\r\n      \"PROPERTY\",\r\n      \"ATTRIBUTE\",\r\n      \"STATIC\",\r\n      \"FACTORY\",\r\n      \"REST\",\r\n      \"FUNCTION\",\r\n      \"SUBJECT\",\r\n      \"CONTEXT\",\r\n      \"PARAMETER\",\r\n      \"OPERATION\"\r\n    ],\r\n    \"functionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"JAVASCRIPT\",\r\n      \"JAVA\",\r\n      \"REST\"\r\n    ],\r\n    \"groupEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ACCOUNT\",\r\n      \"DATA\",\r\n      \"BUCKET\",\r\n      \"USER\",\r\n      \"PERSON\"\r\n    ],\r\n    \"levelEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"LOW\",\r\n      \"MODERATE\",\r\n      \"CONSIDERABLE\",\r\n      \"HIGH\",\r\n      \"SEVERE\",\r\n      \"EXTREME\",\r\n      \"GRAVE\"\r\n    ],\r\n    \"locationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"HOME\",\r\n      \"WORK\",\r\n      \"MOBILE\",\r\n      \"OTHER\",\r\n      \"NETWORK\"\r\n    ],\r\n    \"operationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"NAMED\",\r\n      \"PERMISSION\",\r\n      \"FUNCTION\",\r\n      \"INTERNAL\"\r\n    ],\r\n    \"operationResponseEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"SUCCEEDED\",\r\n      \"FAILED\",\r\n      \"ERROR\"\r\n    ],\r\n    \"orderEnumType\": [\r\n      \"ASCENDING\",\r\n      \"DESCENDING\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"organizationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ROOT\",\r\n      \"SYSTEM\",\r\n      \"PUBLIC\",\r\n      \"DEVELOPMENT\"\r\n    ],\r\n    \"patternEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PARAMETER\",\r\n      \"FUNCTION\",\r\n      \"OPERATION\",\r\n      \"EXPRESSION\",\r\n      \"AUTHORIZATION\",\r\n      \"SEPARATION_OF_DUTY\",\r\n      \"VERIFICATION\",\r\n      \"APPROVAL\"\r\n    ],\r\n    \"permissionEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"DATA\",\r\n      \"GROUP\",\r\n      \"ROLE\",\r\n      \"PERMISSION\",\r\n      \"ACCOUNT\",\r\n      \"USER\",\r\n      \"PERSON\",\r\n      \"OBJECT\",\r\n      \"APPLICATION\"\r\n    ],\r\n    \"policyRequestEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"AUTHENTICATE\",\r\n      \"DECIDE\",\r\n      \"DEFINE\",\r\n      \"SCORE\"\r\n    ],\r\n    \"policyResponseEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"AUTHENTICATED\",\r\n      \"PERMIT\",\r\n      \"DENY\",\r\n      \"PENDING\",\r\n      \"PENDING_OPERATION\",\r\n      \"INVALID_ARGUMENT\",\r\n      \"ERROR\",\r\n      \"BANNED\",\r\n      \"DISABLED\"\r\n    ],\r\n    \"queryEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"CREATEDDATE\",\r\n      \"MODIFIEDDATE\",\r\n      \"NAME\",\r\n      \"ID\"\r\n    ],\r\n    \"responseEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PERMIT\",\r\n      \"VALID\",\r\n      \"INVALID\",\r\n      \"DENY\",\r\n      \"INFO\",\r\n      \"PENDING\"\r\n    ],\r\n    \"roleEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ACCOUNT\",\r\n      \"USER\",\r\n      \"PERSON\"\r\n    ],\r\n    \"ruleEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PERMIT\",\r\n      \"DENY\"\r\n    ],\r\n    \"spoolBucketEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"RAW\",\r\n      \"MESSAGE_QUEUE\",\r\n      \"SECURITY_TOKEN\",\r\n      \"REQUEST\",\r\n      \"APPROVAL\"\r\n    ],\r\n    \"spoolNameEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GENERAL\",\r\n      \"AUTHORIZATION\",\r\n      \"STATE\",\r\n      \"MESSAGE\",\r\n      \"QUEUE\",\r\n      \"DATA\",\r\n      \"REQUEST\",\r\n      \"ACCESS\"\r\n    ],\r\n    \"spoolStatusEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ERROR\",\r\n      \"QUEUEING\",\r\n      \"QUEUED\",\r\n      \"TRANSMITTING\",\r\n      \"TRANSMITTED\",\r\n      \"SPOOLING\",\r\n      \"SPOOLED\",\r\n      \"ACKNOWLEGED_RECEIPT\",\r\n      \"RESPONDED\",\r\n      \"PERSISTED\",\r\n      \"REJECTED\",\r\n      \"DELETED\"\r\n    ],\r\n    \"sqlDataEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ARRAY\",\r\n      \"BIGINT\",\r\n      \"BINARY\",\r\n      \"BIT\",\r\n      \"BLOB\",\r\n      \"BOOLEAN\",\r\n      \"CHAR\",\r\n      \"CLOB\",\r\n      \"DATALINK\",\r\n      \"DATE\",\r\n      \"DECIMAL\",\r\n      \"DISTINCT\",\r\n      \"DOUBLE\",\r\n      \"FLOAT\",\r\n      \"INTEGER\",\r\n      \"JAVA_OBJECT\",\r\n      \"LONGVARBINARY\",\r\n      \"LONGVARCHAR\",\r\n      \"NULL\",\r\n      \"NUMERIC\",\r\n      \"OTHER\",\r\n      \"REAL\",\r\n      \"REF\",\r\n      \"SMALLINT\",\r\n      \"STRUCT\",\r\n      \"TIME\",\r\n      \"TIMESTAMP\",\r\n      \"TINYINT\",\r\n      \"VARBINARY\",\r\n      \"VARCHAR\",\r\n      \"VECTOR\",\r\n      \"TEXT\"\r\n    ],\r\n    \"statisticsEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"USER\",\r\n      \"DATA\",\r\n      \"ACCOUNT\"\r\n    ],\r\n    \"streamEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"FILE\",\r\n      \"NETWORK\"\r\n    ],\r\n    \"tagEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ACCOUNT\",\r\n      \"DATA\",\r\n      \"USER\",\r\n      \"PERSON\",\r\n      \"GROUP\"\r\n    ],\r\n    \"userEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"GUEST\",\r\n      \"SYSTEM\",\r\n      \"NORMAL\",\r\n      \"DEVELOPMENT\"\r\n    ],\r\n    \"userStatusEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"UNREGISTERED\",\r\n      \"NORMAL\",\r\n      \"RESTRICTED\",\r\n      \"REGISTERED\",\r\n      \"DISABLED\"\r\n    ],\r\n    \"validationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"BOOLEAN\",\r\n      \"FUNCTION\",\r\n      \"REPLACEMENT\",\r\n      \"NONE\"\r\n    ],\r\n    \"valueEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"STRING\",\r\n      \"INT\",\r\n      \"LONG\",\r\n      \"BOOLEAN\",\r\n      \"DATETIME\",\r\n      \"BYTE_ARRAY\"\r\n    ],\r\n    \"verificationEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"DEFAULT\",\r\n      \"VERIFIED\",\r\n      \"NOT_VERIFIED\",\r\n      \"ERROR\"\r\n    ],\r\n    \"alignmentEnumType\": [\r\n      \"CHAOTICEVIL\",\r\n      \"NEUTRALEVIL\",\r\n      \"LAWFULEVIL\",\r\n      \"CHAOTICNEUTRAL\",\r\n      \"NEUTRAL\",\r\n      \"UNKNOWN\",\r\n      \"LAWFULNEUTRAL\",\r\n      \"CHAOTICGOOD\",\r\n      \"NEUTRALGOOD\",\r\n      \"LAWFULGOOD\"\r\n    ],\r\n    \"assessedEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"LOCATION\",\r\n      \"GROUP\",\r\n      \"INDIVIDUAL\",\r\n      \"ENCOUNTER\"\r\n    ],\r\n    \"assessmentEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"PHYSIOLOGICAL\",\r\n      \"SAFETY\",\r\n      \"LOVE\",\r\n      \"ESTEEM\",\r\n      \"SELF\",\r\n      \"REPLENISH\",\r\n      \"PREDICTION\",\r\n      \"PREDILECTION\",\r\n      \"CURIOSITY\"\r\n    ],\r\n    \"characterRoleEnumType\": [\r\n      \"ACQUAINTENCE\",\r\n      \"ANTAGONIST\",\r\n      \"ANTIHERO\",\r\n      \"CONFIDANT\",\r\n      \"CONTAGONIST\",\r\n      \"DEUTERAGONIST\",\r\n      \"ENEMY_INTEREST\",\r\n      \"FOIL\",\r\n      \"GUIDE\",\r\n      \"HENCHMAN\",\r\n      \"INDETERMINATE\",\r\n      \"LOVE_INTEREST\",\r\n      \"STRANGER\",\r\n      \"FRIEND_INTEREST\",\r\n      \"COMPANION\",\r\n      \"PROTAGONIST\",\r\n      \"TEMPTRESS\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"densityEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"ROADHOUSE\",\r\n      \"HOMESTEAD\",\r\n      \"BAND\",\r\n      \"HAMLET\",\r\n      \"TRIBE\",\r\n      \"VILLAGE\",\r\n      \"RESIDENTIAL_TOWN\",\r\n      \"TOWN\",\r\n      \"CITY\",\r\n      \"METROPOLIS\",\r\n      \"ECUMENOPOLIS\"\r\n    ],\r\n    \"directionEnumType\": [\r\n      \"NORTH\",\r\n      \"NORTHEAST\",\r\n      \"EAST\",\r\n      \"SOUTHEAST\",\r\n      \"SOUTH\",\r\n      \"SOUTHWEST\",\r\n      \"WEST\",\r\n      \"NORTHWEST\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"esteemNeedsEnumType\": [\r\n      \"RESPECT\",\r\n      \"SELF_ESTEEM\",\r\n      \"STATUS\",\r\n      \"RECOGNITION\",\r\n      \"STRENGTH\",\r\n      \"FREEDOM\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"ethnicityEnumType\": [\r\n      \"A\",\r\n      \"B\",\r\n      \"D\",\r\n      \"E\",\r\n      \"F\",\r\n      \"G\",\r\n      \"H\",\r\n      \"J\",\r\n      \"K\",\r\n      \"L\",\r\n      \"P\",\r\n      \"Q\",\r\n      \"S\",\r\n      \"T\",\r\n      \"V\",\r\n      \"W\",\r\n      \"ZERO\",\r\n      \"ONE\",\r\n      \"TWO\",\r\n      \"THREE\",\r\n      \"FOUR\",\r\n      \"FIVE\",\r\n      \"SIX\",\r\n      \"SEVEN\",\r\n      \"EIGHT\",\r\n      \"NINE\",\r\n      \"TEN\",\r\n      \"ELEVEN\",\r\n      \"TWELVE\",\r\n      \"THIRTEEN\",\r\n      \"FOURTEEN\"\r\n    ],\r\n    \"highEnumType\": [\r\n      \"DISREGARDED\",\r\n      \"NEVER\",\r\n      \"LOW\",\r\n      \"MINIMAL\",\r\n      \"DIMINISHED\",\r\n      \"INSIGNIFICANT\",\r\n      \"WEAK\",\r\n      \"MODEST\",\r\n      \"MARGINAL\",\r\n      \"AVERAGE\",\r\n      \"MODERATE\",\r\n      \"INTERMEDIATE\",\r\n      \"FAIR\",\r\n      \"ADEQUATE\",\r\n      \"BALANCED\",\r\n      \"ELEVATED\",\r\n      \"SUBSTANTIAL\",\r\n      \"STRONG\",\r\n      \"PROFOUND\",\r\n      \"EXTENSIVE\",\r\n      \"PEAK\",\r\n      \"MAXIMUM\",\r\n      \"HERO\"\r\n    ],\r\n    \"instinctEnumType\": [\r\n      \"DISREGARDED\",\r\n      \"INCONCEIVABLE\",\r\n      \"FATAL\",\r\n      \"VAGUE\",\r\n      \"WEAK\",\r\n      \"IMBALANCED\",\r\n      \"INADEQUATE\",\r\n      \"INSIGNIFICANT\",\r\n      \"DIMINISHED\",\r\n      \"BELOW_AVERAGE\",\r\n      \"MINIMAL\",\r\n      \"LOW\",\r\n      \"STASIS\",\r\n      \"MODEST\",\r\n      \"MARGINAL\",\r\n      \"AVERAGE\",\r\n      \"FAIR\",\r\n      \"ADEQUATE\",\r\n      \"BALANCED\",\r\n      \"ELEVATED\",\r\n      \"STRONG\",\r\n      \"PROFOUND\",\r\n      \"PEAK\",\r\n      \"UNCONTROLLABLE\"\r\n    ],\r\n    \"interactionEnumType\": [\r\n      \"ACCOMMODATE\",\r\n      \"ALLY\",\r\n      \"BARTER\",\r\n      \"BEFRIEND\",\r\n      \"BETRAY\",\r\n      \"BREAK_UP\",\r\n      \"COERCE\",\r\n      \"COMBAT\",\r\n      \"COMMERCE\",\r\n      \"COMMUNICATE\",\r\n      \"COMPETE\",\r\n      \"CONFLICT\",\r\n      \"CONGREGATE\",\r\n      \"COOPERATE\",\r\n      \"CORRESPOND\",\r\n      \"CRITICIZE\",\r\n      \"DATE\",\r\n      \"DEBATE\",\r\n      \"DEFEND\",\r\n      \"ENTERTAIN\",\r\n      \"EXCHANGE\",\r\n      \"EXPRESS_GRATITUDE\",\r\n      \"EXPRESS_INDIFFERENCE\",\r\n      \"HELP\",\r\n      \"INTIMATE\",\r\n      \"INVESTIGATE\",\r\n      \"MENTOR\",\r\n      \"NEGOTIATE\",\r\n      \"NONE\",\r\n      \"OPPOSE\",\r\n      \"PEER_PRESSURE\",\r\n      \"RECREATE\",\r\n      \"RELATE\",\r\n      \"ROMANCE\",\r\n      \"SHUN\",\r\n      \"SEPARATE\",\r\n      \"SOCIALIZE\",\r\n      \"THREATEN\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"loveNeedsEnumType\": [\r\n      \"FRIENDSHIP\",\r\n      \"INTIMACY\",\r\n      \"FAMILY\",\r\n      \"CONNECTION\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"outcomeEnumType\": [\r\n      \"VERY_FAVORABLE\",\r\n      \"FAVORABLE\",\r\n      \"EQUILIBRIUM\",\r\n      \"UNFAVORABLE\",\r\n      \"VERY_UNFAVORABLE\"\r\n    ],\r\n    \"pointOfInterestEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"COMMERCIAL\",\r\n      \"RECREATIONAL\",\r\n      \"LANDMARK\",\r\n      \"ENCAMPMENT\",\r\n      \"LAIR\",\r\n      \"RUIN\",\r\n      \"STASH\",\r\n      \"RESOURCE\",\r\n      \"HARVESTABLE\",\r\n      \"ORE\",\r\n      \"STRUCTURE\"\r\n    ],\r\n    \"raceEnumType\": [\r\n      \"A\",\r\n      \"B\",\r\n      \"C\",\r\n      \"D\",\r\n      \"E\",\r\n      \"L\",\r\n      \"R\",\r\n      \"M\",\r\n      \"S\",\r\n      \"U\",\r\n      \"V\",\r\n      \"W\",\r\n      \"X\",\r\n      \"Y\",\r\n      \"Z\"\r\n    ],\r\n    \"reasonEnumType\": [\r\n      \"AGE\",\r\n      \"ALOOFNESS\",\r\n      \"AMORALITY\",\r\n      \"ATTRACTION\",\r\n      \"ATTRACTIVE_NARCISSISM\",\r\n      \"AVARICE\",\r\n      \"COERCION\",\r\n      \"COMMERCE\",\r\n      \"COMMUNITY\",\r\n      \"COMPANIONSHIP\",\r\n      \"CONFIDENCE\",\r\n      \"COWARDICE\",\r\n      \"EXTRAVERSION\",\r\n      \"FRIENDSHIP\",\r\n      \"GENEROSITY\",\r\n      \"GUARDIANSHIP\",\r\n      \"HOSTILITY\",\r\n      \"IMMATURITY\",\r\n      \"INSTINCT\",\r\n      \"INTIMACY\",\r\n      \"INTIMIDATION\",\r\n      \"INTRAVERSION\",\r\n      \"LESS_ATTRACTIVE\",\r\n      \"MACHIAVELLIANISM\",\r\n      \"MATURITY\",\r\n      \"MORALITY\",\r\n      \"NARCISSISM\",\r\n      \"NONE\",\r\n      \"PEER_PRESSURE\",\r\n      \"POLITICAL\",\r\n      \"PSYCHOPATHY\",\r\n      \"REVENGE\",\r\n      \"REVULSION\",\r\n      \"SADISM\",\r\n      \"SANITY\",\r\n      \"SENILITY\",\r\n      \"SENSUALITY\",\r\n      \"SPIRITUALITY\",\r\n      \"SOCIALIZE\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"rollEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"INVALID_STATISTIC\",\r\n      \"CATASTROPHIC_FAILURE\",\r\n      \"FAILURE\",\r\n      \"SUCCESS\",\r\n      \"NATURAL_SUCCESS\"\r\n    ],\r\n    \"safetyNeedsEnumType\": [\r\n      \"SECURITY\",\r\n      \"EMPLOYMENT\",\r\n      \"RESOURCES\",\r\n      \"HEALTH\",\r\n      \"PROPERTY\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"threatEnumType\": [\r\n      \"ANIMAL_TARGET\",\r\n      \"ANIMAL_THREAT\",\r\n      \"ECONOMIC_TARGET\",\r\n      \"ECONOMIC_THREAT\",\r\n      \"ENVIRONMENTAL_THREAT\",\r\n      \"EXISTENTIAL_THREAT\",\r\n      \"EXISTENTIAL_TARGET\",\r\n      \"HEALTH_TARGET\",\r\n      \"HEALTH_THREAT\",\r\n      \"HOLLOW_THREAT\",\r\n      \"IDEOLOGICAL_TARGET\",\r\n      \"IDEOLOGICAL_THREAT\",\r\n      \"NONE\",\r\n      \"PERSONAL_TARGET\",\r\n      \"PERSONAL_THREAT\",\r\n      \"PHYSICAL_TARGET\",\r\n      \"PHYSICAL_THREAT\",\r\n      \"POLITICAL_TARGET\",\r\n      \"POLITICAL_THREAT\",\r\n      \"PSYCHOLOGICAL_TARGET\",\r\n      \"PSYCHOLOGICAL_THREAT\",\r\n      \"SOCIAL_TARGET\",\r\n      \"SOCIAL_THREAT\",\r\n      \"VERBAL_TARGET\",\r\n      \"VERBAL_THREAT\"\r\n    ],\r\n    \"veryEnumType\": [\r\n      \"DISREGARDED\",\r\n      \"NEVER\",\r\n      \"UNLIKELY\",\r\n      \"SLIGHTLY\",\r\n      \"NOT_USUALLY\",\r\n      \"LESS_FREQUENTLY\",\r\n      \"SOMEWHAT\",\r\n      \"FREQUENTLY\",\r\n      \"USUALLY\",\r\n      \"MOSTLY\",\r\n      \"VERY\",\r\n      \"ALWAYS\",\r\n      \"GUARANTEED\"\r\n    ],\r\n    \"wearLevelEnumType\": [\r\n      \"NONE\",\r\n      \"INTERNAL\",\r\n      \"UNDER\",\r\n      \"ON\",\r\n      \"BASE\",\r\n      \"ACCENT\",\r\n      \"SUIT\",\r\n      \"GARNITURE\",\r\n      \"ACCESSORY\",\r\n      \"OVER\",\r\n      \"OUTER\",\r\n      \"FULL_BODY\",\r\n      \"ENCLOSURE\",\r\n      \"UNKNOWN\"\r\n    ],\r\n    \"eSRBEnumType\": [\r\n      \"E\",\r\n      \"E10\",\r\n      \"T\",\r\n      \"M\",\r\n      \"AO\",\r\n      \"RC\"\r\n    ],\r\n    \"lLMServiceEnumType\": [\r\n      \"UNKNOWN\",\r\n      \"LOCAL\",\r\n      \"OLLAMA\",\r\n      \"OPENAI\"\r\n    ]\r\n  },\r\n  \"models\": [\r\n    {\r\n      \"name\": \"common.name\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"label\": \"Name\",\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"index\": true,\r\n          \"allowNull\": false,\r\n          \"maxLength\": 256,\r\n          \"rules\": [\r\n            \"$notEmpty\"\r\n          ],\r\n          \"shortName\": \"n\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.ownerId\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"ownerId\",\r\n          \"type\": \"long\",\r\n          \"required\": true,\r\n          \"private\": true,\r\n          \"shortName\": \"ow\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.objectId\",\r\n      \"abstract\": true,\r\n      \"hints\": [\r\n        \"objectId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"objectId\",\r\n          \"type\": \"string\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"maxLength\": 64,\r\n          \"shortName\": \"oi\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.attributeList\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"attributes\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"common.attribute\",\r\n          \"referenced\": true,\r\n          \"followReference\": false,\r\n          \"shortName\": \"al\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.organizationExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"organizationPath\",\r\n          \"type\": \"string\",\r\n          \"virtual\": true,\r\n          \"baseModel\": \"system.organization\",\r\n          \"baseProperty\": \"organizationId\",\r\n          \"provider\": \"org.cote.accountmanager.provider.PathProvider\",\r\n          \"priority\": 1,\r\n          \"shortName\": \"op\"\r\n        },\r\n        {\r\n          \"name\": \"organizationId\",\r\n          \"type\": \"long\",\r\n          \"required\": true,\r\n          \"private\": true,\r\n          \"index\": true,\r\n          \"dynamicPolicy\": false,\r\n          \"shortName\": \"o\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.populate\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"populated\",\r\n          \"type\": \"boolean\",\r\n          \"ephemeral\": true,\r\n          \"shortName\": \"pop\"\r\n        },\r\n        {\r\n          \"name\": \"populatedFields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true,\r\n          \"private\": true,\r\n          \"shortName\": \"popf\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.primaryKey\",\r\n      \"abstract\": true,\r\n      \"hints\": [\r\n        \"id\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"id\",\r\n          \"label\": \"Id\",\r\n          \"type\": \"long\",\r\n          \"index\": true,\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"private\": true,\r\n          \"sequence\": true,\r\n          \"primaryKey\": true,\r\n          \"shortName\": \"i\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.baseLight\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"common.ownerId\",\r\n        \"common.objectId\",\r\n        \"common.attributeList\",\r\n        \"system.organizationExt\",\r\n        \"common.populate\",\r\n        \"system.primaryKey\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.BaseFactory\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"objectId\",\r\n        \"ownerId\",\r\n        \"organizationId\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"common.urn\",\r\n      \"abstract\": true,\r\n      \"hints\": [\r\n        \"urn\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"urn\",\r\n          \"type\": \"string\",\r\n          \"readOnly\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.UrnProvider\",\r\n          \"priority\": 3,\r\n          \"identity\": true,\r\n          \"maxLength\": 255,\r\n          \"shortName\": \"u\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"dev.debug\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"debug\",\r\n          \"type\": \"boolean\",\r\n          \"ephemeral\": true,\r\n          \"shortName\": \"dbg\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.base\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"common.baseLight\",\r\n        \"common.urn\",\r\n        \"dev.debug\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.BaseFactory\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"urn\",\r\n        \"objectId\",\r\n        \"ownerId\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"policy.controlsExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"controls\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"policy.control\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"shortName\": \"ctls\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.tagsExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"tags\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.tag\",\r\n          \"foreign\": true,\r\n          \"participation\": true,\r\n          \"followReference\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.nameId\",\r\n      \"inherits\": [\r\n        \"common.name\",\r\n        \"common.base\",\r\n        \"policy.controlsExt\",\r\n        \"data.tagsExt\"\r\n      ],\r\n      \"abstract\": true,\r\n      \"query\": [\r\n        \"name\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"common.parent\",\r\n      \"abstract\": true,\r\n      \"query\": [\r\n        \"parentId\"\r\n      ],\r\n      \"validation\": {\r\n        \"rules\": [\r\n          {\r\n            \"fields\": [\r\n              \"parentId\"\r\n            ],\r\n            \"rules\": [\r\n              \"$notInParent\"\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"parentId\",\r\n          \"type\": \"long\",\r\n          \"baseProperty\": \"id\",\r\n          \"baseModel\": \"$self\",\r\n          \"required\": true,\r\n          \"index\": true,\r\n          \"default\": 0,\r\n          \"recursive\": true,\r\n          \"shortName\": \"pi\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.path\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"path\",\r\n          \"type\": \"string\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.PathProvider\",\r\n          \"priority\": 2\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.organization\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.parent\",\r\n        \"common.path\"\r\n      ],\r\n      \"constraints\": [\r\n        \"name, parentId\"\r\n      ],\r\n      \"icon\": \"public\",\r\n      \"label\": \"Organization\",\r\n      \"description\": \"Organization model for defining scope of all other models.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.OrganizationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"required\": true,\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.indexEntry\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"id\",\r\n          \"type\": \"long\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"private\": true\r\n        },\r\n        {\r\n          \"name\": \"objectId\",\r\n          \"type\": \"string\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"maxLength\": 40\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"required\": true\r\n        },\r\n        {\r\n          \"name\": \"indexModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.simpleByteStore\",\r\n      \"inherits\": [\r\n        \"file.indexEntry\"\r\n      ],\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"dataBytesStore\",\r\n          \"type\": \"blob\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.contactInformationExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"contactInformation\",\r\n          \"baseModel\": \"identity.contactInformation\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"AccountUsersReaders\"\r\n              ]\r\n            }\r\n          },\r\n          \"shortName\": \"ci\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.user\",\r\n      \"constraints\": [\r\n        \"name, organizationId\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"identity.contactInformationExt\"\r\n      ],\r\n      \"icon\": \"verified_user\",\r\n      \"label\": \"User\",\r\n      \"validation\": {\r\n        \"rules\": [\r\n          {\r\n            \"fields\": [\r\n              \"name\"\r\n            ],\r\n            \"rules\": [\r\n              \"$minLen5\"\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"io\": {\r\n        \"writer\": \"org.cote.accountmanager.io.factory.UserWriter\"\r\n      },\r\n      \"description\": \"User model for defining system users.\",\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"read\": [\r\n            \"AccountAdministrators\",\r\n            \"AccountUsersReaders\"\r\n          ],\r\n          \"update\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"delete\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"admin\": [\r\n            \"AccountAdministrators\"\r\n          ]\r\n        }\r\n      },\r\n      \"query\": [\r\n        \"name\",\r\n        \"homeDirectory\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"homeDirectory\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"AccountUsersReaders\"\r\n              ]\r\n            }\r\n          },\r\n          \"shortName\": \"hd\"\r\n        },\r\n        {\r\n          \"name\": \"status\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.UserStatusEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"shortName\": \"stat\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.UserEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.groupExt\",\r\n      \"abstract\": true,\r\n      \"query\": [\r\n        \"groupId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"groupId\",\r\n          \"type\": \"long\",\r\n          \"baseProperty\": \"id\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"index\": true,\r\n          \"recursive\": true,\r\n          \"shortName\": \"g\"\r\n        },\r\n        {\r\n          \"name\": \"groupPath\",\r\n          \"type\": \"string\",\r\n          \"virtual\": true,\r\n          \"baseModel\": \"auth.group\",\r\n          \"baseProperty\": \"groupId\",\r\n          \"provider\": \"org.cote.accountmanager.provider.PathProvider\",\r\n          \"priority\": 1,\r\n          \"shortName\": \"gp\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.directory\",\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.nameId\"\r\n      ],\r\n      \"constraints\": [\r\n        \"name, groupId, organizationId\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"abstract\": true,\r\n      \"query\": [\r\n        \"groupId\",\r\n        \"groupPath\",\r\n        \"organizationId\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"identity.account\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"identity.contactInformationExt\"\r\n      ],\r\n      \"icon\": \"account_circle\",\r\n      \"label\": \"Account\",\r\n      \"group\": \"Accounts\",\r\n      \"description\": \"An account represents a system or application identity outside the context of the AccountManager system.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.AccountEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"status\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.AccountStatusEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"referenceId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"accountId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 40\r\n        },\r\n        {\r\n          \"name\": \"databaseRecord\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.description\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"description\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 512,\r\n          \"shortName\": \"dsc\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.person\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"identity.contactInformationExt\"\r\n      ],\r\n      \"icon\": \"person\",\r\n      \"label\": \"Person\",\r\n      \"group\": \"Persons\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Represents an individual identity which may or may not be associated with an account or user.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"race\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"shortName\": \"rac\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"ethnicity\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"shortName\": \"eth\"\r\n        },\r\n        {\r\n          \"name\": \"otherEthnicity\",\r\n          \"type\": \"string\",\r\n          \"shortName\": \"oeth\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"firstName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"middleName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"lastName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"title\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"suffix\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"birthDate\",\r\n          \"type\": \"zonetime\"\r\n        },\r\n        {\r\n          \"name\": \"age\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"gender\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"alias\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"prefix\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"users\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"system.user\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"accounts\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"identity.account\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"partners\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"person.partner\"\r\n        },\r\n        {\r\n          \"name\": \"dependents\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"person.dependent\"\r\n        },\r\n        {\r\n          \"name\": \"siblings\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"person.dependent\"\r\n        },\r\n        {\r\n          \"name\": \"socialRing\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.role\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"description\": \"The social ring is a hierarchy of peer groups by importance, and optionally by circumstance\",\r\n          \"participantModel\": \"person.ring\"\r\n        },\r\n        {\r\n          \"name\": \"notes\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.note\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"personality\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.personality\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"per\"\r\n        },\r\n        {\r\n          \"name\": \"behavior\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.behavior\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"beh\"\r\n        },\r\n        {\r\n          \"name\": \"profile\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.profile\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.group\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.path\",\r\n        \"common.parent\",\r\n        \"common.description\"\r\n      ],\r\n      \"constraints\": [\r\n        \"name, parentId, organizationId\"\r\n      ],\r\n      \"hints\": [\r\n        \"name, type, parentId\"\r\n      ],\r\n      \"icon\": \"folder\",\r\n      \"label\": \"Group\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Containers used to store collections of principles such as users, accounts, or persons, or other groups.  Nested groups of type 'data' are frequently used to emulate directory structures for organizing information.\",\r\n      \"query\": [\r\n        \"type\",\r\n        \"path\",\r\n        \"organizationId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.GroupEnumType\",\r\n          \"type\": \"enum\",\r\n          \"required\": true,\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.reference\",\r\n      \"abstract\": true,\r\n      \"hints\": [\r\n        \"referenceModel, referenceId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"referenceModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"shortName\": \"rm\"\r\n        },\r\n        {\r\n          \"name\": \"referenceId\",\r\n          \"type\": \"long\",\r\n          \"shortName\": \"ri\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.attribute\",\r\n      \"inherits\": [\r\n        \"common.baseLight\",\r\n        \"common.reference\"\r\n      ],\r\n      \"followReference\": false,\r\n      \"description\": \"Attributes are used to store key/value pairs for objects. The valueType is used to determine how the value should be interpreted.\",\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"AccountUsers\"\r\n          ],\r\n          \"read\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"update\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"delete\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"admin\": [\r\n            \"AccountAdministrators\"\r\n          ]\r\n        }\r\n      },\r\n      \"query\": [\r\n        \"name\",\r\n        \"value\",\r\n        \"valueType\"\r\n      ],\r\n      \"sortField\": \"name\",\r\n      \"sortOrder\": \"ASCENDING\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"value\",\r\n          \"type\": \"flex\",\r\n          \"valueType\": \"valueType\",\r\n          \"shortName\": \"v\"\r\n        },\r\n        {\r\n          \"name\": \"valueType\",\r\n          \"baseClass\": \"org.cote.accountmanager.model.field.FieldEnumType\",\r\n          \"type\": \"enum\",\r\n          \"default\": \"string\",\r\n          \"maxLength\": 16,\r\n          \"shortName\": \"vt\"\r\n        },\r\n        {\r\n          \"name\": \"valueModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128,\r\n          \"shortName\": \"vm\"\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"shortName\": \"n\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.role\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.path\",\r\n        \"common.parent\"\r\n      ],\r\n      \"constraints\": [\r\n        \"parentId, name, type, organizationId\"\r\n      ],\r\n      \"icon\": \"badge\",\r\n      \"label\": \"Role\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Roles are used to group permissions and are typically assigned to users, accounts, persons, or groups. System role membership is also used for coarse API authorization.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.RoleEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.permission\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.path\",\r\n        \"common.parent\"\r\n      ],\r\n      \"constraints\": [\r\n        \"parentId, name, type, organizationId\"\r\n      ],\r\n      \"icon\": \"shield\",\r\n      \"label\": \"Permission\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Permissions are used to control access to resources and actions within the system. They are assigned to users, accounts, persons, groups, or roles through participations.\",\r\n      \"fields\": [\r\n        {\r\n          \"label\": \"Type\",\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.PermissionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.compression\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"compressionType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.CompressionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.contentType\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"contentType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.byteStore\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"data.compression\",\r\n        \"data.contentType\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"dataBytesStore\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"dataHash\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"readDataBytes\",\r\n          \"type\": \"boolean\",\r\n          \"virtual\": true\r\n        },\r\n        {\r\n          \"name\": \"size\",\r\n          \"type\": \"long\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.cipherExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"cipherKey\",\r\n          \"type\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"enciphered\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.vaultExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"keyId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"shortName\": \"kid\"\r\n        },\r\n        {\r\n          \"name\": \"vaultId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"shortName\": \"vid\"\r\n        },\r\n        {\r\n          \"name\": \"vaulted\",\r\n          \"type\": \"boolean\",\r\n          \"shortName\": \"vb\"\r\n        },\r\n        {\r\n          \"name\": \"vaultedFields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true,\r\n          \"shortName\": \"vf\"\r\n        },\r\n        {\r\n          \"name\": \"unvaultedFields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true,\r\n          \"shortName\": \"uf\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.cryptoByteStore\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"data.byteStore\",\r\n        \"crypto.cipherExt\",\r\n        \"crypto.vaultExt\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"common.dateTime\",\r\n      \"abstract\": \"true\",\r\n      \"factory\": \"org.cote.accountmanager.factory.DateTimeFactory\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"createdDate\",\r\n          \"type\": \"timestamp\",\r\n          \"shortName\": \"cd\"\r\n        },\r\n        {\r\n          \"name\": \"modifiedDate\",\r\n          \"type\": \"timestamp\",\r\n          \"label\": \"Modified Date\",\r\n          \"shortName\": \"md\"\r\n        },\r\n        {\r\n          \"name\": \"expiryDate\",\r\n          \"type\": \"timestamp\",\r\n          \"shortName\": \"ed\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.streamExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"stream\",\r\n          \"baseModel\": \"data.stream\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.data\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"crypto.cryptoByteStore\",\r\n        \"common.description\",\r\n        \"common.dateTime\",\r\n        \"data.streamExt\"\r\n      ],\r\n      \"group\": \"Data\",\r\n      \"icon\": \"data_object\",\r\n      \"label\": \"Data\",\r\n      \"dedicatedParticipation\": true,\r\n      \"sortField\": \"name\",\r\n      \"sortOrder\": \"ASCENDING\",\r\n      \"query\": [\r\n        \"contentType\",\r\n        \"organizationId\"\r\n      ],\r\n      \"description\": \"Generic data storage model used to store various types of data, including files and streams.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"dimensions\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.control\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.dateTime\",\r\n        \"common.reference\"\r\n      ],\r\n      \"group\": \"Controls\",\r\n      \"icon\": \"app_blocking\",\r\n      \"label\": \"Control\",\r\n      \"description\": \"A control is a specific action or set of actions that can be applied to a resource or policy to enforce security or compliance requirements.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"controlId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"controlType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ControlEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"action\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ControlActionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.credential\",\r\n      \"inherits\": [\r\n        \"common.base\",\r\n        \"common.dateTime\",\r\n        \"crypto.vaultExt\",\r\n        \"crypto.cipherExt\",\r\n        \"common.reference\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.CredentialFactory\",\r\n      \"icon\": \"app_blocking\",\r\n      \"label\": \"Credential\",\r\n      \"description\": \"Credential that may be used to authenticate a principle, such as a user, person, or account.  Credentials are usually hashed passwords, certificates, or tokens.\",\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"AccountUsers\"\r\n          ],\r\n          \"read\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"update\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"delete\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"admin\": [\r\n            \"AccountAdministrators\"\r\n          ]\r\n        }\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"ephemeral\": true,\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"hash\",\r\n          \"baseModel\": \"crypto.hash\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"credential\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"primary\",\r\n          \"type\": \"boolean\",\r\n          \"index\": true\r\n        },\r\n        {\r\n          \"name\": \"previousCredentialId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"nextCredentialId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.CredentialEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.score\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"score\",\r\n          \"type\": \"int\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.order\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"order\",\r\n          \"type\": \"int\",\r\n          \"shortName\": \"ord\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.baseAuthorization\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.dateTime\",\r\n        \"policy.score\",\r\n        \"common.order\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"policy.operation\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"group\": \"Operations\",\r\n      \"icon\": \"call_to_action\",\r\n      \"label\": \"Operation\",\r\n      \"description\": \"An operation is a specific action or set of actions that can be performed on a resource or policy to achieve a desired outcome. Operations can be used to manipulate data, enforce policies, or derive new information based on existing data.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"operation\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.OperationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.contact\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\"\r\n      ],\r\n      \"icon\": \"contact_page\",\r\n      \"label\": \"Contact\",\r\n      \"group\": \"Contacts\",\r\n      \"description\": \"A contact is a method of reaching an individual or group. Contacts can be phone numbers, email or website addresses.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"contactValue\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"contactType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ContactEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"locationType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.LocationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"preferred\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.address\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\"\r\n      ],\r\n      \"icon\": \"maps_home_work\",\r\n      \"label\": \"Address\",\r\n      \"group\": \"Addresses\",\r\n      \"description\": \"An address represents a physical location, such as a home or office, that can be associated with an account or individual. It includes details like street, city, state, and postal code.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"street\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"street2\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"city\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"region\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 40\r\n        },\r\n        {\r\n          \"name\": \"postalCode\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 12\r\n        },\r\n        {\r\n          \"name\": \"country\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 40\r\n        },\r\n        {\r\n          \"name\": \"locationType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.LocationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"location\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"preferred\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.hash\",\r\n      \"inherits\": [\r\n        \"common.base\"\r\n      ],\r\n      \"description\": \"Cryptographic hash\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"keyFunction\",\r\n          \"type\": \"string\",\r\n          \"default\": \"PBKDF2WithHmacSHA512\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"algorithm\",\r\n          \"type\": \"string\",\r\n          \"default\": \"SHA3-224\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"prng\",\r\n          \"type\": \"string\",\r\n          \"default\": \"SHA1PRNG\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"salt\",\r\n          \"type\": \"blob\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.key\",\r\n      \"inherits\": [\r\n        \"common.base\"\r\n      ],\r\n      \"description\": \"Asymmetric key for cryptographic operations.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"key\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"keySpec\",\r\n          \"type\": \"string\",\r\n          \"default\": \"RSA\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"keyMode\",\r\n          \"type\": \"string\",\r\n          \"default\": \"RSA\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"keySize\",\r\n          \"type\": \"int\",\r\n          \"default\": 2048\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.cipherKey\",\r\n      \"inherits\": [\r\n        \"common.base\"\r\n      ],\r\n      \"description\": \"Symmetric cipher key.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"key\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"keyId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"iv\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"encrypt\",\r\n          \"type\": \"boolean\",\r\n          \"default\": false\r\n        },\r\n        {\r\n          \"name\": \"provider\",\r\n          \"type\": \"string\",\r\n          \"default\": \"BC\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"keySpec\",\r\n          \"type\": \"string\",\r\n          \"default\": \"AES\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"keyMode\",\r\n          \"type\": \"string\",\r\n          \"default\": \"AES/CBC/PKCS5Padding\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"keySize\",\r\n          \"type\": \"int\",\r\n          \"default\": 256\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.keySet\",\r\n      \"inherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.KeyFactory\",\r\n      \"group\": \"Key Pairs\",\r\n      \"description\": \"A pair of asymmetric keys and a symmetric cipher key for cryptographic operations.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"hash\",\r\n          \"baseModel\": \"crypto.hash\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"public\",\r\n          \"baseModel\": \"crypto.key\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"private\",\r\n          \"baseModel\": \"crypto.key\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"cipher\",\r\n          \"baseModel\": \"crypto.cipherKey\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"agreementSpec\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"curveName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"organizationKey\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"primaryKey\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"globalKey\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.rsaKey\",\r\n      \"description\": \"Not used\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"modulus\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"exponent\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"d\",\r\n          \"type\": \"blob\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.policy\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"group\": \"Policies\",\r\n      \"icon\": \"policy\",\r\n      \"label\": \"Policy\",\r\n      \"description\": \"A policy is a set of rules or guidelines that govern the behavior of users, systems, or processes within an organization. Policies can be used to enforce security, compliance, and operational standards across various domains.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"rules\",\r\n          \"baseModel\": \"policy.rule\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"enabled\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"decisionAge\",\r\n          \"type\": \"long\",\r\n          \"default\": 0\r\n        },\r\n        {\r\n          \"name\": \"condition\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ConditionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.rule\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"group\": \"Rules\",\r\n      \"icon\": \"rule\",\r\n      \"label\": \"Rule\",\r\n      \"description\": \"A rule is a specific condition or set of conditions that must be met for a policy to be enforced or an operation to be executed. Rules can be used to define the logic and criteria for decision-making within policies and operations.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"rules\",\r\n          \"baseModel\": \"policy.rule\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"patterns\",\r\n          \"baseModel\": \"policy.pattern\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.RuleEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"condition\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ConditionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.pattern\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"group\": \"Patterns\",\r\n      \"icon\": \"texture\",\r\n      \"label\": \"Pattern\",\r\n      \"description\": \"A pattern is a reusable template or structure that defines how data or policies should be organized or processed. Patterns can be used to enforce consistency, derive new information, or apply specific logic to data or policies.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"fact\",\r\n          \"baseModel\": \"policy.fact\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"match\",\r\n          \"baseModel\": \"policy.fact\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"operation\",\r\n          \"baseModel\": \"policy.operation\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"operationClass\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"factUrn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"comparator\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ComparatorEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.PatternEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"matchUrn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"operationUrn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"entitlementType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"entitlementPath\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.fact\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"group\": \"Facts\",\r\n      \"icon\": \"fact_check\",\r\n      \"label\": \"Fact\",\r\n      \"description\": \"A fact is a piece of information that can be used in policies to make decisions. Facts can be derived from various sources and can have different types and values.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"factReference\",\r\n          \"baseModel\": \"common.nameId\",\r\n          \"type\": \"model\",\r\n          \"ephemeral\": \"true\"\r\n        },\r\n        {\r\n          \"name\": \"factData\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"propertyName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"parameters\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"policy.factParameter\"\r\n        },\r\n        {\r\n          \"name\": \"value\",\r\n          \"type\": \"flex\",\r\n          \"valueType\": \"valueType\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"valueType\",\r\n          \"baseClass\": \"org.cote.accountmanager.model.field.FieldEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"class\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"factDataType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"factType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"sourceUrn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"sourceDataType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.SqlDataEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"sourceUrl\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"sourceData\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.FactEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"modelType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"sourceType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"chatConfig\",\r\n          \"baseModel\": \"olio.llm.chatConfig\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"promptConfig\",\r\n          \"baseModel\": \"olio.llm.promptConfig\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        }\r\n\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.factParameter\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"value\",\r\n          \"type\": \"flex\",\r\n          \"valueType\": \"valueType\"\r\n        },\r\n        {\r\n          \"name\": \"valueType\",\r\n          \"baseClass\": \"org.cote.accountmanager.model.field.FieldEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"valueModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"match\",\r\n          \"type\": \"boolean\",\r\n          \"description\": \"Bit to differentiate the parameter between a fact and match fact.\"\r\n        },\r\n        {\r\n          \"name\": \"class\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.policyRequest\",\r\n      \"factory\": \"org.cote.accountmanager.factory.PolicyRequestFactory\",\r\n      \"description\": \"A policy request is a request for a policy to be applied to a resource or subject. It contains the necessary attributes and facts to evaluate the policy.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"attributes\",\r\n          \"baseModel\": \"common.attribute\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"facts\",\r\n          \"baseModel\": \"policy.fact\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"contextUser\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"system.user\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"urn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"organizationPath\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.PolicyRequestEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"subject\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"subjectType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"credentialType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.CredentialEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"verbose\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.policyResponse\",\r\n      \"inherits\": [\r\n        \"common.attributeList\",\r\n        \"policy.score\",\r\n        \"common.description\"\r\n      ],\r\n      \"description\": \"A policy response is a structured response to a policy evaluation that includes messages, rule chains, pattern chains, and response data. It can also include metadata such as type, URN, and expiry date.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"messages\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"ruleChain\",\r\n          \"baseType\": \"string\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"patternChain\",\r\n          \"baseType\": \"string\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"responseData\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"common.base\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.PolicyResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"urn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"expiryDate\",\r\n          \"type\": \"timestamp\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.policyDefinition\",\r\n      \"inherits\": [\r\n        \"common.dateTime\",\r\n        \"system.organizationExt\"\r\n      ],\r\n      \"description\": \"A policy definition is a publicly consummable version of a policy that identifies parameters to be populated.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"parameters\",\r\n          \"baseModel\": \"policy.fact\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"urn\",\r\n          \"type\": \"string\",\r\n          \"readOnly\": true,\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"enabled\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"decisionAge\",\r\n          \"type\": \"long\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.participation\",\r\n      \"inherits\": [\r\n        \"system.organizationExt\",\r\n        \"system.primaryKey\"\r\n      ],\r\n      \"provider\": \"org.cote.accountmanager.provider.ParticipationProvider\",\r\n      \"hints\": [\r\n        \"participationId, participationModel\",\r\n        \"participantId, participantModel\",\r\n        \"participationId, participationModel, participantId, participantModel\"\r\n      ],\r\n      \"description\": \"Participation model for defining relationships between participants and resources.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"ownerId\",\r\n          \"type\": \"long\",\r\n          \"required\": true,\r\n          \"private\": true\r\n        },\r\n        {\r\n          \"name\": \"participationId\",\r\n          \"type\": \"long\",\r\n          \"required\": true\r\n        },\r\n        {\r\n          \"name\": \"participationModel\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"participantId\",\r\n          \"type\": \"long\",\r\n          \"required\": true\r\n        },\r\n        {\r\n          \"name\": \"participantModel\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"permissionId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"effectType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.EffectEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"enabled\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"io.query\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.QueryFactory\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"urn\",\r\n          \"type\": \"string\",\r\n          \"identity\": true,\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"alias\",\r\n          \"type\": \"string\",\r\n          \"ephemeral\": true,\r\n          \"maxLength\": 60\r\n        },\r\n        {\r\n          \"name\": \"count\",\r\n          \"type\": \"int\",\r\n          \"ephemeral\": true,\r\n          \"private\": true\r\n        },\r\n        {\r\n          \"name\": \"cache\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true\r\n        },\r\n        {\r\n          \"name\": \"executed\",\r\n          \"type\": \"boolean\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"comparator\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ComparatorEnumType\",\r\n          \"type\": \"enum\",\r\n          \"default\": \"GROUP_AND\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"sortField\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"startRecord\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"recordCount\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"order\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.OrderEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"queryKey\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"queryHash\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"request\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"contextUser\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"system.user\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"limitFields\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true\r\n        },\r\n        {\r\n          \"name\": \"fields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"io.queryField\"\r\n        },\r\n        {\r\n          \"name\": \"queries\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"query\",\r\n          \"internal\": true,\r\n          \"description\": \"Used to extend the query model with another table, such as participation\"\r\n        },\r\n        {\r\n          \"name\": \"joins\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"query\",\r\n          \"internal\": true,\r\n          \"description\": \"Used to hold sub-queries constructed to reconstitute foreign key fields\"\r\n        },\r\n        {\r\n          \"name\": \"joinKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"internal\": true,\r\n          \"description\": \"Used to identify the foreignKey column that refers to the primary key.  Note: This column must exist in the model schema or will not be permitted\"\r\n        },\r\n        {\r\n          \"name\": \"topCount\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"organizationId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"groupBy\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"having\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"token\",\r\n          \"type\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"havingClause\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"inspect\",\r\n          \"type\": \"boolean\",\r\n          \"description\": \"Indicates to listening providers not to perform some actions intended for read operations\"\r\n        },\r\n        {\r\n          \"name\": \"participation\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"system.participation\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"plan\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"io.queryPlan\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"debug\",\r\n          \"type\": \"boolean\",\r\n          \"ephemeral\": true,\r\n          \"description\": \"For some reason, inheriting from 'debug' leads to a stackover flow, likely due to how query is used to initially lookup models loaded into the system\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"io.queryField\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"comparator\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ComparatorEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"EQUALS\"\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"value\",\r\n          \"type\": \"flex\",\r\n          \"valueType\": \"valueType\",\r\n          \"required\": true\r\n        },\r\n        {\r\n          \"name\": \"valueType\",\r\n          \"description\": \"valueType is only meant to be used for certain serialization cases\",\r\n          \"baseClass\": \"org.cote.accountmanager.model.field.FieldEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"shortName\": \"vt\"\r\n        },\r\n        {\r\n          \"name\": \"fields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"io.queryResult\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"required\": true,\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"queryKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"queryHash\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"count\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"totalCount\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"results\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$flex\"\r\n        },\r\n        {\r\n          \"name\": \"response\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.OperationResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"io.queryPlan\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"modelName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"fieldName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"parent\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"baseModel\": \"io.queryPlan\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"plans\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"io.queryPlan\"\r\n        },\r\n        {\r\n          \"name\": \"fields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.journal\",\r\n      \"inherits\": [\r\n        \"common.base\"\r\n      ],\r\n      \"description\": \"Journal containing model change records.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"journaled\",\r\n          \"type\": \"boolean\",\r\n          \"shortName\": \"jd\"\r\n        },\r\n        {\r\n          \"name\": \"journalHash\",\r\n          \"type\": \"blob\",\r\n          \"shortName\": \"jh\"\r\n        },\r\n        {\r\n          \"name\": \"journalVersion\",\r\n          \"type\": \"double\",\r\n          \"shortName\": \"jv\"\r\n        },\r\n        {\r\n          \"name\": \"journalEntries\",\r\n          \"baseModel\": \"data.journalEntry\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\",\r\n          \"shortName\": \"je\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.hashExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"hash\",\r\n          \"type\": \"blob\",\r\n          \"restricted\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.journalEntry\",\r\n      \"abstract\": false,\r\n      \"emitModel\": true,\r\n      \"inherits\": [\r\n        \"crypto.hashExt\"\r\n      ],\r\n      \"description\": \"Record of a model change.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"journalDate\",\r\n          \"type\": \"timestamp\",\r\n          \"shortName\": \"jd\"\r\n        },\r\n        {\r\n          \"name\": \"version\",\r\n          \"type\": \"double\",\r\n          \"shortName\": \"jv\"\r\n        },\r\n        {\r\n          \"name\": \"baseline\",\r\n          \"type\": \"boolean\",\r\n          \"shortName\": \"jb\"\r\n        },\r\n        {\r\n          \"name\": \"modified\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"shortName\": \"jm\"\r\n        },\r\n        {\r\n          \"name\": \"fields\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"shortName\": \"jf\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.participationList\",\r\n      \"inherits\": [\r\n        \"system.organizationExt\"\r\n      ],\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"id\",\r\n          \"type\": \"long\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"private\": true\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"partId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"parts\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"file.participationEntry\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.participationEntry\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"partId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"permissionId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"effectType\",\r\n          \"type\": \"enum\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.EffectEnumType\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"message.recipient\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"recipientId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"recipientType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"message.sender\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"senderId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"senderType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"message.spool\",\r\n      \"inherits\": [\r\n        \"common.dateTime\",\r\n        \"system.organizationExt\",\r\n        \"system.primaryKey\",\r\n        \"common.reference\",\r\n        \"message.recipient\",\r\n        \"message.sender\"\r\n      ],\r\n      \"description\": \"A spool is a temporary storage for messages that are queued for processing or delivery. Spools can be used to manage message flow, handle retries, and ensure that messages are delivered even if the recipient is temporarily unavailable.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"data\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"objectId\",\r\n          \"type\": \"string\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"maxLength\": 60\r\n        },\r\n        {\r\n          \"name\": \"spoolBucketType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.SpoolBucketEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"spoolBucketName\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.SpoolNameEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"valueType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ValueEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"ownerId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"spoolStatus\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.SpoolStatusEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"expires\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"transportType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"credentialId\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"parentObjectId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 60\r\n        },\r\n        {\r\n          \"name\": \"currentLevel\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"endLevel\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"classification\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"groupId\",\r\n          \"type\": \"long\",\r\n          \"baseModel\": \"auth.group\"\r\n        },\r\n        {\r\n          \"name\": \"groupPath\",\r\n          \"type\": \"string\",\r\n          \"virtual\": true,\r\n          \"baseModel\": \"auth.group\",\r\n          \"baseProperty\": \"groupId\",\r\n          \"provider\": \"org.cote.accountmanager.provider.PathProvider\"\r\n        },\r\n        {\r\n          \"name\": \"modelType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.token\",\r\n      \"inherits\": [\r\n        \"message.spool\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.TokenFactory\",\r\n      \"description\": \"Not used\",\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"dev.parameter\",\r\n      \"inherits\": [\r\n        \"common.attribute\"\r\n      ],\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"valueSchema\",\r\n          \"type\": \"string\",\r\n          \"description\": \"A JSON schema for the parameter value, for use when the entire object model may not be available.\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"dev.parameterList\",\r\n      \"factory\": \"org.cote.accountmanager.factory.ParameterListFactory\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"parameters\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"dev.parameter\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.index2\",\r\n      \"factory\": \"org.cote.accountmanager.factory.ParameterListFactory\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"lastId\",\r\n          \"type\": \"long\",\r\n          \"default\": 100\r\n        },\r\n        {\r\n          \"name\": \"entries\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"file.indexEntry2\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.indexEntry2\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"values\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"file.indexEntryValue2\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"file.indexEntryValue2\",\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.attribute\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"file.indexStore\",\r\n      \"inherits\": [\r\n        \"file.simpleByteStore\"\r\n      ],\r\n      \"ioConstraints\": [\r\n        \"file\"\r\n      ],\r\n      \"fields\": []\r\n    },\r\n    {\r\n      \"name\": \"crypto.keyStore\",\r\n      \"inherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"group\": \"Key Stores\",\r\n      \"description\": \"Repository for cryptographic keys and certificates. It can be used to store private keys, public keys, and certificates in a secure manner.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"alias\",\r\n          \"type\": \"String\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"String\",\r\n          \"default\": \"PKCS12\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"blob\",\r\n          \"readOnly\": true\r\n        },\r\n        {\r\n          \"name\": \"credential\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"auth.credential\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"keySet\",\r\n          \"baseModel\": \"crypto.keySet\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.vault\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.dateTime\"\r\n      ],\r\n      \"ephemeral\": false,\r\n      \"group\": \".vault\",\r\n      \"description\": \"Specialized key store used to store encrypted cryptographic keys outside of the database.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"alias\",\r\n          \"type\": \"String\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"keyPath\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"vaultPath\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"nameHash\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"activeKey\",\r\n          \"baseModel\": \"crypto.keySet\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"ephemeral\": false\r\n        },\r\n        {\r\n          \"name\": \"vaultKey\",\r\n          \"baseModel\": \"crypto.keySet\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"public\",\r\n          \"baseModel\": \"crypto.keySet\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"salt\",\r\n          \"baseModel\": \"crypto.keySet\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"serviceUser\",\r\n          \"baseModel\": \"system.user\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"credential\",\r\n          \"baseModel\": \"auth.credential\",\r\n          \"type\": \"model\",\r\n          \"foreign\": false\r\n        },\r\n        {\r\n          \"name\": \"protectedCredential\",\r\n          \"baseModel\": \"auth.credential\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"protectedCredentialPath\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"vaultGroup\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"groupName\",\r\n          \"type\": \"String\",\r\n          \"default\": \".vault\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"vaultLink\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 60\r\n        },\r\n        {\r\n          \"name\": \"keyExtension\",\r\n          \"type\": \"string\",\r\n          \"default\": \".mprv\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"keyPrefix\",\r\n          \"type\": \"string\",\r\n          \"default\": \"Vault\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"keyProtectedPrefix\",\r\n          \"type\": \"string\",\r\n          \"default\": \"Prot\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"haveVaultKey\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"protected\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"haveCredential\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"dn\",\r\n          \"type\": \"String\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"initialized\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.subject\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"subject\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"subjectType\"\r\n        },\r\n        {\r\n          \"name\": \"subjectType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.submitter\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"submitter\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"subjectType\"\r\n        },\r\n        {\r\n          \"name\": \"submitterType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.requester\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"requester\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"requesterType\"\r\n        },\r\n        {\r\n          \"name\": \"requesterType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.request\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"identity.subject\",\r\n        \"access.submitter\",\r\n        \"access.requester\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"action\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ActionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.authenticationRequest\",\r\n      \"inherits\": [\r\n        \"access.request\"\r\n      ],\r\n      \"description\": \"Authentication request used to pass credentials or tokens for an actor, such as a user, person, or account.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"credential\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"checkCredential\",\r\n          \"type\": \"blob\"\r\n        },\r\n        {\r\n          \"name\": \"credentialType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.CredentialEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"checkCredentialType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.CredentialEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"tokens\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.response\",\r\n      \"inherits\": [\r\n        \"system.organizationExt\"\r\n      ],\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.OperationResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.authenticationResponse\",\r\n      \"inherits\": [\r\n        \"policy.response\"\r\n      ],\r\n      \"description\": \"Authentication response used to return the result of an authentication request. This is typically used to return a token and a reference to the authenticated principle.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"principle\",\r\n          \"type\": \"model\"\r\n        },\r\n        {\r\n          \"name\": \"tokens\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"response\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.AuthenticationResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.description2K\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"description\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 2048,\r\n          \"shortName\": \"dsc\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"crypto.signature\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"signature\",\r\n          \"type\": \"blob\",\r\n          \"restricted\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.audit\",\r\n      \"inherits\": [\r\n        \"common.dateTime\",\r\n        \"system.organizationExt\",\r\n        \"common.description2K\",\r\n        \"system.primaryKey\",\r\n        \"crypto.signature\",\r\n        \"crypto.hashExt\",\r\n        \"identity.subject\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.AuditFactory\",\r\n      \"autoCreateForeignReference\": false,\r\n      \"description\": \"Audit records for actions taken in the system\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"objectId\",\r\n          \"type\": \"string\",\r\n          \"identity\": true,\r\n          \"readOnly\": true,\r\n          \"maxLength\": 40\r\n        },\r\n        {\r\n          \"name\": \"action\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ActionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"response\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"index\": true,\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"resource\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"resourceType\"\r\n        },\r\n        {\r\n          \"name\": \"resourceType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"contextUser\",\r\n          \"baseModel\": \"system.user\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 2048\r\n        },\r\n        {\r\n          \"name\": \"query\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"policy\",\r\n          \"baseModel\": \"policy.policyResponse\",\r\n          \"type\": \"model\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.contactInformation\",\r\n      \"inherits\": [\r\n        \"common.ownerId\",\r\n        \"common.objectId\",\r\n        \"system.organizationExt\",\r\n        \"common.populate\",\r\n        \"system.primaryKey\",\r\n        \"common.reference\",\r\n        \"common.urn\"\r\n      ],\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"AccountUsers\"\r\n          ],\r\n          \"read\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"update\": [\r\n            \"AccountAdministrators\"\r\n          ],\r\n          \"delete\": [\r\n            \"SystemAdministrators\",\r\n            \"DataAdministrators\"\r\n          ],\r\n          \"admin\": [\r\n            \"AccountAdministrators\"\r\n          ]\r\n        },\r\n        \"policies\": {\r\n          \"bind\": {\r\n            \"objectId\": \"referenceId\",\r\n            \"objectSchema\": \"referenceModel\",\r\n            \"description\": \"Defer to the object identified by 'propertyName' when performing policy evaluations.  This is to allow for ephemeral objects to be authorized and audited in a uniform fashion\"\r\n          }\r\n        }\r\n      },\r\n      \"description\": \"A contact information record for a person or organization.  This is used to store phone numbers, emails, and other contact information.\",\r\n      \"followReference\": false,\r\n      \"dedicatedParticipation\": true,\r\n      \"query\": [\r\n        \"referenceId\",\r\n        \"referenceModel\",\r\n        \"id\",\r\n        \"ownerId\",\r\n        \"organizationId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"contacts\",\r\n          \"baseModel\": \"identity.contact\",\r\n          \"baseType\": \"model\",\r\n          \"foreign\": true,\r\n          \"type\": \"list\",\r\n          \"participantModel\": \"ci.contact\"\r\n        },\r\n        {\r\n          \"name\": \"addresses\",\r\n          \"baseModel\": \"identity.address\",\r\n          \"baseType\": \"model\",\r\n          \"foreign\": true,\r\n          \"type\": \"list\",\r\n          \"participantModel\": \"ci.address\"\r\n        },\r\n        {\r\n          \"name\": \"contactInformationType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ContactInformationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"auth.entitlement\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"entitlementType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"entitlement\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"entitlementType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"create\": [\r\n                \"AccountUsersReaders\",\r\n                \"RequestReaders\",\r\n                \"RoleReaders\",\r\n                \"PermissionReaders\"\r\n              ],\r\n              \"read\": [\r\n                \"AccountUsersReaders\",\r\n                \"RequestReaders\",\r\n                \"RoleReaders\",\r\n                \"PermissionReaders\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.baseAccess\",\r\n      \"abstract\": \"true\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.parent\",\r\n        \"access.request\",\r\n        \"auth.entitlement\",\r\n        \"common.dateTime\",\r\n        \"common.description\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"resourceData\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreignType\": \"resourceType\",\r\n          \"description\": \"Placeholder for serialized non-persisted objects\"\r\n        },\r\n        {\r\n          \"name\": \"resource\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"resourceType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"RequestReaders\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"resourceType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"token\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.approver\",\r\n      \"abstract\": true,\r\n      \"inherits\": [\r\n        \"crypto.signature\"\r\n      ],\r\n      \"description\": \"An approver for an access request.  This could be a user, a person, an account, a group, or a role.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"approver\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"approverType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"AccountUsersReaders\",\r\n                \"RequestReaders\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"approverType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"delegate\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"delegateType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"AccountUsersReaders\",\r\n                \"RequestReaders\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"delegateType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"access.accessRequest\",\r\n      \"inherits\": [\r\n        \"access.baseAccess\",\r\n        \"access.approver\",\r\n        \"crypto.hashExt\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.AccessRequestFactory\",\r\n      \"icon\": \"switch_access_shortcut\",\r\n      \"label\": \"Access Request\",\r\n      \"description\": \"A request for access to a resource.  This is typically used to request membership in a group, role, or request an entitlement to a resource that requires approval.\",\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"Requesters\"\r\n          ],\r\n          \"read\": [\r\n            \"RequestReaders\"\r\n          ],\r\n          \"update\": [\r\n            \"RequestUpdaters\",\r\n            \"RequestAdministrators\"\r\n          ],\r\n          \"delete\": [\r\n            \"RequestAdministrators\"\r\n          ],\r\n          \"admin\": [\r\n            \"RequestAdministrators\"\r\n          ]\r\n        }\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"messages\",\r\n          \"baseModel\": \"message.spool\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"approvalStatus\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ApprovalResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"default\": \"UNKNOWN\",\r\n          \"maxLength\": 32,\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"update\": [\r\n                \"Approvers\",\r\n                \"RequestUpdaters\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.modelSchema\",\r\n      \"inherits\": [\r\n        \"common.nameId\"\r\n      ],\r\n      \"constraints\": [\r\n        \"name, organizationId\"\r\n      ],\r\n      \"query\": [\r\n        \"name\",\r\n        \"schemaData\"\r\n      ],\r\n      \"description\": \"Model schema for persisting model structures\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"schemaData\",\r\n          \"type\": \"blob\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.stream\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.dateTime\",\r\n        \"data.contentType\",\r\n        \"crypto.vaultExt\"\r\n      ],\r\n      \"provider\": \"org.cote.accountmanager.provider.StreamProvider\",\r\n      \"query\": [\r\n        \"contentType\",\r\n        \"type\"\r\n      ],\r\n      \"description\": \"Model used to store and retrieve streams of data.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"streamSource\",\r\n          \"type\": \"string\",\r\n          \"provider\": \"org.cote.accountmanager.provider.EncryptFieldProvider\",\r\n          \"priority\": 10,\r\n          \"encrypt\": true\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.StreamEnumType\",\r\n          \"type\": \"enum\",\r\n          \"default\": \"UNKNOWN\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"size\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"segments\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.streamSegment\",\r\n          \"ephemeral\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.streamSegment\",\r\n      \"ephemeral\": true,\r\n      \"io\": {\r\n        \"reader\": \"org.cote.accountmanager.io.stream.StreamSegmentReader\",\r\n        \"writer\": \"org.cote.accountmanager.io.stream.StreamSegmentWriter\",\r\n        \"search\": \"org.cote.accountmanager.io.stream.StreamSegmentSearch\"\r\n      },\r\n      \"access\": {\r\n        \"policies\": {\r\n          \"bind\": {\r\n            \"objectId\": \"streamId\",\r\n            \"schema\": \"data.stream\",\r\n            \"description\": \"Defer to the object identified by 'propertyName' when performing policy evaluations.  This is to allow for ephemeral objects to be authorized and audited in a uniform fashion\"\r\n          }\r\n        }\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"streamId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 60,\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"stream\",\r\n          \"type\": \"blob\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"startPosition\",\r\n          \"type\": \"long\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"length\",\r\n          \"type\": \"long\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"size\",\r\n          \"type\": \"long\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"read\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.thumbnail\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"crypto.cryptoByteStore\",\r\n        \"common.dateTime\"\r\n      ],\r\n      \"access\": {\r\n        \"policies\": {\r\n          \"bind\": {\r\n            \"objectId\": \"referenceId\",\r\n            \"schema\": \"data.data\",\r\n            \"description\": \"Defer to the object identified by 'propertyName' when performing policy evaluations.  This is to allow for ephemeral objects to be authorized and audited in a uniform fashion\"\r\n          }\r\n        }\r\n      },\r\n      \"description\": \"Smaller representation of an image.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"referenceId\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 60\r\n        },\r\n        {\r\n          \"name\": \"referenceModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"data\"\r\n        },\r\n        {\r\n          \"name\": \"width\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"height\",\r\n          \"type\": \"int\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.validationRule\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\"\r\n      ],\r\n      \"icon\": \"rule\",\r\n      \"label\": \"Validation Rule\",\r\n      \"group\": \"Validation Rules\",\r\n      \"description\": \"A validation rule is a specific condition or set of conditions that must be met for data to be considered valid. Validation rules can be used to enforce data integrity, ensure compliance with business rules, and prevent errors in data entry or processing.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"errorMessage\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"replacementValue\",\r\n          \"type\": \"flex\",\r\n          \"valueType\": \"replacementValueType\"\r\n        },\r\n        {\r\n          \"name\": \"replacementValueType\",\r\n          \"baseClass\": \"org.cote.accountmanager.model.field.FieldEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"rules\",\r\n          \"baseModel\": \"policy.validationRule\",\r\n          \"baseType\": \"model\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"expression\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 255\r\n        },\r\n        {\r\n          \"name\": \"function\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"policy.function\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ValidationEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"comparison\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true\r\n        },\r\n        {\r\n          \"name\": \"comparator\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ComparatorEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"allowNull\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.applicationProfile\",\r\n      \"inherits\": [\r\n        \"system.organizationExt\"\r\n      ],\r\n      \"ephemeral\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"jsonModelKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 20,\r\n          \"default\": \"schema\"\r\n        },\r\n        {\r\n          \"name\": \"systemRoles\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.role\"\r\n        },\r\n        {\r\n          \"name\": \"userRoles\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.role\"\r\n        },\r\n        {\r\n          \"name\": \"systemPermissions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.permission\"\r\n        },\r\n        {\r\n          \"name\": \"user\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"system.user\"\r\n        },\r\n        {\r\n          \"name\": \"person\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.person\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"policy.function\",\r\n      \"inherits\": [\r\n        \"policy.baseAuthorization\"\r\n      ],\r\n      \"icon\": \"functions\",\r\n      \"label\": \"Function\",\r\n      \"description\": \"A function is a reusable piece of logic that can be applied to data or policies to perform specific actions or calculations. Functions can be used to manipulate data, enforce policies, or derive new information based on existing data.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"data\",\r\n          \"baseModel\": \"data.data\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.FunctionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"class\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"sourceUrn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.tag\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.description\",\r\n        \"common.name\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"description\": \"A tag is a label that can be applied to objects for categorization or filtering purposes. Tags are often used to organize content in a flexible way, allowing users to find related items easily.\",\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"group\": \"Tags\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Tag\",\r\n      \"dedicatedParticipation\": true,\r\n      \"constraints\": [\r\n        \"name, type, groupId, organizationId\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"name\",\r\n        \"type\"\r\n      ],\r\n      \"sortField\": \"name\",\r\n      \"sortOrder\": \"ASCENDING\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.modelCategory\",\r\n      \"inherits\": [\r\n        \"common.nameId\",\r\n        \"common.description\"\r\n      ],\r\n      \"description\": \"Model category for grouping models together\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"icon\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 25\r\n        },\r\n        {\r\n          \"name\": \"order\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"limit\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"label\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"pathName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"prototype\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"prototypes\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"modelCategory\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.note\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.parent\",\r\n        \"common.dateTime\"\r\n      ],\r\n      \"group\": \"Notes\",\r\n      \"icon\": \"note\",\r\n      \"label\": \"Note\",\r\n      \"description\": \"Generic note model used to store text-based notes.\",\r\n      \"vectorize\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"text\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"message.socketMessage\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"newMessageCount\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"token\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"baseModel\": \"message.spool\",\r\n          \"type\": \"model\"\r\n        },\r\n        {\r\n          \"name\": \"chirps\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"limitTest\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"int\",\r\n          \"limit\": [1, 2, 3]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.fieldLock\",\r\n      \"inherits\": [\r\n        \"common.dateTime\",\r\n        \"system.organizationExt\",\r\n        \"common.reference\",\r\n        \"system.primaryKey\"\r\n      ],\r\n      \"access\": {\r\n        \"roles\": {\r\n          \"create\": [\r\n            \"AccountUsers\"\r\n          ],\r\n          \"read\": [\r\n            \"AccountUsers\"\r\n          ]\r\n        }\r\n      },\r\n      \"description\": \"Lock specific model instance fields for editing.\",\r\n      \"constraints\": [\r\n        \"referenceId, referenceModel, fieldName, organizationId\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.FieldLockFactory\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"fieldName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"enabled\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"ownerId\",\r\n          \"type\": \"long\",\r\n          \"required\": true,\r\n          \"private\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.alignment\",\r\n      \"abstract\": \"true\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"alignment\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.AlignmentEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"aln\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.trait\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.alignment\",\r\n        \"policy.score\"\r\n      ],\r\n      \"constraints\": [\r\n        \"name, type, groupId, organizationId\"\r\n      ],\r\n      \"group\": \"Traits\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Trait\",\r\n      \"description\": \"A trait is a characteristic or quality that can be associated with an object, often used to define behaviors or attributes in a flexible manner. Traits can be used to categorize objects or define specific functionalities.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.TraitEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"code\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"dependencies\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.word\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.name\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Words\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Word\",\r\n      \"description\": \"Represent a single word and any gender or frequency.\",\r\n      \"constraints\": [\r\n        \"name, gender, groupId, organizationId\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"query\": [\r\n        \"name\",\r\n        \"gender\",\r\n        \"groupId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"gender\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 2,\r\n          \"description\": \"Placeholder for gendered words\"\r\n        },\r\n        {\r\n          \"name\": \"count\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Placeholder for tracking frequency; used in wordNetModel for number of words in the synset\"\r\n        },\r\n        {\r\n          \"name\": \"class\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.wordNet\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.name\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Words\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Word\",\r\n      \"constraints\": [\r\n        \"offset, name, type, groupId, organizationId\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"query\": [\r\n        \"name\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"A word with WordNet annotations and synset.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"definition\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 512\r\n        },\r\n        {\r\n          \"name\": \"example\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 512\r\n        },\r\n        {\r\n          \"name\": \"offset\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 8,\r\n          \"description\": \"WordNet synset offset\"\r\n        },\r\n        {\r\n          \"name\": \"lfn\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 2,\r\n          \"description\": \"WordNet lexicographer file name\"\r\n        },\r\n        {\r\n          \"name\": \"count\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Number of words in the synset\"\r\n        },\r\n        {\r\n          \"name\": \"pointerCount\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Number of pointers from this synset to other synsets\"\r\n        },\r\n        {\r\n          \"name\": \"lexId\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Appended to lemma to identify a sense in the lexicographer file\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 1\r\n        },\r\n        {\r\n          \"name\": \"pointers\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"wordNetPointer\"\r\n        },\r\n        {\r\n          \"name\": \"alternatives\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"wordNetAlt\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.cenWord\",\r\n      \"inherits\": [\r\n        \"data.word\"\r\n      ],\r\n      \"group\": \"Words\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Census Word\",\r\n      \"description\": \"Word model used to store words such as names with corresponding census statistics.\",\r\n      \"query\": [\r\n        \"groupId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"rank\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Word rank\"\r\n        },\r\n        {\r\n          \"name\": \"proportion\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Proportion of the word\"\r\n        },\r\n        {\r\n          \"name\": \"pctwhite\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent non-Hispanic White\"\r\n        },\r\n        {\r\n          \"name\": \"pcthispanic\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent Hispanic or Latino\"\r\n        },\r\n        {\r\n          \"name\": \"pctblack\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent non-Hispanic black or African American\"\r\n        },\r\n        {\r\n          \"name\": \"pctapi\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent non-Hispanic Asian, Native Hawaiian, or other Pacific Islander\"\r\n        },\r\n        {\r\n          \"name\": \"pctaian\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent non-Hispanic American Indian or Alaska Native\"\r\n        },\r\n        {\r\n          \"name\": \"pct2prace\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Percent non-Hispanic two or more races\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.wordNetPointer\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"icon\": \"category\",\r\n      \"label\": \"Word Pointer\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"offset\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 8,\r\n          \"description\": \"WordNet synset offset\"\r\n        },\r\n        {\r\n          \"name\": \"pos\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 1,\r\n          \"description\": \"Reference to the word type\"\r\n        },\r\n        {\r\n          \"name\": \"sourceTarget\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Distinguishes lexical and semantic pointers. The first two digits indicates the word number in the current (source) synset, the last two digits indicate the word number in the target synset. A value of 0000 means that pointer_symbol represents a semantic relation between the current (source) synset and the target synset indicated by synset_offset.\",\r\n          \"maxLength\": 4\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.wordNetAlt\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"icon\": \"category\",\r\n      \"label\": \"Word Alternative\",\r\n      \"inherits\": [\r\n        \"common.name\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"lexId\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Appended to lemma to identify a sense in the lexicographer file\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.location\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.parent\",\r\n        \"common.description\",\r\n        \"common.name\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"description\": \"Model used to store locations with various attributes.\",\r\n      \"dedicatedParticipation\": true,\r\n      \"query\": [\r\n        \"name\",\r\n        \"id\",\r\n        \"objectId\",\r\n        \"ownerId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"traits\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"boundaries\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"location.boundary\"\r\n        },\r\n        {\r\n          \"name\": \"borders\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"location.border\"\r\n        },\r\n        {\r\n          \"name\": \"childLocations\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"location.child\"\r\n        },\r\n        {\r\n          \"name\": \"geographyType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.GeographyEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"terrainType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.TerrainEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"classification\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"longitude\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"latitude\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"area\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Area in square meters\"\r\n        },\r\n        {\r\n          \"name\": \"elevation\",\r\n          \"type\": \"double\",\r\n          \"description\": \"Elevation in meters\"\r\n        },\r\n        {\r\n          \"name\": \"gridZone\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 3,\r\n          \"description\": \"Grid zone designation\"\r\n        },\r\n        {\r\n          \"name\": \"kident\",\r\n          \"type\": \"string\",\r\n          \"description\": \"100K Identity\",\r\n          \"maxLength\": 3\r\n        },\r\n        {\r\n          \"name\": \"eastings\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the western grid line\"\r\n        },\r\n        {\r\n          \"name\": \"northings\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the northern grid line\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.geoLocation\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"data.location\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Model used to store geographical locations with various attributes.\",\r\n      \"constraints\": [\r\n        \"geonameid, altgeonameid, parentId, groupId, organizationId\"\r\n      ],\r\n      \"hints\": [\r\n        \"geonameid, groupId\",\r\n        \"parentId, groupId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"altName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 256\r\n        },\r\n        {\r\n          \"name\": \"altgeonameid\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"code\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"geoType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"altType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"feature\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16\r\n        },\r\n        {\r\n          \"name\": \"iso\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 8\r\n        },\r\n        {\r\n          \"name\": \"iso3\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 8\r\n        },\r\n        {\r\n          \"name\": \"languages\",\r\n          \"baseType\": \"string\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"neighbors\",\r\n          \"baseType\": \"string\",\r\n          \"type\": \"list\"\r\n        },\r\n        {\r\n          \"name\": \"capital\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"continent\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"currencyCode\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 4\r\n        },\r\n        {\r\n          \"name\": \"currencyName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"postalCode\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"geonameid\",\r\n          \"type\": \"int\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.personality\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"group\": \"Personalities\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Personality\",\r\n      \"description\": \"A personality is a set of characteristics and traits that define an individual's consistent patterns of thinking, feeling, and behaving. Personalities can be assessed through various models such as the Big Five, MBTI, and Dark Tetrad.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"openness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"conscientiousness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"extraversion\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"agreeableness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"neuroticism\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"machiavellianism\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"narcissism\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"psychopathy\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"sadism\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"sloanKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 5,\r\n          \"provider\": \"org.cote.accountmanager.olio.PersonalityProvider\",\r\n          \"priority\": 10\r\n        },\r\n        {\r\n          \"name\": \"sloanCardinal\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"provider\": \"org.cote.accountmanager.olio.PersonalityProvider\",\r\n          \"priority\": 10\r\n        },\r\n        {\r\n          \"name\": \"mbtiKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"provider\": \"org.cote.accountmanager.olio.PersonalityProvider\",\r\n          \"priority\": 15\r\n        },\r\n        {\r\n          \"name\": \"darkTetradKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 4,\r\n          \"provider\": \"org.cote.accountmanager.olio.PersonalityProvider\",\r\n          \"priority\": 15\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.socialBehavior\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"group\": \"SocialBehaviors\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Social Behavior\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"A social behavior is set of positive and negative traits.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"positive\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"trait.positive\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"negative\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"trait.negative\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.color\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.name\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Colors\",\r\n      \"icon\": \"palette\",\r\n      \"label\": \"Color\",\r\n      \"constraints\": [\r\n        \"name, groupId, organizationId\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"query\": [\r\n        \"name\",\r\n        \"hex\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"Model used to store colors with various representations.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"hex\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 7,\r\n          \"description\": \"Hexadecimal color value\"\r\n        },\r\n        {\r\n          \"name\": \"code\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"red\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"green\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"blue\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"hue\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"saturation\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"lightness\",\r\n          \"type\": \"double\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.socialGroup\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.alignment\",\r\n        \"policy.score\"\r\n      ],\r\n      \"group\": \"SocialGroups\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Social Group\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"A social group is a set of positive and negative social behaviors\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"positive\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"identity.socialBehavior\",\r\n          \"participantModel\": \"behavior.positive\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"negative\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"identity.socialBehavior\",\r\n          \"participantModel\": \"behavior.negative\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.behavior\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"group\": \"Behaviors\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Behavior\",\r\n      \"description\": \"A behavior is a pattern of actions or reactions of an individual or group in response to external or internal stimuli. Behaviors can be influenced by various factors including environment, genetics, and social interactions.\",\r\n      \"dedicatedParticipation\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"rearing\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"education\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"indoctrination\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"herd\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"socialGroups\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"identity.socialGroup\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.profile\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.description\",\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"objectId\",\r\n        \"groupId\",\r\n        \"portrait\",\r\n        \"voice\"\r\n      ],\r\n      \"description\": \"A profile is a collection of shareable information about a person, such as for use in composing UX displays or generating content titles.\",\r\n      \"icon\": \"person\",\r\n      \"label\": \"Profile\",\r\n      \"group\": \"Profiles\",\r\n      \"dedicatedParticipation\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"album\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.data\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"profile.album\"\r\n        },\r\n        {\r\n          \"name\": \"portrait\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.data\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"voice\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.voice\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"contentTitle\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"contentSubTitle\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"pseudonym\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"common.vectorExt\",\r\n      \"inherits\": [\r\n        \"crypto.vaultExt\"\r\n      ],\r\n      \"abstract\": true,\r\n      \"query\": [],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"chunk\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"chunkCount\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"content\",\r\n          \"type\": \"string\",\r\n          \"provider\": \"org.cote.accountmanager.provider.EncryptFieldProvider\",\r\n          \"encrypt\": false\r\n        },\r\n        {\r\n          \"name\": \"embedding\",\r\n          \"type\": \"vector\",\r\n          \"maxLength\": 768\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.vectorModelStore\",\r\n      \"inherits\": [\r\n        \"common.objectId\",\r\n        \"common.dateTime\",\r\n        \"common.vectorExt\",\r\n        \"system.organizationExt\",\r\n        \"system.primaryKey\"\r\n      ],\r\n      \"query\": [\r\n        \"vectorReference\",\r\n        \"vectorReferenceType\",\r\n        \"chunk\",\r\n        \"chunkCount\"\r\n      ],\r\n      \"hints\": [\r\n        \"vectorReference, vectorReferenceType\"\r\n      ],\r\n      \"description\": \"A model store for embedding vectors for use with retrieval-augmented generation (RAG).\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"vectorReference\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"vectorReferenceType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"AccountUsers\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"vectorReferenceType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"score\",\r\n          \"type\": \"double\",\r\n          \"ephemeral\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.vectorList\",\r\n      \"ephemeral\": true,\r\n      \"factory\": \"org.cote.accountmanager.factory.VectorListFactory\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"vectors\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.vectorModelStore\",\r\n          \"type\": \"list\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"data.vectorChunk\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [],\r\n      \"query\": [],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"chapter\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"chapterTitle\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"path\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"chunk\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"chunkCount\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"content\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.taskRequest\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"id\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.SystemTaskEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 10,\r\n          \"default\": \"UNKNOWN\"\r\n        },\r\n        {\r\n          \"name\": \"taskModel\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"taskModelType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"ApiUsers\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"taskModelData\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"taskModelType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"data\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"dataType\",\r\n          \"access\": {\r\n            \"roles\": {\r\n              \"read\": [\r\n                \"ApiUsers\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"dataType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"payload\",\r\n          \"type\": \"blob\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"system.taskResponse\",\r\n      \"inherits\": [\r\n        \"system.taskRequest\"\r\n      ],\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"responseType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ResponseEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 10,\r\n          \"default\": \"UNKNOWN\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"tool.plan\",\r\n      \"ioConstraints\": [\r\n        \"undefined\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"planQuery\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"planPromptConfigName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"planChatName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"executed\",\r\n          \"type\": \"boolean\",\r\n          \"default\": false\r\n        },\r\n        {\r\n          \"name\": \"steps\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"tool.planStep\"\r\n        },\r\n        {\r\n          \"name\": \"output\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"dev.parameter\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"tool.planStep\",\r\n      \"ioConstraints\": [\r\n        \"undefined\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.description\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"toolName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"step\",\r\n          \"type\": \"int\",\r\n          \"default\": 0\r\n        },\r\n        {\r\n          \"name\": \"stepPromptConfigName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"stepChatName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"inputs\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"dev.parameter\"\r\n        },\r\n        {\r\n          \"name\": \"output\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"dev.parameter\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"identity.voice\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"identity.contactInformationExt\"\r\n      ],\r\n      \"icon\": \"volume_up\",\r\n      \"label\": \"Voice\",\r\n      \"group\": \"Voices\",\r\n      \"description\": \"Voice configuration information\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"engine\",\r\n          \"type\": \"string\",\r\n          \"default\": \"xtts\",\r\n          \"limit\": [\r\n            \"piper\",\r\n            \"xtts\"\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"speakerId\",\r\n          \"type\": \"int\",\r\n          \"default\": -1\r\n        },\r\n        {\r\n          \"name\": \"voiceSample\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.data\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"speaker\",\r\n          \"type\": \"string\",\r\n          \"default\": \"Unknown\",\r\n          \"limit\": [\r\n            \"Unknown\",\r\n            \"en_GB-alba-medium\"\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"speed\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0.1,\r\n          \"maxValue\": 4,\r\n          \"default\": 1.3\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.charPerson\",\r\n      \"inherits\": [\r\n        \"identity.person\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"group\": \"Characters\",\r\n      \"icon\": \"face\",\r\n      \"label\": \"Character Person\",\r\n      \"dedicatedParticipation\": true,\r\n      \"factory\": \"org.cote.accountmanager.olio.CharPersonFactory\",\r\n      \"vector\": \"org.cote.accountmanager.olio.VectorProvider\",\r\n      \"query\": [\r\n        \"profile\"\r\n      ],\r\n      \"description\": \"A character person is a specific type of person that has attributes such as appearance, traits, and statistics. They can be involved in various interactions and actions within the system, and they may have specific roles or functions.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"eyeColor\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.color\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"hairColor\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.color\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"hairStyle\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"trades\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"traits\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"person.trait\"\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"person.store\",\r\n          \"shortName\": \"sto\"\r\n        },\r\n        {\r\n          \"name\": \"statistics\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.statistics\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"sta\"\r\n        },\r\n        {\r\n          \"name\": \"instinct\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.instinct\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"inst\"\r\n        },\r\n        {\r\n          \"name\": \"narrative\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.narrative\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.state\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"st\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.instinct\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Instincts\",\r\n      \"icon\": \"category\",\r\n      \"description\": \"Instincts are innate behaviors or tendencies that guide the actions and reactions of characters or entities in the Olio universe. They can influence various aspects of behavior, such as survival, social interaction, and emotional responses.\",\r\n      \"label\": \"Instinct\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"sleep\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"fight\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"flight\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"hide\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"feed\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"drink\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"mate\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"herd\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"hygiene\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"cooperate\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"resist\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"adapt\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"laugh\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"cry\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"protect\",\r\n          \"type\": \"double\",\r\n          \"minValue\": -100,\r\n          \"maxValue\": 100,\r\n          \"validateRange\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.quality\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Qualities\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Quality\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"This model represents the quality attributes of an item, including physical properties, adjustments, and various quality metrics. It is used to define how items behave in terms of their physical characteristics and performance in the game world.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"unit\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 6,\r\n          \"default\": \"us\",\r\n          \"description\": \"Default for US: dimensions in inches, weight in pounds\"\r\n        },\r\n        {\r\n          \"name\": \"valueAdjustment\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"width\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"height\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"weight\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"length\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"opacity\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"elasticity\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"glossiness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"viscocity\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"sliminess\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"range\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 100000,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"smoothness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"hardness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"toughness\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"defensive\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"offensive\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"waterresistance\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"heatresistance\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"insulation\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"skill\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true,\r\n          \"description\": \"Skillfulness needed for full quality application\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.qualityExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"quality\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 100,\r\n          \"default\": 100,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"qualities\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.quality\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.priceExt\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"retailValue\",\r\n          \"type\": \"double\"\r\n        },\r\n        {\r\n          \"name\": \"resaleAdjustment\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true,\r\n          \"default\": 0.5\r\n        },\r\n        {\r\n          \"name\": \"value\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"validateRange\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.item\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.name\",\r\n        \"common.groupExt\",\r\n        \"data.tagsExt\",\r\n        \"common.baseLight\",\r\n        \"common.description\",\r\n        \"olio.qualityExt\",\r\n        \"olio.priceExt\"\r\n      ],\r\n      \"group\": \"Items\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Item\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"name\"\r\n      ],\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"An item is a physical object that can be used, traded, or interacted with in various ways. Items can have specific types, categories, and attributes that define their characteristics and uses. They may also include patterns, colors, and other traits that enhance their functionality or aesthetics.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24\r\n        },\r\n        {\r\n          \"name\": \"category\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"shortName\": \"cat\"\r\n        },\r\n        {\r\n          \"name\": \"quantity\",\r\n          \"type\": \"int\",\r\n          \"shortName\": \"quan\"\r\n        },\r\n        {\r\n          \"name\": \"pattern\",\r\n          \"baseModel\": \"data.data\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"color\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.color\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"complementColor\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.color\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"accentColor\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.color\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"age\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"inuse\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"materials\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"shortName\": \"mat\"\r\n        },\r\n        {\r\n          \"name\": \"perks\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"trait.perk\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"pks\"\r\n        },\r\n        {\r\n          \"name\": \"features\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"trait.feature\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"feat\"\r\n        },\r\n        {\r\n          \"name\": \"statistics\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.itemStatistics\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"stat\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.wearable\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.item\"\r\n      ],\r\n      \"group\": \"Wearables\",\r\n      \"icon\": \"apparel\",\r\n      \"label\": \"Wearable\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"An article of clothing, including layer and placement.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"gender\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 6,\r\n          \"description\": \"Male, female, unisex\"\r\n        },\r\n        {\r\n          \"name\": \"fabric\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24\r\n        },\r\n        {\r\n          \"name\": \"attachment\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16,\r\n          \"description\": \"Worn, carried, etc\"\r\n        },\r\n        {\r\n          \"name\": \"size\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"level\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.WearLevelEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 16,\r\n          \"default\": \"NONE\"\r\n        },\r\n        {\r\n          \"name\": \"location\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"head\",\r\n            \"brow\",\r\n            \"hair\",\r\n            \"back\",\r\n            \"torso\",\r\n            \"chest\",\r\n            \"breast\",\r\n            \"foot\",\r\n            \"toe\",\r\n            \"ankle\",\r\n            \"thigh\",\r\n            \"leg\",\r\n            \"shin\",\r\n            \"wrist\",\r\n            \"hand\",\r\n            \"finger\",\r\n            \"arm\",\r\n            \"forearm\",\r\n            \"neck\",\r\n            \"groin\",\r\n            \"shoulder\",\r\n            \"bicep\",\r\n            \"tricep\",\r\n            \"upper arm\",\r\n            \"knee\",\r\n            \"elbow\",\r\n            \"face\",\r\n            \"nose\",\r\n            \"ear\",\r\n            \"eye\",\r\n            \"hip\",\r\n            \"waist\",\r\n            \"belly\",\r\n            \"lip\"\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.apparel\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.name\",\r\n        \"common.groupExt\",\r\n        \"common.description\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Apparel\",\r\n      \"icon\": \"styler\",\r\n      \"label\": \"Apparel\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"name\"\r\n      ],\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"Apparel is a set of wearable items designed to be worn by characters or entities. It can include various types of clothing, accessories, and other wearable items that enhance the appearance or functionality of the wearer.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"description\": \"The type this apparel is supposed to represent, such as a suit, casual outfit, etc\"\r\n        },\r\n        {\r\n          \"name\": \"category\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"shortName\": \"cat\"\r\n        },\r\n        {\r\n          \"name\": \"gender\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 6,\r\n          \"description\": \"Male, female, unisex\"\r\n        },\r\n        {\r\n          \"name\": \"designer\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"manufacturer\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 127\r\n        },\r\n        {\r\n          \"name\": \"wearables\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.wearable\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"inuse\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.event\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.parent\",\r\n        \"common.description\",\r\n        \"common.name\",\r\n        \"common.baseLight\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.factory.DirectoryFactory\",\r\n      \"group\": \"Olio Events\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Olio Event\",\r\n      \"dedicatedParticipation\": true,\r\n      \"constraints\": [\r\n        \"name, parentId, groupId, organizationId\"\r\n      ],\r\n      \"query\": [\r\n        \"name\",\r\n        \"id\",\r\n        \"objectId\",\r\n        \"ownerId\",\r\n        \"parentId\",\r\n        \"type\",\r\n        \"state\"\r\n      ],\r\n      \"description\": \"An event is a significant occurrence or happening within the Olio universe, which can involve various entities, interactions, and states. Events can have multiple participants, actors, and observers, and they may be influenced by various factors such as location, time, and preceding or subsequent events.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.EventEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"timeType\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.TimeEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"tt\"\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ActionResultEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"st\"\r\n        },\r\n        {\r\n          \"name\": \"entryTraits\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.entryTrait\",\r\n          \"shortName\": \"et\"\r\n        },\r\n        {\r\n          \"name\": \"exitTraits\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.exitTrait\",\r\n          \"shortName\": \"xt\"\r\n        },\r\n        {\r\n          \"name\": \"actors\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.actor\",\r\n          \"shortName\": \"as\"\r\n        },\r\n        {\r\n          \"name\": \"participants\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.participant\",\r\n          \"shortName\": \"ps\"\r\n        },\r\n        {\r\n          \"name\": \"observers\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.observer\",\r\n          \"shortName\": \"os\"\r\n        },\r\n        {\r\n          \"name\": \"influencers\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.influencer\",\r\n          \"shortName\": \"is\"\r\n        },\r\n        {\r\n          \"name\": \"location\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"loc\"\r\n        },\r\n        {\r\n          \"name\": \"realm\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.realm\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"shortName\": \"rea\"\r\n        },\r\n        {\r\n          \"name\": \"interactions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.interaction\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"actionResult.interaction\",\r\n          \"shortName\": \"ias\"\r\n        },\r\n        {\r\n          \"name\": \"eventStart\",\r\n          \"type\": \"zonetime\",\r\n          \"shortName\": \"es\"\r\n        },\r\n        {\r\n          \"name\": \"eventProgress\",\r\n          \"type\": \"zonetime\",\r\n          \"shortName\": \"ep\"\r\n        },\r\n        {\r\n          \"name\": \"inProgress\",\r\n          \"type\": \"boolean\",\r\n          \"shortName\": \"ip\"\r\n        },\r\n        {\r\n          \"name\": \"eventEnd\",\r\n          \"type\": \"zonetime\",\r\n          \"shortName\": \"ee\"\r\n        },\r\n        {\r\n          \"name\": \"precedingEvents\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.preceding\",\r\n          \"shortName\": \"pe\"\r\n        },\r\n        {\r\n          \"name\": \"subsequentEvents\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.subsequent\",\r\n          \"shortName\": \"se\"\r\n        },\r\n        {\r\n          \"name\": \"behavior\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.behavior\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"be\"\r\n        },\r\n        {\r\n          \"name\": \"instinct\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.instinct\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"inst\"\r\n        },\r\n        {\r\n          \"name\": \"groups\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"event.group\",\r\n          \"shortName\": \"gps\"\r\n        },\r\n        {\r\n          \"name\": \"actions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.actionResult\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"action.result\",\r\n          \"shortName\": \"acts\"\r\n        },\r\n        {\r\n          \"name\": \"epoch\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.statistics\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Statistics\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Character Statistics\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"This model represents the statistical attributes of a character in a realm, including physical and mental attributes, derived statistics, and overall potential. It is used to define how characters perform in various aspects of the game world.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"physicalStrength\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"physicalEndurance\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"manualDexterity\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"agility\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"speed\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"mentalStrength\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"mentalEndurance\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"intelligence\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"wisdom\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"perception\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"creativity\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"spirituality\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"description\": \"Potential for both worldy and otherworldly empathy and awareness\"\r\n        },\r\n        {\r\n          \"name\": \"charisma\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"luck\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"athleticism\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"physicalStrength\",\r\n            \"physicalEndurance\",\r\n            \"agility\",\r\n            \"speed\",\r\n            \"mentalEndurance\"\r\n          ],\r\n          \"description\": \"Overall fitness and prowess\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 30\r\n        },\r\n        {\r\n          \"name\": \"magic\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"willpower\",\r\n            \"wisdom\",\r\n            \"creativity\",\r\n            \"spirituality\"\r\n          ],\r\n          \"description\": \"Potential for otherworldly perceptions and manipulations\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 30\r\n        },\r\n        {\r\n          \"name\": \"science\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"intelligence\",\r\n            \"wisdom\",\r\n            \"creativity\"\r\n          ],\r\n          \"description\": \"Propensity to innovate/discover/understand fundamental natural elements\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 30\r\n        },\r\n        {\r\n          \"name\": \"willpower\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"mentalEndurance\",\r\n            \"mentalStrength\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 1\r\n        },\r\n        {\r\n          \"name\": \"reaction\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"agility\",\r\n            \"speed\",\r\n            \"wisdom\",\r\n            \"perception\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 1\r\n        },\r\n        {\r\n          \"name\": \"save\",\r\n          \"type\": \"double\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"PERC20\",\r\n          \"fields\": [\r\n            \"physicalStrength\",\r\n            \"physicalEndurance\",\r\n            \"mentalStrength\",\r\n            \"mentalEndurance\",\r\n            \"charisma\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"validateRange\": true,\r\n          \"priority\": 20\r\n        },\r\n        {\r\n          \"name\": \"potential\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 150,\r\n          \"description\": \"Available attribute points\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"health\",\r\n          \"type\": \"int\",\r\n          \"minValue\": -1,\r\n          \"maxValue\": 20,\r\n          \"default\": -1,\r\n          \"description\": \"Note: This is duplicated with state.health because it's tied to the save calculation\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"maximumHealth\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"physicalStrength\",\r\n            \"physicalEndurance\",\r\n            \"mentalStrength\",\r\n            \"mentalEndurance\",\r\n            \"charisma\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 10\r\n        },\r\n        {\r\n          \"name\": \"physicalAppearance\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"physicalStrength\",\r\n            \"agility\",\r\n            \"maximumHealth\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 15\r\n        },\r\n        {\r\n          \"name\": \"mentalHealth\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"willpower\",\r\n            \"spirituality\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 15\r\n        },\r\n        {\r\n          \"name\": \"wit\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"intelligence\",\r\n            \"creativity\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 15\r\n        },\r\n        {\r\n          \"name\": \"charm\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"charisma\",\r\n            \"wit\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 20\r\n        },\r\n        {\r\n          \"name\": \"beauty\",\r\n          \"type\": \"int\",\r\n          \"virtual\": true,\r\n          \"provider\": \"org.cote.accountmanager.provider.ComputeProvider\",\r\n          \"compute\": \"AVG\",\r\n          \"fields\": [\r\n            \"physicalAppearance\",\r\n            \"charm\",\r\n            \"manualDexterity\",\r\n            \"mentalHealth\",\r\n            \"perception\"\r\n          ],\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"priority\": 25\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.state\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"States\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"State\",\r\n      \"dedicatedParticipation\": true,\r\n      \"query\": [\r\n        \"groupId\",\r\n        \"organizationId\"\r\n      ],\r\n      \"description\": \"This model represents the state of an entity in a realm, including its current event, location, actions, and various status flags. It is used to track the condition and activities of entities such as players or NPCs within the game world.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"currentEvent\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"currentLocation\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"followReference\": true\r\n        },\r\n        {\r\n          \"name\": \"actions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.actionResult\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"alive\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true\r\n        },\r\n        {\r\n          \"name\": \"awake\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true\r\n        },\r\n        {\r\n          \"name\": \"agitated\",\r\n          \"type\": \"boolean\",\r\n          \"description\": \"Bit indicating that the state was intentionally agitated\"\r\n        },\r\n        {\r\n          \"name\": \"immobilized\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"incapacitated\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"disabled\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"currentEast\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the western grid line of the currentLocation\",\r\n          \"default\": -1\r\n        },\r\n        {\r\n          \"name\": \"currentNorth\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the northern grid line of the currentLocation\",\r\n          \"default\": -1\r\n        },\r\n        {\r\n          \"name\": \"health\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"description\": \"Percentage of health remaining\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"energy\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"description\": \"Percentage of energy remaining\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"schedules\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.schedule\",\r\n          \"participantModel\": \"state.schedule\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.action\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"group\": \"Actions\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Action\",\r\n      \"description\": \"An action that can be performed by a character or entity, which may have various effects on their attributes, skills, and states.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"provider\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Class or script name used to perform a discrete execution of the action\"\r\n        },\r\n        {\r\n          \"name\": \"difficulty\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true,\r\n          \"shortName\": \"hard\"\r\n        },\r\n        {\r\n          \"name\": \"minimumTime\",\r\n          \"type\": \"int\",\r\n          \"minValue\": -1,\r\n          \"description\": \"Minimum amount of seconds required to perform the action\",\r\n          \"shortName\": \"mint\"\r\n        },\r\n        {\r\n          \"name\": \"maximumTime\",\r\n          \"type\": \"int\",\r\n          \"minValue\": -1,\r\n          \"description\": \"Maximum amount of seconds to perform the action before becoming counter-productive or futile\",\r\n          \"shortName\": \"maxt\"\r\n        },\r\n        {\r\n          \"name\": \"minimumEnergyCost\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1,\r\n          \"description\": \"Minimum amount of energy required to perform the action, expressed as a percentage of maximum available energy\",\r\n          \"validateRange\": true,\r\n          \"shortName\": \"mine\"\r\n        },\r\n        {\r\n          \"name\": \"positiveStatistics\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"physicalStrength\",\r\n            \"physicalEndurance\",\r\n            \"manualDexterity\",\r\n            \"agility\",\r\n            \"speed\",\r\n            \"mentalStrength\",\r\n            \"mentalEndurance\",\r\n            \"intelligence\",\r\n            \"wisdom\",\r\n            \"charisma\",\r\n            \"creativity\",\r\n            \"spirituality\",\r\n            \"science\",\r\n            \"reaction\",\r\n            \"save\",\r\n            \"magic\",\r\n            \"maximumHealth\"\r\n          ],\r\n          \"shortName\": \"psta\"\r\n        },\r\n        {\r\n          \"name\": \"negativeStatistics\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"physicalStrength\",\r\n            \"physicalEndurance\",\r\n            \"manualDexterity\",\r\n            \"agility\",\r\n            \"speed\",\r\n            \"mentalStrength\",\r\n            \"mentalEndurance\",\r\n            \"intelligence\",\r\n            \"wisdom\",\r\n            \"charisma\",\r\n            \"creativity\",\r\n            \"spirituality\",\r\n            \"science\",\r\n            \"reaction\",\r\n            \"save\",\r\n            \"magic\",\r\n            \"maximumHealth\"\r\n          ],\r\n          \"shortName\": \"nsta\"\r\n        },\r\n        {\r\n          \"name\": \"positivePersonality\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"open\",\r\n            \"conscientious\",\r\n            \"extraverted\",\r\n            \"agreeable\",\r\n            \"neurotic\"\r\n          ],\r\n          \"shortName\": \"pper\"\r\n        },\r\n        {\r\n          \"name\": \"negativePersonality\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"open\",\r\n            \"conscientious\",\r\n            \"extraverted\",\r\n            \"agreeable\",\r\n            \"neurotic\"\r\n          ],\r\n          \"shortName\": \"nper\"\r\n        },\r\n        {\r\n          \"name\": \"positiveStates\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"health\",\r\n            \"energy\"\r\n          ],\r\n          \"shortName\": \"pst\"\r\n        },\r\n        {\r\n          \"name\": \"negativeStates\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"health\",\r\n            \"energy\"\r\n          ],\r\n          \"shortName\": \"nst\"\r\n        },\r\n        {\r\n          \"name\": \"positiveInstincts\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"sleep\",\r\n            \"fight\",\r\n            \"flight\",\r\n            \"feed\",\r\n            \"drink\",\r\n            \"mate\",\r\n            \"herd\",\r\n            \"hygiene\",\r\n            \"cooperate\",\r\n            \"resist\",\r\n            \"adapt\",\r\n            \"laugh\",\r\n            \"cry\",\r\n            \"protect\"\r\n          ],\r\n          \"shortName\": \"pi\"\r\n        },\r\n        {\r\n          \"name\": \"negativeInstincts\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"limit\": [\r\n            \"sleep\",\r\n            \"fight\",\r\n            \"flight\",\r\n            \"feed\",\r\n            \"drink\",\r\n            \"mate\",\r\n            \"herd\",\r\n            \"hygiene\",\r\n            \"cooperate\",\r\n            \"resist\",\r\n            \"adapt\",\r\n            \"laugh\",\r\n            \"cry\",\r\n            \"protect\"\r\n          ],\r\n          \"shortName\": \"ni\"\r\n        },\r\n        {\r\n          \"name\": \"counterActions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"shortName\": \"ca\"\r\n        },\r\n        {\r\n          \"name\": \"requiredSkills\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"rs\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.actionResult\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"group\": \"Action Results\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Action Result\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"An action result is a record of the outcome of an action performed by an actor, which may include various attributes, statistics, and states that are affected by the action. It can also include interactions with other entities and dependent actions.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"action\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"builder\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.builder\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"counterAction\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"parameters\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.actionParameters\",\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ActionResultEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"actorType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"actt\"\r\n        },\r\n        {\r\n          \"name\": \"actor\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"actorType\",\r\n          \"shortName\": \"act\"\r\n        },\r\n        {\r\n          \"name\": \"delegateType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"delt\"\r\n        },\r\n        {\r\n          \"name\": \"delegate\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"delegateType\",\r\n          \"shortName\": \"del\"\r\n        },\r\n        {\r\n          \"name\": \"outcome\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.OutcomeEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"equilibrium\",\r\n          \"shortName\": \"out\"\r\n        },\r\n        {\r\n          \"name\": \"need\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"description\": \"Placeholder for the name of a need the action satisfies\"\r\n        },\r\n        {\r\n          \"name\": \"needType\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.AssessmentEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"description\": \"Placeholder for the type need the action satisfies\"\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"actionStart\",\r\n          \"type\": \"zonetime\"\r\n        },\r\n        {\r\n          \"name\": \"actionProgress\",\r\n          \"type\": \"zonetime\"\r\n        },\r\n        {\r\n          \"name\": \"actionEnd\",\r\n          \"type\": \"zonetime\"\r\n        },\r\n        {\r\n          \"name\": \"statistics\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.statistics\",\r\n          \"description\": \"Statistics modifiers from this action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.state\",\r\n          \"description\": \"State modifiers from this action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"instinct\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.instinct\",\r\n          \"description\": \"Instinct modifiers from this action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"personality\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"identity.personality\",\r\n          \"description\": \"Personality modifiers from this action\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"dependentActions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.actionResult\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"actionResult.actionResult\",\r\n          \"shortName\": \"das\"\r\n        },\r\n        {\r\n          \"name\": \"interactions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.interaction\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"actionResult.interaction\",\r\n          \"shortName\": \"ias\"\r\n        },\r\n        {\r\n          \"name\": \"results\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"trace\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.actionParameters\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"actionName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"itemName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"itemCategory\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"itemModel\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"default\": \"olio.item\"\r\n        },\r\n        {\r\n          \"name\": \"direction\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.DirectionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"wearLevel\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.WearLevelEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"narrate\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"autoComplete\",\r\n          \"type\": \"boolean\",\r\n          \"description\": \"In an action is interrupted for some reason, and then the same action attempted again, setting autoComplete to true will conclude the incomplete action.  Otherwise, if false the new action won't start until the prior action is completed.\"\r\n        },\r\n        {\r\n          \"name\": \"duration\",\r\n          \"type\": \"int\",\r\n          \"default\": 0,\r\n          \"description\": \"Number of seconds to perform a timed action.\"\r\n        },\r\n        {\r\n          \"name\": \"quantity\",\r\n          \"type\": \"int\",\r\n          \"default\": 0,\r\n          \"description\": \"Placeholder of quantity to be used in conduct of the action.\"\r\n        },\r\n        {\r\n          \"name\": \"distance\",\r\n          \"type\": \"double\",\r\n          \"default\": 0\r\n        },\r\n        {\r\n          \"name\": \"needName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"needType\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.AssessmentEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"UNKNOWN\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.schedule\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\",\r\n        \"common.reference\"\r\n      ],\r\n      \"group\": \"Schedules\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Schedule\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"This model represents a schedule for recurring events or actions within a realm. It includes details about the schedule's timing, recurrence, and associated actions. Schedules can be used to automate tasks or manage events that occur at specific times or intervals.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"beginDate\",\r\n          \"type\": \"timestamp\"\r\n        },\r\n        {\r\n          \"name\": \"endDate\",\r\n          \"type\": \"timestamp\"\r\n        },\r\n        {\r\n          \"name\": \"completedDate\",\r\n          \"type\": \"timestamp\",\r\n          \"description\": \"Time when the schedule was last completed\"\r\n        },\r\n        {\r\n          \"name\": \"reoccurs\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"reoccurence\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.TimeEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"reoccurenceInterval\",\r\n          \"type\": \"int\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"dayOfWeek\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 7,\r\n          \"description\": \"For reoccuring - Day of the week the schedule applies\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"secondOfDay\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 86400,\r\n          \"description\": \"For reoccuring - Second of the day the schedule applies\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"duration\",\r\n          \"type\": \"int\",\r\n          \"minValue\": -1,\r\n          \"description\": \"For reoccuring - number of seconds the schedule lasts\",\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"schedules\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"$self\",\r\n          \"type\": \"list\",\r\n          \"foreign\": true,\r\n          \"followReference\": false,\r\n          \"participantModel\": \"schedule.child\"\r\n        },\r\n        {\r\n          \"name\": \"actions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.action\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.inventoryEntry\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Inventory Entries\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Inventory Entry\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"An inventory entry represents a specific item or apparel in the inventory system. It includes details such as quantity, age, usage status, and the associated item or apparel model.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"quantity\",\r\n          \"type\": \"int\",\r\n          \"shortName\": \"quan\"\r\n        },\r\n        {\r\n          \"name\": \"age\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"inuse\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"item\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.item\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"apparel\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.apparel\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.store\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Stores\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Store\",\r\n      \"dedicatedParticipation\": true,\r\n      \"sortField\": \"name\",\r\n      \"sortOrder\": \"ASCENDING\",\r\n      \"description\": \"This model represents a store in a realm, which can be a physical or virtual place where items, apparel, and other goods are sold or stored. It includes details about the store's name, inventory, items, apparel, and locations associated with the store.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"inventory\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.inventoryEntry\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"store.entry\",\r\n          \"description\": \"Inventory is meant to hold item references, particularly renewable or consumable items versus continually used items.  For example, an item in a merchant's or manufacturer's inventory entry versus an item that someone owns, and makes use of. At present, it is an abstract duplicate of what may be in the items or apparel or wearable lists, and may ultimately replace those.\"\r\n        },\r\n        {\r\n          \"name\": \"items\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.item\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"store.item\",\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"apparel\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.apparel\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"store.apparel\"\r\n        },\r\n        {\r\n          \"name\": \"locations\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"store.location\",\r\n          \"description\": \"Locations that belong to this store - eg: locations a person owns, etc\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.builder\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.name\",\r\n        \"common.groupExt\",\r\n        \"data.tagsExt\",\r\n        \"common.baseLight\",\r\n        \"common.description\",\r\n        \"olio.qualityExt\",\r\n        \"olio.priceExt\"\r\n      ],\r\n      \"group\": \"Builders\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Builder\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"name\",\r\n        \"tags\"\r\n      ],\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"A builder is an entity that can create or produce items, apparel, or other objects using various materials and skills. Builders can have specific types, schedules, and renewable capabilities, and they may require certain materials and skills to perform their tasks.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.BuilderEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\"\r\n        },\r\n        {\r\n          \"name\": \"time\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Time in minutes to build this object with mean skill level\"\r\n        },\r\n        {\r\n          \"name\": \"schedule\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.schedule\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"buildable.schedule\",\r\n          \"description\": \"Schedule to use for reoccuring builders\",\r\n          \"shortName\": \"sch\"\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"buildable.store\",\r\n          \"description\": \"Store where a produced item will be placed\",\r\n          \"shortName\": \"sto\"\r\n        },\r\n        {\r\n          \"name\": \"renewable\",\r\n          \"type\": \"boolean\",\r\n          \"shortName\": \"ren\"\r\n        },\r\n        {\r\n          \"name\": \"materials\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.item\",\r\n          \"participantModel\": \"builder.material\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"mat\"\r\n        },\r\n        {\r\n          \"name\": \"apparel\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.apparel\",\r\n          \"description\": \"Templates to use when building out apparel/wearables\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"app\"\r\n        },\r\n        {\r\n          \"name\": \"item\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.item\",\r\n          \"description\": \"Templates to use when building out items\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"skills\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.builder\",\r\n          \"participantModel\": \"builder.builder\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"sk\"\r\n        },\r\n        {\r\n          \"name\": \"perks\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"builder.perk\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"pks\"\r\n        },\r\n        {\r\n          \"name\": \"features\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"participantModel\": \"builder.feature\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"feat\"\r\n        },\r\n        {\r\n          \"name\": \"terrain\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"description\": \"Terrain limitations for a particular build.  E.G.: Can't build an igloo in a desert\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.itemStatistics\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Statistics\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Item Statistics\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"Item statistics represent various attributes of an item that can affect its performance, usability, and interaction within the Olio universe. These statistics include damage, protection, entrapment capabilities, range, and consumption/replenishment characteristics.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"damage\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"protection\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"entrapment\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"maxValue\": 20,\r\n          \"validateRange\": true\r\n        },\r\n        {\r\n          \"name\": \"range\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Range in meters\"\r\n        },\r\n        {\r\n          \"name\": \"consumptionType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16,\r\n          \"description\": \"General indicator that the item passively or actively consumes some other item or resource.  It's up to the implementation rule to determine how.\"\r\n        },\r\n        {\r\n          \"name\": \"consumption\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"description\": \"General indicator of how much of the consumptionType is consumed.  It's up to the implementation rule to determine how.\"\r\n        },\r\n        {\r\n          \"name\": \"replenishmentType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 16,\r\n          \"description\": \"General indicator that the item passively or actively replenishes some other item or resource.  It's up to the implementation rule to determine how.\"\r\n        },\r\n        {\r\n          \"name\": \"replenishment\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 0,\r\n          \"description\": \"General indicator of how much of the replenishmentType is replenished.  It's up to the implementation rule to determine how.\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.animal\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.name\",\r\n        \"common.groupExt\",\r\n        \"data.tagsExt\",\r\n        \"common.baseLight\",\r\n        \"common.description\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"group\": \"Animals\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Animal\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"name\"\r\n      ],\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"An animal is a living entity that can be interacted with in various ways, such as being tamed, trained, or used for various purposes. Animals can have traits, statistics, and states that define their behavior and capabilities.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"type\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24\r\n        },\r\n        {\r\n          \"name\": \"category\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"shortName\": \"cat\"\r\n        },\r\n        {\r\n          \"name\": \"groupName\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 24,\r\n          \"shortName\": \"grpn\"\r\n        },\r\n        {\r\n          \"name\": \"habitat\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"age\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"gender\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 10\r\n        },\r\n        {\r\n          \"name\": \"traits\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.trait\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"person.trait\"\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"animal.store\",\r\n          \"shortName\": \"sto\"\r\n        },\r\n        {\r\n          \"name\": \"statistics\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.statistics\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"sta\"\r\n        },\r\n        {\r\n          \"name\": \"instinct\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.instinct\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"inst\"\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.state\",\r\n          \"foreign\": true,\r\n          \"shortName\": \"st\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.realm\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\"\r\n      ],\r\n      \"group\": \"Realms\",\r\n      \"icon\": \"note\",\r\n      \"label\": \"Realm\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"This model represents a realm, which is a collection of communities and their associated data. It includes information about the realm's population, groups, locations, and other relevant details.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"population\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"populationGroups\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"community.group\"\r\n        },\r\n        {\r\n          \"name\": \"principalGroup\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true,\r\n          \"description\": \"Placeholder for a primary group (aka: party or band)\"\r\n        },\r\n        {\r\n          \"name\": \"leadershipGroup\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true,\r\n          \"description\": \"Placeholder for any leadership group\"\r\n        },\r\n        {\r\n          \"name\": \"origin\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"community.origin\"\r\n        },\r\n        {\r\n          \"name\": \"currentEpoch\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"currentEvent\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"currentIncrement\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"locations\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"community.location\"\r\n        },\r\n        {\r\n          \"name\": \"zoo\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.animal\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"community.animal\"\r\n        },\r\n        {\r\n          \"name\": \"currencies\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.item\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"community.currency\"\r\n        },\r\n        {\r\n          \"name\": \"schedules\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.schedule\",\r\n          \"participantModel\": \"community.schedule\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"person.store\",\r\n          \"shortName\": \"sto\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.interaction\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"Interactions\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Interaction\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"description\": \"Track interactions between an individual actor and individual interactor.  Interaction outcomes are defined as favorable, equilibrium, or unfavorable for the actor and interactor.  The context is determined elsewhere, such as at the event or actionResult level.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"description\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128,\r\n          \"shortName\": \"dsc\"\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.InteractionEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"intt\"\r\n        },\r\n        {\r\n          \"name\": \"state\",\r\n          \"baseClass\": \"org.cote.accountmanager.schema.type.ActionResultEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"acts\"\r\n        },\r\n        {\r\n          \"name\": \"interactionStart\",\r\n          \"type\": \"zonetime\",\r\n          \"shortName\": \"is\"\r\n        },\r\n        {\r\n          \"name\": \"interactionEnd\",\r\n          \"type\": \"zonetime\",\r\n          \"shortName\": \"ie\"\r\n        },\r\n        {\r\n          \"name\": \"actorType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"actt\"\r\n        },\r\n        {\r\n          \"name\": \"actor\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"actorType\",\r\n          \"shortName\": \"act\"\r\n        },\r\n        {\r\n          \"name\": \"actorClaim\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128,\r\n          \"shortName\": \"acla\",\r\n          \"description\": \"Textual statement representing the actor's immediate position of the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"actorInstinct\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"ainst\",\r\n          \"description\": \"Name of any primary instinct driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"actorPersonality\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"aper\",\r\n          \"description\": \"Name of any primary personality trait driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"actorStatistic\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"asta\",\r\n          \"description\": \"Name of any primary statistic driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"actorRoleSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"actorRole\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.CharacterRoleEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"actr\"\r\n        },\r\n        {\r\n          \"name\": \"actorReasonSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"actorReason\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.ReasonEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"actrr\"\r\n        },\r\n        {\r\n          \"name\": \"actorAlignmentSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"actorAlignment\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.AlignmentEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"acta\"\r\n        },\r\n        {\r\n          \"name\": \"actorOutcome\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.OutcomeEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"equilibrium\",\r\n          \"shortName\": \"acto\"\r\n        },\r\n        {\r\n          \"name\": \"actorThreatSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"actorThreat\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.ThreatEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"none\",\r\n          \"shortName\": \"actth\"\r\n        },\r\n        {\r\n          \"name\": \"interactorType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"iactt\"\r\n        },\r\n        {\r\n          \"name\": \"interactor\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"interactorType\",\r\n          \"shortName\": \"iact\"\r\n        },\r\n        {\r\n          \"name\": \"interactorClaim\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128,\r\n          \"shortName\": \"icla\",\r\n          \"description\": \"Textual statement representing the interactor's immediate position of the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"interactorInstinct\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"iinst\",\r\n          \"description\": \"Name of any primary instinct driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"interactorPersonality\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"iper\",\r\n          \"description\": \"Name of any primary personality trait driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"interactorStatistic\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"ista\",\r\n          \"description\": \"Name of any primary statistic driving the interaction.\"\r\n        },\r\n        {\r\n          \"name\": \"interactorRoleSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"interactorRole\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.CharacterRoleEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"iactr\"\r\n        },\r\n        {\r\n          \"name\": \"interactorReason\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.ReasonEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\",\r\n          \"shortName\": \"iactrr\"\r\n        },\r\n        {\r\n          \"name\": \"interactorReasonSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"interactorAlignmentSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"interactorAlignment\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.AlignmentEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"shortName\": \"iacta\"\r\n        },\r\n        {\r\n          \"name\": \"interactorOutcome\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.OutcomeEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"equilibrium\",\r\n          \"shortName\": \"iacto\"\r\n        },\r\n        {\r\n          \"name\": \"interactorThreatSuggestion\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"interactorThreat\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.ThreatEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"none\",\r\n          \"shortName\": \"iactth\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.narrative\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"icon\": \"category\",\r\n      \"label\": \"Narrative\",\r\n      \"group\": \"Narratives\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"A narrative is a structured story or account that includes various elements such as characters, scenes, interactions, and descriptions. It can be used to create immersive experiences in games or simulations, providing detailed backgrounds and contexts for characters and events.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"fullName\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"sceneDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"interactionDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"physicalDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"outfitDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"armamentDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"statisticsDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"alignmentDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"darkTetradDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"mbtiDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"sloanDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"sdPrompt\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"sdNegativePrompt\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"images\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"data.data\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"narrative.image\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.chatConfig\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.alignment\",\r\n        \"crypto.vaultExt\"\r\n      ],\r\n      \"group\": \"Chat\",\r\n      \"icon\": \"chat\",\r\n      \"label\": \"Chat Configuration\",\r\n      \"description\": \"Configuration for a chat session with an LLM (Large Language Model). This includes settings for characters, narratives, interactions, and various options to control the chat experience.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"rating\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.llm.ESRBEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 3,\r\n          \"default\": \"E\"\r\n        },\r\n        {\r\n          \"name\": \"serviceType\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.llm.LLMServiceEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 10,\r\n          \"default\": \"OPENAI\"\r\n        },\r\n        {\r\n          \"name\": \"systemCharacter\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"systemNarrative\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.narrative\"\r\n        },\r\n        {\r\n          \"name\": \"userCharacter\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"userNarrative\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.narrative\"\r\n        },\r\n        {\r\n          \"name\": \"interactions\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.interaction\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"chatConfig.interaction\",\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"interaction\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.interaction\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"event\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"useNLP\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"stream\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"nlpCommand\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Brief phrase (not a complete sentence) of what to reinfore through NLP during a chat conversation\"\r\n        },\r\n        {\r\n          \"name\": \"useJailBreak\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"prune\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"scene\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"terrain\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"populationDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"animalDescription\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"includeScene\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"setting\",\r\n          \"type\": \"string\",\r\n          \"default\": \"random\"\r\n        },\r\n        {\r\n          \"name\": \"model\",\r\n          \"type\": \"string\",\r\n          \"default\": \"dolphin-llama3\"\r\n        },\r\n        {\r\n          \"name\": \"analyzeModel\",\r\n          \"type\": \"string\",\r\n          \"default\": \"dolphin-llama3\"\r\n        },\r\n        {\r\n          \"name\": \"userPrompt\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"universeName\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Name of any olio universe related to the characters or interactions.\"\r\n        },\r\n        {\r\n          \"name\": \"worldName\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Name of any olio world related to the characters or interactions.\"\r\n        },\r\n        {\r\n          \"name\": \"startMode\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": \"16\",\r\n          \"description\": \"Variant used to control how a chat begins\",\r\n          \"limit\": [\r\n            \"user\",\r\n            \"system\",\r\n            \"none\"\r\n          ],\r\n          \"default\": \"none\"\r\n        },\r\n        {\r\n          \"name\": \"episodes\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.episode\"\r\n        },\r\n        {\r\n          \"name\": \"chatOptions\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.chatOptions\"\r\n        },\r\n        {\r\n          \"name\": \"apiVersion\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"serverUrl\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 512,\r\n          \"default\": \"http://localhost:11434\"\r\n        },\r\n        {\r\n          \"name\": \"apiKey\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 256,\r\n          \"provider\": \"org.cote.accountmanager.provider.EncryptFieldProvider\",\r\n          \"encrypt\": true\r\n        },\r\n        {\r\n          \"name\": \"assist\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"remindEvery\",\r\n          \"type\": \"int\",\r\n          \"default\": 6,\r\n          \"description\": \"When assist is true, the number of user messages before any reminder text is included in the conversation history\"\r\n        },\r\n        {\r\n          \"name\": \"keyframeEvery\",\r\n          \"type\": \"int\",\r\n          \"default\": 0,\r\n          \"description\": \"When assist is true and prune is true, the number of messages after any previous keyframe or after the beginning of the message history before conducting a conversation analysis.  This is intended to be an objective summary of the conversation to preserve context and important details\"\r\n        },\r\n        {\r\n          \"name\": \"messageTrim\",\r\n          \"type\": \"int\",\r\n          \"default\": 20,\r\n          \"description\": \"When prune is true, sets the size of the message history to include in each request. messageTrim and keyframeEvery should be the same size when used in conjunction.  Note: The entire conversation is always preserved and may be used for summarization and analysis, this only affects the number of messages to include when using the chat capability.\"\r\n        },\r\n    {\r\n          \"name\": \"policy\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"policy.policy\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.promptConfig\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\",\r\n        \"common.alignment\"\r\n      ],\r\n      \"group\": \"Chat\",\r\n      \"icon\": \"chat\",\r\n      \"label\": \"Prompt Configuration\",\r\n      \"description\": \"Configuration for prompts used in chat sessions with an LLM (Large Language Model). This includes system prompts, user prompts, and various settings to control the chat experience.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"system\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"systemCensorWarning\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"systemNlp\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"systemSDPrompt\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"systemNarrate\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"systemAnalyze\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistant\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantAnalyze\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantNarrate\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantNlp\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantCensorWarning\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantReminder\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"user\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userReminder\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userAnalyze\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userCitation\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userNarrate\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userReduce\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"jailBreak\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"scene\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"setting\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userConsentPrefix\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userConsentRating\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userConsentNlp\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"femalePerspective\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"malePerspective\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"races\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.promptRaceConfig\"\r\n        },\r\n        {\r\n          \"name\": \"outfit\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"userOutfit\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"assistantOutfit\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"episodeRule\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.promptRaceConfig\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"raceType\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.RaceEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 2,\r\n          \"default\": \"E\"\r\n        },\r\n        {\r\n          \"name\": \"race\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.pointOfInterest\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\"\r\n      ],\r\n      \"group\": \"POIs\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Point of Interest\",\r\n      \"dedicatedParticipation\": true,\r\n      \"sortField\": \"name\",\r\n      \"sortOrder\": \"ASCENDING\",\r\n      \"query\": [\r\n        \"location\",\r\n        \"groupId\",\r\n        \"organizationId\"\r\n      ],\r\n      \"description\": \"This model represents a point of interest in a realm, such as a building, landmark, or other significant location. It includes details about the point's name, type, location, and associated store or builder.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"description\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 256\r\n        },\r\n        {\r\n          \"name\": \"type\",\r\n          \"baseClass\": \"org.cote.accountmanager.olio.PointOfInterestEnumType\",\r\n          \"type\": \"enum\",\r\n          \"maxLength\": 32,\r\n          \"default\": \"unknown\"\r\n        },\r\n        {\r\n          \"name\": \"concealed\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"location\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"store\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.store\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"poi.store\",\r\n          \"shortName\": \"sto\"\r\n        },\r\n        {\r\n          \"name\": \"builder\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.builder\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"poi.build\",\r\n          \"shortName\": \"bld\"\r\n        },\r\n        {\r\n          \"name\": \"east\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the western grid line of the location\",\r\n          \"default\": -1\r\n        },\r\n        {\r\n          \"name\": \"north\",\r\n          \"type\": \"int\",\r\n          \"description\": \"Meters from the northern grid line of the location\",\r\n          \"default\": -1\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.world\",\r\n      \"inherits\": [\r\n        \"data.directory\",\r\n        \"common.description\"\r\n      ],\r\n      \"factory\": \"org.cote.accountmanager.olio.WorldFactory\",\r\n      \"group\": \"Worlds\",\r\n      \"icon\": \"note\",\r\n      \"label\": \"World\",\r\n      \"description\": \"Collection of groups used to represent a world.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"population\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"locations\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"addresses\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"contacts\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"features\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"events\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"words\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"names\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"surnames\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"occupations\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"dictionary\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"traits\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"colors\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"patterns\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"apparel\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"wearables\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"qualities\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"statistics\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"instincts\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"behaviors\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"states\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"personalities\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"basis\",\r\n          \"baseModel\": \"olio.world\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"schedules\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"actions\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"actionResults\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"builders\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"stores\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"inventories\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"interactions\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"items\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"animals\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"gallery\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"narratives\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"tagsGroup\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"description\": \"Using an alternate name so as not to conflict with the existing 'tags' property\"\r\n        },\r\n        {\r\n          \"name\": \"realmsGroup\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"profiles\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"pointsOfInterest\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"auth.group\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"realms\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.realm\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.episode\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"theme\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 128\r\n        },\r\n        {\r\n          \"name\": \"name\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"completed\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"summary\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"episodeAssist\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"number\",\r\n          \"type\": \"int\",\r\n          \"default\": 0\r\n        },\r\n        {\r\n          \"name\": \"stages\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"duration\",\r\n          \"type\": \"int\",\r\n          \"default\": 0,\r\n          \"description\": \"Number of minutes the episode should last.\"\r\n        }\r\n      ]\r\n    },\r\n       {\r\n      \"name\": \"olio.sd.config\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"description\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"imageAction\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Verb phrase describing the action to be performed in the image.\"\r\n        },\r\n        {\r\n          \"name\": \"seed\",\r\n          \"type\": \"int\",\r\n          \"default\": -1\r\n        },\r\n        {\r\n        \"name\": \"shared\",\r\n        \"type\": \"boolean\",\r\n        \"description\": \"Whether the config is meant to be shared internally across generations.\"\r\n         },\r\n        {\r\n          \"name\": \"hires\",\r\n          \"type\": \"boolean\",\r\n          \"default\": true,\r\n          \"description\": \"Whether to use the refiner.\"\r\n        },\r\n        {\r\n          \"name\": \"steps\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 100,\r\n          \"default\": 20\r\n        },\r\n        {\r\n          \"name\": \"refinerSteps\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 100,\r\n          \"default\": 20\r\n        },\r\n        {\r\n          \"name\": \"width\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 2048,\r\n          \"default\": 1024\r\n        },\r\n        {\r\n          \"name\": \"height\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 2048,\r\n          \"default\": 1024\r\n        },\r\n        {\r\n          \"name\": \"cfg\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 20,\r\n          \"default\": 7\r\n        },\r\n        {\r\n          \"name\": \"model\",\r\n          \"type\": \"string\",\r\n          \"default\": \"sdXL_v10VAEFix.safetensors\"\r\n        },\r\n        {\r\n          \"name\": \"scheduler\",\r\n          \"type\": \"string\",\r\n          \"default\": \"Karras\"\r\n        },\r\n        {\r\n          \"name\": \"sampler\",\r\n          \"type\": \"string\",\r\n          \"default\": \"dpmpp_2m\"\r\n        },\r\n        {\r\n          \"name\": \"refinerScheduler\",\r\n          \"type\": \"string\",\r\n          \"default\": \"Karras\"\r\n        },\r\n        {\r\n          \"name\": \"refinerSampler\",\r\n          \"type\": \"string\",\r\n          \"default\": \"dpmpp_2m\"\r\n        },\r\n        {\r\n          \"name\": \"refinerModel\",\r\n          \"type\": \"string\",\r\n          \"default\": \"juggernautXL_ragnarokBy.safetensors\"\r\n        },\r\n        {\r\n          \"name\": \"refinerMethod\",\r\n          \"type\": \"string\",\r\n          \"default\": \"PostApply\"\r\n        },\r\n        {\r\n          \"name\": \"refinerUpscaleMethod\",\r\n          \"type\": \"string\",\r\n          \"default\": \"pixel-lanczos\"\r\n        },\r\n        {\r\n          \"name\": \"refinerControlPercentage\",\r\n          \"type\": \"double\",\r\n          \"minValue\": 0.01,\r\n          \"maxValue\": 1.0,\r\n          \"default\": 0.2\r\n        },\r\n        {\r\n          \"name\": \"refinerUpscale\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 2,\r\n          \"default\": 2\r\n        },\r\n        {\r\n          \"name\": \"refinerCfg\",\r\n          \"type\": \"int\",\r\n          \"minValue\": 1,\r\n          \"maxValue\": 20,\r\n          \"default\": 7\r\n        },\r\n        {\r\n          \"name\": \"imageCount\",\r\n          \"type\": \"int\",\r\n          \"default\": 1,\r\n          \"minValue\": 1,\r\n          \"maxValue\": 5\r\n        },\r\n        {\r\n          \"name\": \"imageSetting\",\r\n          \"type\": \"string\",\r\n          \"default\": \"random\"\r\n        },\r\n        {\r\n          \"name\": \"bodyStyle\",\r\n          \"type\": \"string\",\r\n          \"default\": \"full body\"\r\n        },\r\n        {\r\n          \"name\": \"stillCamera\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"film\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"lens\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"colorProcess\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"photographer\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"movieCamera\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"movieFilm\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"director\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"photoStyle\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"style\",\r\n          \"type\": \"string\",\r\n          \"limit\": [\r\n            \"art\",\r\n            \"movie\",\r\n            \"photograph\"\r\n          ]\r\n        },\r\n        {\r\n          \"name\": \"artStyle\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.sd.configData\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"stillCameras\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"films\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"lenses\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"colorProcesses\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"photographers\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"movieCameras\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"movieFilms\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"directors\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"photoStyles\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"artStyles\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"styles\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.vectorChatHistory\",\r\n      \"inherits\": [\r\n        \"data.vectorModelStore\"\r\n      ],\r\n      \"query\": [],\r\n      \"hints\": [],\r\n      \"description\": \"Used for storing chat history with vector embeddings\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"systemCharacter\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"userCharacter\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"event\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"session\",\r\n          \"baseModel\": \"data.data\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"chatConfig\",\r\n          \"baseModel\": \"olio.llm.chatConfig\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"promptConfig\",\r\n          \"baseModel\": \"olio.llm.promptConfig\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.vectorChatHistoryList\",\r\n      \"ephemeral\": true,\r\n      \"factory\": \"org.cote.accountmanager.olio.llm.VectorChatHistoryListFactory\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"vectors\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.vectorChatHistory\",\r\n          \"type\": \"list\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.chatOptions\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"top_k\",\r\n          \"type\": \"int\",\r\n          \"default\": 50,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1\r\n        },\r\n        {\r\n          \"name\": \"top_p\",\r\n          \"type\": \"double\",\r\n          \"default\": 1,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1\r\n        },\r\n        {\r\n          \"name\": \"min_p\",\r\n          \"type\": \"double\",\r\n          \"default\": 0.1,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1\r\n        },\r\n        {\r\n          \"name\": \"typical_p\",\r\n          \"type\": \"double\",\r\n          \"default\": 0.85,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 1\r\n        },\r\n        {\r\n          \"name\": \"repeat_last_n\",\r\n          \"type\": \"int\",\r\n          \"default\": 64,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 100\r\n        },\r\n        {\r\n          \"name\": \"temperature\",\r\n          \"type\": \"double\",\r\n          \"default\": 1,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 2\r\n        },\r\n        {\r\n          \"name\": \"repeat_penalty\",\r\n          \"type\": \"double\",\r\n          \"default\": 1.2,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 2\r\n        },\r\n        {\r\n          \"name\": \"num_ctx\",\r\n          \"type\": \"int\",\r\n          \"default\": 8192,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 120000\r\n        },\r\n        {\r\n          \"name\": \"num_gpu\",\r\n          \"type\": \"int\",\r\n          \"default\": 1\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.chatRequest\",\r\n      \"inherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"group\": \"ChatRequests\",\r\n      \"icon\": \"chat\",\r\n      \"label\": \"Requests\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\",\r\n        \"chatConfig\",\r\n        \"promptConfig\",\r\n        \"session\",\r\n        \"sessionType\",\r\n        \"setting\"\r\n      ],\r\n      \"description\": \"Used for proxying chat requests\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"uid\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64,\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"chatConfig\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.chatConfig\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"promptConfig\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.promptConfig\",\r\n          \"foreign\": true\r\n        },\r\n        {\r\n          \"name\": \"sessionType\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"session\",\r\n          \"baseModel\": \"$flex\",\r\n          \"type\": \"model\",\r\n          \"foreign\": true,\r\n          \"foreignType\": \"sessionType\"\r\n        },\r\n        {\r\n          \"name\": \"data\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\",\r\n          \"ephemeral\": true\r\n        },\r\n        {\r\n          \"name\": \"setting\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.chatResponseModel\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"description\": \"Used for proxying chat responses\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"messages\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.message\"\r\n        },\r\n        {\r\n          \"name\": \"actor\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"uid\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"model\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.message\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"role\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 32\r\n        },\r\n        {\r\n          \"name\": \"content\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"pruned\",\r\n          \"type\": \"boolean\",\r\n          \"ephemeral\": true\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.ollama.ollamaMessage\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.message\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"images\",\r\n          \"type\": \"string\",\r\n          \"description\": \"Not currently used or correct\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.request\",\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"model\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"options\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.chatOptions\"\r\n        },\r\n        {\r\n          \"name\": \"stream\",\r\n          \"type\": \"boolean\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.ollama.ollamaRequest\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.request\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"prompt\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"system\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"context\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"messages\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.ollama.ollamaMessage\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.response\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"abstract\": true,\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"model\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        },\r\n        {\r\n          \"name\": \"response\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.ollama.ollamaResponse\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.response\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"created_at\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"context\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"done\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"total_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"load_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"done_reason\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_eval_count\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_eval_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"eval_count\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"eval_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.ollama.ollamaMessage\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiMessage\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.message\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"annotations\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"context\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiCitation\"\r\n        },\r\n        {\r\n          \"name\": \"refusal\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiRequest\",\r\n      \"likeInherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"inherits\": [\r\n        \"common.groupExt\",\r\n        \"common.baseLight\",\r\n        \"olio.llm.request\"\r\n      ],\r\n      \"description\": \"An OpenAI request model that defines the parameters for making requests to OpenAI's language models. This includes settings like temperature, max tokens, and the messages to be processed by the model.\",\r\n      \"group\": \"ChatRequests\",\r\n      \"icon\": \"chat\",\r\n      \"label\": \"Requests\",\r\n      \"vector\": \"org.cote.accountmanager.olio.VectorProvider\",\r\n      \"query\": [\r\n        \"id\",\r\n        \"groupId\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"max_completion_tokens\",\r\n          \"type\": \"int\",\r\n          \"default\": 2048,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 120000,\r\n          \"description\": \"For o1 and later models\"\r\n        },\r\n        {\r\n          \"name\": \"max_tokens\",\r\n          \"type\": \"int\",\r\n          \"default\": 2048,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 120000\r\n        },\r\n        {\r\n          \"name\": \"num_ctx\",\r\n          \"type\": \"int\",\r\n          \"default\": 2048,\r\n          \"minValue\": 0,\r\n          \"maxValue\": 120000,\r\n          \"description\": \"Cross compat for Ollama OpenAI\"\r\n        },\r\n        {\r\n          \"name\": \"temperature\",\r\n          \"type\": \"double\",\r\n          \"default\": 0.75\r\n        },\r\n        {\r\n          \"name\": \"top_p\",\r\n          \"type\": \"double\",\r\n          \"default\": 0.5\r\n        },\r\n        {\r\n          \"name\": \"frequency_penalty\",\r\n          \"type\": \"double\",\r\n          \"default\": 1.3\r\n        },\r\n        {\r\n          \"name\": \"presence_penalty\",\r\n          \"type\": \"double\",\r\n          \"default\": 1.3\r\n        },\r\n        {\r\n          \"name\": \"messages\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiMessage\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiResponse\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.response\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"id\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"system_fingerprint\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"created\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"object\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"usage\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiUsage\"\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiMessage\"\r\n        },\r\n        {\r\n          \"name\": \"choices\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiChoice\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_filter_results\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResults\"\r\n        },\r\n        {\r\n          \"name\": \"created_at\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"done\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"total_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"load_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"done_reason\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_eval_count\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_eval_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"eval_count\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"eval_duration\",\r\n          \"type\": \"long\"\r\n        },\r\n        {\r\n          \"name\": \"data\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiData\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiChoice\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"finish_reason\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"logprobs\",\r\n          \"type\": \"double\",\r\n          \"default\": 0\r\n        },\r\n        {\r\n          \"name\": \"index\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"message\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiMessage\"\r\n        },\r\n        {\r\n          \"name\": \"content_filter_results\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResults\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiContext\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"citations\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiCitation\"\r\n        },\r\n        {\r\n          \"name\": \"intent\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiCitation\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"content\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"title\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"url\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"filepath\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"chunk_id\",\r\n          \"type\": \"int\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiUsage\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"completion_tokens\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_tokens\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"total_tokens\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"completion_tokens_details\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"prompt_tokens_details\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiFilterResult\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"filtered\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"detected\",\r\n          \"type\": \"boolean\"\r\n        },\r\n        {\r\n          \"name\": \"severity\",\r\n          \"type\": \"string\",\r\n          \"maxLength\": 64\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiFilterResults\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.response\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"hate\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"protected_material_code\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"protected_material_text\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"self_harm\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"sexual\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"violence\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        },\r\n        {\r\n          \"name\": \"jailbreak\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.llm.openai.openaiFilterResult\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiData\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"inherits\": [\r\n        \"olio.llm.response\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"object\",\r\n          \"type\": \"string\"\r\n        },\r\n        {\r\n          \"name\": \"index\",\r\n          \"type\": \"int\"\r\n        },\r\n        {\r\n          \"name\": \"embedding\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"float\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"name\": \"olio.llm.openai.openaiInput\",\r\n      \"ioConstraints\": [\r\n        \"unknown\"\r\n      ],\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"input\",\r\n          \"type\": \"string\"\r\n        }\r\n      ]\r\n    },\r\n {\r\n      \"name\": \"olio.playerState\",\r\n      \"inherits\": [\r\n        \"data.directory\"\r\n      ],\r\n      \"group\": \"Player States\",\r\n      \"icon\": \"category\",\r\n      \"label\": \"Player State\",\r\n      \"dedicatedParticipation\": true,\r\n      \"description\": \"This model represents the state of a player in a realm, including their character, current event, location, and actions.\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"realm\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.realm\",\r\n          \"foreign\": true,\r\n          \"followReference\": false\r\n        },\r\n        {\r\n          \"name\": \"character\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"followReference\": true\r\n        },\r\n        {\r\n          \"name\": \"party\",\r\n          \"type\": \"list\",\r\n          \"baseType\": \"model\",\r\n          \"baseModel\": \"olio.charPerson\",\r\n          \"foreign\": true,\r\n          \"participantModel\": \"state.party\"\r\n        },\r\n        {\r\n          \"name\": \"user\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"system.user\",\r\n          \"foreign\": true,\r\n          \"followReference\": true\r\n        },\r\n        {\r\n          \"name\": \"currentEvent\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.event\",\r\n          \"foreign\": true,\r\n          \"followReference\": true\r\n        },\r\n        {\r\n          \"name\": \"currentLocation\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"data.geoLocation\",\r\n          \"foreign\": true,\r\n          \"followReference\": true\r\n        },\r\n        {\r\n          \"name\": \"currentAction\",\r\n          \"type\": \"model\",\r\n          \"baseModel\": \"olio.actionResult\",\r\n          \"foreign\": true\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"validationRules\": [\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"emailRule\",\r\n      \"expression\": \"^[a-zA-Z0-9_!#$%&*+/=?`{|}~^.-]+@[a-zA-Z0-9.-]+$\",\r\n      \"type\": \"boolean\"\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"minLen5\",\r\n      \"type\": \"boolean\",\r\n      \"expression\": \"[A-Za-z0-9]{5}\",\r\n      \"rules\": [\r\n        \"${notEmpty}\"\r\n      ]\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"notEmpty\",\r\n      \"type\": \"boolean\",\r\n      \"expression\": \"\\\\S\",\r\n      \"rules\": [\r\n        \"${trimEnds}\"\r\n      ]\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"notInParent\",\r\n      \"type\": \"function\",\r\n      \"function\": \"!{notInParent}\"\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"trimBegin\",\r\n      \"expression\": \"^\\\\s+\",\r\n      \"type\": \"replacement\",\r\n      \"replacementValue\": \"\",\r\n      \"replacementValueType\": \"string\"\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"trimEnd\",\r\n      \"expression\": \"\\\\s+$\",\r\n      \"type\": \"replacement\",\r\n      \"replacementValue\": \"\",\r\n      \"replacementValueType\": \"string\"\r\n    },\r\n    {\r\n      \"schema\": \"policy.validationRule\",\r\n      \"name\": \"trimEnds\",\r\n      \"type\": \"none\",\r\n      \"rules\": [\r\n        \"${trimBegin}\",\r\n        \"${trimEnd}\"\r\n      ]\r\n    }\r\n  ]\r\n};\r\n\r\n  if (typeof module != \"undefined\") {\r\n    module.am7model = am7model;\r\n  } else {\r\n    window.am7model = am7model;\r\n  }\r\n\r\n}());\n\n;/* === model/model.js === */\n(function () {\r\n\r\n\tam7model.enums.modelNames = [];\r\n\tam7model.models.forEach((o) => {\r\n\t\tif (!o.abstract) {\r\n\t\t\tam7model.enums.modelNames.push(o.name);\r\n\t\t}\r\n\t});\r\n\r\n\tam7model.system = {\r\n\t\tlibrary: {\r\n\t\t\t\"data.color\": \"/Library/Colors\"\r\n\t\t}\r\n\t};\r\n\r\n\tam7model.getPrototype = function (name) {\r\n\t\tlet cat = am7model.categories;\r\n\t\tlet proto;\r\n\t\tlet aP = Object.keys(cat).filter((k) => {\r\n\r\n\t\t\tlet vP = Object.keys(cat[k]).filter((l) => {\r\n\t\t\t\tif (l.match(/^prototype$/)) {\r\n\t\t\t\t\tlet catO = cat[k][l];\r\n\t\t\t\t\tif (catO[name]) {\r\n\t\t\t\t\t\tproto = catO[name];\r\n\t\t\t\t\t\tproto.key = name;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlet xP = Object.keys(catO).filter((m) => {\r\n\t\t\t\t\t\t\tif (catO[m].pathName && catO[m].pathName.toLowerCase() == name) {\r\n\t\t\t\t\t\t\t\tproto = catO[m];\r\n\t\t\t\t\t\t\t\tproto.key = m;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (xP.length) return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (vP.length) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (proto) return proto;\r\n\t\treturn null;\r\n\t}\r\n\r\n\tam7model.getModel = function (type) {\r\n\t\tif (type == null || !type) {\r\n\t\t\tconsole.error(\"Invalid type\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet model = am7model.models.filter(o => o.name.toLowerCase() == type.toLowerCase());\r\n\t\tif (!model.length) {\r\n\t\t\tmodel = am7model.getPrototype(type);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tmodel = model[0];\r\n\t\t}\r\n\t\tif (model == null) {\r\n\t\t\t// console.warn(\"No model for '\" + type + \"'\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn model;\r\n\t};\r\n\r\n\tam7model.hasField = function (model, n) {\r\n\t\tlet f;\r\n\t\tif(n.match(/\\./)){\r\n\t\t\tlet an = n.split(\".\");\r\n\t\t\tlet om = model;\r\n\t\t\tfor (let i = 0; i < an.length; i++) {\r\n\t\t\t\tf = am7model.getModelField(om, an[i]);\r\n\t\t\t\tif(!f){\r\n\t\t\t\t\tconsole.error(\"Failed to find field \" + an[i] + \" in \" + model + \", \" + n);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif(f.type == \"model\" && f.baseModel){\r\n\t\t\t\t\tom = am7model.getModel(f.baseModel);\r\n\t\t\t\t\tif(!om){\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\tf = am7model.getModelField(model, n);\r\n\t\t}\r\n\t\t\r\n\t\treturn (f ? true : false);\r\n\t};\r\n\r\n\tam7model.getModelField = function (model, n, ftype) {\r\n\t\tif (typeof model == \"string\") {\r\n\t\t\tif (model == \"$flex\") {\r\n\t\t\t\tif (!ftype) {\r\n\t\t\t\t\tftype = 'common.nameId';\r\n\t\t\t\t}\r\n\t\t\t\tmodel = ftype;\r\n\t\t\t}\r\n\t\t\tmodel = am7model.getModel(model);\r\n\t\t}\r\n\t\tif (!model) {\r\n\t\t\tconsole.error(\"Failed to find model definition for \" + model + \" from \" + model + \", \" + ftype);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet fld = model.fields.filter(o => o.name.toLowerCase() == n.toLowerCase());\r\n\t\tlet field = fld[0];\r\n\t\tif (!field && model.inherits) {\r\n\t\t\tfor (let i in model.inherits) {\r\n\t\t\t\tfield = am7model.getModelField(model.inherits[i], n);\r\n\t\t\t\tif (field) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn field;\r\n\t};\r\n\r\n\tam7model.getModelFields = function (model) {\r\n\t\tlet am = [];\r\n\t\tif (typeof model == \"string\") {\r\n\t\t\tmodel = am7model.getModel(model);\r\n\t\t}\r\n\r\n\t\tif (!model) {\r\n\t\t\tconsole.error(\"Failed to find model definition for \" + model);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tam.push(...model.fields);\r\n\t\tfor (let i in model.inherits) {\r\n\t\t\tam.push(...am7model.getModelFields(model.inherits[i]));\r\n\t\t}\r\n\t\treturn [...new Set(am)];\r\n\t};\r\n\r\n\tam7model.newPrimitive = function (sLType, ignoreEmptyNull, sPath, innerCall) {\r\n\t\tlet o = {};\r\n\t\tlet f = am7model.getModel(sLType);\r\n\t\tif (!f) {\r\n\t\t\tconsole.error(\"No model for: \" + sLType);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (f.followReference == false) {\r\n\t\t\to[am7model.jsonModelKey] = sLType;\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tif (f.inherits) {\r\n\t\t\tf.inherits.forEach(i => {\r\n\t\t\t\tObject.assign(o, am7model.newPrimitive(i, ignoreEmptyNull, sPath, true));\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (f.fields) {\r\n\t\t\tf.fields.forEach(i => {\r\n\t\t\t\tif (!i.identity && !i.ephemeral && !i.virtual) {\r\n\t\t\t\t\tlet nfv = am7model.defaultValue(i);\r\n\t\t\t\t\tlet emptyArray = (i.type == 'list' && nfv.length == 0);\r\n\t\t\t\t\tlet nullOrUndef = ((i.type == 'string' || i.type == 'object' || i.type == 'enum') && (!nfv || nfv == null));\r\n\t\t\t\t\tif (!ignoreEmptyNull || !(\r\n\t\t\t\t\t\temptyArray\r\n\t\t\t\t\t\t||\r\n\t\t\t\t\t\tnullOrUndef\r\n\t\t\t\t\t)) {\r\n\t\t\t\t\t\to[i.name] = nfv;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tconsole.warn(\"Skip: \" + i.name + \" because \" + emptyArray);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (!innerCall) {\r\n\t\t\to[am7model.jsonModelKey] = sLType;\r\n\t\t\tlet ft = am7model.getModel(sLType);\r\n\t\t\t// ft.inherits && ft.inherits.find(s => s == \"directory\") != null\r\n\t\t\tif (ft && am7model.isGroup(ft)) {\r\n\t\t\t\tlet sDP = sPath || am7view.path(sLType);\r\n\t\t\t\tif (sLType == \"auth.group\") o.path = sDP;\r\n\t\t\t\telse o.groupPath = sDP;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn o;\r\n\t};\r\n\tam7model.defaultValue = function (field) {\r\n\t\tlet fieldDefVal = field.default;\r\n\t\tlet defVal;\r\n\t\tswitch (field.type) {\r\n\t\t\tcase \"int\":\r\n\t\t\tcase \"double\":\r\n\t\t\tcase \"long\":\r\n\t\t\tcase \"number\":\r\n\t\t\t\tdefVal = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"blob\":\r\n\t\t\tcase \"binary\":\r\n\t\t\t\tdefVal = \"\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"string\":\r\n\t\t\t\tdefVal = null;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"enum\":\r\n\t\t\t\tdefVal = \"UNKNOWN\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tdefVal = false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"list\":\r\n\t\t\tcase \"array\":\r\n\t\t\t\tdefVal = [];\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"model\":\r\n\t\t\tcase \"object\":\r\n\t\t\t\tdefVal = null;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"zonetime\":\r\n\t\t\t\tdefVal = new Date().toISOString().slice(0, 16);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"timestamp\":\r\n\t\t\tcase \"datetime\":\r\n\t\t\t\tdefVal = (new Date()).getTime();\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"color\":\r\n\t\t\tcase \"flex\":\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"Unhandled field type\", field.type, field);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn (fieldDefVal || defVal);\r\n\t};\r\n\r\n\tam7model.inherits = function (o, i) {\r\n\t\tlet b = false;\r\n\t\tif (typeof o == \"string\") o = am7model.getModel(o);\r\n\t\tif (o.inherits) {\r\n\t\t\tif (o.inherits.includes(i) || (o.likeInherits && o.likeInherits.includes(i))) {\r\n\t\t\t\tb = true;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let h in o.inherits) {\r\n\t\t\t\t\tlet p = am7model.getModel(o.inherits[h]);\r\n\t\t\t\t\tif (p) {\r\n\t\t\t\t\t\tb = am7model.inherits(p, i);\r\n\t\t\t\t\t\tif (b) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn b;\r\n\t};\r\n\r\n\tam7model.inheritsFrom = function (o) {\r\n\t\tlet a = [];\r\n\t\tif (typeof o == \"string\") o = am7model.getModel(o);\r\n\t\ta.push(o);\r\n\t\tif (o.inherits) {\r\n\t\t\tfor (let h in o.inherits) {\r\n\t\t\t\tlet p = am7model.getModel(o.inherits[h]);\r\n\t\t\t\tif (p && !a.includes(p)) {\r\n\t\t\t\t\ta = [].concat(a, am7model.inheritsFrom(p));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn a;\r\n\t};\r\n\r\n\tam7model.isParent = function (o) {\r\n\t\treturn am7model.inherits(o, \"common.parent\");\r\n\t};\r\n\r\n\tam7model.isGroup = function (o) {\r\n\t\tif (typeof o == \"string\") o = am7model.getModel(o);\r\n\t\treturn (am7model.inherits(o, \"data.directory\") || o.name == 'auth.group');\r\n\t};\r\n\r\n\tam7model.observers = {\r\n\t\tmodels: {}\r\n\t};\r\n\r\n\tam7model.observe = function (o, s) {\r\n\t\tlet m = am7model.observers.models;\r\n\t\tif (!m[s]) {\r\n\t\t\tm[s] = [];\r\n\t\t}\r\n\t\tm[s].push(o);\r\n\t};\r\n\r\n\tam7model.updateListModel = function (v, f) {\r\n\t\t/// In AM7, the 'model' property may be condensed to occur in only the first result  if the remaining results are the same\r\n\t\t///\r\n\t\tif (v && v.length) {\r\n\t\t\tlet mk = v[0][am7model.jsonModelKey];\r\n\t\t\tlet m = mk || f?.baseModel;\r\n\r\n\t\t\tfor (let i = (mk ? 1 : 0); i < v.length; i++) {\r\n\t\t\t\tif (!v[i][am7model.jsonModelKey]) v[i][am7model.jsonModelKey] = m;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tam7model.applyModelNames = function (o) {\r\n\t\tlet af = am7model.getModelFields(o[am7model.jsonModelKey]);\r\n\t\taf.forEach(f => {\r\n\t\t\tif (f.type == \"model\" && o[f.name] && !o[f.name][am7model.jsonModelKey]) {\r\n\t\t\t\to[f.name][am7model.jsonModelKey] = f.baseModel;\r\n\t\t\t\tam7model.applyModelNames(o[f.name]);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/// A more generic version of the mergeEntity function in Object\r\n\tam7model.prepareEntity = function (e, baseModel, recurse) {\r\n\t\tlet ue = am7model.newPrimitive(e && e[am7model.jsonModelKey] ? e[am7model.jsonModelKey] : baseModel);\r\n\t\tif (!e[am7model.jsonModelKey]) e[am7model.jsonModelKey] = ue[am7model.jsonModelKey] || baseModel;\r\n\t\tif (!e[am7model.jsonModelKey]) {\r\n\t\t\tconsole.warn(\"Cannot find model\", e);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet x = Object.assign(ue, e);\r\n\t\tlet af = am7model.getModelFields(e[am7model.jsonModelKey]);\r\n\t\t\r\n\t\tif (recurse) {\r\n\t\t\taf.forEach(f => {\r\n\t\t\t\tif ((f.type == 'list' || f.type == 'model') && f.foreign && f.baseModel) {\r\n\t\t\t\t\tif (f.type == 'model' && !ue[f.name] && e[f.name]) {\r\n\t\t\t\t\t\tue[f.name] = am7model.prepareEntity(e[f.name], f.baseModel, recurse);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (f.type == 'list') {\r\n\t\t\t\t\t\tue[f.name] = ue[f.name].map(e2 => am7model.prepareEntity(e2, f.baseModel, recurse));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/*\r\n\t\t\t\t\tif (ue[f.name] && (f.type != 'list' || ue[f.name].length > 0)) {\r\n\t\t\t\t\t\tlet fm = f.baseModel;\r\n\t\t\t\t\t\tue[f.name] = am7model.prepareEntity(e[f.name] || ue[f.name], f.baseModel, recurse);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t*/\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tam7model.applyModelNames(x);\r\n\t\treturn x;\r\n\t};\r\n\r\n\tam7model.validationRule = function (n) {\r\n\t\tlet r = am7model.validationRules.filter(r => r.name == n);\r\n\t\treturn r.length ? r[0] : undefined;\r\n\t};\r\n\r\n\tam7model.validateInstance = function (o) {\r\n\t\tlet r = o.model.fields.map((f) => am7model.validateField(o, f, f.rules));\r\n\t\treturn r;\r\n\t};\r\n\r\n\tlet vrcache = {};\r\n\r\n\tam7model.getValidationRuleInstance = function (ru) {\r\n\t\tlet oru = ru;\r\n\t\tlet vr = oru;\r\n\t\tlet isStr = typeof oru == \"string\"\r\n\t\tif (isStr) {\r\n\t\t\tif (vrcache[oru]) {\r\n\t\t\t\treturn vrcache[oru]\r\n\t\t\t}\r\n\t\t\t/// System rule references start with $, such as $rule\r\n\t\t\t/// Tokenized system rules are in the format of ${rule}, with the intent of being dynamically substituded when the rule is loaded on the backend\r\n\t\t\t/// Otherwise, rules would follow the foreign list model\r\n\t\t\t/// Since this is  a lookup, anything starting with $ is a system rule and $,{,} will be stripped\r\n\t\t\tif (oru.match(/^\\$/)) {\r\n\t\t\t\toru = oru.replace(/[\\$\\{\\}]*/g, \"\");\r\n\t\t\t}\r\n\t\t\tvr = am7model.validationRule(oru);\r\n\t\t}\r\n\t\tlet nvr = am7model.prepareEntity(vr, \"policy.validationRule\")\r\n\t\tlet vri = am7model.prepareInstance(nvr, am7model.forms.validationRule);\r\n\r\n\t\tif (isStr) {\r\n\t\t\tvrcache[ru] = vri;\r\n\t\t}\r\n\t\treturn vri;\r\n\t};\r\n\r\n\tam7model.validateField = function (o, f, rules, applyReplacement) {\r\n\r\n\t\tvar r = 0,\r\n\t\t\tir = 1,\r\n\t\t\ttir,\r\n\t\t\tre = 1\r\n\t\t\t;\r\n\r\n\t\tif (f.readOnly || f.virtual || f.ephemeral || f.private) return 1;\r\n\r\n\t\t/// don't read from API for validation because it will include decorators which may change the value\r\n\t\t///\r\n\t\tlet v = o.entity[f.name];\r\n\t\tlet err;\r\n\t\tswitch (f.type) {\r\n\t\t\tcase \"enum\":\r\n\t\t\tcase \"string\":\r\n\t\t\t\tif (f.required && (v == undefined || v.length == 0)) {\r\n\t\t\t\t\terr = \"Field is required\";\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (f.maxLength > 0 && v != undefined && v.length > f.maxLength) {\r\n\t\t\t\t\terr = \"Exceeds maximum length \" + f.maxLength;\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (f.minLength && (v == undefined || v.length < f.minLength)) {\r\n\t\t\t\t\terr = \"Does not meet the minimum length \" + f.minLength;\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (f.limit?.length > 0 && !f.limit.includes(v) && f.required) {\r\n\t\t\t\t\terr = \"Not defined in the limit\", f.limit;\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"timestamp\":\r\n\t\t\tcase \"long\":\r\n\t\t\tcase \"int\":\r\n\t\t\tcase \"double\":\r\n\t\t\t\tif (f.name == \"parentId\" && am7model.isGroup(o.model.name)) {\r\n\t\t\t\t\t/// Allow parentId to be 0 if group is also present\r\n\t\t\t\t\t///\r\n\t\t\t\t}\r\n\t\t\t\telse if (f.required && (v == undefined || v == 0)) {\r\n\t\t\t\t\terr = \"Field is required\";\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (f.validateRange && (v < f.minValue || v > f.maxValue)) {\r\n\t\t\t\t\terr = v + \" outside value range \" + f.minValue + \" - \" + f.maxValue;\r\n\t\t\t\t\tre = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"list\":\r\n\t\t\t\t/// ignore\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"Unhandled field type: \" + f.type, f);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif (re == 0) {\r\n\t\t\to.validationErrors[f.name] = err;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tif (!rules || !rules.length) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tfor (let ri in rules) {\r\n\t\t\tlet ru = rules[ri];\r\n\t\t\tlet vr = am7model.getValidationRuleInstance(ru);\r\n\t\t\tif (!vr) {\r\n\t\t\t\to.validationErrors[f.name] = \"Invalid rule: \" + ru;\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (vr.api.rules()?.length) {\r\n\t\t\t\ttir = am7model.validateField(o, f, vr.api.rules(), applyReplacement);\r\n\t\t\t\tif (ir && !tir) {\r\n\t\t\t\t\tir = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\t/* check typeof == \"number\" because \"\" == 0*/\r\n\t\t\tif (\r\n\t\t\t\t(f.type == \"int\" || f.type == \"double\" || f.type == \"float\") && v == f.default\r\n\r\n\t\t\t) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (v == undefined) {\r\n\t\t\t\to.validationErrors[f.name] = \"Field is empty or undefined\";\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (vr.api.expression()) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet re = new RegExp(vr.api.expression());\r\n\t\t\t\t\tswitch (vr.api.type()) {\r\n\t\t\t\t\t\tcase \"replacement\":\r\n\t\t\t\t\t\t\tr = 1;\r\n\t\t\t\t\t\t\tif (applyReplacement && typeof vr.api.replacementValue() == \"string\") {\r\n\t\t\t\t\t\t\t\tv = v.replace(re, vr.api.replacementValue());\r\n\t\t\t\t\t\t\t\to.api[f.name](v);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t(v.allowNull && v.length == 0)\r\n\t\t\t\t\t\t\t\t||\r\n\t\t\t\t\t\t\t\t(v.match(re) != null) == vr.api.comparison()\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tr = 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\to.validationErrors[f.name] = \"Invalid value for \" + vr.api.name();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"none\":\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tconsole.warn(\"Unhandled expression type: \" + v.type);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.error(\"Error in validateField:: \" + (e.description ? e.description : e.message));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (vr.api.type() == \"none\") r = 1;\r\n\t\t\telse if (vr.api.type() == \"function\") {\r\n\t\t\t\tconsole.warn(\"Unhandled function type: \" + vr.api.name());\r\n\t\t\t\tr = 1;\r\n\t\t\t}\r\n\t\t\t/*\r\n\t\t\t\tif the return value is true, but the include return value is false\r\n\t\t\t\tset the return value to false\r\n\t\t\t*/\r\n\t\t\tif (r && !ir) r = 0;\r\n\t\t\tif (!r) {\r\n\t\t\t\tconsole.error(\"Validation failed for \" + f.name + \" with value \" + v);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\treturn r;\r\n\t};\r\n\r\n\tam7model.hasIdentity = function (entity) {\r\n\t\treturn am7model.getModelFields(entity[am7model.jsonModelKey]).filter(f => {\r\n\t\t\treturn (f.identity && entity[f.name] && entity[f.name] != am7model.defaultValue(f));\r\n\t\t}).length > 0;\r\n\t};\r\n\r\n\r\n\r\n\tlet dateTimeDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (typeof v == \"number\") {\r\n\t\t\t\tlet d = new Date(v);\r\n\t\t\t\t//v = new Date(d.getTime() - (d.getTimezoneOffset() * 60000)).toISOString().slice(0,16);\r\n\t\t\t\tv = new Date(d.getTime()).toISOString().slice(0, 16);\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\tif (typeof v == \"string\") {\r\n\t\t\t\tlet d = new Date(v);\r\n\t\t\t\tv = d.getTime();\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet dateTimeZDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (typeof v == \"string\") {\r\n\t\t\t\tv = new Date(v).toISOString().slice(0, 16);\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet numberDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (v == undefined) {\r\n\t\t\t\tv = f.default || 0;\r\n\t\t\t}\r\n\t\t\tif (f.type == \"double\" && v % 1 == 0) {\r\n\t\t\t\tv = v + \".0\";\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\tif (typeof v == \"string\") {\r\n\t\t\t\tif (f.type == \"double\") {\r\n\t\t\t\t\tv = parseFloat(v);\r\n\t\t\t\t}\r\n\t\t\t\telse if (f.type == \"int\") {\r\n\t\t\t\t\tv = parseInt(v);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet rangeDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (typeof v == \"number\" && f.type == \"double\" && f.maxValue >= 1) {\r\n\t\t\t\tv = parseInt(v * 100);\r\n\t\t\t}\r\n\t\t\telse if (v == undefined) {\r\n\t\t\t\tv = 0;\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\t\r\n\t\t\tif (f.type == \"double\" && f.maxValue >= 1) {\r\n\t\t\t\tif (v != 0) {\r\n\t\t\t\t\tv = parseFloat(v / 100);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (f.type == \"int\") {\r\n\t\t\t\tv = parseInt(v);\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet textListDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (v && (v instanceof Array)) {\r\n\t\t\t\tv = v.join(\"\\r\\n\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tv = \"\";\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\tif (v && typeof v == \"string\") {\r\n\t\t\t\tv = v.split(/\\r?\\n|\\r|\\n/g);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tv = [];\r\n\t\t\t}\r\n\t\t\t//v = ntc.name(v)[0];\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet colorDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\t//v = ntc.hex(v)[0];\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\tif (i.model.name == \"data.color\" && v && v.length == 7) {\r\n\t\t\t\ti.api[\"red\"](parseInt(v.substring(1, 3), 16));\r\n\t\t\t\ti.api[\"green\"](parseInt(v.substring(3, 5), 16));\r\n\t\t\t\ti.api[\"blue\"](parseInt(v.substring(5, 7), 16));\r\n\r\n\t\t\t}\r\n\t\t\t//v = ntc.name(v)[0];\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tlet blobDecorator = {\r\n\t\tdecorateOut: function (i, f, v) {\r\n\t\t\tif (typeof v == \"string\") {\r\n\t\t\t\tv = Base64.decode(v);\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t},\r\n\t\tdecorateIn: function (i, f, v) {\r\n\t\t\tif (typeof v == \"string\") {\r\n\t\t\t\tv = Base64.encode(v);\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\t};\r\n\r\n\tam7model.base64ToUint8 = function (data) {\r\n\t\tvar dec = Base64.decode(data);\r\n\t\tvar array = new Uint8Array(new ArrayBuffer(dec.length));\r\n\t\tfor (var i = 0; i < dec.length; i++) {\r\n\t\t\tarray[i] = dec.charCodeAt(i);\r\n\t\t}\r\n\t\treturn array;\r\n\t};\r\n\r\n\tam7model.queryFields = function (type) {\r\n\t\tlet r1 = am7model.inheritsFrom(type).filter(m => m.query).map(m => m.query).flat(1);\r\n\t\tif (am7model.inherits(type, \"system.organizationExt\")) {\r\n\t\t\tr1.push(\"organizationId\");\r\n\t\t\tr1.push(\"organizationPath\");\r\n\t\t}\r\n\t\tif (am7model.inherits(type, \"common.dateTime\")) {\r\n\t\t\tr1.push(\"createdDate\");\r\n\t\t\tr1.push(\"modifiedDate\");\r\n\t\t}\r\n\t\tif (am7model.isParent(type)) {\r\n\t\t\tif (am7model.hasField(type, \"path\")) r1.push(\"path\");\r\n\t\t\tr1.push(\"parentId\");\r\n\t\t}\r\n\t\tif (am7model.isGroup(type) && type != 'auth.group') {\r\n\t\t\tr1.push(\"groupPath\");\r\n\t\t\tr1.push(\"groupId\");\r\n\t\t}\r\n\t\treturn r1;\r\n\t}\r\n\r\n\tam7model.newInstance = function (model, form) {\r\n\t\treturn am7model.prepareInstance(am7model.newPrimitive(model), form);\r\n\t};\r\n\r\n\tam7model.prepareInstance = function (entity, form) {\r\n\t\tform = form ?? am7model.forms[entity[am7model.jsonModelKey].substring(entity[am7model.jsonModelKey].lastIndexOf(\".\") + 1)];\r\n\t\tlet inst = {\r\n\t\t\tentity,\r\n\t\t\tform,\r\n\t\t\tmodel: am7model.getModel(entity[am7model.jsonModelKey]),\r\n\t\t\tobservers: [],\r\n\t\t\tactions: {},\r\n\t\t\tdecorators: {},\r\n\t\t\tdesigners: {},\r\n\t\t\tviewProperties: {},\r\n\t\t\tapi: {},\r\n\t\t\tvalidateField: {},\r\n\t\t\tchanges: [],\r\n\t\t\tvalidations: {},\r\n\t\t\tvalidationErrors: {},\r\n\t\t\tresetChanges: () => {\r\n\t\t\t\tinst.changes = [];\r\n\t\t\t},\r\n\t\t\tfields: []\r\n\t\t};\r\n\t\tinst.fields = am7model.getModelFields(entity[am7model.jsonModelKey]);\r\n\r\n\t\tinst.change = function (n) {\r\n\t\t\tif (!inst.changes.includes(n)) inst.changes.push(n);\r\n\t\t};\r\n\r\n\t\tinst.unchange = function (n) {\r\n\t\t\tinst.changes = inst.changes.filter((value, index, arr) => value != n);\r\n\t\t};\r\n\r\n\t\tfunction report(a, e) {\r\n\t\t\tinst.observers.forEach((o) => {\r\n\t\t\t\tif (o.report) {\r\n\t\t\t\t\to.report(a, e, inst);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction decorateInOut(bIn, v, f) {\r\n\t\t\tlet d = inst.decorators;\r\n\t\t\tif (d[f.name]) {\r\n\r\n\t\t\t\td[f.name].forEach((c) => {\r\n\t\t\t\t\tif (bIn && c.decorateIn) {\r\n\t\t\t\t\t\tv = c.decorateIn(inst, f, v);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!bIn && c.decorateOut) {\r\n\t\t\t\t\t\tv = c.decorateOut(inst, f, v);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\tinst.decorate = (e, o) => {\r\n\t\t\tlet d = inst.decorators;\r\n\t\t\tif (!d[e]) {\r\n\t\t\t\td[e] = [];\r\n\t\t\t}\r\n\t\t\td[e].push(o);\r\n\t\t};\r\n\r\n\t\tinst.viewProperties = (e, o) => {\r\n\t\t\tif (o) {\r\n\t\t\t\treturn inst.viewDesigner(e, o, \"viewProperties\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn inst.viewDesign(e, \"viewProperties\");\r\n\t\t\t}\r\n\t\t};\r\n\t\tinst.design = (e) => {\r\n\t\t\treturn inst.viewDesign(te, \"designers\");\r\n\t\t};\r\n\r\n\t\tinst.designer = (e, o) => {\r\n\t\t\treturn inst.viewDesigner(e, o, \"designers\");\r\n\t\t};\r\n\t\tinst.design = (e) => {\r\n\t\t\treturn inst.viewDesign(e, \"designers\");\r\n\t\t};\r\n\t\tinst.viewDesigner = (e, o, p) => {\r\n\t\t\tlet d = inst[p];\r\n\t\t\tif (!d[e]) {\r\n\t\t\t\td[e] = [];\r\n\t\t\t}\r\n\t\t\td[e].push(o);\r\n\t\t};\r\n\t\tinst.viewDesign = (e, p) => {\r\n\t\t\tlet v;\r\n\t\t\tlet d = inst[p];\r\n\t\t\tlet dx = [];\r\n\t\t\tlet dd = dx.concat(d[e], d[\"all\"]);\r\n\t\t\tdd.forEach(df => {\r\n\t\t\t\tif (df) {\r\n\t\t\t\t\tif (typeof df == \"function\") {\r\n\t\t\t\t\t\tv = df(inst, e, v);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse v = df;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn v;\r\n\t\t};\r\n\r\n\t\tinst.field = (n) => {\r\n\t\t\tlet f;\r\n\t\t\t//let a = inst[am7model.jsonModelKey].fields.filter(f => f.name === n);\r\n\t\t\tlet a = inst.fields.filter(f => f.name === n);\r\n\t\t\treturn (a.length ? a[0] : f);\r\n\t\t};\r\n\r\n\t\tinst.formField = (n, v) => {\r\n\t\t\tlet x = inst?.form?.fields[n];\r\n\t\t\tif (v) {\r\n\t\t\t\tlet z;\r\n\t\t\t\tif (x && x[v]) z = x[v];\r\n\t\t\t\telse if (inst.field(n)) z = inst.field(n)[v];\r\n\t\t\t\treturn z;\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t};\r\n\r\n\t\tinst.observe = (o) => {\r\n\t\t\tinst.observers.push(o);\r\n\t\t};\r\n\t\tinst.action = (n, o) => {\r\n\t\t\tif (!o && inst.actions[n]) {\r\n\t\t\t\tinst.actions[n](inst, n);\r\n\t\t\t}\r\n\t\t\telse if (o) {\r\n\t\t\t\tinst.actions[n] = o;\r\n\t\t\t}\r\n\t\t};\r\n\t\tinst.icon = () => {\r\n\t\t\treturn form.icon || inst.model.icon;\r\n\t\t};\r\n\r\n\t\tinst.modelValue = (n, p) => {\r\n\t\t\tif (form.fields[n] && form.fields[n][p]) {\r\n\t\t\t\treturn form.fields[n][p];\r\n\t\t\t}\r\n\t\t\tlet mf = inst.field(n);\r\n\t\t\tif (mf && mf[p]) {\r\n\t\t\t\treturn mf[p];\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t};\r\n\r\n\t\tinst.label = (n) => {\r\n\t\t\tif (n) {\r\n\t\t\t\tlet r = inst.modelValue(n, \"label\");\r\n\t\t\t\tif (!r) r = inst.modelValue(n, \"name\");\r\n\t\t\t\t// console.log(n + \" \" + r + \" \" + inst.modelValue(n, \"label\"));\r\n\t\t\t\treturn r || n;\r\n\t\t\t}\r\n\t\t\treturn form.label || inst.model.label;\r\n\t\t};\r\n\r\n\t\tinst.placeholder = (n) => {\r\n\t\t\treturn inst.modelValue(n, \"placeholder\");\r\n\t\t};\r\n\r\n\t\tam7model.getModelFields(inst.model).forEach((f) => {\r\n\t\t\tinst.api[f.name] = (...v) => {\r\n\t\t\t\tif (!f.readOnly && v.length) {\r\n\t\t\t\t\tlet val = decorateInOut(true, v[0], f);\r\n\t\t\t\t\tinst.entity[f.name] = val;\r\n\t\t\t\t\tinst.change(f.name);\r\n\t\t\t\t\treport('update', f.name, inst);\r\n\t\t\t\t}\r\n\t\t\t\treturn decorateInOut(false, entity[f.name], f);\r\n\t\t\t};\r\n\r\n\t\t\tinst.dapi = (pn, ...v) => {\r\n\t\t\t\tif (v.length) {\r\n\t\t\t\t\tlet p = pn.split(\".\");\r\n\t\t\t\t\tlet op = p[0];\r\n\t\t\t\t\tinst.change(op);\r\n\t\t\t\t\tlet o = inst.entity;\r\n\r\n\t\t\t\t\tfor (let i = 0; i < (p.length - 1); i++) {\r\n\t\t\t\t\t\to = o[op];\r\n\t\t\t\t\t\top = p[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t\to[p[p.length - 1]] = v[0];\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlet field = am7view.formField(form, f.name);\r\n\r\n\t\t\tif (field && field.format == \"color\") {\r\n\t\t\t\tinst.decorate(f.name, colorDecorator);\r\n\t\t\t}\r\n\t\t\telse if (field && field.format == \"textlist\") {\r\n\t\t\t\tinst.decorate(f.name, textListDecorator);\r\n\t\t\t}\r\n\t\t\t/// f.type == \"zonetime\" || \r\n\t\t\telse if (f.type == \"zonetime\") {\r\n\t\t\t\tinst.decorate(f.name, dateTimeZDecorator);\r\n\t\t\t}\r\n\t\t\telse if (f.type == \"timestamp\" || f.type == \"datetime\") {\r\n\t\t\t\tinst.decorate(f.name, dateTimeDecorator);\r\n\t\t\t}\r\n\t\t\telse if (f.type == \"blob\") {\r\n\t\t\t\tinst.decorate(f.name, blobDecorator);\r\n\t\t\t}\r\n\t\t\telse if ((f.type == 'double' || f.type == 'int') && typeof f.minValue == \"number\" && typeof f.maxValue == \"number\" && form && field && field.format == \"range\") {\r\n\t\t\t\tinst.decorate(f.name, rangeDecorator);\r\n\t\t\t}\r\n\t\t\telse if (f.type == 'double' || f.type == 'int') {\r\n\t\t\t\tinst.decorate(f.name, numberDecorator);\r\n\t\t\t}\r\n\r\n\t\t\tinst.validateField[f.name] = (applyReplacement) => {\r\n\t\t\t\tif (field?.skipValidation) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tlet r = am7model.validateField(inst, f, f.rules, applyReplacement);\r\n\t\t\t\tinst.validations[f.name] = (r == 1);\r\n\t\t\t\tif (r == 0 && !inst.validationErrors[f.name]) {\r\n\t\t\t\t\tinst.validationErrors[f.name] = \"Invalid value for \" + f.name;\r\n\t\t\t\t}\r\n\t\t\t\telse if (r == 1) {\r\n\t\t\t\t\tdelete inst.validationErrors[f.name];\r\n\t\t\t\t}\r\n\t\t\t\treturn (r == 1);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tinst.validate = (applyReplacement) => {\r\n\t\t\tlet fv = [];\r\n\t\t\tam7model.getModelFields(inst.model).forEach((f) => {\r\n\t\t\t\tfv.push(inst.validateField[f.name](applyReplacement));\r\n\t\t\t});\r\n\t\t\treturn !fv.includes(false);\r\n\t\t}\r\n\r\n\t\tinst.handleChange = (n, fh) => {\r\n\t\t\tlet f = inst.field(n);\r\n\t\t\tif (!f) {\r\n\t\t\t\tconsole.warn(\"Invalid field: '\" + n + \"'\");\r\n\t\t\t}\r\n\t\t\treturn function (e) {\r\n\t\t\t\tlet v = e.target.value;\r\n\t\t\t\tif (e.target.type && e.target.type == \"checkbox\") {\r\n\t\t\t\t\tv = e.target.checked;\r\n\t\t\t\t}\r\n\t\t\t\telse if (f.type == \"string\" && typeof v == \"string\" && v.length == 0) {\r\n\t\t\t\t\tv = null;\r\n\t\t\t\t}\r\n\t\t\t\tinst.api[n](v);\r\n\t\t\t\tif (fh) fh(e);\r\n\t\t\t\tinst.action(n);\r\n\t\t\t\tinst.validateField[n]();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tinst.patch = () => {\r\n\t\t\tlet pent = {};\r\n\t\t\tlet b1id = 0;\r\n\t\t\tif (inst.changes.length == 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tam7model.getModelFields(inst.model).filter(f => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\t(f.identity && inst.entity[f.name])\r\n\t\t\t\t\t\t||\r\n\t\t\t\t\t\tinst.changes.includes(f.name)\r\n\t\t\t\t\t\t||\r\n\t\t\t\t\t\tf.provider\r\n\t\t\t\t\t)\r\n\t\t\t\t\t&&\r\n\t\t\t\t\t/// Foreign entities can patch their own fields - except the initial foreign ref, which can only be set by updating this field\r\n\t\t\t\t\t/// !f.foreign\r\n\t\t\t\t\t/// &&\r\n\t\t\t\t\t!f.ephemeral\r\n\t\t\t\t\t&&\r\n\t\t\t\t\t!f.virtual\r\n\t\t\t\t);\r\n\t\t\t}).forEach(f => {\r\n\t\t\t\tif (!f.identity || !b1id) {\r\n\t\t\t\t\tif (f.identity) b1id++;\r\n\t\t\t\t\tpent[f.name] = entity[f.name];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tpent[am7model.jsonModelKey] = inst.model.name;\r\n\t\t\treturn pent;\r\n\t\t};\r\n\r\n\t\tinst.hasIdentity = () => {\r\n\t\t\treturn am7model.hasIdentity(entity);\r\n\t\t};\r\n\r\n\t\tlet om = am7model.observers.models[entity[am7model.jsonModelKey]];\r\n\t\tif (om) {\r\n\t\t\tom.forEach((o) => {\r\n\t\t\t\tobserve(o);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn inst;\r\n\t};\r\n\r\n}());\n\n;/* === common/ntc.js === */\n/*\r\n\r\n+-----------------------------------------------------------------+\r\n|     Created by Chirag Mehta - http://chir.ag/projects/ntc       |\r\n|-----------------------------------------------------------------|\r\n|               ntc js (Name that Color JavaScript)               |\r\n+-----------------------------------------------------------------+\r\n\r\nAll the functions, code, lists etc. have been written specifically\r\nfor the Name that Color JavaScript by Chirag Mehta unless otherwise\r\nspecified.\r\n\r\nThis script is released under the: Creative Commons License:\r\nAttribution 2.5 http://creativecommons.org/licenses/by/2.5/\r\n\r\nSample Usage:\r\n\r\n  <script type=\"text/javascript\" src=\"ntc.js\"></script>\r\n\r\n  <script type=\"text/javascript\">\r\n\r\n    var n_match  = ntc.name(\"#6195ED\");\r\n    n_rgb        = n_match[0]; // This is the RGB value of the closest matching color\r\n    n_name       = n_match[1]; // This is the text string for the name of the match\r\n    n_exactmatch = n_match[2]; // True if exact color match, False if close-match\r\n\r\n    alert(n_match);\r\n\r\n  </script>\r\n\r\n*/\r\n\r\nvar ntc = {\r\n    nameHash:{},\r\n    init: function() {\r\n      var color, rgb, hsl;\r\n      for(var i = 0; i < ntc.names.length; i++)\r\n      {\r\n        color = \"#\" + ntc.names[i][0];\r\n        rgb = ntc.rgb(color);\r\n        hsl = ntc.hsl(color);\r\n        ntc.nameHash[ntc.names[i][1].toLowerCase()] = i;\r\n        ntc.names[i].push(rgb[0], rgb[1], rgb[2], hsl[0], hsl[1], hsl[2]);\r\n      }\r\n    },\r\n    hex: function(color){\r\n        return ntc.names[ntc.nameHash[color.toLowerCase()]] || [\"#000000\", \"Invalid Color: \" + color, false];\r\n    },\r\n    name: function(color) {\r\n  \r\n      color = color.toUpperCase();\r\n      if(color.length < 3 || color.length > 7)\r\n        return [\"#000000\", \"Invalid Color: \" + color, false];\r\n      if(color.length % 3 == 0)\r\n        color = \"#\" + color;\r\n      if(color.length == 4)\r\n        color = \"#\" + color.substr(1, 1) + color.substr(1, 1) + color.substr(2, 1) + color.substr(2, 1) + color.substr(3, 1) + color.substr(3, 1);\r\n  \r\n      var rgb = ntc.rgb(color);\r\n      var r = rgb[0], g = rgb[1], b = rgb[2];\r\n      var hsl = ntc.hsl(color);\r\n      var h = hsl[0], s = hsl[1], l = hsl[2];\r\n      var ndf1 = 0; ndf2 = 0; ndf = 0;\r\n      var cl = -1, df = -1;\r\n  \r\n      for(var i = 0; i < ntc.names.length; i++)\r\n      {\r\n        if(color == \"#\" + ntc.names[i][0])\r\n          return [\"#\" + ntc.names[i][0], ntc.names[i][1], true];\r\n  \r\n        ndf1 = Math.pow(r - ntc.names[i][2], 2) + Math.pow(g - ntc.names[i][3], 2) + Math.pow(b - ntc.names[i][4], 2);\r\n        ndf2 = Math.pow(h - ntc.names[i][5], 2) + Math.pow(s - ntc.names[i][6], 2) + Math.pow(l - ntc.names[i][7], 2);\r\n        ndf = ndf1 + ndf2 * 2;\r\n        if(df < 0 || df > ndf)\r\n        {\r\n          df = ndf;\r\n          cl = i;\r\n        }\r\n      }\r\n  \r\n      return (cl < 0 ? [\"#000000\", \"Invalid Color: \" + color, false] : [\"#\" + ntc.names[cl][0], ntc.names[cl][1], false]);\r\n    },\r\n  \r\n    // adopted from: Farbtastic 1.2\r\n    // http://acko.net/dev/farbtastic\r\n    hsl: function (color) {\r\n  \r\n      var rgb = [parseInt('0x' + color.substring(1, 3)) / 255, parseInt('0x' + color.substring(3, 5)) / 255, parseInt('0x' + color.substring(5, 7)) / 255];\r\n      var min, max, delta, h, s, l;\r\n      var r = rgb[0], g = rgb[1], b = rgb[2];\r\n  \r\n      min = Math.min(r, Math.min(g, b));\r\n      max = Math.max(r, Math.max(g, b));\r\n      delta = max - min;\r\n      l = (min + max) / 2;\r\n  \r\n      s = 0;\r\n      if(l > 0 && l < 1)\r\n        s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));\r\n  \r\n      h = 0;\r\n      if(delta > 0)\r\n      {\r\n        if (max == r && max != g) h += (g - b) / delta;\r\n        if (max == g && max != b) h += (2 + (b - r) / delta);\r\n        if (max == b && max != r) h += (4 + (r - g) / delta);\r\n        h /= 6;\r\n      }\r\n      return [parseInt(h * 255), parseInt(s * 255), parseInt(l * 255)];\r\n    },\r\n  \r\n    // adopted from: Farbtastic 1.2\r\n    // http://acko.net/dev/farbtastic\r\n    rgb: function(color) {\r\n      return [parseInt('0x' + color.substring(1, 3)), parseInt('0x' + color.substring(3, 5)),  parseInt('0x' + color.substring(5, 7))];\r\n    },\r\n  \r\n    names: [\r\n  [\"000000\", \"Black\"],\r\n  [\"000080\", \"Navy Blue\"],\r\n  [\"0000C8\", \"Dark Blue\"],\r\n  [\"0000FF\", \"Blue\"],\r\n  [\"000741\", \"Stratos\"],\r\n  [\"001B1C\", \"Swamp\"],\r\n  [\"002387\", \"Resolution Blue\"],\r\n  [\"002900\", \"Deep Fir\"],\r\n  [\"002E20\", \"Burnham\"],\r\n  [\"002FA7\", \"International Klein Blue\"],\r\n  [\"003153\", \"Prussian Blue\"],\r\n  [\"003366\", \"Midnight Blue\"],\r\n  [\"003399\", \"Smalt\"],\r\n  [\"003532\", \"Deep Teal\"],\r\n  [\"003E40\", \"Cyprus\"],\r\n  [\"004620\", \"Kaitoke Green\"],\r\n  [\"0047AB\", \"Cobalt\"],\r\n  [\"004816\", \"Crusoe\"],\r\n  [\"004950\", \"Sherpa Blue\"],\r\n  [\"0056A7\", \"Endeavour\"],\r\n  [\"00581A\", \"Camarone\"],\r\n  [\"0066CC\", \"Science Blue\"],\r\n  [\"0066FF\", \"Blue Ribbon\"],\r\n  [\"00755E\", \"Tropical Rain Forest\"],\r\n  [\"0076A3\", \"Allports\"],\r\n  [\"007BA7\", \"Deep Cerulean\"],\r\n  [\"007EC7\", \"Lochmara\"],\r\n  [\"007FFF\", \"Azure Radiance\"],\r\n  [\"008080\", \"Teal\"],\r\n  [\"0095B6\", \"Bondi Blue\"],\r\n  [\"009DC4\", \"Pacific Blue\"],\r\n  [\"00A693\", \"Persian Green\"],\r\n  [\"00A86B\", \"Jade\"],\r\n  [\"00CC99\", \"Caribbean Green\"],\r\n  [\"00CCCC\", \"Robin's Egg Blue\"],\r\n  [\"00FF00\", \"Green\"],\r\n  [\"00FF7F\", \"Spring Green\"],\r\n  [\"00FFFF\", \"Cyan / Aqua\"],\r\n  [\"010D1A\", \"Blue Charcoal\"],\r\n  [\"011635\", \"Midnight\"],\r\n  [\"011D13\", \"Holly\"],\r\n  [\"012731\", \"Daintree\"],\r\n  [\"01361C\", \"Cardin Green\"],\r\n  [\"01371A\", \"County Green\"],\r\n  [\"013E62\", \"Astronaut Blue\"],\r\n  [\"013F6A\", \"Regal Blue\"],\r\n  [\"014B43\", \"Aqua Deep\"],\r\n  [\"015E85\", \"Orient\"],\r\n  [\"016162\", \"Blue Stone\"],\r\n  [\"016D39\", \"Fun Green\"],\r\n  [\"01796F\", \"Pine Green\"],\r\n  [\"017987\", \"Blue Lagoon\"],\r\n  [\"01826B\", \"Deep Sea\"],\r\n  [\"01A368\", \"Green Haze\"],\r\n  [\"022D15\", \"English Holly\"],\r\n  [\"02402C\", \"Sherwood Green\"],\r\n  [\"02478E\", \"Congress Blue\"],\r\n  [\"024E46\", \"Evening Sea\"],\r\n  [\"026395\", \"Bahama Blue\"],\r\n  [\"02866F\", \"Observatory\"],\r\n  [\"02A4D3\", \"Cerulean\"],\r\n  [\"03163C\", \"Tangaroa\"],\r\n  [\"032B52\", \"Green Vogue\"],\r\n  [\"036A6E\", \"Mosque\"],\r\n  [\"041004\", \"Midnight Moss\"],\r\n  [\"041322\", \"Black Pearl\"],\r\n  [\"042E4C\", \"Blue Whale\"],\r\n  [\"044022\", \"Zuccini\"],\r\n  [\"044259\", \"Teal Blue\"],\r\n  [\"051040\", \"Deep Cove\"],\r\n  [\"051657\", \"Gulf Blue\"],\r\n  [\"055989\", \"Venice Blue\"],\r\n  [\"056F57\", \"Watercourse\"],\r\n  [\"062A78\", \"Catalina Blue\"],\r\n  [\"063537\", \"Tiber\"],\r\n  [\"069B81\", \"Gossamer\"],\r\n  [\"06A189\", \"Niagara\"],\r\n  [\"073A50\", \"Tarawera\"],\r\n  [\"080110\", \"Jaguar\"],\r\n  [\"081910\", \"Black Bean\"],\r\n  [\"082567\", \"Deep Sapphire\"],\r\n  [\"088370\", \"Elf Green\"],\r\n  [\"08E8DE\", \"Bright Turquoise\"],\r\n  [\"092256\", \"Downriver\"],\r\n  [\"09230F\", \"Palm Green\"],\r\n  [\"09255D\", \"Madison\"],\r\n  [\"093624\", \"Bottle Green\"],\r\n  [\"095859\", \"Deep Sea Green\"],\r\n  [\"097F4B\", \"Salem\"],\r\n  [\"0A001C\", \"Black Russian\"],\r\n  [\"0A480D\", \"Dark Fern\"],\r\n  [\"0A6906\", \"Japanese Laurel\"],\r\n  [\"0A6F75\", \"Atoll\"],\r\n  [\"0B0B0B\", \"Cod Gray\"],\r\n  [\"0B0F08\", \"Marshland\"],\r\n  [\"0B1107\", \"Gordons Green\"],\r\n  [\"0B1304\", \"Black Forest\"],\r\n  [\"0B6207\", \"San Felix\"],\r\n  [\"0BDA51\", \"Malachite\"],\r\n  [\"0C0B1D\", \"Ebony\"],\r\n  [\"0C0D0F\", \"Woodsmoke\"],\r\n  [\"0C1911\", \"Racing Green\"],\r\n  [\"0C7A79\", \"Surfie Green\"],\r\n  [\"0C8990\", \"Blue Chill\"],\r\n  [\"0D0332\", \"Black Rock\"],\r\n  [\"0D1117\", \"Bunker\"],\r\n  [\"0D1C19\", \"Aztec\"],\r\n  [\"0D2E1C\", \"Bush\"],\r\n  [\"0E0E18\", \"Cinder\"],\r\n  [\"0E2A30\", \"Firefly\"],\r\n  [\"0F2D9E\", \"Torea Bay\"],\r\n  [\"10121D\", \"Vulcan\"],\r\n  [\"101405\", \"Green Waterloo\"],\r\n  [\"105852\", \"Eden\"],\r\n  [\"110C6C\", \"Arapawa\"],\r\n  [\"120A8F\", \"Ultramarine\"],\r\n  [\"123447\", \"Elephant\"],\r\n  [\"126B40\", \"Jewel\"],\r\n  [\"130000\", \"Diesel\"],\r\n  [\"130A06\", \"Asphalt\"],\r\n  [\"13264D\", \"Blue Zodiac\"],\r\n  [\"134F19\", \"Parsley\"],\r\n  [\"140600\", \"Nero\"],\r\n  [\"1450AA\", \"Tory Blue\"],\r\n  [\"151F4C\", \"Bunting\"],\r\n  [\"1560BD\", \"Denim\"],\r\n  [\"15736B\", \"Genoa\"],\r\n  [\"161928\", \"Mirage\"],\r\n  [\"161D10\", \"Hunter Green\"],\r\n  [\"162A40\", \"Big Stone\"],\r\n  [\"163222\", \"Celtic\"],\r\n  [\"16322C\", \"Timber Green\"],\r\n  [\"163531\", \"Gable Green\"],\r\n  [\"171F04\", \"Pine Tree\"],\r\n  [\"175579\", \"Chathams Blue\"],\r\n  [\"182D09\", \"Deep Forest Green\"],\r\n  [\"18587A\", \"Blumine\"],\r\n  [\"19330E\", \"Palm Leaf\"],\r\n  [\"193751\", \"Nile Blue\"],\r\n  [\"1959A8\", \"Fun Blue\"],\r\n  [\"1A1A68\", \"Lucky Point\"],\r\n  [\"1AB385\", \"Mountain Meadow\"],\r\n  [\"1B0245\", \"Tolopea\"],\r\n  [\"1B1035\", \"Haiti\"],\r\n  [\"1B127B\", \"Deep Koamaru\"],\r\n  [\"1B1404\", \"Acadia\"],\r\n  [\"1B2F11\", \"Seaweed\"],\r\n  [\"1B3162\", \"Biscay\"],\r\n  [\"1B659D\", \"Matisse\"],\r\n  [\"1C1208\", \"Crowshead\"],\r\n  [\"1C1E13\", \"Rangoon Green\"],\r\n  [\"1C39BB\", \"Persian Blue\"],\r\n  [\"1C402E\", \"Everglade\"],\r\n  [\"1C7C7D\", \"Elm\"],\r\n  [\"1D6142\", \"Green Pea\"],\r\n  [\"1E0F04\", \"Creole\"],\r\n  [\"1E1609\", \"Karaka\"],\r\n  [\"1E1708\", \"El Paso\"],\r\n  [\"1E385B\", \"Cello\"],\r\n  [\"1E433C\", \"Te Papa Green\"],\r\n  [\"1E90FF\", \"Dodger Blue\"],\r\n  [\"1E9AB0\", \"Eastern Blue\"],\r\n  [\"1F120F\", \"Night Rider\"],\r\n  [\"1FC2C2\", \"Java\"],\r\n  [\"20208D\", \"Jacksons Purple\"],\r\n  [\"202E54\", \"Cloud Burst\"],\r\n  [\"204852\", \"Blue Dianne\"],\r\n  [\"211A0E\", \"Eternity\"],\r\n  [\"220878\", \"Deep Blue\"],\r\n  [\"228B22\", \"Forest Green\"],\r\n  [\"233418\", \"Mallard\"],\r\n  [\"240A40\", \"Violet\"],\r\n  [\"240C02\", \"Kilamanjaro\"],\r\n  [\"242A1D\", \"Log Cabin\"],\r\n  [\"242E16\", \"Black Olive\"],\r\n  [\"24500F\", \"Green House\"],\r\n  [\"251607\", \"Graphite\"],\r\n  [\"251706\", \"Cannon Black\"],\r\n  [\"251F4F\", \"Port Gore\"],\r\n  [\"25272C\", \"Shark\"],\r\n  [\"25311C\", \"Green Kelp\"],\r\n  [\"2596D1\", \"Curious Blue\"],\r\n  [\"260368\", \"Paua\"],\r\n  [\"26056A\", \"Paris M\"],\r\n  [\"261105\", \"Wood Bark\"],\r\n  [\"261414\", \"Gondola\"],\r\n  [\"262335\", \"Steel Gray\"],\r\n  [\"26283B\", \"Ebony Clay\"],\r\n  [\"273A81\", \"Bay of Many\"],\r\n  [\"27504B\", \"Plantation\"],\r\n  [\"278A5B\", \"Eucalyptus\"],\r\n  [\"281E15\", \"Oil\"],\r\n  [\"283A77\", \"Astronaut\"],\r\n  [\"286ACD\", \"Mariner\"],\r\n  [\"290C5E\", \"Violent Violet\"],\r\n  [\"292130\", \"Bastille\"],\r\n  [\"292319\", \"Zeus\"],\r\n  [\"292937\", \"Charade\"],\r\n  [\"297B9A\", \"Jelly Bean\"],\r\n  [\"29AB87\", \"Jungle Green\"],\r\n  [\"2A0359\", \"Cherry Pie\"],\r\n  [\"2A140E\", \"Coffee Bean\"],\r\n  [\"2A2630\", \"Baltic Sea\"],\r\n  [\"2A380B\", \"Turtle Green\"],\r\n  [\"2A52BE\", \"Cerulean Blue\"],\r\n  [\"2B0202\", \"Sepia Black\"],\r\n  [\"2B194F\", \"Valhalla\"],\r\n  [\"2B3228\", \"Heavy Metal\"],\r\n  [\"2C0E8C\", \"Blue Gem\"],\r\n  [\"2C1632\", \"Revolver\"],\r\n  [\"2C2133\", \"Bleached Cedar\"],\r\n  [\"2C8C84\", \"Lochinvar\"],\r\n  [\"2D2510\", \"Mikado\"],\r\n  [\"2D383A\", \"Outer Space\"],\r\n  [\"2D569B\", \"St Tropaz\"],\r\n  [\"2E0329\", \"Jacaranda\"],\r\n  [\"2E1905\", \"Jacko Bean\"],\r\n  [\"2E3222\", \"Rangitoto\"],\r\n  [\"2E3F62\", \"Rhino\"],\r\n  [\"2E8B57\", \"Sea Green\"],\r\n  [\"2EBFD4\", \"Scooter\"],\r\n  [\"2F270E\", \"Onion\"],\r\n  [\"2F3CB3\", \"Governor Bay\"],\r\n  [\"2F519E\", \"Sapphire\"],\r\n  [\"2F5A57\", \"Spectra\"],\r\n  [\"2F6168\", \"Casal\"],\r\n  [\"300529\", \"Melanzane\"],\r\n  [\"301F1E\", \"Cocoa Brown\"],\r\n  [\"302A0F\", \"Woodrush\"],\r\n  [\"304B6A\", \"San Juan\"],\r\n  [\"30D5C8\", \"Turquoise\"],\r\n  [\"311C17\", \"Eclipse\"],\r\n  [\"314459\", \"Pickled Bluewood\"],\r\n  [\"315BA1\", \"Azure\"],\r\n  [\"31728D\", \"Calypso\"],\r\n  [\"317D82\", \"Paradiso\"],\r\n  [\"32127A\", \"Persian Indigo\"],\r\n  [\"32293A\", \"Blackcurrant\"],\r\n  [\"323232\", \"Mine Shaft\"],\r\n  [\"325D52\", \"Stromboli\"],\r\n  [\"327C14\", \"Bilbao\"],\r\n  [\"327DA0\", \"Astral\"],\r\n  [\"33036B\", \"Christalle\"],\r\n  [\"33292F\", \"Thunder\"],\r\n  [\"33CC99\", \"Shamrock\"],\r\n  [\"341515\", \"Tamarind\"],\r\n  [\"350036\", \"Mardi Gras\"],\r\n  [\"350E42\", \"Valentino\"],\r\n  [\"350E57\", \"Jagger\"],\r\n  [\"353542\", \"Tuna\"],\r\n  [\"354E8C\", \"Chambray\"],\r\n  [\"363050\", \"Martinique\"],\r\n  [\"363534\", \"Tuatara\"],\r\n  [\"363C0D\", \"Waiouru\"],\r\n  [\"36747D\", \"Ming\"],\r\n  [\"368716\", \"La Palma\"],\r\n  [\"370202\", \"Chocolate\"],\r\n  [\"371D09\", \"Clinker\"],\r\n  [\"37290E\", \"Brown Tumbleweed\"],\r\n  [\"373021\", \"Birch\"],\r\n  [\"377475\", \"Oracle\"],\r\n  [\"380474\", \"Blue Diamond\"],\r\n  [\"381A51\", \"Grape\"],\r\n  [\"383533\", \"Dune\"],\r\n  [\"384555\", \"Oxford Blue\"],\r\n  [\"384910\", \"Clover\"],\r\n  [\"394851\", \"Limed Spruce\"],\r\n  [\"396413\", \"Dell\"],\r\n  [\"3A0020\", \"Toledo\"],\r\n  [\"3A2010\", \"Sambuca\"],\r\n  [\"3A2A6A\", \"Jacarta\"],\r\n  [\"3A686C\", \"William\"],\r\n  [\"3A6A47\", \"Killarney\"],\r\n  [\"3AB09E\", \"Keppel\"],\r\n  [\"3B000B\", \"Temptress\"],\r\n  [\"3B0910\", \"Aubergine\"],\r\n  [\"3B1F1F\", \"Jon\"],\r\n  [\"3B2820\", \"Treehouse\"],\r\n  [\"3B7A57\", \"Amazon\"],\r\n  [\"3B91B4\", \"Boston Blue\"],\r\n  [\"3C0878\", \"Windsor\"],\r\n  [\"3C1206\", \"Rebel\"],\r\n  [\"3C1F76\", \"Meteorite\"],\r\n  [\"3C2005\", \"Dark Ebony\"],\r\n  [\"3C3910\", \"Camouflage\"],\r\n  [\"3C4151\", \"Bright Gray\"],\r\n  [\"3C4443\", \"Cape Cod\"],\r\n  [\"3C493A\", \"Lunar Green\"],\r\n  [\"3D0C02\", \"Bean  \"],\r\n  [\"3D2B1F\", \"Bistre\"],\r\n  [\"3D7D52\", \"Goblin\"],\r\n  [\"3E0480\", \"Kingfisher Daisy\"],\r\n  [\"3E1C14\", \"Cedar\"],\r\n  [\"3E2B23\", \"English Walnut\"],\r\n  [\"3E2C1C\", \"Black Marlin\"],\r\n  [\"3E3A44\", \"Ship Gray\"],\r\n  [\"3EABBF\", \"Pelorous\"],\r\n  [\"3F2109\", \"Bronze\"],\r\n  [\"3F2500\", \"Cola\"],\r\n  [\"3F3002\", \"Madras\"],\r\n  [\"3F307F\", \"Minsk\"],\r\n  [\"3F4C3A\", \"Cabbage Pont\"],\r\n  [\"3F583B\", \"Tom Thumb\"],\r\n  [\"3F5D53\", \"Mineral Green\"],\r\n  [\"3FC1AA\", \"Puerto Rico\"],\r\n  [\"3FFF00\", \"Harlequin\"],\r\n  [\"401801\", \"Brown Pod\"],\r\n  [\"40291D\", \"Cork\"],\r\n  [\"403B38\", \"Masala\"],\r\n  [\"403D19\", \"Thatch Green\"],\r\n  [\"405169\", \"Fiord\"],\r\n  [\"40826D\", \"Viridian\"],\r\n  [\"40A860\", \"Chateau Green\"],\r\n  [\"410056\", \"Ripe Plum\"],\r\n  [\"411F10\", \"Paco\"],\r\n  [\"412010\", \"Deep Oak\"],\r\n  [\"413C37\", \"Merlin\"],\r\n  [\"414257\", \"Gun Powder\"],\r\n  [\"414C7D\", \"East Bay\"],\r\n  [\"4169E1\", \"Royal Blue\"],\r\n  [\"41AA78\", \"Ocean Green\"],\r\n  [\"420303\", \"Burnt Maroon\"],\r\n  [\"423921\", \"Lisbon Brown\"],\r\n  [\"427977\", \"Faded Jade\"],\r\n  [\"431560\", \"Scarlet Gum\"],\r\n  [\"433120\", \"Iroko\"],\r\n  [\"433E37\", \"Armadillo\"],\r\n  [\"434C59\", \"River Bed\"],\r\n  [\"436A0D\", \"Green Leaf\"],\r\n  [\"44012D\", \"Barossa\"],\r\n  [\"441D00\", \"Morocco Brown\"],\r\n  [\"444954\", \"Mako\"],\r\n  [\"454936\", \"Kelp\"],\r\n  [\"456CAC\", \"San Marino\"],\r\n  [\"45B1E8\", \"Picton Blue\"],\r\n  [\"460B41\", \"Loulou\"],\r\n  [\"462425\", \"Crater Brown\"],\r\n  [\"465945\", \"Gray Asparagus\"],\r\n  [\"4682B4\", \"Steel Blue\"],\r\n  [\"480404\", \"Rustic Red\"],\r\n  [\"480607\", \"Bulgarian Rose\"],\r\n  [\"480656\", \"Clairvoyant\"],\r\n  [\"481C1C\", \"Cocoa Bean\"],\r\n  [\"483131\", \"Woody Brown\"],\r\n  [\"483C32\", \"Taupe\"],\r\n  [\"49170C\", \"Van Cleef\"],\r\n  [\"492615\", \"Brown Derby\"],\r\n  [\"49371B\", \"Metallic Bronze\"],\r\n  [\"495400\", \"Verdun Green\"],\r\n  [\"496679\", \"Blue Bayoux\"],\r\n  [\"497183\", \"Bismark\"],\r\n  [\"4A2A04\", \"Bracken\"],\r\n  [\"4A3004\", \"Deep Bronze\"],\r\n  [\"4A3C30\", \"Mondo\"],\r\n  [\"4A4244\", \"Tundora\"],\r\n  [\"4A444B\", \"Gravel\"],\r\n  [\"4A4E5A\", \"Trout\"],\r\n  [\"4B0082\", \"Pigment Indigo\"],\r\n  [\"4B5D52\", \"Nandor\"],\r\n  [\"4C3024\", \"Saddle\"],\r\n  [\"4C4F56\", \"Abbey\"],\r\n  [\"4D0135\", \"Blackberry\"],\r\n  [\"4D0A18\", \"Cab Sav\"],\r\n  [\"4D1E01\", \"Indian Tan\"],\r\n  [\"4D282D\", \"Cowboy\"],\r\n  [\"4D282E\", \"Livid Brown\"],\r\n  [\"4D3833\", \"Rock\"],\r\n  [\"4D3D14\", \"Punga\"],\r\n  [\"4D400F\", \"Bronzetone\"],\r\n  [\"4D5328\", \"Woodland\"],\r\n  [\"4E0606\", \"Mahogany\"],\r\n  [\"4E2A5A\", \"Bossanova\"],\r\n  [\"4E3B41\", \"Matterhorn\"],\r\n  [\"4E420C\", \"Bronze Olive\"],\r\n  [\"4E4562\", \"Mulled Wine\"],\r\n  [\"4E6649\", \"Axolotl\"],\r\n  [\"4E7F9E\", \"Wedgewood\"],\r\n  [\"4EABD1\", \"Shakespeare\"],\r\n  [\"4F1C70\", \"Honey Flower\"],\r\n  [\"4F2398\", \"Daisy Bush\"],\r\n  [\"4F69C6\", \"Indigo\"],\r\n  [\"4F7942\", \"Fern Green\"],\r\n  [\"4F9D5D\", \"Fruit Salad\"],\r\n  [\"4FA83D\", \"Apple\"],\r\n  [\"504351\", \"Mortar\"],\r\n  [\"507096\", \"Kashmir Blue\"],\r\n  [\"507672\", \"Cutty Sark\"],\r\n  [\"50C878\", \"Emerald\"],\r\n  [\"514649\", \"Emperor\"],\r\n  [\"516E3D\", \"Chalet Green\"],\r\n  [\"517C66\", \"Como\"],\r\n  [\"51808F\", \"Smalt Blue\"],\r\n  [\"52001F\", \"Castro\"],\r\n  [\"520C17\", \"Maroon Oak\"],\r\n  [\"523C94\", \"Gigas\"],\r\n  [\"533455\", \"Voodoo\"],\r\n  [\"534491\", \"Victoria\"],\r\n  [\"53824B\", \"Hippie Green\"],\r\n  [\"541012\", \"Heath\"],\r\n  [\"544333\", \"Judge Gray\"],\r\n  [\"54534D\", \"Fuscous Gray\"],\r\n  [\"549019\", \"Vida Loca\"],\r\n  [\"55280C\", \"Cioccolato\"],\r\n  [\"555B10\", \"Saratoga\"],\r\n  [\"556D56\", \"Finlandia\"],\r\n  [\"5590D9\", \"Havelock Blue\"],\r\n  [\"56B4BE\", \"Fountain Blue\"],\r\n  [\"578363\", \"Spring Leaves\"],\r\n  [\"583401\", \"Saddle Brown\"],\r\n  [\"585562\", \"Scarpa Flow\"],\r\n  [\"587156\", \"Cactus\"],\r\n  [\"589AAF\", \"Hippie Blue\"],\r\n  [\"591D35\", \"Wine Berry\"],\r\n  [\"592804\", \"Brown Bramble\"],\r\n  [\"593737\", \"Congo Brown\"],\r\n  [\"594433\", \"Millbrook\"],\r\n  [\"5A6E9C\", \"Waikawa Gray\"],\r\n  [\"5A87A0\", \"Horizon\"],\r\n  [\"5B3013\", \"Jambalaya\"],\r\n  [\"5C0120\", \"Bordeaux\"],\r\n  [\"5C0536\", \"Mulberry Wood\"],\r\n  [\"5C2E01\", \"Carnaby Tan\"],\r\n  [\"5C5D75\", \"Comet\"],\r\n  [\"5D1E0F\", \"Redwood\"],\r\n  [\"5D4C51\", \"Don Juan\"],\r\n  [\"5D5C58\", \"Chicago\"],\r\n  [\"5D5E37\", \"Verdigris\"],\r\n  [\"5D7747\", \"Dingley\"],\r\n  [\"5DA19F\", \"Breaker Bay\"],\r\n  [\"5E483E\", \"Kabul\"],\r\n  [\"5E5D3B\", \"Hemlock\"],\r\n  [\"5F3D26\", \"Irish Coffee\"],\r\n  [\"5F5F6E\", \"Mid Gray\"],\r\n  [\"5F6672\", \"Shuttle Gray\"],\r\n  [\"5FA777\", \"Aqua Forest\"],\r\n  [\"5FB3AC\", \"Tradewind\"],\r\n  [\"604913\", \"Horses Neck\"],\r\n  [\"605B73\", \"Smoky\"],\r\n  [\"606E68\", \"Corduroy\"],\r\n  [\"6093D1\", \"Danube\"],\r\n  [\"612718\", \"Espresso\"],\r\n  [\"614051\", \"Eggplant\"],\r\n  [\"615D30\", \"Costa Del Sol\"],\r\n  [\"61845F\", \"Glade Green\"],\r\n  [\"622F30\", \"Buccaneer\"],\r\n  [\"623F2D\", \"Quincy\"],\r\n  [\"624E9A\", \"Butterfly Bush\"],\r\n  [\"625119\", \"West Coast\"],\r\n  [\"626649\", \"Finch\"],\r\n  [\"639A8F\", \"Patina\"],\r\n  [\"63B76C\", \"Fern\"],\r\n  [\"6456B7\", \"Blue Violet\"],\r\n  [\"646077\", \"Dolphin\"],\r\n  [\"646463\", \"Storm Dust\"],\r\n  [\"646A54\", \"Siam\"],\r\n  [\"646E75\", \"Nevada\"],\r\n  [\"6495ED\", \"Cornflower Blue\"],\r\n  [\"64CCDB\", \"Viking\"],\r\n  [\"65000B\", \"Rosewood\"],\r\n  [\"651A14\", \"Cherrywood\"],\r\n  [\"652DC1\", \"Purple Heart\"],\r\n  [\"657220\", \"Fern Frond\"],\r\n  [\"65745D\", \"Willow Grove\"],\r\n  [\"65869F\", \"Hoki\"],\r\n  [\"660045\", \"Pompadour\"],\r\n  [\"660099\", \"Purple\"],\r\n  [\"66023C\", \"Tyrian Purple\"],\r\n  [\"661010\", \"Dark Tan\"],\r\n  [\"66B58F\", \"Silver Tree\"],\r\n  [\"66FF00\", \"Bright Green\"],\r\n  [\"66FF66\", \"Screamin' Green\"],\r\n  [\"67032D\", \"Black Rose\"],\r\n  [\"675FA6\", \"Scampi\"],\r\n  [\"676662\", \"Ironside Gray\"],\r\n  [\"678975\", \"Viridian Green\"],\r\n  [\"67A712\", \"Christi\"],\r\n  [\"683600\", \"Nutmeg Wood Finish\"],\r\n  [\"685558\", \"Zambezi\"],\r\n  [\"685E6E\", \"Salt Box\"],\r\n  [\"692545\", \"Tawny Port\"],\r\n  [\"692D54\", \"Finn\"],\r\n  [\"695F62\", \"Scorpion\"],\r\n  [\"697E9A\", \"Lynch\"],\r\n  [\"6A442E\", \"Spice\"],\r\n  [\"6A5D1B\", \"Himalaya\"],\r\n  [\"6A6051\", \"Soya Bean\"],\r\n  [\"6B2A14\", \"Hairy Heath\"],\r\n  [\"6B3FA0\", \"Royal Purple\"],\r\n  [\"6B4E31\", \"Shingle Fawn\"],\r\n  [\"6B5755\", \"Dorado\"],\r\n  [\"6B8BA2\", \"Bermuda Gray\"],\r\n  [\"6B8E23\", \"Olive Drab\"],\r\n  [\"6C3082\", \"Eminence\"],\r\n  [\"6CDAE7\", \"Turquoise Blue\"],\r\n  [\"6D0101\", \"Lonestar\"],\r\n  [\"6D5E54\", \"Pine Cone\"],\r\n  [\"6D6C6C\", \"Dove Gray\"],\r\n  [\"6D9292\", \"Juniper\"],\r\n  [\"6D92A1\", \"Gothic\"],\r\n  [\"6E0902\", \"Red Oxide\"],\r\n  [\"6E1D14\", \"Moccaccino\"],\r\n  [\"6E4826\", \"Pickled Bean\"],\r\n  [\"6E4B26\", \"Dallas\"],\r\n  [\"6E6D57\", \"Kokoda\"],\r\n  [\"6E7783\", \"Pale Sky\"],\r\n  [\"6F440C\", \"Cafe Royale\"],\r\n  [\"6F6A61\", \"Flint\"],\r\n  [\"6F8E63\", \"Highland\"],\r\n  [\"6F9D02\", \"Limeade\"],\r\n  [\"6FD0C5\", \"Downy\"],\r\n  [\"701C1C\", \"Persian Plum\"],\r\n  [\"704214\", \"Sepia\"],\r\n  [\"704A07\", \"Antique Bronze\"],\r\n  [\"704F50\", \"Ferra\"],\r\n  [\"706555\", \"Coffee\"],\r\n  [\"708090\", \"Slate Gray\"],\r\n  [\"711A00\", \"Cedar Wood Finish\"],\r\n  [\"71291D\", \"Metallic Copper\"],\r\n  [\"714693\", \"Affair\"],\r\n  [\"714AB2\", \"Studio\"],\r\n  [\"715D47\", \"Tobacco Brown\"],\r\n  [\"716338\", \"Yellow Metal\"],\r\n  [\"716B56\", \"Peat\"],\r\n  [\"716E10\", \"Olivetone\"],\r\n  [\"717486\", \"Storm Gray\"],\r\n  [\"718080\", \"Sirocco\"],\r\n  [\"71D9E2\", \"Aquamarine Blue\"],\r\n  [\"72010F\", \"Venetian Red\"],\r\n  [\"724A2F\", \"Old Copper\"],\r\n  [\"726D4E\", \"Go Ben\"],\r\n  [\"727B89\", \"Raven\"],\r\n  [\"731E8F\", \"Seance\"],\r\n  [\"734A12\", \"Raw Umber\"],\r\n  [\"736C9F\", \"Kimberly\"],\r\n  [\"736D58\", \"Crocodile\"],\r\n  [\"737829\", \"Crete\"],\r\n  [\"738678\", \"Xanadu\"],\r\n  [\"74640D\", \"Spicy Mustard\"],\r\n  [\"747D63\", \"Limed Ash\"],\r\n  [\"747D83\", \"Rolling Stone\"],\r\n  [\"748881\", \"Blue Smoke\"],\r\n  [\"749378\", \"Laurel\"],\r\n  [\"74C365\", \"Mantis\"],\r\n  [\"755A57\", \"Russett\"],\r\n  [\"7563A8\", \"Deluge\"],\r\n  [\"76395D\", \"Cosmic\"],\r\n  [\"7666C6\", \"Blue Marguerite\"],\r\n  [\"76BD17\", \"Lima\"],\r\n  [\"76D7EA\", \"Sky Blue\"],\r\n  [\"770F05\", \"Dark Burgundy\"],\r\n  [\"771F1F\", \"Crown of Thorns\"],\r\n  [\"773F1A\", \"Walnut\"],\r\n  [\"776F61\", \"Pablo\"],\r\n  [\"778120\", \"Pacifika\"],\r\n  [\"779E86\", \"Oxley\"],\r\n  [\"77DD77\", \"Pastel Green\"],\r\n  [\"780109\", \"Japanese Maple\"],\r\n  [\"782D19\", \"Mocha\"],\r\n  [\"782F16\", \"Peanut\"],\r\n  [\"78866B\", \"Camouflage Green\"],\r\n  [\"788A25\", \"Wasabi\"],\r\n  [\"788BBA\", \"Ship Cove\"],\r\n  [\"78A39C\", \"Sea Nymph\"],\r\n  [\"795D4C\", \"Roman Coffee\"],\r\n  [\"796878\", \"Old Lavender\"],\r\n  [\"796989\", \"Rum\"],\r\n  [\"796A78\", \"Fedora\"],\r\n  [\"796D62\", \"Sandstone\"],\r\n  [\"79DEEC\", \"Spray\"],\r\n  [\"7A013A\", \"Siren\"],\r\n  [\"7A58C1\", \"Fuchsia Blue\"],\r\n  [\"7A7A7A\", \"Boulder\"],\r\n  [\"7A89B8\", \"Wild Blue Yonder\"],\r\n  [\"7AC488\", \"De York\"],\r\n  [\"7B3801\", \"Red Beech\"],\r\n  [\"7B3F00\", \"Cinnamon\"],\r\n  [\"7B6608\", \"Yukon Gold\"],\r\n  [\"7B7874\", \"Tapa\"],\r\n  [\"7B7C94\", \"Waterloo \"],\r\n  [\"7B8265\", \"Flax Smoke\"],\r\n  [\"7B9F80\", \"Amulet\"],\r\n  [\"7BA05B\", \"Asparagus\"],\r\n  [\"7C1C05\", \"Kenyan Copper\"],\r\n  [\"7C7631\", \"Pesto\"],\r\n  [\"7C778A\", \"Topaz\"],\r\n  [\"7C7B7A\", \"Concord\"],\r\n  [\"7C7B82\", \"Jumbo\"],\r\n  [\"7C881A\", \"Trendy Green\"],\r\n  [\"7CA1A6\", \"Gumbo\"],\r\n  [\"7CB0A1\", \"Acapulco\"],\r\n  [\"7CB7BB\", \"Neptune\"],\r\n  [\"7D2C14\", \"Pueblo\"],\r\n  [\"7DA98D\", \"Bay Leaf\"],\r\n  [\"7DC8F7\", \"Malibu\"],\r\n  [\"7DD8C6\", \"Bermuda\"],\r\n  [\"7E3A15\", \"Copper Canyon\"],\r\n  [\"7F1734\", \"Claret\"],\r\n  [\"7F3A02\", \"Peru Tan\"],\r\n  [\"7F626D\", \"Falcon\"],\r\n  [\"7F7589\", \"Mobster\"],\r\n  [\"7F76D3\", \"Moody Blue\"],\r\n  [\"7FFF00\", \"Chartreuse\"],\r\n  [\"7FFFD4\", \"Aquamarine\"],\r\n  [\"800000\", \"Maroon\"],\r\n  [\"800B47\", \"Rose Bud Cherry\"],\r\n  [\"801818\", \"Falu Red\"],\r\n  [\"80341F\", \"Red Robin\"],\r\n  [\"803790\", \"Vivid Violet\"],\r\n  [\"80461B\", \"Russet\"],\r\n  [\"807E79\", \"Friar Gray\"],\r\n  [\"808000\", \"Olive\"],\r\n  [\"808080\", \"Gray\"],\r\n  [\"80B3AE\", \"Gulf Stream\"],\r\n  [\"80B3C4\", \"Glacier\"],\r\n  [\"80CCEA\", \"Seagull\"],\r\n  [\"81422C\", \"Nutmeg\"],\r\n  [\"816E71\", \"Spicy Pink\"],\r\n  [\"817377\", \"Empress\"],\r\n  [\"819885\", \"Spanish Green\"],\r\n  [\"826F65\", \"Sand Dune\"],\r\n  [\"828685\", \"Gunsmoke\"],\r\n  [\"828F72\", \"Battleship Gray\"],\r\n  [\"831923\", \"Merlot\"],\r\n  [\"837050\", \"Shadow\"],\r\n  [\"83AA5D\", \"Chelsea Cucumber\"],\r\n  [\"83D0C6\", \"Monte Carlo\"],\r\n  [\"843179\", \"Plum\"],\r\n  [\"84A0A0\", \"Granny Smith\"],\r\n  [\"8581D9\", \"Chetwode Blue\"],\r\n  [\"858470\", \"Bandicoot\"],\r\n  [\"859FAF\", \"Bali Hai\"],\r\n  [\"85C4CC\", \"Half Baked\"],\r\n  [\"860111\", \"Red Devil\"],\r\n  [\"863C3C\", \"Lotus\"],\r\n  [\"86483C\", \"Ironstone\"],\r\n  [\"864D1E\", \"Bull Shot\"],\r\n  [\"86560A\", \"Rusty Nail\"],\r\n  [\"868974\", \"Bitter\"],\r\n  [\"86949F\", \"Regent Gray\"],\r\n  [\"871550\", \"Disco\"],\r\n  [\"87756E\", \"Americano\"],\r\n  [\"877C7B\", \"Hurricane\"],\r\n  [\"878D91\", \"Oslo Gray\"],\r\n  [\"87AB39\", \"Sushi\"],\r\n  [\"885342\", \"Spicy Mix\"],\r\n  [\"886221\", \"Kumera\"],\r\n  [\"888387\", \"Suva Gray\"],\r\n  [\"888D65\", \"Avocado\"],\r\n  [\"893456\", \"Camelot\"],\r\n  [\"893843\", \"Solid Pink\"],\r\n  [\"894367\", \"Cannon Pink\"],\r\n  [\"897D6D\", \"Makara\"],\r\n  [\"8A3324\", \"Burnt Umber\"],\r\n  [\"8A73D6\", \"True V\"],\r\n  [\"8A8360\", \"Clay Creek\"],\r\n  [\"8A8389\", \"Monsoon\"],\r\n  [\"8A8F8A\", \"Stack\"],\r\n  [\"8AB9F1\", \"Jordy Blue\"],\r\n  [\"8B00FF\", \"Electric Violet\"],\r\n  [\"8B0723\", \"Monarch\"],\r\n  [\"8B6B0B\", \"Corn Harvest\"],\r\n  [\"8B8470\", \"Olive Haze\"],\r\n  [\"8B847E\", \"Schooner\"],\r\n  [\"8B8680\", \"Natural Gray\"],\r\n  [\"8B9C90\", \"Mantle\"],\r\n  [\"8B9FEE\", \"Portage\"],\r\n  [\"8BA690\", \"Envy\"],\r\n  [\"8BA9A5\", \"Cascade\"],\r\n  [\"8BE6D8\", \"Riptide\"],\r\n  [\"8C055E\", \"Cardinal Pink\"],\r\n  [\"8C472F\", \"Mule Fawn\"],\r\n  [\"8C5738\", \"Potters Clay\"],\r\n  [\"8C6495\", \"Trendy Pink\"],\r\n  [\"8D0226\", \"Paprika\"],\r\n  [\"8D3D38\", \"Sanguine Brown\"],\r\n  [\"8D3F3F\", \"Tosca\"],\r\n  [\"8D7662\", \"Cement\"],\r\n  [\"8D8974\", \"Granite Green\"],\r\n  [\"8D90A1\", \"Manatee\"],\r\n  [\"8DA8CC\", \"Polo Blue\"],\r\n  [\"8E0000\", \"Red Berry\"],\r\n  [\"8E4D1E\", \"Rope\"],\r\n  [\"8E6F70\", \"Opium\"],\r\n  [\"8E775E\", \"Domino\"],\r\n  [\"8E8190\", \"Mamba\"],\r\n  [\"8EABC1\", \"Nepal\"],\r\n  [\"8F021C\", \"Pohutukawa\"],\r\n  [\"8F3E33\", \"El Salva\"],\r\n  [\"8F4B0E\", \"Korma\"],\r\n  [\"8F8176\", \"Squirrel\"],\r\n  [\"8FD6B4\", \"Vista Blue\"],\r\n  [\"900020\", \"Burgundy\"],\r\n  [\"901E1E\", \"Old Brick\"],\r\n  [\"907874\", \"Hemp\"],\r\n  [\"907B71\", \"Almond Frost\"],\r\n  [\"908D39\", \"Sycamore\"],\r\n  [\"92000A\", \"Sangria\"],\r\n  [\"924321\", \"Cumin\"],\r\n  [\"926F5B\", \"Beaver\"],\r\n  [\"928573\", \"Stonewall\"],\r\n  [\"928590\", \"Venus\"],\r\n  [\"9370DB\", \"Medium Purple\"],\r\n  [\"93CCEA\", \"Cornflower\"],\r\n  [\"93DFB8\", \"Algae Green\"],\r\n  [\"944747\", \"Copper Rust\"],\r\n  [\"948771\", \"Arrowtown\"],\r\n  [\"950015\", \"Scarlett\"],\r\n  [\"956387\", \"Strikemaster\"],\r\n  [\"959396\", \"Mountain Mist\"],\r\n  [\"960018\", \"Carmine\"],\r\n  [\"964B00\", \"Brown\"],\r\n  [\"967059\", \"Leather\"],\r\n  [\"9678B6\", \"Purple Mountain's Majesty\"],\r\n  [\"967BB6\", \"Lavender Purple\"],\r\n  [\"96A8A1\", \"Pewter\"],\r\n  [\"96BBAB\", \"Summer Green\"],\r\n  [\"97605D\", \"Au Chico\"],\r\n  [\"9771B5\", \"Wisteria\"],\r\n  [\"97CD2D\", \"Atlantis\"],\r\n  [\"983D61\", \"Vin Rouge\"],\r\n  [\"9874D3\", \"Lilac Bush\"],\r\n  [\"98777B\", \"Bazaar\"],\r\n  [\"98811B\", \"Hacienda\"],\r\n  [\"988D77\", \"Pale Oyster\"],\r\n  [\"98FF98\", \"Mint Green\"],\r\n  [\"990066\", \"Fresh Eggplant\"],\r\n  [\"991199\", \"Violet Eggplant\"],\r\n  [\"991613\", \"Tamarillo\"],\r\n  [\"991B07\", \"Totem Pole\"],\r\n  [\"996666\", \"Copper Rose\"],\r\n  [\"9966CC\", \"Amethyst\"],\r\n  [\"997A8D\", \"Mountbatten Pink\"],\r\n  [\"9999CC\", \"Blue Bell\"],\r\n  [\"9A3820\", \"Prairie Sand\"],\r\n  [\"9A6E61\", \"Toast\"],\r\n  [\"9A9577\", \"Gurkha\"],\r\n  [\"9AB973\", \"Olivine\"],\r\n  [\"9AC2B8\", \"Shadow Green\"],\r\n  [\"9B4703\", \"Oregon\"],\r\n  [\"9B9E8F\", \"Lemon Grass\"],\r\n  [\"9C3336\", \"Stiletto\"],\r\n  [\"9D5616\", \"Hawaiian Tan\"],\r\n  [\"9DACB7\", \"Gull Gray\"],\r\n  [\"9DC209\", \"Pistachio\"],\r\n  [\"9DE093\", \"Granny Smith Apple\"],\r\n  [\"9DE5FF\", \"Anakiwa\"],\r\n  [\"9E5302\", \"Chelsea Gem\"],\r\n  [\"9E5B40\", \"Sepia Skin\"],\r\n  [\"9EA587\", \"Sage\"],\r\n  [\"9EA91F\", \"Citron\"],\r\n  [\"9EB1CD\", \"Rock Blue\"],\r\n  [\"9EDEE0\", \"Morning Glory\"],\r\n  [\"9F381D\", \"Cognac\"],\r\n  [\"9F821C\", \"Reef Gold\"],\r\n  [\"9F9F9C\", \"Star Dust\"],\r\n  [\"9FA0B1\", \"Santas Gray\"],\r\n  [\"9FD7D3\", \"Sinbad\"],\r\n  [\"9FDD8C\", \"Feijoa\"],\r\n  [\"A02712\", \"Tabasco\"],\r\n  [\"A1750D\", \"Buttered Rum\"],\r\n  [\"A1ADB5\", \"Hit Gray\"],\r\n  [\"A1C50A\", \"Citrus\"],\r\n  [\"A1DAD7\", \"Aqua Island\"],\r\n  [\"A1E9DE\", \"Water Leaf\"],\r\n  [\"A2006D\", \"Flirt\"],\r\n  [\"A23B6C\", \"Rouge\"],\r\n  [\"A26645\", \"Cape Palliser\"],\r\n  [\"A2AAB3\", \"Gray Chateau\"],\r\n  [\"A2AEAB\", \"Edward\"],\r\n  [\"A3807B\", \"Pharlap\"],\r\n  [\"A397B4\", \"Amethyst Smoke\"],\r\n  [\"A3E3ED\", \"Blizzard Blue\"],\r\n  [\"A4A49D\", \"Delta\"],\r\n  [\"A4A6D3\", \"Wistful\"],\r\n  [\"A4AF6E\", \"Green Smoke\"],\r\n  [\"A50B5E\", \"Jazzberry Jam\"],\r\n  [\"A59B91\", \"Zorba\"],\r\n  [\"A5CB0C\", \"Bahia\"],\r\n  [\"A62F20\", \"Roof Terracotta\"],\r\n  [\"A65529\", \"Paarl\"],\r\n  [\"A68B5B\", \"Barley Corn\"],\r\n  [\"A69279\", \"Donkey Brown\"],\r\n  [\"A6A29A\", \"Dawn\"],\r\n  [\"A72525\", \"Mexican Red\"],\r\n  [\"A7882C\", \"Luxor Gold\"],\r\n  [\"A85307\", \"Rich Gold\"],\r\n  [\"A86515\", \"Reno Sand\"],\r\n  [\"A86B6B\", \"Coral Tree\"],\r\n  [\"A8989B\", \"Dusty Gray\"],\r\n  [\"A899E6\", \"Dull Lavender\"],\r\n  [\"A8A589\", \"Tallow\"],\r\n  [\"A8AE9C\", \"Bud\"],\r\n  [\"A8AF8E\", \"Locust\"],\r\n  [\"A8BD9F\", \"Norway\"],\r\n  [\"A8E3BD\", \"Chinook\"],\r\n  [\"A9A491\", \"Gray Olive\"],\r\n  [\"A9ACB6\", \"Aluminium\"],\r\n  [\"A9B2C3\", \"Cadet Blue\"],\r\n  [\"A9B497\", \"Schist\"],\r\n  [\"A9BDBF\", \"Tower Gray\"],\r\n  [\"A9BEF2\", \"Perano\"],\r\n  [\"A9C6C2\", \"Opal\"],\r\n  [\"AA375A\", \"Night Shadz\"],\r\n  [\"AA4203\", \"Fire\"],\r\n  [\"AA8B5B\", \"Muesli\"],\r\n  [\"AA8D6F\", \"Sandal\"],\r\n  [\"AAA5A9\", \"Shady Lady\"],\r\n  [\"AAA9CD\", \"Logan\"],\r\n  [\"AAABB7\", \"Spun Pearl\"],\r\n  [\"AAD6E6\", \"Regent St Blue\"],\r\n  [\"AAF0D1\", \"Magic Mint\"],\r\n  [\"AB0563\", \"Lipstick\"],\r\n  [\"AB3472\", \"Royal Heath\"],\r\n  [\"AB917A\", \"Sandrift\"],\r\n  [\"ABA0D9\", \"Cold Purple\"],\r\n  [\"ABA196\", \"Bronco\"],\r\n  [\"AC8A56\", \"Limed Oak\"],\r\n  [\"AC91CE\", \"East Side\"],\r\n  [\"AC9E22\", \"Lemon Ginger\"],\r\n  [\"ACA494\", \"Napa\"],\r\n  [\"ACA586\", \"Hillary\"],\r\n  [\"ACA59F\", \"Cloudy\"],\r\n  [\"ACACAC\", \"Silver Chalice\"],\r\n  [\"ACB78E\", \"Swamp Green\"],\r\n  [\"ACCBB1\", \"Spring Rain\"],\r\n  [\"ACDD4D\", \"Conifer\"],\r\n  [\"ACE1AF\", \"Celadon\"],\r\n  [\"AD781B\", \"Mandalay\"],\r\n  [\"ADBED1\", \"Casper\"],\r\n  [\"ADDFAD\", \"Moss Green\"],\r\n  [\"ADE6C4\", \"Padua\"],\r\n  [\"ADFF2F\", \"Green Yellow\"],\r\n  [\"AE4560\", \"Hippie Pink\"],\r\n  [\"AE6020\", \"Desert\"],\r\n  [\"AE809E\", \"Bouquet\"],\r\n  [\"AF4035\", \"Medium Carmine\"],\r\n  [\"AF4D43\", \"Apple Blossom\"],\r\n  [\"AF593E\", \"Brown Rust\"],\r\n  [\"AF8751\", \"Driftwood\"],\r\n  [\"AF8F2C\", \"Alpine\"],\r\n  [\"AF9F1C\", \"Lucky\"],\r\n  [\"AFA09E\", \"Martini\"],\r\n  [\"AFB1B8\", \"Bombay\"],\r\n  [\"AFBDD9\", \"Pigeon Post\"],\r\n  [\"B04C6A\", \"Cadillac\"],\r\n  [\"B05D54\", \"Matrix\"],\r\n  [\"B05E81\", \"Tapestry\"],\r\n  [\"B06608\", \"Mai Tai\"],\r\n  [\"B09A95\", \"Del Rio\"],\r\n  [\"B0E0E6\", \"Powder Blue\"],\r\n  [\"B0E313\", \"Inch Worm\"],\r\n  [\"B10000\", \"Bright Red\"],\r\n  [\"B14A0B\", \"Vesuvius\"],\r\n  [\"B1610B\", \"Pumpkin Skin\"],\r\n  [\"B16D52\", \"Santa Fe\"],\r\n  [\"B19461\", \"Teak\"],\r\n  [\"B1E2C1\", \"Fringy Flower\"],\r\n  [\"B1F4E7\", \"Ice Cold\"],\r\n  [\"B20931\", \"Shiraz\"],\r\n  [\"B2A1EA\", \"Biloba Flower\"],\r\n  [\"B32D29\", \"Tall Poppy\"],\r\n  [\"B35213\", \"Fiery Orange\"],\r\n  [\"B38007\", \"Hot Toddy\"],\r\n  [\"B3AF95\", \"Taupe Gray\"],\r\n  [\"B3C110\", \"La Rioja\"],\r\n  [\"B43332\", \"Well Read\"],\r\n  [\"B44668\", \"Blush\"],\r\n  [\"B4CFD3\", \"Jungle Mist\"],\r\n  [\"B57281\", \"Turkish Rose\"],\r\n  [\"B57EDC\", \"Lavender\"],\r\n  [\"B5A27F\", \"Mongoose\"],\r\n  [\"B5B35C\", \"Olive Green\"],\r\n  [\"B5D2CE\", \"Jet Stream\"],\r\n  [\"B5ECDF\", \"Cruise\"],\r\n  [\"B6316C\", \"Hibiscus\"],\r\n  [\"B69D98\", \"Thatch\"],\r\n  [\"B6B095\", \"Heathered Gray\"],\r\n  [\"B6BAA4\", \"Eagle\"],\r\n  [\"B6D1EA\", \"Spindle\"],\r\n  [\"B6D3BF\", \"Gum Leaf\"],\r\n  [\"B7410E\", \"Rust\"],\r\n  [\"B78E5C\", \"Muddy Waters\"],\r\n  [\"B7A214\", \"Sahara\"],\r\n  [\"B7A458\", \"Husk\"],\r\n  [\"B7B1B1\", \"Nobel\"],\r\n  [\"B7C3D0\", \"Heather\"],\r\n  [\"B7F0BE\", \"Madang\"],\r\n  [\"B81104\", \"Milano Red\"],\r\n  [\"B87333\", \"Copper\"],\r\n  [\"B8B56A\", \"Gimblet\"],\r\n  [\"B8C1B1\", \"Green Spring\"],\r\n  [\"B8C25D\", \"Celery\"],\r\n  [\"B8E0F9\", \"Sail\"],\r\n  [\"B94E48\", \"Chestnut\"],\r\n  [\"B95140\", \"Crail\"],\r\n  [\"B98D28\", \"Marigold\"],\r\n  [\"B9C46A\", \"Wild Willow\"],\r\n  [\"B9C8AC\", \"Rainee\"],\r\n  [\"BA0101\", \"Guardsman Red\"],\r\n  [\"BA450C\", \"Rock Spray\"],\r\n  [\"BA6F1E\", \"Bourbon\"],\r\n  [\"BA7F03\", \"Pirate Gold\"],\r\n  [\"BAB1A2\", \"Nomad\"],\r\n  [\"BAC7C9\", \"Submarine\"],\r\n  [\"BAEEF9\", \"Charlotte\"],\r\n  [\"BB3385\", \"Medium Red Violet\"],\r\n  [\"BB8983\", \"Brandy Rose\"],\r\n  [\"BBD009\", \"Rio Grande\"],\r\n  [\"BBD7C1\", \"Surf\"],\r\n  [\"BCC9C2\", \"Powder Ash\"],\r\n  [\"BD5E2E\", \"Tuscany\"],\r\n  [\"BD978E\", \"Quicksand\"],\r\n  [\"BDB1A8\", \"Silk\"],\r\n  [\"BDB2A1\", \"Malta\"],\r\n  [\"BDB3C7\", \"Chatelle\"],\r\n  [\"BDBBD7\", \"Lavender Gray\"],\r\n  [\"BDBDC6\", \"French Gray\"],\r\n  [\"BDC8B3\", \"Clay Ash\"],\r\n  [\"BDC9CE\", \"Loblolly\"],\r\n  [\"BDEDFD\", \"French Pass\"],\r\n  [\"BEA6C3\", \"London Hue\"],\r\n  [\"BEB5B7\", \"Pink Swan\"],\r\n  [\"BEDE0D\", \"Fuego\"],\r\n  [\"BF5500\", \"Rose of Sharon\"],\r\n  [\"BFB8B0\", \"Tide\"],\r\n  [\"BFBED8\", \"Blue Haze\"],\r\n  [\"BFC1C2\", \"Silver Sand\"],\r\n  [\"BFC921\", \"Key Lime Pie\"],\r\n  [\"BFDBE2\", \"Ziggurat\"],\r\n  [\"BFFF00\", \"Lime\"],\r\n  [\"C02B18\", \"Thunderbird\"],\r\n  [\"C04737\", \"Mojo\"],\r\n  [\"C08081\", \"Old Rose\"],\r\n  [\"C0C0C0\", \"Silver\"],\r\n  [\"C0D3B9\", \"Pale Leaf\"],\r\n  [\"C0D8B6\", \"Pixie Green\"],\r\n  [\"C1440E\", \"Tia Maria\"],\r\n  [\"C154C1\", \"Fuchsia Pink\"],\r\n  [\"C1A004\", \"Buddha Gold\"],\r\n  [\"C1B7A4\", \"Bison Hide\"],\r\n  [\"C1BAB0\", \"Tea\"],\r\n  [\"C1BECD\", \"Gray Suit\"],\r\n  [\"C1D7B0\", \"Sprout\"],\r\n  [\"C1F07C\", \"Sulu\"],\r\n  [\"C26B03\", \"Indochine\"],\r\n  [\"C2955D\", \"Twine\"],\r\n  [\"C2BDB6\", \"Cotton Seed\"],\r\n  [\"C2CAC4\", \"Pumice\"],\r\n  [\"C2E8E5\", \"Jagged Ice\"],\r\n  [\"C32148\", \"Maroon Flush\"],\r\n  [\"C3B091\", \"Indian Khaki\"],\r\n  [\"C3BFC1\", \"Pale Slate\"],\r\n  [\"C3C3BD\", \"Gray Nickel\"],\r\n  [\"C3CDE6\", \"Periwinkle Gray\"],\r\n  [\"C3D1D1\", \"Tiara\"],\r\n  [\"C3DDF9\", \"Tropical Blue\"],\r\n  [\"C41E3A\", \"Cardinal\"],\r\n  [\"C45655\", \"Fuzzy Wuzzy Brown\"],\r\n  [\"C45719\", \"Orange Roughy\"],\r\n  [\"C4C4BC\", \"Mist Gray\"],\r\n  [\"C4D0B0\", \"Coriander\"],\r\n  [\"C4F4EB\", \"Mint Tulip\"],\r\n  [\"C54B8C\", \"Mulberry\"],\r\n  [\"C59922\", \"Nugget\"],\r\n  [\"C5994B\", \"Tussock\"],\r\n  [\"C5DBCA\", \"Sea Mist\"],\r\n  [\"C5E17A\", \"Yellow Green\"],\r\n  [\"C62D42\", \"Brick Red\"],\r\n  [\"C6726B\", \"Contessa\"],\r\n  [\"C69191\", \"Oriental Pink\"],\r\n  [\"C6A84B\", \"Roti\"],\r\n  [\"C6C3B5\", \"Ash\"],\r\n  [\"C6C8BD\", \"Kangaroo\"],\r\n  [\"C6E610\", \"Las Palmas\"],\r\n  [\"C7031E\", \"Monza\"],\r\n  [\"C71585\", \"Red Violet\"],\r\n  [\"C7BCA2\", \"Coral Reef\"],\r\n  [\"C7C1FF\", \"Melrose\"],\r\n  [\"C7C4BF\", \"Cloud\"],\r\n  [\"C7C9D5\", \"Ghost\"],\r\n  [\"C7CD90\", \"Pine Glade\"],\r\n  [\"C7DDE5\", \"Botticelli\"],\r\n  [\"C88A65\", \"Antique Brass\"],\r\n  [\"C8A2C8\", \"Lilac\"],\r\n  [\"C8A528\", \"Hokey Pokey\"],\r\n  [\"C8AABF\", \"Lily\"],\r\n  [\"C8B568\", \"Laser\"],\r\n  [\"C8E3D7\", \"Edgewater\"],\r\n  [\"C96323\", \"Piper\"],\r\n  [\"C99415\", \"Pizza\"],\r\n  [\"C9A0DC\", \"Light Wisteria\"],\r\n  [\"C9B29B\", \"Rodeo Dust\"],\r\n  [\"C9B35B\", \"Sundance\"],\r\n  [\"C9B93B\", \"Earls Green\"],\r\n  [\"C9C0BB\", \"Silver Rust\"],\r\n  [\"C9D9D2\", \"Conch\"],\r\n  [\"C9FFA2\", \"Reef\"],\r\n  [\"C9FFE5\", \"Aero Blue\"],\r\n  [\"CA3435\", \"Flush Mahogany\"],\r\n  [\"CABB48\", \"Turmeric\"],\r\n  [\"CADCD4\", \"Paris White\"],\r\n  [\"CAE00D\", \"Bitter Lemon\"],\r\n  [\"CAE6DA\", \"Skeptic\"],\r\n  [\"CB8FA9\", \"Viola\"],\r\n  [\"CBCAB6\", \"Foggy Gray\"],\r\n  [\"CBD3B0\", \"Green Mist\"],\r\n  [\"CBDBD6\", \"Nebula\"],\r\n  [\"CC3333\", \"Persian Red\"],\r\n  [\"CC5500\", \"Burnt Orange\"],\r\n  [\"CC7722\", \"Ochre\"],\r\n  [\"CC8899\", \"Puce\"],\r\n  [\"CCCAA8\", \"Thistle Green\"],\r\n  [\"CCCCFF\", \"Periwinkle\"],\r\n  [\"CCFF00\", \"Electric Lime\"],\r\n  [\"CD5700\", \"Tenn\"],\r\n  [\"CD5C5C\", \"Chestnut Rose\"],\r\n  [\"CD8429\", \"Brandy Punch\"],\r\n  [\"CDF4FF\", \"Onahau\"],\r\n  [\"CEB98F\", \"Sorrell Brown\"],\r\n  [\"CEBABA\", \"Cold Turkey\"],\r\n  [\"CEC291\", \"Yuma\"],\r\n  [\"CEC7A7\", \"Chino\"],\r\n  [\"CFA39D\", \"Eunry\"],\r\n  [\"CFB53B\", \"Old Gold\"],\r\n  [\"CFDCCF\", \"Tasman\"],\r\n  [\"CFE5D2\", \"Surf Crest\"],\r\n  [\"CFF9F3\", \"Humming Bird\"],\r\n  [\"CFFAF4\", \"Scandal\"],\r\n  [\"D05F04\", \"Red Stage\"],\r\n  [\"D06DA1\", \"Hopbush\"],\r\n  [\"D07D12\", \"Meteor\"],\r\n  [\"D0BEF8\", \"Perfume\"],\r\n  [\"D0C0E5\", \"Prelude\"],\r\n  [\"D0F0C0\", \"Tea Green\"],\r\n  [\"D18F1B\", \"Geebung\"],\r\n  [\"D1BEA8\", \"Vanilla\"],\r\n  [\"D1C6B4\", \"Soft Amber\"],\r\n  [\"D1D2CA\", \"Celeste\"],\r\n  [\"D1D2DD\", \"Mischka\"],\r\n  [\"D1E231\", \"Pear\"],\r\n  [\"D2691E\", \"Hot Cinnamon\"],\r\n  [\"D27D46\", \"Raw Sienna\"],\r\n  [\"D29EAA\", \"Careys Pink\"],\r\n  [\"D2B48C\", \"Tan\"],\r\n  [\"D2DA97\", \"Deco\"],\r\n  [\"D2F6DE\", \"Blue Romance\"],\r\n  [\"D2F8B0\", \"Gossip\"],\r\n  [\"D3CBBA\", \"Sisal\"],\r\n  [\"D3CDC5\", \"Swirl\"],\r\n  [\"D47494\", \"Charm\"],\r\n  [\"D4B6AF\", \"Clam Shell\"],\r\n  [\"D4BF8D\", \"Straw\"],\r\n  [\"D4C4A8\", \"Akaroa\"],\r\n  [\"D4CD16\", \"Bird Flower\"],\r\n  [\"D4D7D9\", \"Iron\"],\r\n  [\"D4DFE2\", \"Geyser\"],\r\n  [\"D4E2FC\", \"Hawkes Blue\"],\r\n  [\"D54600\", \"Grenadier\"],\r\n  [\"D591A4\", \"Can Can\"],\r\n  [\"D59A6F\", \"Whiskey\"],\r\n  [\"D5D195\", \"Winter Hazel\"],\r\n  [\"D5F6E3\", \"Granny Apple\"],\r\n  [\"D69188\", \"My Pink\"],\r\n  [\"D6C562\", \"Tacha\"],\r\n  [\"D6CEF6\", \"Moon Raker\"],\r\n  [\"D6D6D1\", \"Quill Gray\"],\r\n  [\"D6FFDB\", \"Snowy Mint\"],\r\n  [\"D7837F\", \"New York Pink\"],\r\n  [\"D7C498\", \"Pavlova\"],\r\n  [\"D7D0FF\", \"Fog\"],\r\n  [\"D84437\", \"Valencia\"],\r\n  [\"D87C63\", \"Japonica\"],\r\n  [\"D8BFD8\", \"Thistle\"],\r\n  [\"D8C2D5\", \"Maverick\"],\r\n  [\"D8FCFA\", \"Foam\"],\r\n  [\"D94972\", \"Cabaret\"],\r\n  [\"D99376\", \"Burning Sand\"],\r\n  [\"D9B99B\", \"Cameo\"],\r\n  [\"D9D6CF\", \"Timberwolf\"],\r\n  [\"D9DCC1\", \"Tana\"],\r\n  [\"D9E4F5\", \"Link Water\"],\r\n  [\"D9F7FF\", \"Mabel\"],\r\n  [\"DA3287\", \"Cerise\"],\r\n  [\"DA5B38\", \"Flame Pea\"],\r\n  [\"DA6304\", \"Bamboo\"],\r\n  [\"DA6A41\", \"Red Damask\"],\r\n  [\"DA70D6\", \"Orchid\"],\r\n  [\"DA8A67\", \"Copperfield\"],\r\n  [\"DAA520\", \"Golden Grass\"],\r\n  [\"DAECD6\", \"Zanah\"],\r\n  [\"DAF4F0\", \"Iceberg\"],\r\n  [\"DAFAFF\", \"Oyster Bay\"],\r\n  [\"DB5079\", \"Cranberry\"],\r\n  [\"DB9690\", \"Petite Orchid\"],\r\n  [\"DB995E\", \"Di Serria\"],\r\n  [\"DBDBDB\", \"Alto\"],\r\n  [\"DBFFF8\", \"Frosted Mint\"],\r\n  [\"DC143C\", \"Crimson\"],\r\n  [\"DC4333\", \"Punch\"],\r\n  [\"DCB20C\", \"Galliano\"],\r\n  [\"DCB4BC\", \"Blossom\"],\r\n  [\"DCD747\", \"Wattle\"],\r\n  [\"DCD9D2\", \"Westar\"],\r\n  [\"DCDDCC\", \"Moon Mist\"],\r\n  [\"DCEDB4\", \"Caper\"],\r\n  [\"DCF0EA\", \"Swans Down\"],\r\n  [\"DDD6D5\", \"Swiss Coffee\"],\r\n  [\"DDF9F1\", \"White Ice\"],\r\n  [\"DE3163\", \"Cerise Red\"],\r\n  [\"DE6360\", \"Roman\"],\r\n  [\"DEA681\", \"Tumbleweed\"],\r\n  [\"DEBA13\", \"Gold Tips\"],\r\n  [\"DEC196\", \"Brandy\"],\r\n  [\"DECBC6\", \"Wafer\"],\r\n  [\"DED4A4\", \"Sapling\"],\r\n  [\"DED717\", \"Barberry\"],\r\n  [\"DEE5C0\", \"Beryl Green\"],\r\n  [\"DEF5FF\", \"Pattens Blue\"],\r\n  [\"DF73FF\", \"Heliotrope\"],\r\n  [\"DFBE6F\", \"Apache\"],\r\n  [\"DFCD6F\", \"Chenin\"],\r\n  [\"DFCFDB\", \"Lola\"],\r\n  [\"DFECDA\", \"Willow Brook\"],\r\n  [\"DFFF00\", \"Chartreuse Yellow\"],\r\n  [\"E0B0FF\", \"Mauve\"],\r\n  [\"E0B646\", \"Anzac\"],\r\n  [\"E0B974\", \"Harvest Gold\"],\r\n  [\"E0C095\", \"Calico\"],\r\n  [\"E0FFFF\", \"Baby Blue\"],\r\n  [\"E16865\", \"Sunglo\"],\r\n  [\"E1BC64\", \"Equator\"],\r\n  [\"E1C0C8\", \"Pink Flare\"],\r\n  [\"E1E6D6\", \"Periglacial Blue\"],\r\n  [\"E1EAD4\", \"Kidnapper\"],\r\n  [\"E1F6E8\", \"Tara\"],\r\n  [\"E25465\", \"Mandy\"],\r\n  [\"E2725B\", \"Terracotta\"],\r\n  [\"E28913\", \"Golden Bell\"],\r\n  [\"E292C0\", \"Shocking\"],\r\n  [\"E29418\", \"Dixie\"],\r\n  [\"E29CD2\", \"Light Orchid\"],\r\n  [\"E2D8ED\", \"Snuff\"],\r\n  [\"E2EBED\", \"Mystic\"],\r\n  [\"E2F3EC\", \"Apple Green\"],\r\n  [\"E30B5C\", \"Razzmatazz\"],\r\n  [\"E32636\", \"Alizarin Crimson\"],\r\n  [\"E34234\", \"Cinnabar\"],\r\n  [\"E3BEBE\", \"Cavern Pink\"],\r\n  [\"E3F5E1\", \"Peppermint\"],\r\n  [\"E3F988\", \"Mindaro\"],\r\n  [\"E47698\", \"Deep Blush\"],\r\n  [\"E49B0F\", \"Gamboge\"],\r\n  [\"E4C2D5\", \"Melanie\"],\r\n  [\"E4CFDE\", \"Twilight\"],\r\n  [\"E4D1C0\", \"Bone\"],\r\n  [\"E4D422\", \"Sunflower\"],\r\n  [\"E4D5B7\", \"Grain Brown\"],\r\n  [\"E4D69B\", \"Zombie\"],\r\n  [\"E4F6E7\", \"Frostee\"],\r\n  [\"E4FFD1\", \"Snow Flurry\"],\r\n  [\"E52B50\", \"Amaranth\"],\r\n  [\"E5841B\", \"Zest\"],\r\n  [\"E5CCC9\", \"Dust Storm\"],\r\n  [\"E5D7BD\", \"Stark White\"],\r\n  [\"E5D8AF\", \"Hampton\"],\r\n  [\"E5E0E1\", \"Bon Jour\"],\r\n  [\"E5E5E5\", \"Mercury\"],\r\n  [\"E5F9F6\", \"Polar\"],\r\n  [\"E64E03\", \"Trinidad\"],\r\n  [\"E6BE8A\", \"Gold Sand\"],\r\n  [\"E6BEA5\", \"Cashmere\"],\r\n  [\"E6D7B9\", \"Double Spanish White\"],\r\n  [\"E6E4D4\", \"Satin Linen\"],\r\n  [\"E6F2EA\", \"Harp\"],\r\n  [\"E6F8F3\", \"Off Green\"],\r\n  [\"E6FFE9\", \"Hint of Green\"],\r\n  [\"E6FFFF\", \"Tranquil\"],\r\n  [\"E77200\", \"Mango Tango\"],\r\n  [\"E7730A\", \"Christine\"],\r\n  [\"E79F8C\", \"Tonys Pink\"],\r\n  [\"E79FC4\", \"Kobi\"],\r\n  [\"E7BCB4\", \"Rose Fog\"],\r\n  [\"E7BF05\", \"Corn\"],\r\n  [\"E7CD8C\", \"Putty\"],\r\n  [\"E7ECE6\", \"Gray Nurse\"],\r\n  [\"E7F8FF\", \"Lily White\"],\r\n  [\"E7FEFF\", \"Bubbles\"],\r\n  [\"E89928\", \"Fire Bush\"],\r\n  [\"E8B9B3\", \"Shilo\"],\r\n  [\"E8E0D5\", \"Pearl Bush\"],\r\n  [\"E8EBE0\", \"Green White\"],\r\n  [\"E8F1D4\", \"Chrome White\"],\r\n  [\"E8F2EB\", \"Gin\"],\r\n  [\"E8F5F2\", \"Aqua Squeeze\"],\r\n  [\"E96E00\", \"Clementine\"],\r\n  [\"E97451\", \"Burnt Sienna\"],\r\n  [\"E97C07\", \"Tahiti Gold\"],\r\n  [\"E9CECD\", \"Oyster Pink\"],\r\n  [\"E9D75A\", \"Confetti\"],\r\n  [\"E9E3E3\", \"Ebb\"],\r\n  [\"E9F8ED\", \"Ottoman\"],\r\n  [\"E9FFFD\", \"Clear Day\"],\r\n  [\"EA88A8\", \"Carissma\"],\r\n  [\"EAAE69\", \"Porsche\"],\r\n  [\"EAB33B\", \"Tulip Tree\"],\r\n  [\"EAC674\", \"Rob Roy\"],\r\n  [\"EADAB8\", \"Raffia\"],\r\n  [\"EAE8D4\", \"White Rock\"],\r\n  [\"EAF6EE\", \"Panache\"],\r\n  [\"EAF6FF\", \"Solitude\"],\r\n  [\"EAF9F5\", \"Aqua Spring\"],\r\n  [\"EAFFFE\", \"Dew\"],\r\n  [\"EB9373\", \"Apricot\"],\r\n  [\"EBC2AF\", \"Zinnwaldite\"],\r\n  [\"ECA927\", \"Fuel Yellow\"],\r\n  [\"ECC54E\", \"Ronchi\"],\r\n  [\"ECC7EE\", \"French Lilac\"],\r\n  [\"ECCDB9\", \"Just Right\"],\r\n  [\"ECE090\", \"Wild Rice\"],\r\n  [\"ECEBBD\", \"Fall Green\"],\r\n  [\"ECEBCE\", \"Aths Special\"],\r\n  [\"ECF245\", \"Starship\"],\r\n  [\"ED0A3F\", \"Red Ribbon\"],\r\n  [\"ED7A1C\", \"Tango\"],\r\n  [\"ED9121\", \"Carrot Orange\"],\r\n  [\"ED989E\", \"Sea Pink\"],\r\n  [\"EDB381\", \"Tacao\"],\r\n  [\"EDC9AF\", \"Desert Sand\"],\r\n  [\"EDCDAB\", \"Pancho\"],\r\n  [\"EDDCB1\", \"Chamois\"],\r\n  [\"EDEA99\", \"Primrose\"],\r\n  [\"EDF5DD\", \"Frost\"],\r\n  [\"EDF5F5\", \"Aqua Haze\"],\r\n  [\"EDF6FF\", \"Zumthor\"],\r\n  [\"EDF9F1\", \"Narvik\"],\r\n  [\"EDFC84\", \"Honeysuckle\"],\r\n  [\"EE82EE\", \"Lavender Magenta\"],\r\n  [\"EEC1BE\", \"Beauty Bush\"],\r\n  [\"EED794\", \"Chalky\"],\r\n  [\"EED9C4\", \"Almond\"],\r\n  [\"EEDC82\", \"Flax\"],\r\n  [\"EEDEDA\", \"Bizarre\"],\r\n  [\"EEE3AD\", \"Double Colonial White\"],\r\n  [\"EEEEE8\", \"Cararra\"],\r\n  [\"EEEF78\", \"Manz\"],\r\n  [\"EEF0C8\", \"Tahuna Sands\"],\r\n  [\"EEF0F3\", \"Athens Gray\"],\r\n  [\"EEF3C3\", \"Tusk\"],\r\n  [\"EEF4DE\", \"Loafer\"],\r\n  [\"EEF6F7\", \"Catskill White\"],\r\n  [\"EEFDFF\", \"Twilight Blue\"],\r\n  [\"EEFF9A\", \"Jonquil\"],\r\n  [\"EEFFE2\", \"Rice Flower\"],\r\n  [\"EF863F\", \"Jaffa\"],\r\n  [\"EFEFEF\", \"Gallery\"],\r\n  [\"EFF2F3\", \"Porcelain\"],\r\n  [\"F091A9\", \"Mauvelous\"],\r\n  [\"F0D52D\", \"Golden Dream\"],\r\n  [\"F0DB7D\", \"Golden Sand\"],\r\n  [\"F0DC82\", \"Buff\"],\r\n  [\"F0E2EC\", \"Prim\"],\r\n  [\"F0E68C\", \"Khaki\"],\r\n  [\"F0EEFD\", \"Selago\"],\r\n  [\"F0EEFF\", \"Titan White\"],\r\n  [\"F0F8FF\", \"Alice Blue\"],\r\n  [\"F0FCEA\", \"Feta\"],\r\n  [\"F18200\", \"Gold Drop\"],\r\n  [\"F19BAB\", \"Wewak\"],\r\n  [\"F1E788\", \"Sahara Sand\"],\r\n  [\"F1E9D2\", \"Parchment\"],\r\n  [\"F1E9FF\", \"Blue Chalk\"],\r\n  [\"F1EEC1\", \"Mint Julep\"],\r\n  [\"F1F1F1\", \"Seashell\"],\r\n  [\"F1F7F2\", \"Saltpan\"],\r\n  [\"F1FFAD\", \"Tidal\"],\r\n  [\"F1FFC8\", \"Chiffon\"],\r\n  [\"F2552A\", \"Flamingo\"],\r\n  [\"F28500\", \"Tangerine\"],\r\n  [\"F2C3B2\", \"Mandys Pink\"],\r\n  [\"F2F2F2\", \"Concrete\"],\r\n  [\"F2FAFA\", \"Black Squeeze\"],\r\n  [\"F34723\", \"Pomegranate\"],\r\n  [\"F3AD16\", \"Buttercup\"],\r\n  [\"F3D69D\", \"New Orleans\"],\r\n  [\"F3D9DF\", \"Vanilla Ice\"],\r\n  [\"F3E7BB\", \"Sidecar\"],\r\n  [\"F3E9E5\", \"Dawn Pink\"],\r\n  [\"F3EDCF\", \"Wheatfield\"],\r\n  [\"F3FB62\", \"Canary\"],\r\n  [\"F3FBD4\", \"Orinoco\"],\r\n  [\"F3FFD8\", \"Carla\"],\r\n  [\"F400A1\", \"Hollywood Cerise\"],\r\n  [\"F4A460\", \"Sandy brown\"],\r\n  [\"F4C430\", \"Saffron\"],\r\n  [\"F4D81C\", \"Ripe Lemon\"],\r\n  [\"F4EBD3\", \"Janna\"],\r\n  [\"F4F2EE\", \"Pampas\"],\r\n  [\"F4F4F4\", \"Wild Sand\"],\r\n  [\"F4F8FF\", \"Zircon\"],\r\n  [\"F57584\", \"Froly\"],\r\n  [\"F5C85C\", \"Cream Can\"],\r\n  [\"F5C999\", \"Manhattan\"],\r\n  [\"F5D5A0\", \"Maize\"],\r\n  [\"F5DEB3\", \"Wheat\"],\r\n  [\"F5E7A2\", \"Sandwisp\"],\r\n  [\"F5E7E2\", \"Pot Pourri\"],\r\n  [\"F5E9D3\", \"Albescent White\"],\r\n  [\"F5EDEF\", \"Soft Peach\"],\r\n  [\"F5F3E5\", \"Ecru White\"],\r\n  [\"F5F5DC\", \"Beige\"],\r\n  [\"F5FB3D\", \"Golden Fizz\"],\r\n  [\"F5FFBE\", \"Australian Mint\"],\r\n  [\"F64A8A\", \"French Rose\"],\r\n  [\"F653A6\", \"Brilliant Rose\"],\r\n  [\"F6A4C9\", \"Illusion\"],\r\n  [\"F6F0E6\", \"Merino\"],\r\n  [\"F6F7F7\", \"Black Haze\"],\r\n  [\"F6FFDC\", \"Spring Sun\"],\r\n  [\"F7468A\", \"Violet Red\"],\r\n  [\"F77703\", \"Chilean Fire\"],\r\n  [\"F77FBE\", \"Persian Pink\"],\r\n  [\"F7B668\", \"Rajah\"],\r\n  [\"F7C8DA\", \"Azalea\"],\r\n  [\"F7DBE6\", \"We Peep\"],\r\n  [\"F7F2E1\", \"Quarter Spanish White\"],\r\n  [\"F7F5FA\", \"Whisper\"],\r\n  [\"F7FAF7\", \"Snow Drift\"],\r\n  [\"F8B853\", \"Casablanca\"],\r\n  [\"F8C3DF\", \"Chantilly\"],\r\n  [\"F8D9E9\", \"Cherub\"],\r\n  [\"F8DB9D\", \"Marzipan\"],\r\n  [\"F8DD5C\", \"Energy Yellow\"],\r\n  [\"F8E4BF\", \"Givry\"],\r\n  [\"F8F0E8\", \"White Linen\"],\r\n  [\"F8F4FF\", \"Magnolia\"],\r\n  [\"F8F6F1\", \"Spring Wood\"],\r\n  [\"F8F7DC\", \"Coconut Cream\"],\r\n  [\"F8F7FC\", \"White Lilac\"],\r\n  [\"F8F8F7\", \"Desert Storm\"],\r\n  [\"F8F99C\", \"Texas\"],\r\n  [\"F8FACD\", \"Corn Field\"],\r\n  [\"F8FDD3\", \"Mimosa\"],\r\n  [\"F95A61\", \"Carnation\"],\r\n  [\"F9BF58\", \"Saffron Mango\"],\r\n  [\"F9E0ED\", \"Carousel Pink\"],\r\n  [\"F9E4BC\", \"Dairy Cream\"],\r\n  [\"F9E663\", \"Portica\"],\r\n  [\"F9EAF3\", \"Amour\"],\r\n  [\"F9F8E4\", \"Rum Swizzle\"],\r\n  [\"F9FF8B\", \"Dolly\"],\r\n  [\"F9FFF6\", \"Sugar Cane\"],\r\n  [\"FA7814\", \"Ecstasy\"],\r\n  [\"FA9D5A\", \"Tan Hide\"],\r\n  [\"FAD3A2\", \"Corvette\"],\r\n  [\"FADFAD\", \"Peach Yellow\"],\r\n  [\"FAE600\", \"Turbo\"],\r\n  [\"FAEAB9\", \"Astra\"],\r\n  [\"FAECCC\", \"Champagne\"],\r\n  [\"FAF0E6\", \"Linen\"],\r\n  [\"FAF3F0\", \"Fantasy\"],\r\n  [\"FAF7D6\", \"Citrine White\"],\r\n  [\"FAFAFA\", \"Alabaster\"],\r\n  [\"FAFDE4\", \"Hint of Yellow\"],\r\n  [\"FAFFA4\", \"Milan\"],\r\n  [\"FB607F\", \"Brink Pink\"],\r\n  [\"FB8989\", \"Geraldine\"],\r\n  [\"FBA0E3\", \"Lavender Rose\"],\r\n  [\"FBA129\", \"Sea Buckthorn\"],\r\n  [\"FBAC13\", \"Sun\"],\r\n  [\"FBAED2\", \"Lavender Pink\"],\r\n  [\"FBB2A3\", \"Rose Bud\"],\r\n  [\"FBBEDA\", \"Cupid\"],\r\n  [\"FBCCE7\", \"Classic Rose\"],\r\n  [\"FBCEB1\", \"Apricot Peach\"],\r\n  [\"FBE7B2\", \"Banana Mania\"],\r\n  [\"FBE870\", \"Marigold Yellow\"],\r\n  [\"FBE96C\", \"Festival\"],\r\n  [\"FBEA8C\", \"Sweet Corn\"],\r\n  [\"FBEC5D\", \"Candy Corn\"],\r\n  [\"FBF9F9\", \"Hint of Red\"],\r\n  [\"FBFFBA\", \"Shalimar\"],\r\n  [\"FC0FC0\", \"Shocking Pink\"],\r\n  [\"FC80A5\", \"Tickle Me Pink\"],\r\n  [\"FC9C1D\", \"Tree Poppy\"],\r\n  [\"FCC01E\", \"Lightning Yellow\"],\r\n  [\"FCD667\", \"Goldenrod\"],\r\n  [\"FCD917\", \"Candlelight\"],\r\n  [\"FCDA98\", \"Cherokee\"],\r\n  [\"FCF4D0\", \"Double Pearl Lusta\"],\r\n  [\"FCF4DC\", \"Pearl Lusta\"],\r\n  [\"FCF8F7\", \"Vista White\"],\r\n  [\"FCFBF3\", \"Bianca\"],\r\n  [\"FCFEDA\", \"Moon Glow\"],\r\n  [\"FCFFE7\", \"China Ivory\"],\r\n  [\"FCFFF9\", \"Ceramic\"],\r\n  [\"FD0E35\", \"Torch Red\"],\r\n  [\"FD5B78\", \"Wild Watermelon\"],\r\n  [\"FD7B33\", \"Crusta\"],\r\n  [\"FD7C07\", \"Sorbus\"],\r\n  [\"FD9FA2\", \"Sweet Pink\"],\r\n  [\"FDD5B1\", \"Light Apricot\"],\r\n  [\"FDD7E4\", \"Pig Pink\"],\r\n  [\"FDE1DC\", \"Cinderella\"],\r\n  [\"FDE295\", \"Golden Glow\"],\r\n  [\"FDE910\", \"Lemon\"],\r\n  [\"FDF5E6\", \"Old Lace\"],\r\n  [\"FDF6D3\", \"Half Colonial White\"],\r\n  [\"FDF7AD\", \"Drover\"],\r\n  [\"FDFEB8\", \"Pale Prim\"],\r\n  [\"FDFFD5\", \"Cumulus\"],\r\n  [\"FE28A2\", \"Persian Rose\"],\r\n  [\"FE4C40\", \"Sunset Orange\"],\r\n  [\"FE6F5E\", \"Bittersweet\"],\r\n  [\"FE9D04\", \"California\"],\r\n  [\"FEA904\", \"Yellow Sea\"],\r\n  [\"FEBAAD\", \"Melon\"],\r\n  [\"FED33C\", \"Bright Sun\"],\r\n  [\"FED85D\", \"Dandelion\"],\r\n  [\"FEDB8D\", \"Salomie\"],\r\n  [\"FEE5AC\", \"Cape Honey\"],\r\n  [\"FEEBF3\", \"Remy\"],\r\n  [\"FEEFCE\", \"Oasis\"],\r\n  [\"FEF0EC\", \"Bridesmaid\"],\r\n  [\"FEF2C7\", \"Beeswax\"],\r\n  [\"FEF3D8\", \"Bleach White\"],\r\n  [\"FEF4CC\", \"Pipi\"],\r\n  [\"FEF4DB\", \"Half Spanish White\"],\r\n  [\"FEF4F8\", \"Wisp Pink\"],\r\n  [\"FEF5F1\", \"Provincial Pink\"],\r\n  [\"FEF7DE\", \"Half Dutch White\"],\r\n  [\"FEF8E2\", \"Solitaire\"],\r\n  [\"FEF8FF\", \"White Pointer\"],\r\n  [\"FEF9E3\", \"Off Yellow\"],\r\n  [\"FEFCED\", \"Orange White\"],\r\n  [\"FF0000\", \"Red\"],\r\n  [\"FF007F\", \"Rose\"],\r\n  [\"FF00CC\", \"Purple Pizzazz\"],\r\n  [\"FF00FF\", \"Magenta / Fuchsia\"],\r\n  [\"FF2400\", \"Scarlet\"],\r\n  [\"FF3399\", \"Wild Strawberry\"],\r\n  [\"FF33CC\", \"Razzle Dazzle Rose\"],\r\n  [\"FF355E\", \"Radical Red\"],\r\n  [\"FF3F34\", \"Red Orange\"],\r\n  [\"FF4040\", \"Coral Red\"],\r\n  [\"FF4D00\", \"Vermilion\"],\r\n  [\"FF4F00\", \"International Orange\"],\r\n  [\"FF6037\", \"Outrageous Orange\"],\r\n  [\"FF6600\", \"Blaze Orange\"],\r\n  [\"FF66FF\", \"Pink Flamingo\"],\r\n  [\"FF681F\", \"Orange\"],\r\n  [\"FF69B4\", \"Hot Pink\"],\r\n  [\"FF6B53\", \"Persimmon\"],\r\n  [\"FF6FFF\", \"Blush Pink\"],\r\n  [\"FF7034\", \"Burning Orange\"],\r\n  [\"FF7518\", \"Pumpkin\"],\r\n  [\"FF7D07\", \"Flamenco\"],\r\n  [\"FF7F00\", \"Flush Orange\"],\r\n  [\"FF7F50\", \"Coral\"],\r\n  [\"FF8C69\", \"Salmon\"],\r\n  [\"FF9000\", \"Pizazz\"],\r\n  [\"FF910F\", \"West Side\"],\r\n  [\"FF91A4\", \"Pink Salmon\"],\r\n  [\"FF9933\", \"Neon Carrot\"],\r\n  [\"FF9966\", \"Atomic Tangerine\"],\r\n  [\"FF9980\", \"Vivid Tangerine\"],\r\n  [\"FF9E2C\", \"Sunshade\"],\r\n  [\"FFA000\", \"Orange Peel\"],\r\n  [\"FFA194\", \"Mona Lisa\"],\r\n  [\"FFA500\", \"Web Orange\"],\r\n  [\"FFA6C9\", \"Carnation Pink\"],\r\n  [\"FFAB81\", \"Hit Pink\"],\r\n  [\"FFAE42\", \"Yellow Orange\"],\r\n  [\"FFB0AC\", \"Cornflower Lilac\"],\r\n  [\"FFB1B3\", \"Sundown\"],\r\n  [\"FFB31F\", \"My Sin\"],\r\n  [\"FFB555\", \"Texas Rose\"],\r\n  [\"FFB7D5\", \"Cotton Candy\"],\r\n  [\"FFB97B\", \"Macaroni and Cheese\"],\r\n  [\"FFBA00\", \"Selective Yellow\"],\r\n  [\"FFBD5F\", \"Koromiko\"],\r\n  [\"FFBF00\", \"Amber\"],\r\n  [\"FFC0A8\", \"Wax Flower\"],\r\n  [\"FFC0CB\", \"Pink\"],\r\n  [\"FFC3C0\", \"Your Pink\"],\r\n  [\"FFC901\", \"Supernova\"],\r\n  [\"FFCBA4\", \"Flesh\"],\r\n  [\"FFCC33\", \"Sunglow\"],\r\n  [\"FFCC5C\", \"Golden Tainoi\"],\r\n  [\"FFCC99\", \"Peach Orange\"],\r\n  [\"FFCD8C\", \"Chardonnay\"],\r\n  [\"FFD1DC\", \"Pastel Pink\"],\r\n  [\"FFD2B7\", \"Romantic\"],\r\n  [\"FFD38C\", \"Grandis\"],\r\n  [\"FFD700\", \"Gold\"],\r\n  [\"FFD800\", \"School bus Yellow\"],\r\n  [\"FFD8D9\", \"Cosmos\"],\r\n  [\"FFDB58\", \"Mustard\"],\r\n  [\"FFDCD6\", \"Peach Schnapps\"],\r\n  [\"FFDDAF\", \"Caramel\"],\r\n  [\"FFDDCD\", \"Tuft Bush\"],\r\n  [\"FFDDCF\", \"Watusi\"],\r\n  [\"FFDDF4\", \"Pink Lace\"],\r\n  [\"FFDEAD\", \"Navajo White\"],\r\n  [\"FFDEB3\", \"Frangipani\"],\r\n  [\"FFE1DF\", \"Pippin\"],\r\n  [\"FFE1F2\", \"Pale Rose\"],\r\n  [\"FFE2C5\", \"Negroni\"],\r\n  [\"FFE5A0\", \"Cream Brulee\"],\r\n  [\"FFE5B4\", \"Peach\"],\r\n  [\"FFE6C7\", \"Tequila\"],\r\n  [\"FFE772\", \"Kournikova\"],\r\n  [\"FFEAC8\", \"Sandy Beach\"],\r\n  [\"FFEAD4\", \"Karry\"],\r\n  [\"FFEC13\", \"Broom\"],\r\n  [\"FFEDBC\", \"Colonial White\"],\r\n  [\"FFEED8\", \"Derby\"],\r\n  [\"FFEFA1\", \"Vis Vis\"],\r\n  [\"FFEFC1\", \"Egg White\"],\r\n  [\"FFEFD5\", \"Papaya Whip\"],\r\n  [\"FFEFEC\", \"Fair Pink\"],\r\n  [\"FFF0DB\", \"Peach Cream\"],\r\n  [\"FFF0F5\", \"Lavender blush\"],\r\n  [\"FFF14F\", \"Gorse\"],\r\n  [\"FFF1B5\", \"Buttermilk\"],\r\n  [\"FFF1D8\", \"Pink Lady\"],\r\n  [\"FFF1EE\", \"Forget Me Not\"],\r\n  [\"FFF1F9\", \"Tutu\"],\r\n  [\"FFF39D\", \"Picasso\"],\r\n  [\"FFF3F1\", \"Chardon\"],\r\n  [\"FFF46E\", \"Paris Daisy\"],\r\n  [\"FFF4CE\", \"Barley White\"],\r\n  [\"FFF4DD\", \"Egg Sour\"],\r\n  [\"FFF4E0\", \"Sazerac\"],\r\n  [\"FFF4E8\", \"Serenade\"],\r\n  [\"FFF4F3\", \"Chablis\"],\r\n  [\"FFF5EE\", \"Seashell Peach\"],\r\n  [\"FFF5F3\", \"Sauvignon\"],\r\n  [\"FFF6D4\", \"Milk Punch\"],\r\n  [\"FFF6DF\", \"Varden\"],\r\n  [\"FFF6F5\", \"Rose White\"],\r\n  [\"FFF8D1\", \"Baja White\"],\r\n  [\"FFF9E2\", \"Gin Fizz\"],\r\n  [\"FFF9E6\", \"Early Dawn\"],\r\n  [\"FFFACD\", \"Lemon Chiffon\"],\r\n  [\"FFFAF4\", \"Bridal Heath\"],\r\n  [\"FFFBDC\", \"Scotch Mist\"],\r\n  [\"FFFBF9\", \"Soapstone\"],\r\n  [\"FFFC99\", \"Witch Haze\"],\r\n  [\"FFFCEA\", \"Buttery White\"],\r\n  [\"FFFCEE\", \"Island Spice\"],\r\n  [\"FFFDD0\", \"Cream\"],\r\n  [\"FFFDE6\", \"Chilean Heath\"],\r\n  [\"FFFDE8\", \"Travertine\"],\r\n  [\"FFFDF3\", \"Orchid White\"],\r\n  [\"FFFDF4\", \"Quarter Pearl Lusta\"],\r\n  [\"FFFEE1\", \"Half and Half\"],\r\n  [\"FFFEEC\", \"Apricot White\"],\r\n  [\"FFFEF0\", \"Rice Cake\"],\r\n  [\"FFFEF6\", \"Black White\"],\r\n  [\"FFFEFD\", \"Romance\"],\r\n  [\"FFFF00\", \"Yellow\"],\r\n  [\"FFFF66\", \"Laser Lemon\"],\r\n  [\"FFFF99\", \"Pale Canary\"],\r\n  [\"FFFFB4\", \"Portafino\"],\r\n  [\"FFFFF0\", \"Ivory\"],\r\n  [\"FFFFFF\", \"White\"]\r\n  ]\r\n  \r\n  }\r\n  \r\n  ntc.init();\r\n  \n\n;/* === client/codemirror.jslint.js === */\n/*jslint browser*/\r\nconst CodeMirror = window.CodeMirror;\r\n\r\nfunction validator(text, options) {\r\n    let data = jslint(text, options, options.globals);\r\n    let warnings = data.warnings;\r\n    let output = [];\r\n\r\n    if (data.stop) {\r\n        output.push({\r\n            message: \"JSLint was unable to finish.\",\r\n            severity: \"warning\",\r\n            from: new CodeMirror.Pos(0, 0),\r\n            to: new CodeMirror.Pos(0, 0)\r\n        });\r\n    }\r\n\r\n    warnings.forEach(function (warning) {\r\n        output.push({\r\n            message: warning.message,\r\n            severity: \"error\",\r\n            from: new CodeMirror.Pos(warning.line - 1, warning.column - 1),\r\n            to: new CodeMirror.Pos(warning.line - 1, warning.column + 1)\r\n        });\r\n    });\r\n\r\n    return output;\r\n}\r\n\r\nCodeMirror.registerHelper(\"lint\", \"javascript\", validator);\r\n\n\n;/* === client/bbscript.js === */\n\r\nwindow.bbConverter = {\r\n\tpatterns : [\r\n\t\t{exp:/\\[ul(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/ul(?:\\s*)\\]/gi,replace:\"<ul>$1</ul>\"},\r\n\t\t{exp:/\\[ol(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/ol(?:\\s*)\\]/gi,replace:\"<ol>$1</ol>\"},\r\n\t\t{exp:/\\[li(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/li(?:\\s*)\\]/gi,replace:\"<li>$1</li>\"},\r\n\t\t{exp:/\\[b(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/b(?:\\s*)\\]/gi,replace:\"<b>$1</b>\"},\r\n\t\t{exp:/\\[p(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/p(?:\\s*)\\]/gi,replace:\"<p>$1</p>\"},\r\n\t\t{exp:/\\[div(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/div(?:\\s*)\\]/gi,replace:\"<div>$1</div>\"},\r\n\t\t{exp:/\\[p class=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/p(?:\\s*)\\]/gi,replace:\"<p class = \\\"$1\\\">$3</p>\"},\r\n\t\t{exp:/\\[div class=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/div(?:\\s*)\\]/gi,replace:\"<div class = \\\"$1\\\">$3</div>\"},\r\n\t\t{exp:/\\[div style=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/div(?:\\s*)\\]/gi,replace:\"<div style = \\\"$1\\\">$3</div>\"},\r\n\t\t{exp:/\\[blockquote(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/blockquote(?:\\s*)\\]/gi,replace:\"<blockquote>$1</blockquote>\"},\r\n\t\t{exp:/\\[h1(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/h1(?:\\s*)\\]/gi,replace:\"<h1>$1</h1>\"},\r\n\t\t{exp:/\\[h2(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/h2(?:\\s*)\\]/gi,replace:\"<h2>$1</h2>\"},\r\n\t\t{exp:/\\[h3(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/h3(?:\\s*)\\]/gi,replace:\"<h3>$1</h3>\"},\r\n\t\t{exp:/\\[h4(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/h4(?:\\s*)\\]/gi,replace:\"<h4>$1</h4>\"},\r\n\t\t{exp:/\\[h5(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/h5(?:\\s*)\\]/gi,replace:\"<h5>$1</h5>\"},\r\n\t\t{exp:/\\[i(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/i(?:\\s*)\\]/gi,replace:\"<i>$1</i>\"},\r\n\t\t{exp:/\\[s(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/s(?:\\s*)\\]/gi,replace:\"<strike>$1</strike>\"},\r\n\t\r\n\t\t{exp:/\\[url(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/url(?:\\s*)\\]/gi,replace:\"<a href=\\\"$1\\\" target=\\\"_blank\\\" title=\\\"$1\\\">$1</a>\"},\r\n\t\t{exp:/\\[url=\\\"\\\"((.|\\n|\\r)*?)(?:\\s*)\\\"\\\"\\]((.|\\n|\\r)*?)\\[\\/url(?:\\s*)\\]/gi,replace:\"<a href=\\\"$1\\\" target=\\\"_blank\\\" title=\\\"$1\\\">$3</a>\"},\r\n\t\t{exp:/\\[url=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/url(?:\\s*)\\]/gi,replace:\"<a href=\\\"$1\\\" target=\\\"_blank\\\" title=\\\"$1\\\">$3</a>\"},\r\n\t\r\n\t\t{exp:/\\[img align=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/img(?:\\s*)\\]/gi,replace:\"<img src=\\\"$3\\\" border=\\\"0\\\" align=\\\"$1\\\" alt=\\\"\\\" />\"},\r\n\t\t{exp:/\\[img class=((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/img(?:\\s*)\\]/gi,replace:\"<img src=\\\"$3\\\" border=\\\"0\\\" class=\\\"$1\\\" alt=\\\"\\\" />\"},\r\n\t\t{exp:/\\[img(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/img(?:\\s*)\\]/gi,replace:\"<img src=\\\"$1\\\" border=\\\"0\\\" alt=\\\"\\\" />\"},\r\n\t\t{exp:/\\[img=((.|\\n|\\r)*?)x((.|\\n|\\r)*?)(?:\\s*)\\]((.|\\n|\\r)*?)\\[\\/img(?:\\s*)\\]/gi,replace:\"<img width=\\\"$1\\\" height=\\\"$3\\\" src=\\\"$5\\\" border=\\\"0\\\" alt=\\\"\\\" />\"}\r\n\t],\r\n\r\n\tlimitAttr : ['class', 'style', 'border', 'align', 'alt', 'type', 'src', 'width', 'height', 'title', 'target'],\r\n\r\n\tmInto : function(s){\r\n\t\tvar x = (new DOMParser()).parseFromString(\"<div>\" + bbConverter.import(s) + \"</div>\", \"text/xml\");\r\n\t\tif(!x || x.documentElement == null){\r\n\t\t\tconsole.error(\"Failed to parse \" + s);\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn bbConverter.mCurse(x.documentElement);\t\t\t\t\r\n\t},\r\n\tmProp : function(o){\r\n\t\tlet attr = bbConverter.limitAttr;\r\n\t\tlet prop = {};\r\n\t\tattr.forEach((a)=>{\r\n\t\t\tif(o.hasAttribute(a)) prop[a] = o.getAttribute(a);\r\n\t\t});\r\n\t\treturn prop;\r\n\t},\r\n\tmCurse : function(o){\r\n\t\tlet a = [];\r\n\t\tif(!o) return a;\r\n\t\tfor(let i = 0; i < o.childNodes.length; i++){\r\n\t\t\tlet node = o.childNodes[i];\r\n\t\t\tswitch(node.nodeType){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\ta.push(m(node.nodeName, bbConverter.mProp(node), bbConverter.mCurse(node)));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\ta.push(node.nodeValue);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn a;\r\n\t},\r\n\r\n\tcopyInto : function(s, o, b){\r\n\t\tvar x = (new DOMParser()).parseFromString(\"<div>\" + bbConverter.import(s) + \"</div>\", \"text/xml\");\r\n\t\tif(!x || x.documentElement == null){\r\n\t\t\tconsole.error(\"Failed to parse \" + s);\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tfor(var i = 0; i < x.documentElement.childNodes.length;i++){\r\n\t\t\tpage.setInnerXHTML(o, x.documentElement.childNodes[i],(i==0 ? b : 1));\r\n\t\t}\r\n\t\treturn 1;\r\n\t},\r\n\timport : function(s){\r\n\t\tvar aP = bbConverter.patterns;\r\n\t\tfor(var i = 0; i < aP.length;i++){\r\n\t\t\twhile(s.match(aP[i].exp)){\r\n\t\t\t\ts = s.replace(aP[i].exp, aP[i].replace);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn s;\r\n\t},\r\n\tconvert : function(o){\r\n\t   var r = \"\";\r\n\t   if(typeof o == \"string\") return o;\r\n\t   if(typeof o.nodeType != \"number\") return \"[error]\";\r\n\t   switch(o.nodeType){\r\n\t   \t\tcase 1:\r\n\t   \t\t\tr = bbConverter.node(o);\r\n\t\t   break;\r\n\t      case 3:\r\n\t           r = o.nodeValue;\r\n\t   \t       //r = r.replace(/[\\s]{2,}/gi,\" \"),\r\n\t   \t       r = r.replace(/&nbsp;/gi,\" \");\r\n\t           break;\r\n\t   }\r\n\t   return r;\r\n\t\r\n\t},\r\n\r\n\tconvertNodes : function(a){\r\n\t   var aa = [];\r\n\t   for(var i = 0; i < a.length; i++){\r\n\t       aa.push(bbConverter.convert(a[i]));\r\n\t   }\r\n\t   return aa.join(\"\").trim();\r\n\t},\r\n\r\n\tnode : function(o){\r\n\t\tvar s = \"\";\r\n\t\tif(typeof o != \"object\" || o == null || o.nodeType != 1) return s;\r\n\t\tvar sStart = \"\";\r\n\t\tvar sEnd = \"\";\r\n\t\tswitch(o.nodeName.toLowerCase()){\r\n\t\t\tcase \"a\":\r\n\t\t\t\tsStart = \"[url=\" + o.getAttribute(\"href\") + \"]\";\r\n\t\t\t\tsEnd = \"[/url]\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ul\":\r\n\t\t\tcase \"ol\":\r\n\t\t\tcase \"li\":\r\n\t\t\tcase \"blockquote\":\r\n\t\t\tcase \"h1\":\r\n\t\t\tcase \"h2\":\r\n\t\t\tcase \"h3\":\r\n\t\t\tcase \"h4\":\r\n\t\t\tcase \"h5\":\r\n\t\t\tcase \"b\":\r\n\t\t\tcase \"i\":\r\n\t\t\t\tvar sA = o.getAttribute(\"align\");\r\n\t\t\t\tsStart = \"[\" + o.nodeName.toLowerCase() + (sA ? \" align=\" + sA : \"\") + \"]\";\r\n\t\t\t\tsEnd = \"[/\" + o.nodeName.toLowerCase() + \"]\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"img\":\r\n\t\t\t\tvar sA = o.getAttribute(\"align\");\r\n\t\t\t\tvar sC = o.getAttribute(\"class\");\r\n\t\t\t\treturn \"[img\" + (sC ? \" class=\" + sC :\"\") + (sA ? \" align=\" + sA : \"\") + \"]\" + o.getAttribute(\"src\") + \"[/img]\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"p\":\r\n\t\t\tcase \"div\":\r\n\t\t\t\t\r\n\t\t\t\tvar sC = o.getAttribute(\"class\");\r\n\t\t\t\t/// Trash the default html designer class\r\n\t\t\t\t///\r\n\t\t\t\tif(sC && sC.match(/^p1$/)) sC = 0;\r\n\t\t\t\tvar sS = o.getAttribute(\"style\");\r\n\r\n\t\t\t\tsStart = \"[\" + o.nodeName.toLowerCase() + (sC ? \" class=\" + sC :\"\") + (sS ? \" style=\" + sS: \"\") + \"]\";\r\n\t\t\t\tsEnd = \"[/\" + o.nodeName.toLowerCase() + \"]\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tsStart = \"\";\r\n\t\t\t\tsEnd = \"\";\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t}\r\n\t   \r\n\t\treturn (sStart + bbConverter.convertNodes(o.childNodes) + sEnd);\r\n\t}\r\n};\r\n\n\n;/* === client/pageClient.js === */\n(function(){\r\n\r\n    let undef;\r\n\r\n    /// Note: These only apply to a handful of system roles within an organization.\r\n    ///\r\n    function getContextRoles(){\r\n        return {\r\n            api : false,\r\n            userReader : false,\r\n            roleReader : false,\r\n            permissionReader : false,\r\n            author : false,\r\n            user : false,\r\n            systemAdmin : false,\r\n            accountAdmin : false,\r\n            objectAdmin : false,\r\n            dataAdmin : false\r\n        }\r\n    }\r\n\r\n    function newContextModel(){\r\n        return {\r\n            streams : {},\r\n            contextObjects : {},\r\n            entitlements : {},\r\n            tags : {},\r\n            favorites : {},\r\n            controls: {},\r\n            requests: {},\r\n            contextViews : {},\r\n            roles : getContextRoles(),\r\n            notifications: [],\r\n            messages: [],\r\n            pendingEntity : undef\r\n        };\r\n    }\r\n\r\n    function clearContextObject(id){\r\n        let ctx = page.context();\r\n        delete ctx.streams[id];\r\n        delete ctx.contextObjects[id];\r\n        delete ctx.entitlements[id];\r\n        delete ctx.tags[id];\r\n        delete ctx.controls[id];\r\n        delete ctx.requests[id];\r\n        delete ctx.contextViews[id];\r\n    }\r\n\r\n    let contextModel = newContextModel();\r\n\r\n    let uidStub = \"xxxxxxxx-xxxx-9xxx-yxxx-xxxxxxxxxxxx\";\r\n    let luidStub = \"xxxx-xxxx\";\r\n\r\n    let toast = [];\r\n    let toastConfig = {\r\n        info: {\r\n            ico: \"info\",\r\n            style: \"text-gray-500 bg-white dark:bg-black dark:text-gray-300\",\r\n            icoStyle: \"text-blue-500 dark:text-blue-300\",\r\n            timeout: 5000\r\n        },\r\n        success: {\r\n            ico: \"check\",\r\n            style: \"text-gray-500 bg-green-200 dark:bg-green-800 dark:text-gray-300\",\r\n            icoStyle: \"text-black dark:text-white\",\r\n            timeout: 5000\r\n        },\r\n        warn: {\r\n            ico: \"warning\",\r\n            style: \"bg-yellow-200 text-black dark:text-white dark:bg-yellow-800\",\r\n            icoStyle: \"text-black dark:text-white\",\r\n            timeout: 10000\r\n        },\r\n        error: {\r\n            ico: \"stop\",\r\n            style: \"bg-red-200 text-black dark:text-white dark:bg-red-700\",\r\n            icoStyle: \"text-black dark:text-white\",\r\n            timeout: 15000\r\n        }\r\n    };\r\n\r\n    let page = {\r\n\r\n        profile,\r\n        imageView,\r\n        imageGallery,\r\n        clearToast,\r\n        reconnect,\r\n        toast: addToast,\r\n        toasts: () => toast,\r\n        loadToast,\r\n        clearServerCache,\r\n        cleanup,\r\n        clearCache : clearPageCache,\r\n        components: {},\r\n        user : null,\r\n        application : undef,\r\n        navigable : undef,\r\n        contentRouter : contentRouter,\r\n        authenticated : () => (page.user != null),\r\n        getRawUrl : getRawUrl,\r\n        home : goHome,\r\n        nav: goNav,\r\n        getTag,\r\n        chat: goChat,\r\n        member: promiseMember,\r\n        parentType: promiseParentType,\r\n        moveObject: promiseMoveObject,\r\n        reparentObject: promiseReparentObject,\r\n        countObjects : promiseCountObjects,\r\n        deleteObject: promiseDeleteObject,\r\n        listObjects : promiseListObjects,\r\n        findObject : promiseFindObject,\r\n        makePath: promiseMakePath,\r\n        stream : promiseStream,\r\n        openObject : promiseOpenObject,\r\n        search: promiseSearch,\r\n        searchByName : promiseSearchObjectByName,\r\n        count: promiseCount,\r\n        openObjectByName : promiseOpenObjectByName,\r\n        createObject: promiseCreate,\r\n        patchObject: promisePatch,\r\n        uriStem : getURIStem,\r\n        uri : getURI,\r\n        iconButton : iconButton,\r\n        context : function(){ return contextModel;},\r\n        clearContextObject : clearContextObject,\r\n        listByType,\r\n        navigateToPath : navigateToPathId,\r\n        logout : async function(){\r\n            clearPageCache();\r\n            await uwm.logout();\r\n            m.route.set(\"/sig\");\r\n        },\r\n        removeDuplicates : removeDuplicates,\r\n        tags : getTags,\r\n        controls: getControls,\r\n        requests: getRequests,\r\n        entitlements : getEntitlements,\r\n        resetCredential,\r\n        wss: {\r\n            connect: wssConnect,\r\n            close: wssClose,\r\n            send: wssSend\r\n        },\r\n        messages,\r\n        cleanupUserRemains,\r\n        uid : function(){\r\n            return uid(uidStub);\r\n        },\r\n        luid : function(){\r\n            return uid(luidStub);\r\n        },\r\n        views: {},\r\n        setInnerXHTML,\r\n        checkFavorites,\r\n        isFavorite,\r\n        favorite,\r\n        favorites,\r\n        systemLibrary,\r\n        blobUrl : toBlobUrl,\r\n        sessionName: function() {\r\n            let a = [\"turtle\", \"bunny\", \"kitty\", \"puppy\", \"duckling\", \"pony\", \"fishy\", \"birdie\"];\r\n            let b = [\"fluffy\", \"cute\", \"ornery\", \"obnoxious\", \"scratchy\", \"licky\", \"cuddly\", \"mangy\"];\r\n            let c = [\"little\", \"tiny\", \"enormous\", \"big\", \"skinny\", \"lumpy\"];\r\n      \r\n            return b[parseInt(Math.random() * b.length)] + \" \" + c[parseInt(Math.random() * c.length)] + \" \" + a[parseInt(Math.random() * a.length)];\r\n          },\r\n        searchFirst,\r\n        chatAvatar,\r\n        normalizePath,\r\n        chatStream: undefined,\r\n        audioStream: undefined,\r\n        imageTags: (id) => {\r\n            return am7client.getImageTags(id);\r\n        },\r\n        applyImageTags: async (id) => {\r\n            let tags = await am7client.applyImageTags(id);\r\n            await am7client.clearCache(\"data.data\");\r\n            await am7client.clearCache(\"data.tag\");\r\n            return tags;\r\n        }\r\n\r\n    };\r\n\r\n\r\n    function normalizePath(path, grp){\r\n      let opath;\r\n      let cnt = grp || page.user.homeDirectory;\r\n      if(cnt && cnt.path){\r\n        if(path.startsWith(\"./\")){\r\n          opath = cnt.path + path.substring(1);\r\n        }\r\n        else if(path.startsWith(\"../\")){\r\n          let p = cnt.path.split(\"/\");\r\n          p.pop();\r\n          opath = p.join(\"/\") + path.substring(2);\r\n        }\r\n        else if(path.startsWith(\"/\") || path.startsWith(\"~\")){\r\n          opath = path;\r\n        }\r\n        else{\r\n          opath = cnt.path + \"/\" + path;\r\n        }\r\n      }\r\n      return opath;\r\n    }\r\n\r\n    async function chatAvatar(){\r\n        await am7model.forms.commands.character(\"Basi Lisk\", undefined, 42, \"M\", \"/media/logo_512.png\");\r\n    }\r\n    function isFavorite(obj){\r\n        let ctx = contextModel;\r\n        let type = obj[am7model.jsonModelKey];\r\n        return (ctx.favorites[type] != undefined && ctx.favorites[type].filter((o)=>o.objectId == obj.objectId).length)\r\n    }\r\n    async function favorite(obj){\r\n        let set = !isFavorite(obj);\r\n        let ctx = contextModel;\r\n        //ctx.favorites[obj[am7model.jsonModelKey]] = undefined;\r\n        let fav = await favorites();\r\n        let b = await promiseMember(fav[am7model.jsonModelKey], fav.objectId, obj[am7model.jsonModelKey], obj.objectId, set);\r\n        if(!b){\r\n            addToast(\"warn\", \"Failed to set favorite status\");\r\n        }\r\n        page.context().favorites[obj[am7model.jsonModelKey]] = undefined;\r\n        await am7client.clearCache();\r\n        return b;\r\n    }\r\n\r\n    async function checkFavorites(itype){\r\n        let type = itype || m.route.param(\"type\");\r\n        let ctx = contextModel;\r\n        if(type && ctx.favorites[type] == undefined){\r\n          ctx.favorites[type] = [];\r\n          let fav = await favorites();\r\n          am7client.members(fav[am7model.jsonModelKey], fav.objectId, type, 0, 100, function (v) {\r\n            ctx.favorites[type] = v;\r\n          });\r\n        }\r\n      }\r\n\r\n    async function getTag(name, type){\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"~/Tags\");\r\n        if(grp == null){\r\n            return;\r\n        }\r\n        let q = am7view.viewQuery(am7model.newInstance(\"data.tag\"));\r\n        q.field(\"groupId\", grp.id);\r\n        q.field(\"name\", name);\r\n        if(type){\r\n            q.field(\"type\", type);\r\n        }\r\n        let qr = await page.search(q);\r\n        let tag;\r\n        if(qr && qr.results && qr.results.length){\r\n            tag = qr.results[0];\r\n        }\r\n        return tag;\r\n    }\r\n\r\n    async function systemLibrary(model){\r\n        let grp;\r\n        if(am7model.system.library[model]){\r\n            grp = await page.findObject(\"auth.group\", \"data\", am7model.system.library[model]);\r\n        }\r\n        return grp;\r\n    }\r\n\r\n    async function favorites(){\r\n        if(!page.user){\r\n            return;\r\n        }\r\n        let origin = page.user.homeDirectory;\r\n\r\n        let grp = await page.openObjectByName(\"auth.group\", origin.objectId, \"Favorites\");\r\n        if(!grp){\r\n            grp = am7model.newPrimitive(\"auth.group\");\r\n            grp.type = \"bucket\";\r\n            grp.parentId = origin.id;\r\n            grp.name = \"Favorites\";\r\n            await page.createObject(grp);\r\n            am7client.clearCache(\"auth.group\", true);\r\n            grp = await page.openObjectByName(\"auth.group\", origin.objectId, \"Favorites\");\r\n        }\r\n        return grp;\r\n    }\r\n\r\n    function uid(temp){\r\n        return temp.replace(/[xy]/g, function (c) {\r\n            const r = Math.random() * 16 | 0, \r\n                v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    }\r\n\r\n    async function cleanupUserRemains(name){\r\n\r\n        let g = await promiseFindObject(\"auth.group\", \"data\", \"/home/\" + name);\r\n        if(g){\r\n            console.log(\"Cleaning up home directory\");\r\n            await promiseDeleteObject(\"auth.group\", g.objectId);\r\n        }\r\n        let r = await promiseFindObject(\"auth.role\", \"user\", \"/home/\" + name);\r\n        if(r){\r\n            console.log(\"Cleaning up home role\");\r\n            await promiseDeleteObject(\"auth.role\", r.objectId);\r\n        }\r\n        let p = await promiseFindObject(\"auth.permission\", \"user\", \"/home/\" + name);\r\n        if(p){\r\n            console.log(\"Cleaning up home permission\");\r\n            await promiseDeleteObject(\"auth.permission\", p.objectId);\r\n        }\r\n        let pg = await promiseFindObject(\"auth.group\", \"data\", \"/Persons\")\r\n        if(pg){\r\n            let up = await promiseOpenObjectByName(\"identity.person\", pg.objectId, name);\r\n            if(up){\r\n                console.log(\"Cleaning up person object\");\r\n                await promiseDeleteObject(\"identity.person\", up.objectId);\r\n            }\r\n        }\r\n    }\r\n\r\n    async function messages(){\r\n        contextModel.notifications = [];\r\n        //let listPathBase = (am7community.getCommunityMode() ? getRawUrl() : \"\") + \"/list/message\";\r\n        let listPathBase = getRawUrl() + \"/list/message\";\r\n        let dir = await page.makePath(\"auth.group\", \"data\", \"~/.messages\");\r\n        m.route.set(listPathBase + \"/\" + dir.objectId);\r\n    }\r\n\r\n    let webSocket;\r\n    function wssClose(){\r\n        if(!webSocket || webSocket.readyState === WebSocket.CLOSED){\r\n            // console.log(\"Connection already closed\");\r\n            return;\r\n        }\r\n        // console.log(\"Closing WebSocket\");\r\n        webSocket.close();\r\n        webSocket = undefined;\r\n    }\r\n\r\n    function wssConnect() {\r\n        if (webSocket !== undefined && webSocket.readyState !== WebSocket.CLOSED) {\r\n            console.warn(\"Connection is already open\");\r\n            return;\r\n        }\r\n        /*\r\n        if(!page.user){\r\n            console.warn(\"Connection requires authentication\");\r\n            return;\r\n        }\r\n        */\r\n        return new Promise((res, rej) => {\r\n            /// /\" + (page?.user?.objectId)\r\n            let wsUrl = g_application_path.replace(/^http[s]*/, \"wss\") + \"/wss\";\r\n            webSocket = new WebSocket(wsUrl);\r\n    \r\n            webSocket.onopen = function(event) {\r\n                res(event);\r\n            };\r\n    \r\n            webSocket.onmessage = function(event) {\r\n                if(event.data){\r\n                    routeMessage(JSON.parse(event.data));\r\n                }\r\n            };\r\n    \r\n            webSocket.onclose = function(event) {\r\n                /// console.log(\"WebSocket Closed ... TODO: Add reconnect\");\r\n                setTimeout(function(){\r\n                    reconnect(am7client.currentOrganization, page.token, 0);\r\n                }, 5000)\r\n                \r\n            };\r\n        });\r\n      }\r\n\r\n      let maxReconnect = 60;\r\n      async function reconnect(sOrg, sTok, iIter){\r\n        addToast(\"warn\", \"Reconnecting ...\", 5000);\r\n        let i = 0;\r\n        let iter = (iIter || 0) + 1;\r\n        let org = sOrg || am7client.currentOrganization;\r\n        let tok = sTok || page.token;\r\n        if(!org || !tok){\r\n            clearToast();\r\n            addToast(\"error\", \"Unable to reconnect\", 5000);\r\n            return;\r\n        }\r\n\r\n        /// Test that the server is available\r\n        try{\r\n            i = await m.request({method: \"GET\", url: g_application_path + \"/rest/login/time\"});\r\n        }\r\n        catch(e){\r\n            \r\n        }\r\n        \r\n        if(iter >= maxReconnect){\r\n            addToast(\"error\", \"Failed to reconnect\", 5000);\r\n            return;\r\n        }\r\n        if(i > 0){\r\n            await am7client.loginWithPassword(sOrg, \"${jwt}\", sTok, function(v){\r\n                clearToast();\r\n                if(v != null){\r\n                    addToast(\"success\", \"Reconnected\", 5000);\r\n                    page.router.refresh();\r\n                }\r\n                else{\r\n                    addToast(\"error\", \"Failed to reconnect\", 5000);\r\n                }\r\n            });\r\n        }\r\n        else{\r\n            setTimeout(function(){\r\n                reconnect(sOrg, sTok, iter);\r\n            }, 5000);\r\n        }\r\n      }\r\n\r\n      function routeMessage(msg){\r\n        if(msg.token){\r\n            page.token = msg.token;\r\n        }\r\n        if(msg.chirps){\r\n            let c1 = msg.chirps[0] || \"\";\r\n            if(c1.match(/(chatStart|chatComplete|chatUpdate|chatError)/)){\r\n                if(!page.chatStream){\r\n                    console.error(\"Chat stream isn't available\");\r\n                    return;\r\n                }\r\n                page.chatStream[\"on\" + c1.toLowerCase()](msg.chirps[1], msg.chirps[2], msg.chirps[3]);\r\n            }\r\n            else if(c1.match(/(audioUpdate|audioSTTUpdate|audioError)/)){\r\n                if(!page.audioStream){\r\n                    console.error(\"Audio stream isn't available\");\r\n                    return;\r\n                }\r\n                page.audioStream[\"on\" + c1.toLowerCase()](msg.chirps[1], msg.chirps[2]);\r\n            }\r\n            else{\r\n                //console.warn(\"Unhandled message type: \" + c1);\r\n            }\r\n            /*\r\n            msg.chirps.forEach((s) => {\r\n                console.log(s);\r\n                page.toast(\"info\", s, 5000);\r\n            });\r\n            */\r\n        }\r\n      }\r\n  \r\n      async function wssSend(name, message, recipient, schema) {\r\n        try{\r\n            let recipientId = null;\r\n            if(typeof recipient == \"number\") recipientId = recipient;\r\n            else if(typeof recipient == \"string\"){\r\n                let obj = await promiseOpenObjectByName(\"USER\", null, recipient);\r\n                if(obj){\r\n                    recipientId = obj.id;\r\n                }\r\n            }\r\n            if(recipient && !recipientId){\r\n                console.warn(\"Invalid recipientId (\" + recipientId + \") for recipient \" + recipient);\r\n                return;\r\n            }\r\n            let msg = {\r\n                data : uwm.base64Encode(message),\r\n                modelType: schema,\r\n                messageId: page.uid(),\r\n                name : name,\r\n                // userId: (page?.user?.objectId),\r\n                recipientId,\r\n                recipientType: (recipientId != null ? \"USER\" : \"UNKNOWN\")\r\n\r\n            };\r\n            let dat = JSON.stringify({schema: \"message.socketMessage\", token: page?.token, message: msg});\r\n            webSocket.send(dat);\r\n        }\r\n        catch(e){\r\n            console.error(e);\r\n        }\r\n    }\r\n \r\n\r\n    async function resetCredential(obj, newCredential, currentCredential){\r\n\r\n        if(!obj){\r\n            obj = page.user;\r\n        }\r\n        let authReq = {\r\n\t\t\tschema: \"authenticationRequest\",\r\n\t\t\tcredential: uwm.base64Encode(newCredential),\r\n\t\t\tcredentialType: \"hashed_password\",\r\n            checkCredential: (currentCredential ? uwm.base64Encode(currentCredential) : null),\r\n            checkCredentialType: (currentCredential ? \"hashed_password\" : null)\r\n\t\t};\r\n        let newCred = await new Promise((res, rej)=>{\r\n            am7client.newPrimaryCredential(obj[am7model.jsonModelKey], obj.objectId, authReq, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n\r\n        return newCred;\r\n    }\r\n\r\n    function getEntitlements(type, id){\r\n        return new Promise((res, rej) => {\r\n            if(contextModel.entitlements[id]) res(contextModel.entitlements[id]);\r\n            else am7client.entitlements(type, id, function(v){\r\n                contextModel.entitlements[id] = v || [];\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    function getRequests(type, id, startRecord, recordCount){\r\n        let sr = startRecord || 0;\r\n        let rc = recordCount || 25;\r\n        return new Promise((res, rej) => {\r\n            if(contextModel.requests[id]) res(contextModel.requests[id]);\r\n            else am7client.listRequests(type, id, sr, rc, function(v){\r\n                contextModel.requests[id] = v || [];\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    function getControls(type, id, startRecord, recordCount){\r\n        let sr = startRecord || 0;\r\n        let rc = recordCount || 25;\r\n        return new Promise((res, rej) => {\r\n            if(contextModel.controls[id]) res(contextModel.controls[id]);\r\n            else am7client.listControls(type, id, sr, rc, function(v){\r\n                contextModel.controls[id] = v || [];\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n\r\n    function getTags(type, id){\r\n        return new Promise((res, rej) => {\r\n            if(contextModel.tags[id]) res(contextModel.tags[id]);\r\n            else am7client.findTags(type, id, function(v){\r\n                contextModel.tags[id] = v || [];\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    function clearServerCache(){\r\n        return new Promise((res, rej)=>{\r\n            am7client.clearCache(null, false, function(){\r\n                res(true);\r\n            });\r\n        });\r\n    }\r\n    async function cleanup(){\r\n        await am7client.cleanup();\r\n        await am7client.clearCache();\r\n    }\r\n    function clearPageCache(){\r\n        \r\n        am7client.clearCache(false, true);\r\n\r\n        contextModel = newContextModel();\r\n\r\n        page.token = null;\r\n        page.user = null;\r\n        page.application = null;\r\n\r\n    }\r\n\r\n    function navigateToPathId(type, modType, path, handler){\r\n        console.log(type, modType, path);\r\n        return new Promise((res, rej)=>{\r\n            if(am7model.isGroup(modType)){\r\n                am7client.find(\"auth.group\",\"UNKNOWN\", path,function(v){\r\n                    if(v != null){\r\n                        res(v.objectId);\r\n                    }\r\n                    else res(null);\r\n                });\r\n            }\r\n            else res(null);\r\n        });\r\n    }\r\n\r\n    async function profileEntity(){\r\n        let grp = await promiseMakePath(\"auth.group\", \"DATA\", am7view.path(\"data.data\"));\r\n        let obj;\r\n        try{\r\n            obj = await promiseSearchObjectByName(\"data.data\", grp.id, \".profile\");\r\n        } catch(e){\r\n            console.error(e);\r\n        }\r\n        if(!obj){\r\n            obj = am7model.newPrimitive(\"data.data\");\r\n            obj.name = \".profile\";\r\n            obj.mimeType = \"application/json\";\r\n            obj.dataBytesStore = uwm.base64Encode(JSON.stringify({schema: \"userProfile\"}));\r\n            let bUp = await promiseCreate(obj);\r\n            obj = await promiseSearchObjectByName(\"data.data\", grp.objectId, \".profile\");\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    function imageView(entity, fConfirm, fCancel){\r\n        page.components.dialog.setDialog({\r\n            label: \"Viewer\",\r\n            entityType: \"imageView\",\r\n            size: 75,\r\n            data: {\r\n                entity: {schema:\"imageView\", image:entity}\r\n            },\r\n            cancel: function(data){\r\n                if(fCancel) fCancel(data);\r\n                page.components.dialog.cancelDialog();\r\n            }\r\n        });\r\n    }\r\n\r\n    async function imageGallery(images, charInst, fCancel){\r\n        let galleryImages = images || [];\r\n        let characterInstance = charInst;\r\n\r\n        // If charInst is provided, try to load all images from the portrait's group\r\n        if(characterInstance && characterInstance.entity){\r\n            let profile = characterInstance.entity.profile;\r\n            let portrait = profile ? profile.portrait : null;\r\n            let profileObjectId = profile ? profile.objectId : null;\r\n\r\n            // If profile exists but portrait isn't loaded, or profile is just a reference,\r\n            // query for the profile with portrait attribute\r\n            if(profileObjectId && (!portrait || !portrait.groupId)){\r\n                let pq = am7view.viewQuery(\"identity.profile\");\r\n                pq.field(\"objectId\", profileObjectId);\r\n                pq.entity.request.push(\"portrait\");\r\n                let pqr = await page.search(pq);\r\n                if(pqr && pqr.results && pqr.results.length){\r\n                    portrait = pqr.results[0].portrait;\r\n                    // Update the entity's profile portrait reference\r\n                    if(!characterInstance.entity.profile){\r\n                        characterInstance.entity.profile = pqr.results[0];\r\n                    } else {\r\n                        characterInstance.entity.profile.portrait = portrait;\r\n                    }\r\n                    if(!portrait){\r\n                        console.warn(\"imageGallery: Profile query returned but no portrait found\");\r\n                    }\r\n                } else {\r\n                    console.warn(\"imageGallery: Profile query returned no results for objectId: \" + profileObjectId);\r\n                }\r\n            } else if(!profileObjectId){\r\n                console.warn(\"imageGallery: No profile objectId available\", profile);\r\n            }\r\n\r\n            if(portrait && portrait.groupId){\r\n                // Query for all images in the same group as the portrait\r\n                //let q = am7view.viewQuery(am7model.newInstance(\"data.data\"));\r\n                let q = am7client.newQuery(\"data.data\")\r\n                q.field(\"groupId\", portrait.groupId);\r\n                //q.field(\"contentType\", \"image/%\");\r\n                q.entity.request.push(\"id\", \"objectId\", \"name\", \"groupId\", \"groupPath\", \"contentType\", \"attributes\", \"tags\");\r\n                \r\n                q.range(0, 200);\r\n                q.sort(\"createdDate\");\r\n                q.order(\"descending\");\r\n                let qr = await page.search(q);\r\n                if(qr && qr.results && qr.results.length){\r\n                    // Put any new images (passed in) at the beginning, avoiding duplicates\r\n                    let existingIds = new Set(qr.results.map(r => r.id));\r\n                    let newImages = galleryImages.filter(img => !existingIds.has(img.id));\r\n                    galleryImages = [...newImages, ...qr.results];\r\n                } else {\r\n                    console.warn(\"imageGallery: No images found in group: \" + portrait.groupId);\r\n                }\r\n            } else if(portrait && !portrait.groupId){\r\n                console.warn(\"imageGallery: Portrait exists but no groupId\", portrait);\r\n            } else if(!portrait){\r\n                console.warn(\"imageGallery: No portrait available after all attempts\");\r\n            }\r\n        } else {\r\n            console.warn(\"imageGallery: No characterInstance or entity provided\", characterInstance);\r\n        }\r\n\r\n        page.components.dialog.setDialog({\r\n            label: \"Gallery (\" + galleryImages.length + \" images)\",\r\n            entityType: \"imageGallery\",\r\n            size: 75,\r\n            data: {\r\n                entity: {schema:\"imageGallery\", images: galleryImages, currentIndex: 0, characterInstance: characterInstance}\r\n            },\r\n            cancel: function(data){\r\n                if(fCancel) fCancel(data);\r\n                page.components.dialog.cancelDialog();\r\n            }\r\n        });\r\n    }\r\n   \r\n\r\n    async function profile(){\r\n        let obj = await profileEntity();\r\n        let objj = {schema: \"userProfile\"};\r\n        if(obj.dataBytesStore && obj.dataBytesStore.length){\r\n            objj = JSON.parse(uwm.base64Decode(obj.dataBytesStore));\r\n            if(!objj[am7model.jsonModelKey]) objj[am7model.jsonModelKey] = \"userProfile\";\r\n        }\r\n        page.components.dialog.setDialog({\r\n            label: \"Profile\",\r\n            entityType: \"userProfile\",\r\n            size: 75,\r\n            data: {\r\n                object: obj,\r\n                entity: objj\r\n            },\r\n            confirm: updateProfile,\r\n            cancel: page.components.dialog.cancelDialog,\r\n        });\r\n    }\r\n    \r\n    /// TODO: Replace this by having system.user inherit identity.profile\r\n    /// Need to fix how referenced objects are created\r\n    /// In fact, the whole reference approach should probably just be removed in favor of participations\r\n    /// The new version of the back end only auto-creates when the parent object is created, and won't try to auto create \r\n    async function updateProfile(obj){\r\n\r\n        let a1 = am7client.getAttribute(page.user, \"v1-profile\");\r\n        let a2 = am7client.getAttribute(page.user, \"v1-profile-path\");\r\n\r\n        obj.entity.profilePortraitPath = undefined;\r\n        if(obj.entity.profilePortrait){\r\n            let port = await promiseOpenObject(\"data\", obj.entity.profilePortrait);\r\n            obj.entity.profilePortraitPath = am7client.dotPath(port.organizationPath) + \"/data.data\" + port.groupPath + \"/\" + port.name;\r\n        }\r\n\r\n        if(obj.entity.profilePortraitPath){\r\n            await am7client.patchAttribute(page.user, \"v1-profile-path\",obj.entity.profilePortraitPath);\r\n        }\r\n        if(obj.entity.profileId){\r\n            await am7client.patchAttribute(page.user, \"v1-profile\", obj.entity.profileId);\r\n        }\r\n\r\n        obj.object.dataBytesStore = uwm.base64Encode(JSON.stringify(obj.entity));\r\n        let bUp = await promisePatch(obj.object);\r\n\r\n        page.components.dialog.endDialog();\r\n        m.redraw();\r\n    }\r\n\r\n\r\n    \r\n    function removeToast(id){\r\n        toast = toast.filter((t)=>{\r\n            return t.id != id;\r\n        });\r\n    }\r\n    function burnToast(nt){\r\n        let o = document.querySelector(\"#toast-box-\" + nt.id);\r\n        if(o){\r\n            o.className = \"transition transition-0 toast-box \" + toastConfig[nt.type].style;\r\n        }\r\n        window.setTimeout(()=>{\r\n            nt.visible = false;\r\n            removeToast(nt.id);\r\n            m.redraw();\r\n        }, 300);\r\n    }\r\n    \r\n    function clearToast(){\r\n        toast = [];\r\n        m.redraw();\r\n    }\r\n\r\n    function addToast(type, msg, timeout){\r\n        let nt = {\r\n            id: page.luid(),\r\n            type,\r\n            message: msg,\r\n            visible: false,\r\n            expiry: timeout || 5000\r\n        };\r\n        toast.push(nt);\r\n        window.setTimeout(()=>{\r\n            nt.visible = true;\r\n            let o = document.querySelector(\"#toast-box-\" + nt.id);\r\n            if(o){\r\n                o.className = \"transition transition-100 toast-box \" + toastConfig[nt.type].style;\r\n            }\r\n        }, 10);\r\n        if(nt.expiry >= 0){\r\n            window.setTimeout(()=>{\r\n            burnToast(nt);\r\n            }, nt.expiry);\r\n        }\r\n        m.redraw();\r\n        return nt.id;\r\n    }\r\n\r\n    /// dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700\r\n    function loadToast(){\r\n        // transition-full transition-0 transition-100\r\n        let items = toast.map((t)=>{\r\n            let cfg = toastConfig[t.type];\r\n            let closeBtn = m(\"button\", {onclick: ()=>{ burnToast(t);}, type: \"button\", class: \"ms-auto -mx-1.5 -my-1.5  rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 dark:bg-gray-900 dark:text-gray-200 inline-flex items-center justify-center h-8 w-8 \"}, \r\n                m(\"span\", {class: \"material-symbols-outlined\"}, \"close\")\r\n            );\r\n            return m(\"div\", {id: \"toast-box-\" + t.id, class: \"transition transition-\" + (t.visible ? \"100\":\"0\") + \" toast-box \" + cfg.style}, [\r\n                m(\"div\", {class: cfg.icoStyle + \" ico-box\"}, [\r\n                    m(\"span\", {class: \"material-symbols-outlined\"}, cfg.ico)\r\n                ]),\r\n                m(\"div\", {class: \"toast-text\"}, t.message),\r\n                closeBtn\r\n            ]);\r\n        });\r\n        return (items.length == 0 ? \"\" : m(\"div\", {class: \"toast-container\"}, [\r\n            items\r\n        ]));\r\n\r\n    }\r\n\r\n\r\n    function listByType(type, objectId, bParent){\r\n        //let viewPath = (am7community.getCommunityMode() ? getRawUrl() : \"\") + \"/\" + (bParent ? \"p\" : \"\") + \"list/\" + type + \"/\" + objectId;\r\n        /// getRawUrl() + \r\n        let viewPath = \"/\" + (bParent ? \"p\" : \"\") + \"list/\" + type + \"/\" + objectId;\r\n        m.route.set(viewPath);\r\n    }\r\n\r\n    function iconButton(sClass, sIco, sLabel, fHandler){\r\n        return m(\"button\",{onclick : fHandler, class: sClass}, (sIco ? m(\"span\",{class: \"material-symbols-outlined material-icons-24\"},sIco) : \"\"), (sLabel || \"\"));\r\n    }\r\n    function getURI(){\r\n        let url = page.getRawUrl();\r\n        let params = [];\r\n        if(page.pagination.paginating){\r\n            let pages = page.pagination.pages();\r\n            if(pages != null && pages.currentPage > 0){\r\n                if(pages.filter != null) params.push(\"filter=\" + encodeURI(pages.filter));\r\n                params.push(\"startRecord=\" + ((pages.currentPage - 1)*pages.recordCount));\r\n                params.push(\"recordCount=\" + pages.recordCount);\r\n            }\r\n        }\r\n        return url + (params.length ? \"?\" + params.join(\"&\") : \"\");\r\n    }\r\n    function getURIStem(){\r\n        let stem = [];\r\n        let openItems = [];\r\n        Object.keys(contextModel.contextViews).forEach((k)=>{\r\n          openItems.push(\"{\" + contextModel.contextViews[k].mode + \".\" + contextModel.contextViews[k].type + \".\" + k + \"}\");\r\n        });\r\n        if(openItems.length) stem.push(\"open=\" + openItems.join(\",\"));\r\n        return stem.join(\"&\");\r\n    }\r\n\r\n    async function promiseCreate(object){\r\n        return new Promise((res, rej)=>{\r\n            am7client.create(object[am7model.jsonModelKey], object, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    async function promiseMakePath(type, subType, path){\r\n        return new Promise((res, rej)=>{\r\n            am7client.make(type, subType, path,function(v){\r\n                if(v != null){\r\n                    res(v);\r\n                }\r\n                else res(null);\r\n            });\r\n        });\r\n    }\r\n    async function promiseFindObject(type, subType, path){\r\n        return new Promise((res, rej)=>{\r\n            am7client.find(type, subType, path,function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    /*\r\n    async function promiseListObjectsInParent(sType, id, start, length){\r\n        return new Promise((res, rej)=>{\r\n            am7client.listInParent(sType, id, start, length, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    */\r\n    async function promiseReparentObject(child, newParent){\r\n        let modType = am7model.getModel(child[am7model.jsonModelKey]);\r\n        let modType2 = am7model.getModel(newParent[am7model.jsonModelKey]);\r\n        if(!am7model.inherits(modType2, \"common.parent\")){\r\n            console.warn(\"Not a parentable object\");\r\n            return false;\r\n        }\r\n\r\n        child.parentId = newParent.id;\r\n\r\n        let b = await promisePatch(child);\r\n        am7client.clearCache(child[am7model.jsonModelKey]);\r\n        return b;\r\n    }\r\n    /*\r\n    async function promiseMember(object, actor, enabled){\r\n        return new Promise((res, rej)=>{\r\n            am7client.member(object[am7model.jsonModelKey], object.objectId, null, actor[am7model.jsonModelKey], actor.objectId, enabled, function(v){\r\n                res(v);\r\n            })\r\n\r\n        });\r\n    }\r\n    */\r\n\r\n    async function promiseParentType(sType){\r\n        return new Promise((res, rej) => {\r\n            am7client.user(sType, \"USER\", function(v){\r\n                uwm.getDefaultParentForType(sType, v).then((parObj) =>{\r\n                    if(parObj != null){\r\n                        res(parObj);\r\n                    }\r\n                    else{\r\n                        rej();\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n    async function promiseMoveObject(object, group){\r\n        let modType = am7model.getModel(object[am7model.jsonModelKey]);\r\n        let bUp = false;\r\n        if(object[am7model.jsonModelKey].match(/^auth\\.group$/gi)){\r\n          console.warn(\"Use reparent to move groups\");\r\n          return;\r\n        }\r\n        if(object[am7model.jsonModelKey].match(/^data\\.data$/gi)){\r\n          delete object.dataBytesStore;\r\n        }\r\n        if(am7model.isGroup(modType)){\r\n          object.groupId = group.id;\r\n          object.groupPath = group.path;\r\n          bUp = await promisePatch(object);\r\n        }\r\n        return bUp;\r\n      }\r\n\r\n      async function promiseMember(sType, sId, sActorType, sActorId, bEnable){\r\n        return new Promise((res, rej)=>{\r\n            am7client.member(sType, sId, null, sActorType, sActorId, bEnable, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n\r\n    async function promiseDeleteObject(sType, id){\r\n        return new Promise((res, rej)=>{\r\n            am7client.delete(sType, id, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    async function promiseListObjects(sType, id, sFields, start, length){\r\n            return am7client.list(sType, id, sFields, start, length);\r\n    }\r\n\r\n    async function promiseCountObjects(sType, id){\r\n            return am7client.count(sType, id);\r\n    }\r\n\r\n    async function promiseSearchObjectByName(type, id, name){\r\n        \r\n        if(typeof id == \"string\"){\r\n            let q = am7view.viewQuery(am7model.newInstance(\"auth.group\"));\r\n            q.field(\"objectId\", id);\r\n            let qr = await promiseSearch(q);\r\n            if(qr && qr.results){\r\n                id = qr.results[0].id;\r\n            }\r\n        }\r\n        if(typeof id == \"string\"){\r\n            console.error(\"Expected a numeric groupId\");\r\n            return null;\r\n        }\r\n        let q = am7view.viewQuery(am7model.newInstance(type));\r\n        q.field(\"groupId\", id);\r\n        if(name){\r\n            q.field(\"name\", name);\r\n        }\r\n        return new Promise( (res, rej) => {\r\n            page.search(q).then( (g2) => {\r\n                let og;\r\n                if(g2 && g2.results){\r\n                    og = g2.results[0];\r\n                }\r\n                res(og);\r\n            })\r\n        });\r\n    }\r\n\r\n    async function promiseOpenObjectByName(type, id, name, bParent){\r\n        return new Promise ((res, rej) => {\r\n            let o = null;\r\n            am7client.getByName(type, id, name, function(o){\r\n                res (o);\r\n            }).catch( () => {\r\n                res(null);\r\n            });\r\n        });\r\n    }\r\n\r\n    async function promiseStream(id, start, length){\r\n        if(typeof start == \"undefined\"){\r\n            start = 0;\r\n        }\r\n        if(typeof length == \"undefined\"){\r\n            length == 0;\r\n        }\r\n        if(typeof id == \"object\"){\r\n            if(!length) length = id.size;\r\n            id = id.objectId;\r\n        }\r\n        return (contextModel.streams[id] ? Promise.resolve(contextModel.streams[id]) : new Promise((res, rej)=>{\r\n            am7client.stream(id, start, length, function(v){\r\n                contextModel.streams[id] = v;\r\n                res(v);\r\n            });\r\n        }));\r\n    }\r\n\r\n    async function promiseSearch(query){\r\n        return am7client.search(query);\r\n    }\r\n    async function promiseCount(query){\r\n        return am7client.search(query, undefined, true);\r\n    }\r\n    async function promisePatch(object){\r\n        return new Promise((res, rej)=>{\r\n            am7client.patch(object[am7model.jsonModelKey], object, function(v){\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n    async function promiseOpenObject(type, id, mode){\r\n        return (contextModel.contextObjects[id] ? Promise.resolve(contextModel.contextObjects[id]) : new Promise((res, rej)=>{\r\n            let alt = (typeof id == \"string\" && id.match(/^am:/));\r\n            am7client[alt ? \"getByUrn\" : \"get\"](type, id, function(v){\r\n                contextModel.contextObjects[id] = v;\r\n                contextModel.contextViews[id] = {type: type, mode:mode};\r\n                res(v);\r\n            });\r\n        }));\r\n    }\r\n    function removeDuplicates(array, key){\r\n        return array.filter((obj, index, self) => index === self.findIndex((obj2) => (obj2.objectId === obj.objectId)));\r\n\r\n    }\r\n    function filterObject(object, keyMatch){\r\n        return Object.keys(object).filter((key) => { \r\n            return key.includes(keyMatch) == false;\r\n        }).reduce(( prev, key) => {\r\n            return Object.assign(prev, { [key]: object[key] });\r\n        }, {});\r\n    }\r\n\r\n     function goNav(){\r\n        m.route.set(\"/nav\");\r\n    }\r\n    \r\n    function goChat(){\r\n        m.route.set(\"/chat\");\r\n    }\r\n\r\n    function goHome(){\r\n        let url = \"/main\";\r\n       m.route.set(url);\r\n    }\r\n    function getRawUrl(){\r\n        let url = m.route.get();\r\n        let idx = url.indexOf(\"?\");\r\n        if(idx > -1) url = url.substring(0, idx);\r\n        return url;\r\n    }\r\n    function contentRouter(){\r\n        let curRout = m.route.get();\r\n        if(curRout != \"/sig\" && !page.authenticated()){\r\n            console.log(\"Force to /sig\");\r\n            return m.route.set(\"/sig\");\r\n        }\r\n        else{\r\n            return m(page.components.panel);\r\n        }\r\n    }\r\n   \r\n    /// given a data: url, exchange it for a blob url which caches the data to the client to be referenced by the blob id\r\n    ///\r\n    function toBlobUrl(dataURI){\r\n        /// https://stackoverflow.com/questions/9388412/data-uri-to-object-url-with-createobjecturl-in-chrome-ff\r\n        var mime = dataURI.split(',')[0].split(':')[1].split(';')[0];\r\n        /// TODO: Replace with Buffer.from(dataURI.split(',')[1],\"base64\"); \r\n        var binary = window.atob(dataURI.split(',')[1]);\r\n        var a = [];\r\n        for (var i = 0; i < binary.length; i++) {\r\n            a.push(binary.charCodeAt(i));\r\n        }\r\n        return URL.createObjectURL(new Blob([new Uint8Array(a)], {type: mime}));\r\n    }\r\n\r\n    function isAttributeSet (o, n, b) {\r\n        if (o == null || (typeof o != \"object\") || o.nodeType != 1) return 0;\r\n        var s = o.getAttribute(n);\r\n        if (typeof s != \"string\" || s.length == 0) return 0;\r\n        return (b ? s : 1);\r\n    }\r\n\r\n\r\n    function setInnerXHTML(t, s, p, d, z, c, h, ch) {\r\n\r\n        var y, e, a, l, x, n, v, r = 0, b, f;\r\n\r\n\r\n        if (!d) d = document;\r\n\r\n        b = (d == document ? 1 : 0);\r\n\r\n        if (!p)\r\n            HemiEngine.xml.removeChildren(t);\r\n\r\n        y = (s && typeof s == \"object\") ? s.nodeType : (typeof s == \"string\") ? 33 : -1;\r\n\r\n        try {\r\n\r\n            switch (y) {\r\n                case 1:\r\n                    if (h) {\r\n                        e = s.cloneNode(false);\r\n                    }\r\n                    else {\r\n                        f = s.nodeName;\r\n                        if (typeof ch == \"function\") f = ch(y, f);\r\n                        if (!f) return 0;\r\n                        e = d.createElement(f);\r\n                        a = s.attributes;\r\n                        l = a.length;\r\n                        for (x = 0; x < l; x++) {\r\n                            n = a[x].nodeName;\r\n                            v = a[x].nodeValue;\r\n                            if (typeof ch == \"function\") {\r\n                                n = ch(2, n);\r\n                                v = ch(2, v);\r\n                            }\r\n\r\n\r\n\r\n                            if (b && n == \"style\") {\r\n                                e.style.cssText = v;\r\n                            }\r\n\r\n                            else if (b && n == \"id\") {\r\n                                e.id = v;\r\n                            }\r\n\r\n\r\n\r\n                            else if (b && n == \"class\") {\r\n                                e.className = v;\r\n                            }\r\n\r\n\r\n                            else if (b && n.match(/^on/i)) {\r\n                                eval(\"e.\" + n + \"=function(){\" + v + \"}\");\r\n                            }\r\n                            else {\r\n                                e.setAttribute(n, v);\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!z && s.hasChildNodes()) {\r\n                        a = s.childNodes;\r\n                        l = a.length;\r\n                        for (x = 0; x < l; x++)\r\n                           page.setInnerXHTML(e, a[x], 1, d, z, c, h, ch);\r\n\r\n                    }\r\n\r\n                    if (b && s.nodeName.match(/input/i) && isAttributeSet(s,\"checked\")) {\r\n                        e.checked = true;\r\n                    }\r\n                    t.appendChild(e);\r\n                    r = e;\r\n                    break;\r\n                case 3:\r\n                    e = s.nodeValue;\r\n                    if (typeof ch == DATATYPES.TYPE_FUNCTION) e = ch(y, e);\r\n                    if (e) {\r\n                        e = e.replace(/\\s+/g, \" \");\r\n                        t.appendChild(d.createTextNode(e));\r\n                        r = e;\r\n                    }\r\n                    break;\r\n\r\n                case 4:\r\n                    e = s.nodeValue;\r\n                    if (typeof ch == DATATYPES.TYPE_FUNCTION) e = ch(y, e);\r\n                    t.appendChild(d.createCDATASection(e));\r\n                    break;\r\n                case 8:\r\n\r\n                    break;\r\n                case 33:\r\n                    e = s;\r\n                    if (typeof ch == DATATYPES.TYPE_FUNCTION) e = ch(y, e);\r\n                    if (e) {\r\n                        if (!c) {\r\n                            e = e.replace(/^\\s*/, \"\");\r\n                            e = e.replace(/\\s*$/, \"\");\r\n                            e = e.replace(/\\s+/g, \" \");\r\n                        }\r\n                        t.appendChild(d.createTextNode(e));\r\n                        r = e;\r\n                    }\r\n                    break;\r\n                default:\r\n\r\n                    break;\r\n            }\r\n\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    async function searchFirst(model, groupId, name, objectId){\r\n        let q = am7view.viewQuery(am7model.newInstance(model));\r\n        if(groupId){\r\n            q.field(\"groupId\", groupId);\r\n        }\r\n        if(name){\r\n            q.field(\"name\", name);\r\n        }\r\n        if(objectId){\r\n            q.field(\"objectId\", objectId);\r\n        }\r\n        let qr = await page.search(q);\r\n        let obj;\r\n        if(qr && qr.results && qr.results.length){\r\n            obj = qr.results[0];\r\n        }\r\n        return obj;\r\n    }\r\n    \r\n\r\n    let test = typeof module;\r\n\r\n    if (test !== \"undefined\") {\r\n        module.exports = page;\r\n    } else {\r\n        window.page = page;\r\n    }\r\n}());\r\n\n\n;/* === client/components/dialog.js === */\n(function(){\r\n\r\n    /// TODO: Persist chatRequest.\r\n    /// NOTE: The underlying AI request should also be persisted to make it easier to access and edit without having to deserialize the data.data byteStore\r\n    ///\r\n\r\n    let dialogUp = false;\r\n    let dialogCfg;\r\n\r\n    async function chatInto(ref, inst, aCCfg){\r\n        let sessName = page.sessionName();\r\n\r\n        let pa = (await loadPromptList()).filter(c => c.name.match(/^Object/gi));\r\n        let ca = (await loadChatList()).filter(c => c.name.match(/^Object/gi));\r\n        let cname = \"Analyze \" + (ref && ref[am7model.jsonModelKey] ? ref[am7model.jsonModelKey].toUpperCase() + \" \" : \"\") + (ref?.name ? ref.name : inst.api.name());\r\n        let remoteEnt = {\r\n          schema: \"olio.llm.chatRequest\",          \r\n          chatConfig: ca.length ? ca[0] : undefined,\r\n          promptConfig: pa.length ? pa[0] : undefined,\r\n          name:cname\r\n          //sessions: sessName\r\n        };\r\n        let wset = [];\r\n        /*\r\n        /// Since the summary tag is set to the summary notes and not the reference, adding the tag will limit the citations to only the summary notes\r\n        let tag = await page.getTag(\"Summary\");\r\n        if(tag){\r\n            wset.push(tag);\r\n        }\r\n        */\r\n        let aCPs = [];\r\n        \r\n        if(inst && aCCfg){\r\n            let aC = aCCfg.filter(c => c.name == inst.api.chatConfig()?.name);\r\n            if(aC.length && aC[0].userCharacter && aC[0].systemCharacter){\r\n                aCPs.push(aC[0].userCharacter.name);\r\n                aCPs.push(aC[0].systemCharacter.name);\r\n            }\r\n        }\r\n        else if(ref && ref[am7model.jsonModelKey] == \"olio.charPerson\" || ref[am7model.jsonModelKey] == \"identity.person\"){\r\n            aCPs.push(ref.name);\r\n        }\r\n        \r\n        if(inst && inst.api.session && inst.api.session() != null && inst.api.session()[am7model.jsonModelKey]){\r\n            let sq = am7view.viewQuery(inst.api.session()[am7model.jsonModelKey]);\r\n            sq.entity.request = [\"id\", \"objectId\", \"groupId\", \"groupPath\", \"organizationId\", \"organizationPath\"];\r\n            sq.field(\"id\", inst.api.session().id);\r\n            let sess = await page.search(sq);\r\n            if(sess && sess.results && sess.results.length){\r\n                let x = await m.request({ method: 'GET', url: am7client.base() + \"/vector/vectorize/\" + inst.api.session()[am7model.jsonModelKey] + \"/\" + sess.results[0].objectId + \"/WORD/500\", withCredentials: true });\r\n                if(x){\r\n                    wset.push(sess.results[0]);\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"Session vectorization failed: \" + inst.api.session().id);\r\n                }\r\n            }\r\n            else{\r\n                page.toast(\"error\", \"Session not found: \" + inst.api.session().id);\r\n            }\r\n        }\r\n        \r\n        if(aCPs.length){\r\n            let grp = await page.findObject(\"auth.group\", \"data\", \"~/Tags\");\r\n            let q = am7view.viewQuery(am7model.newInstance(\"data.tag\"));\r\n            q.field(\"groupId\", grp.id);\r\n            let q2 = q.field(null, null);\r\n            q2.comparator = \"group_or\";\r\n            q2.fields = aCPs.map((a) => {\r\n                return {\r\n                    name: \"name\",\r\n                    comparator: \"equals\",\r\n                    value: a\r\n                }\r\n            });\r\n            /*\r\n            [\r\n                {name: \"name\", comparator: \"equals\", value: aC[0].userCharacter.name},\r\n                {name: \"name\", comparator: \"equals\", value: aC[0].systemCharacter.name}\r\n            ];\r\n            */\r\n    \r\n            let qr = await page.search(q);\r\n            if(qr && qr.results){\r\n                wset.push(...qr.results);\r\n            }\r\n        }\r\n        \r\n        if(ref){\r\n            wset.push(ref);\r\n        }\r\n  \r\n        let w = window.open(\"/\", \"_blank\");\r\n        w.remoteEntity = remoteEnt;\r\n        w.onload = function(){\r\n          w.page.components.dnd.workingSet.push(...wset);\r\n          if(wset.length){\r\n            w.page.components.topMenu.activeShuffle(wset[0]);\r\n          }\r\n          w.m.route.set(\"/chat\");\r\n        }\r\n  \r\n  \r\n        \r\n      }\r\n\r\n    function endDialog(){\r\n        dialogUp = false;\r\n        m.redraw();\r\n    }\r\n    function setDialog(cfg){\r\n        dialogCfg = cfg;\r\n        dialogUp = true;\r\n        m.redraw();\r\n    }\r\n\r\n    function showProgress(object, inst) {\r\n        if(!object){\r\n            return;\r\n        }\r\n        object.label = object.label || \"Progress\";\r\n        let cfg = {\r\n            label: object.label,\r\n            entityType: \"progress\",\r\n            size: 50,\r\n            data: {entity:object, inst},\r\n            cancel: async function (data) {\r\n                endDialog();\r\n            }\r\n        };\r\n        setDialog(cfg);\r\n    }\r\n\r\n    async function loadPromptList(){\r\n        let dir = await page.findObject(\"auth.group\", \"DATA\", \"~/Chat\");\r\n        return await am7client.list(\"olio.llm.promptConfig\", dir.objectId, null, 0, 0);\r\n    }\r\n\r\n    async function loadChatList() {\r\n        let dir = await page.findObject(\"auth.group\", \"DATA\", \"~/Chat\");\r\n        return await am7client.list(\"olio.llm.chatConfig\", dir.objectId, null, 0, 0);\r\n      }\r\n\r\n    function updateSessionName(inst, acfg, pcfg, bRename){\r\n        let chat = inst.api.chatConfig();\r\n        let prompt = inst.api.promptConfig();\r\n        if(!chat || !prompt){\r\n            console.warn(\"Invalid chat or prompt selection: \" + chat + \" / \" + prompt);\r\n            return;\r\n        }\r\n       \r\n        let ycfg = pcfg.filter(a => a.name.toLowerCase() == prompt.name.toLowerCase());\r\n        let vcfg = acfg.filter(a => a.name.toLowerCase() == chat.name.toLowerCase());\r\n        if(!ycfg.length || !vcfg.length){\r\n            console.warn(\"Invalid chat or prompt list: \" + chat + \" / \" + prompt);\r\n            return;\r\n        }\r\n        let occfg = vcfg[0];\r\n        let opcfg = ycfg[0];\r\n\r\n        inst.api.setting(occfg.setting)\r\n\r\n        let name;\r\n        if(inst.api.name) name = inst.api.name();\r\n\r\n        if(bRename || !name || !name.length){\r\n            if(page.components.dnd.workingSet.length){\r\n                name = page.components.dnd.workingSet[0].name;\r\n            }\r\n            else if(occfg.systemCharacter && occfg.userCharacter){\r\n                let sysName = occfg.systemCharacter.firstName || occfg.systemCharacter.name.substring(0,occfg.systemCharacter.name.indexOf(\" \"));\r\n                let usrName = occfg.userCharacter.firstName || occfg.userCharacter.name.substring(0,occfg.userCharacter.name.indexOf(\" \"));\r\n                name = sysName + \" and \" + usrName + \" (\" + occfg.rating.toUpperCase() + \")\";\r\n            }\r\n            else {\r\n                name = page.sessionName();\r\n            }\r\n        }\r\n        inst.api.name(name);\r\n\r\n    }\r\n    \r\n    async function chatSettings(cinst, fHandler){\r\n        let entity = cinst ? cinst.entity : am7model.newPrimitive(\"olio.llm.chatRequest\");\r\n        let inst = am7model.prepareInstance(entity, am7model.forms.newChatRequest);\r\n        let acfg = await loadChatList();\r\n        if(acfg && acfg.length && !entity.chatConfig) entity.chatConfig = acfg[0];\r\n        let pcfg = await loadPromptList();\r\n        if(pcfg && pcfg.length && !entity.promptConfig) entity.promptConfig = pcfg[0];\r\n\r\n        inst.action(\"chatConfig\", function(){updateSessionName(inst, acfg, pcfg, true);});\r\n        inst.action(\"promptConfig\", function(){updateSessionName(inst, acfg, pcfg, true);});\r\n        updateSessionName(inst, acfg, pcfg);\r\n\r\n        let cfg = {\r\n            label: \"Chat Settings\",\r\n            entityType: \"olio.llm.chatRequest\",\r\n            size: 75,\r\n            data: {entity, inst},\r\n            confirm: async function (data) {\r\n\r\n                if(fHandler){\r\n                    fHandler(entity);\r\n                }\r\n\r\n                endDialog();\r\n            },\r\n            cancel: async function (data) {\r\n                endDialog();\r\n            }\r\n        };\r\n        setDialog(cfg);\r\n    }\r\n\r\n    async function summarize(object, inst){\r\n        let entity = am7model.newPrimitive(\"summarizeSettings\");\r\n        let acfg = await loadChatList();\r\n        if(acfg && acfg.length) entity.chat = acfg[0].name;\r\n        am7model.getModelField(\"summarizeSettings\", \"chat\").limit  = acfg.map((c) => { return c.name; });\r\n\r\n        let pcfg = await loadPromptList();\r\n        if(pcfg && pcfg.length) entity.prompt = pcfg[0].name;\r\n        am7model.getModelField(\"summarizeSettings\", \"prompt\").limit  = pcfg.map((c) => { return c.name; });\r\n\r\n\r\n        let cfg = {\r\n            label: \"Summarize Options\",\r\n            entityType: \"summarizeSettings\",\r\n            size: 50,\r\n            data: {entity},\r\n            confirm: async function (data) {\r\n                let ycfg = pcfg.filter(a => a.name.toLowerCase() == entity.prompt.toLowerCase());\r\n                if(!ycfg.length){\r\n                    page.toast(\"error\", \"Invalid prompt selection: \" + entity.prompt);\r\n                    return;\r\n                }\r\n\r\n                let vcfg = acfg.filter(a => a.name.toLowerCase() == entity.chat.toLowerCase());\r\n                if(!vcfg.length){\r\n                    page.toast(\"error\", \"Invalid chat selection: \" + entity.chat);\r\n                    return;\r\n                }\r\n                page.toast(\"info\", \"Summarizing ...\", -1);\r\n                let creq = am7model.newPrimitive(\"olio.llm.chatRequest\");\r\n                creq.chatConfig = {name:vcfg[0].name,id:vcfg[0].id};\r\n                creq.promptConfig = {name: ycfg[0].name, id: ycfg[0].id};\r\n                creq.data = [\r\n                    JSON.stringify({schema:inst.model.name,objectId:inst.api.objectId()})\r\n                ];\r\n                let x = await m.request({ method: 'POST', url: am7client.base() + \"/vector/summarize/\" + entity.chunkType.toUpperCase() + \"/\" + entity.chunk, body: creq, withCredentials: true });\r\n                page.clearToast();\r\n                if (x && x != null) {\r\n                    page.toast(\"success\", \"Summarization complete\");\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"Summarization failed\");\r\n                }\r\n                endDialog();\r\n            },\r\n            cancel: async function (data) {\r\n                endDialog();\r\n            }\r\n        };\r\n        setDialog(cfg);\r\n\r\n    }\r\n\r\n    async function vectorize(object, inst) {\r\n        let entity = am7model.newPrimitive(\"vectorOptions\");\r\n        let cfg = {\r\n            label: \"Vector Options\",\r\n            entityType: \"vectorOptions\",\r\n            size: 50,\r\n            data: {entity},\r\n            confirm: async function (data) {\r\n                page.toast(\"info\", \"Vectorizing ...\");\r\n                let x = await m.request({ method: 'GET', url: am7client.base() + \"/vector/vectorize/\" + inst.model.name + \"/\" + inst.api.objectId() + \"/\" + entity.chunkType.toUpperCase() + \"/\" + entity.chunk, withCredentials: true });\r\n                if (x && x != null) {\r\n                    page.toast(\"success\", \"Vectorization complete\");\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"Vectorization failed\");\r\n                }\r\n                endDialog();\r\n            },\r\n            cancel: async function (data) {\r\n                endDialog();\r\n            }\r\n        };\r\n        setDialog(cfg);\r\n    }\r\n\r\n    let lastReimage;\r\n\r\n    async function loadSDConfig(name){\r\n        let grp = await page.makePath(\"auth.group\", \"DATA\", \"~/Data/.preferences\");\r\n        if(!grp) return null;\r\n        try {\r\n            let q = am7view.viewQuery(am7model.newInstance(\"data.data\"));\r\n            q.entity.request.push(\"dataBytesStore\");\r\n            q.field(\"groupId\", grp.id);\r\n            q.field(\"name\", name);\r\n            let qr = await page.search(q);\r\n            if(qr && qr.results && qr.results.length){\r\n                let obj = qr.results[0];\r\n                if(obj.dataBytesStore && obj.dataBytesStore.length){\r\n                    return JSON.parse(uwm.base64Decode(obj.dataBytesStore));\r\n                }\r\n            }\r\n        } catch(e){\r\n            console.warn(\"Failed to load SD config: \" + name, e);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    async function saveSDConfig(name, config){\r\n        let grp = await page.makePath(\"auth.group\", \"DATA\", \"~/Data/.preferences\");\r\n        if(!grp) return false;\r\n\r\n        // Create a clean copy without transient fields\r\n        let saveConfig = {};\r\n        let excludeFields = [\"narration\", \"id\", \"objectId\", \"ownerId\"];\r\n        for(let k in config){\r\n            if(!excludeFields.includes(k)){\r\n                saveConfig[k] = config[k];\r\n            }\r\n        }\r\n\r\n        let obj;\r\n        try {\r\n            obj = await page.searchByName(\"data.data\", grp.objectId, name);\r\n        } catch(e){\r\n            // Object doesn't exist yet\r\n        }\r\n\r\n        if(!obj){\r\n            obj = am7model.newPrimitive(\"data.data\");\r\n            obj.name = name;\r\n            obj.mimeType = \"application/json\";\r\n            obj.groupId = grp.id;\r\n            obj.groupPath = grp.path;\r\n            obj.dataBytesStore = uwm.base64Encode(JSON.stringify(saveConfig));\r\n            await page.createObject(obj);\r\n        } else {\r\n            let patch = {id: obj.id, compressionType: \"none\", dataBytesStore: uwm.base64Encode(JSON.stringify(saveConfig))};\r\n            patch[am7model.jsonModelKey] = \"data.data\";\r\n            //console.log(patch, saveConfig);\r\n            await page.patchObject(patch);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    function applySDConfig(cinst, config){\r\n        if(!config) return;\r\n        let excludeFields = [\"narration\", \"id\", \"objectId\", \"groupId\", \"organizationId\", \"ownerId\", \"groupPath\", \"organizationPath\", \"seed\"];\r\n        for(let k in config){\r\n            if(!excludeFields.includes(k) && cinst.api[k]){\r\n                cinst.api[k](config[k]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Social sharing context mapping to wear levels\r\n    // Maps wear level names (from wearLevelEnumType) to social sharing tags\r\n    // Levels: NONE, INTERNAL, UNDER, ON, BASE, ACCENT, SUIT, GARNITURE, ACCESSORY, OVER, OUTER, FULL_BODY, ENCLOSURE, UNKNOWN\r\n    // UNDER/ON = tattoos/implants (under skin, on skin), BASE = skin contact clothing\r\n    const socialSharingMap = {\r\n        \"NONE\": \"nude\",      // No clothing - nude\r\n        \"INTERNAL\": \"nude\",  // Internal items (implants)\r\n        \"UNDER\": \"nude\",     // Under skin (implants)\r\n        \"ON\": \"nude\",        // On skin (tattoos)\r\n        \"BASE\": \"intimate\",           // Skin contact clothing (underwear)\r\n        \"ACCENT\": \"public\",           // Everything above BASE is public\r\n        \"SUIT\": \"public\",\r\n        \"GARNITURE\": \"public\",\r\n        \"ACCESSORY\": \"public\",\r\n        \"OVER\": \"public\",\r\n        \"OUTER\": \"public\",\r\n        \"FULL_BODY\": \"public\",\r\n        \"ENCLOSURE\": \"public\",\r\n        \"UNKNOWN\": null               // No automatic tag for unknown\r\n    };\r\n\r\n    // All social sharing tags that can be toggled in the gallery\r\n    // These are the subjective tags users can manually apply\r\n    const socialSharingTags = [\r\n        \"nude\",\r\n        \"selfie\",\r\n        \"inappropriate\",\r\n        \"intimate\",\r\n        \"sexy\",\r\n        \"private\",\r\n        \"casual\",\r\n        \"public\",\r\n        \"professional\"\r\n    ];\r\n\r\n    // Get or create a social sharing tag\r\n    async function getOrCreateSharingTag(tagName, objectType){\r\n        // First try to get existing tag\r\n        let tag = await page.getTag(tagName, objectType);\r\n        if(tag){\r\n            return tag;\r\n        }\r\n\r\n        // Create the tag if it doesn't exist\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"~/Tags\");\r\n        if(!grp){\r\n            console.warn(\"Tags group not found\");\r\n            return null;\r\n        }\r\n\r\n        let newTag = am7model.newPrimitive(\"data.tag\");\r\n        newTag.name = tagName;\r\n        newTag.type = objectType;\r\n        newTag.groupId = grp.id;\r\n        newTag.groupPath = grp.path;\r\n        newTag.description = \"Social sharing context: \" + tagName;\r\n\r\n        tag = await page.createObject(newTag);\r\n        return tag;\r\n    }\r\n\r\n    // Apply social sharing tag to an image based on wear level\r\n    async function applySharingTag(image, wearLevelName){\r\n        let sharingContext = socialSharingMap[wearLevelName];\r\n        if(!sharingContext){\r\n            // No automatic tag for this level (e.g., UNKNOWN)\r\n            return;\r\n        }\r\n\r\n        let tag = await getOrCreateSharingTag(sharingContext, \"data.data\");\r\n        if(!tag){\r\n            console.warn(\"Failed to get/create sharing tag: \" + sharingContext);\r\n            return;\r\n        }\r\n\r\n        // Make the image a member of the tag\r\n        await page.member(\"data.tag\", tag.objectId, \"data.data\", image.objectId, true);\r\n    }\r\n\r\n    // Toggle a sharing tag on an image\r\n    async function toggleSharingTag(image, tagName, enable){\r\n        let tag = await getOrCreateSharingTag(tagName, \"data.data\");\r\n        if(!tag){\r\n            console.warn(\"Failed to get/create sharing tag: \" + tagName);\r\n            return false;\r\n        }\r\n\r\n        // Add or remove membership\r\n        await page.member(\"data.tag\", tag.objectId, \"data.data\", image.objectId, enable);\r\n        return true;\r\n    }\r\n\r\n    // Expose for use in gallery\r\n    if(typeof window !== \"undefined\"){\r\n        window.am7sharingTags = {\r\n            tags: socialSharingTags,\r\n            toggle: toggleSharingTag,\r\n            getOrCreate: getOrCreateSharingTag\r\n        };\r\n    }\r\n\r\n    async function getCurrentWearLevel(inst){\r\n        // Get character's store and apparel\r\n        let sto = await page.searchFirst(\"olio.store\", undefined, undefined, inst.api.store().objectId);\r\n        if(!sto || !sto.apparel || !sto.apparel.length){\r\n            return null;\r\n        }\r\n\r\n        // Load the apparel and wearables\r\n        am7client.clearCache(\"olio.apparel\");\r\n        let aq = am7view.viewQuery(\"olio.apparel\");\r\n        aq.field(\"objectId\", sto.apparel[0].objectId);\r\n        let aqr = await page.search(aq);\r\n        let app;\r\n        if(aqr && aqr.results && aqr.results.length){\r\n            app = aqr.results[0];\r\n        }\r\n        if(!app || !app.wearables || !app.wearables.length){\r\n            return null;\r\n        }\r\n\r\n        // Load full wearable details\r\n        let q = am7view.viewQuery(\"olio.wearable\");\r\n        q.range(0, 20);\r\n        let oids = app.wearables.map((a) => a.objectId).join(\",\");\r\n        q.field(\"groupId\", app.wearables[0].groupId);\r\n        let fld = q.field(\"objectId\", oids);\r\n        fld.comparator = \"in\";\r\n        let qr = await page.search(q);\r\n        if(!qr || !qr.results || !qr.results.length){\r\n            return null;\r\n        }\r\n        let wears = qr.results;\r\n\r\n        // Find the current max level that is in use\r\n        let maxLevel = -1;\r\n        let maxLevelName = \"NUDE\";\r\n        wears.forEach((w) => {\r\n            if(w.level && w.inuse){\r\n                let lvl = am7model.enums.wearLevelEnumType.findIndex(we => we == w.level.toUpperCase());\r\n                if(lvl > maxLevel){\r\n                    maxLevel = lvl;\r\n                    maxLevelName = w.level.toUpperCase();\r\n                }\r\n            }\r\n        });\r\n\r\n        // Get level index (position in enum)\r\n        let levelIndex = maxLevel >= 0 ? maxLevel : 0;\r\n        return {level: maxLevelName, index: levelIndex};\r\n    }\r\n\r\n    async function reimage(object, inst) {\r\n\r\n        //let entity = am7model.newPrimitive(\"olio.sd.config\");\r\n        let entity = await m.request({ method: 'GET', url: am7client.base() + \"/olio/randomImageConfig\", withCredentials: true });\r\n        let cinst = (lastReimage || am7model.prepareInstance(entity, am7model.forms.sdConfig));\r\n\r\n        function tempApplyDefaults(){\r\n            // TODO - Add to form\r\n            cinst.api.steps(40);\r\n            cinst.api.refinerSteps(40);\r\n            cinst.api.cfg(5);\r\n            cinst.api.refinerCfg(5);\r\n            cinst.api.model(\"sdXL_v10VAEFix.safetensors\");\r\n            cinst.api.refinerModel(\"juggernautXL_ragnarokBy.safetensors\");\r\n        }\r\n\r\n        tempApplyDefaults();\r\n\r\n        // Try to load character-specific config\r\n        let charConfigName = inst.api.name() + \"-SD.json\";\r\n        let charConfig = await loadSDConfig(charConfigName);\r\n        if(charConfig){\r\n            applySDConfig(cinst, charConfig);\r\n        }\r\n\r\n        lastReimage = cinst;\r\n        await am7olio.setNarDescription(inst, cinst);\r\n\r\n        // Apply preferred seed from character attributes (overrides saved config)\r\n        let cseed = (inst.entity?.attributes || []).filter(a => a.name == \"preferredSeed\");\r\n        if(cseed.length){\r\n            cinst.api.seed(cseed[0].value);\r\n        }\r\n        let cfg = {\r\n            label: \"Reimage \" + inst.api.name(),\r\n            entityType: \"olio.sd.config\",\r\n            size: 75,\r\n            data: {entity:cinst.entity, inst: cinst},\r\n            confirm: async function (data) {\r\n                //console.log(data);\r\n                let count = cinst.api.imageCount ? (parseInt(cinst.api.imageCount()) || 1) : 1;\r\n                if(count < 1) count = 1;\r\n\r\n                let baseSeed = cinst.api.seed();\r\n                let images = [];\r\n                let wearLevel = await getCurrentWearLevel(inst);\r\n\r\n                for(let i = 0; i < count; i++){\r\n                    page.toast(\"info\", \"Creating image \" + (i + 1) + \" of \" + count + \"...\", -1);\r\n\r\n                    // Increment seed for subsequent images\r\n                    let useSeed = (i === 0) ? baseSeed : (parseInt(baseSeed) + i);\r\n                    let imgEntity = Object.assign({}, cinst.entity);\r\n                    imgEntity.seed = useSeed;\r\n\r\n                    let x = await m.request({ method: 'POST', url: am7client.base() + \"/olio/\" + inst.model.name + \"/\" + inst.api.objectId() + \"/reimage\", body: imgEntity, withCredentials: true });\r\n\r\n                    if(!x){\r\n                        page.toast(\"error\", \"Failed to create image \" + (i + 1));\r\n                        break;\r\n                    }\r\n\r\n                    // Tag image with wear level and apply sharing tag\r\n                    if(wearLevel){\r\n                        await am7client.patchAttribute(x, \"wearLevel\", wearLevel.level + \"/\" + wearLevel.index);\r\n                        await applySharingTag(x, wearLevel.level);\r\n                    }\r\n\r\n                    // Apply image tags (caption/description)\r\n                    await page.applyImageTags(x.objectId);\r\n\r\n                    images.push(x);\r\n\r\n                    // For first image, extract seed and update portrait\r\n                    if(i === 0){\r\n                        inst.entity.profile.portrait = x;\r\n\r\n                        let od = {id: inst.entity.profile.id, portrait: {id: x.id}};\r\n                        od[am7model.jsonModelKey] = \"identity.profile\";\r\n                        await page.patchObject(od);\r\n\r\n                        // Extract seed from response image (important for random seeds)\r\n                        let seed = x.attributes.filter(a => a.name == \"seed\");\r\n                        if(seed.length){\r\n                            await am7client.patchAttribute(inst.entity, \"preferredSeed\", seed[0].value);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                page.clearToast();\r\n\r\n                if(images.length > 0){\r\n                    page.toast(\"success\", \"Created \" + images.length + \" image(s)\");\r\n\r\n                    // Save SD config for this character\r\n                    let charConfigName = inst.api.name() + \"-SD.json\";\r\n                    let saveEntity = Object.assign({}, cinst.entity);\r\n                    saveEntity.shared = false; // Always save character config with shared=false\r\n                    await saveSDConfig(charConfigName, saveEntity);\r\n\r\n                    // If shared was checked, also save to shared config\r\n                    if(cinst.api.shared && cinst.api.shared()){\r\n                        await saveSDConfig(\"sharedSD.json\", cinst.entity);\r\n                        cinst.api.shared(false); // Reset checkbox after save\r\n                    }\r\n\r\n                    // Clear the context cache for this object and its portrait\r\n                    page.clearContextObject(inst.api.objectId());\r\n                    images.forEach(img => {\r\n                        if(img.objectId) page.clearContextObject(img.objectId);\r\n                    });\r\n\r\n                    // Force Mithril redraw\r\n                    m.redraw();\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"Reimage failed\");\r\n                }\r\n\r\n                endDialog();\r\n\r\n                // Show images - single or gallery\r\n                if(images.length === 1){\r\n                    page.imageView(images[0]);\r\n                } else if(images.length > 1){\r\n                    page.imageGallery(images, inst);\r\n                }\r\n\r\n            },\r\n            cancel: async function (data) {\r\n                endDialog();\r\n            }\r\n        };\r\n        \r\n        am7model.forms.sdConfig.fields.dressDown.field.command = async function(){\r\n            await am7olio.dressCharacter(inst, false);\r\n            await am7olio.setNarDescription(inst, cinst);\r\n        };\r\n        \r\n        am7model.forms.sdConfig.fields.dressUp.field.command = async function(){\r\n            await am7olio.dressCharacter(inst, true);\r\n            await am7olio.setNarDescription(inst, cinst);\r\n        };\r\n        am7model.forms.sdConfig.fields.randomSeed.field.command = async function(){\r\n            cinst.api.seed(-1);\r\n        };\r\n        am7model.forms.sdConfig.fields.createApparelSequence.field.command = async function(){\r\n            // Get character's store and apparel\r\n            let sto = await page.searchFirst(\"olio.store\", undefined, undefined, inst.api.store().objectId);\r\n            let appl = sto.apparel;\r\n            if(!appl || !appl.length){\r\n                page.toast(\"error\", \"No apparel found in store \" + sto.name);\r\n                return;\r\n            }\r\n\r\n            // Load the apparel and wearables\r\n            am7client.clearCache(\"olio.apparel\");\r\n            let aq = am7view.viewQuery(\"olio.apparel\");\r\n            aq.field(\"objectId\", appl[0].objectId);\r\n            let aqr = await page.search(aq);\r\n            let app;\r\n            if(aqr && aqr.results && aqr.results.length){\r\n                app = aqr.results[0];\r\n            }\r\n            if(!app || !app.wearables || !app.wearables.length){\r\n                page.toast(\"error\", \"No wearables found in apparel\");\r\n                return;\r\n            }\r\n\r\n            // Load full wearable details\r\n            let q = am7view.viewQuery(\"olio.wearable\");\r\n            q.range(0, 20);\r\n            let oids = app.wearables.map((a) => a.objectId).join(\",\");\r\n            q.field(\"groupId\", app.wearables[0].groupId);\r\n            let fld = q.field(\"objectId\", oids);\r\n            fld.comparator = \"in\";\r\n            let qr = await page.search(q);\r\n            if(!qr || !qr.results || !qr.results.length){\r\n                page.toast(\"error\", \"No wearables found\");\r\n                return;\r\n            }\r\n            let wears = qr.results;\r\n\r\n            // Get sorted unique wear levels present in wearables\r\n            let lvls = [...new Set(wears.sort((a, b) => {\r\n                let aL = am7model.enums.wearLevelEnumType.findIndex(we => we == a.level.toUpperCase());\r\n                let bL = am7model.enums.wearLevelEnumType.findIndex(we => we == b.level.toUpperCase());\r\n                return aL < bL ? -1 : aL > bL ? 1 : 0;\r\n            }).map((w) => w.level.toUpperCase()))];\r\n\r\n            if(!lvls.length){\r\n                page.toast(\"error\", \"No wear levels found\");\r\n                return;\r\n            }\r\n\r\n            // Dress down completely (all wearables off) first\r\n            page.toast(\"info\", \"Dressing down completely...\", -1);\r\n            let dressedDown = true;\r\n            while(dressedDown == true){\r\n                dressedDown = await am7olio.dressApparel(appl[0], false);\r\n            }\r\n\r\n            // Store original seed\r\n            let baseSeed = cinst.api.seed();\r\n            let images = [];\r\n\r\n            // Check if lowest level is not NUDE - if so, create a nude image first\r\n            let lowestLevel = lvls[0];\r\n            let nudeIdx = am7model.enums.wearLevelEnumType.findIndex(we => we == \"NUDE\");\r\n            let lowestIdx = am7model.enums.wearLevelEnumType.findIndex(we => we == lowestLevel);\r\n            let includeNude = (lowestIdx > nudeIdx);\r\n\r\n            // Iterate through each level from lowest to highest\r\n            page.toast(\"info\", \"Creating apparel sequence...\", -1);\r\n            let totalImages = lvls.length + (includeNude ? 1 : 0);\r\n\r\n            // Create nude image first if needed\r\n            if(includeNude){\r\n                await am7olio.setNarDescription(inst, cinst);\r\n                page.toast(\"info\", \"Creating image 1 of \" + totalImages + \" (level: NUDE)...\", -1);\r\n                let imgEntity = Object.assign({}, cinst.entity);\r\n                imgEntity.seed = baseSeed;\r\n                let x = await m.request({ method: 'POST', url: am7client.base() + \"/olio/\" + inst.model.name + \"/\" + inst.api.objectId() + \"/reimage\", body: imgEntity, withCredentials: true });\r\n                if(x){\r\n                    // Extract seed if it was random (-1)\r\n                    let seed = x.attributes.filter(a => a.name == \"seed\");\r\n                    if(seed.length){\r\n                        baseSeed = seed[0].value;\r\n                        await am7client.patchAttribute(inst.entity, \"preferredSeed\", baseSeed);\r\n                    }\r\n                    await am7client.patchAttribute(x, \"wearLevel\", \"NUDE/\" + nudeIdx);\r\n                    await applySharingTag(x, \"NUDE\");\r\n                    // Apply image tags (caption/description)\r\n                    await page.applyImageTags(x.objectId);\r\n                    images.push(x);\r\n                }\r\n            }\r\n\r\n            for(let i = 0; i < lvls.length; i++){\r\n                // Dress up to this level first (we start fully undressed)\r\n                await am7olio.dressApparel(appl[0], true);\r\n\r\n                // Update narration description for current outfit\r\n                await am7olio.setNarDescription(inst, cinst);\r\n\r\n                // Set seed (base seed + image count for 2nd+ images)\r\n                let useSeed = (images.length === 0) ? baseSeed : (parseInt(baseSeed) + images.length);\r\n                cinst.api.seed(useSeed);\r\n\r\n                // Create image\r\n                page.toast(\"info\", \"Creating image \" + (images.length + 1) + \" of \" + totalImages + \" (level: \" + lvls[i] + \")...\", -1);\r\n                let imgEntity = Object.assign({}, cinst.entity);\r\n                imgEntity.seed = useSeed;\r\n                let x = await m.request({ method: 'POST', url: am7client.base() + \"/olio/\" + inst.model.name + \"/\" + inst.api.objectId() + \"/reimage\", body: imgEntity, withCredentials: true });\r\n\r\n                if(!x){\r\n                    page.toast(\"error\", \"Failed to create image at level \" + lvls[i]);\r\n                    break;\r\n                }\r\n\r\n                // For first image (if no nude), extract seed if it was random (-1)\r\n                if(images.length === 0){\r\n                    let seed = x.attributes.filter(a => a.name == \"seed\");\r\n                    if(seed.length){\r\n                        baseSeed = seed[0].value;\r\n                        await am7client.patchAttribute(inst.entity, \"preferredSeed\", baseSeed);\r\n                    }\r\n                }\r\n\r\n                // Tag image with wear level and apply sharing tag\r\n                let levelIndex = am7model.enums.wearLevelEnumType.findIndex(we => we == lvls[i]);\r\n                await am7client.patchAttribute(x, \"wearLevel\", lvls[i] + \"/\" + levelIndex);\r\n                await applySharingTag(x, lvls[i]);\r\n\r\n                // Apply image tags (caption/description)\r\n                await page.applyImageTags(x.objectId);\r\n\r\n                images.push(x);\r\n            }\r\n\r\n            // Restore seed to extracted value (important if it was random)\r\n            cinst.api.seed(baseSeed);\r\n\r\n            // Save SD config for this character\r\n            if(images.length > 0){\r\n                let charConfigName = inst.api.name() + \"-SD.json\";\r\n                let saveEntity = Object.assign({}, cinst.entity);\r\n                saveEntity.shared = false;\r\n                await saveSDConfig(charConfigName, saveEntity);\r\n\r\n                // If shared was checked, also save to shared config\r\n                if(cinst.api.shared && cinst.api.shared()){\r\n                    await saveSDConfig(\"sharedSD.json\", cinst.entity);\r\n                    cinst.api.shared(false);\r\n                }\r\n            }\r\n            else{\r\n                page.toast(\"warn\", \"Nothing  to save\");\r\n            }\r\n\r\n            page.clearToast();\r\n            page.toast(\"success\", \"Created \" + images.length + \" images in apparel sequence\");\r\n            m.redraw();\r\n\r\n            // Show images in gallery\r\n            if(images.length === 1){\r\n                page.imageView(images[0]);\r\n            } else if(images.length > 1){\r\n                page.imageGallery(images, inst);\r\n            }\r\n        };\r\n        am7model.forms.sdConfig.fields.loadShared.field.command = async function(){\r\n            let sharedConfig = await loadSDConfig(\"sharedSD.json\");\r\n            if(sharedConfig){\r\n                let seed = cinst.api.seed(); // Preserve current seed\r\n                applySDConfig(cinst, sharedConfig);\r\n                cinst.api.seed(seed);\r\n                cinst.api.shared(false); // Reset shared checkbox after loading\r\n                m.redraw();\r\n                page.toast(\"success\", \"Loaded shared SD config\");\r\n            } else {\r\n                page.toast(\"warn\", \"No shared SD config found\");\r\n            }\r\n        };\r\n        am7model.forms.sdConfig.fields.randomConfig.field.command = async function(){\r\n            let ncfg = await m.request({ method: 'GET', url: am7client.base() + \"/olio/randomImageConfig\", withCredentials: true });\r\n            // Do style first since that drives the display\r\n            cinst.api.style(ncfg.style);\r\n            m.redraw();\r\n            let seed = cinst.api.seed();\r\n            for(let k in ncfg){\r\n                if(k != \"id\" && k != \"objectId\" && k != \"style\"){\r\n                    if(cinst.api[k]) cinst.api[k](ncfg[k]);\r\n                }\r\n            }\r\n            cinst.api.seed(seed);\r\n            tempApplyDefaults();\r\n            setTimeout(m.redraw, 10);\r\n        };\r\n        setDialog(cfg);\r\n    }\r\n\r\n    function loadDialog(){\r\n        if(!dialogCfg || !dialogUp) return \"\";\r\n        return createDialog(dialogCfg.size, dialogCfg.entityType, dialogCfg.data, dialogCfg.label, dialogCfg.confirm, dialogCfg.cancel);\r\n    }\r\n\r\n    function createDialog(size, entityType, data, title, fConf, fCanc){\r\n        let sizeCls = \"page-dialog-\" + (size || \"50\");\r\n\r\n        if(!data.view){\r\n            data.view = page.views.object().view;\r\n        }\r\n        let mconf = \"\";\r\n        if(fConf){\r\n            mconf = m(\"button\", {class: \"page-dialog-button\", onclick: async function(){ if(data.view) data.view.sync(); await fConf(data);}}, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-symbols-outlined-white md-18 mr-2\"}, \"check\"),\r\n                \"Ok\"\r\n            ])\r\n        }\r\n        return [\r\n            m(\"div\", {class: \"screen-glass screen-glass-open\"}, [\r\n                m(\"div\", {class: \"screen-glass-gray\"})\r\n            ]),\r\n            m(\"div\", {class: \"page-dialog-container\"}, [\r\n                m(\"div\", {class: \"page-dialog \" + sizeCls}, [\r\n                    m(\"div\", {class: \"list-results-container\"}, [\r\n                        m(\"div\", {class: \"list-results\"}, [\r\n                            m(\"div\",{class: \"result-nav-outer\"},[\r\n                                m(\"div\",{class: \"result-nav-inner\"},[\r\n                                        m(\"nav\",{class: \"result-nav\"},[\r\n                                        m(\"h3\", {class: \"box-title\"}, title)\r\n                                    ])\r\n                                ])\r\n                            ]),\r\n                            m(data.view, {\r\n                                freeForm: true,\r\n                                freeFormType: entityType,\r\n                                freeFormEntity: data.entity,\r\n                                freeFormInstance: data.inst\r\n                            }),\r\n                            m(\"div\",{class: \"result-nav-outer\"},[\r\n                                m(\"div\",{class: \"result-nav-inner\"},[\r\n                                    m(\"nav\",{class: \"result-nav\"},[\r\n                                       mconf,\r\n                                        m(\"button\", {class: \"page-dialog-button\", onclick: async function(){ await fCanc(data);}},[\r\n                                            m(\"span\", {class: \"material-symbols-outlined material-symbols-outlined-white md-18 mr-2\"}, \"cancel\"),\r\n                                            \"Cancel\"\r\n                                        ])\r\n                                    ])\r\n                                ])\r\n                            ]),\r\n                        ])\r\n                    ])\r\n                ])\r\n            ])\r\n        ];\r\n    }\r\n    \r\n    function confirm(sMessage, fConfirm, fCancel){\r\n        dialogCfg = {\r\n            label: \"Confirmation\",\r\n            entityType: \"confirmation\",\r\n            size: 50,\r\n            data: {\r\n                entity: {textData: sMessage}\r\n            },\r\n            confirm: function(data){\r\n                if(fConfirm) fConfirm(data);\r\n                dialogUp = false;\r\n                m.redraw();\r\n            },\r\n            cancel: function(data){\r\n                if(fCancel) fCancel(data);\r\n                dialogUp = false;\r\n                m.redraw();\r\n            }\r\n        };\r\n        dialogUp = true;\r\n        m.redraw();\r\n    }\r\n\r\n    function cancelDialog(obj){\r\n        dialogUp = false;\r\n        m.redraw();\r\n    }\r\n\r\n    let dialog = {\r\n        endDialog,\r\n        setDialog,\r\n        loadDialog,\r\n        confirm,\r\n        cancelDialog,\r\n        vectorize,\r\n        summarize,\r\n        reimage,\r\n        chatSettings,\r\n        showProgress,\r\n        chatInto\r\n    }\r\n    page.components.dialog = dialog;\r\n}())\n\n;/* === client/components/dnd.js === */\n(function () {\r\n\r\n    const dnd = {\r\n        dragTarget: undefined,\r\n        overTarget: undefined,\r\n        workingSet: []\r\n    };\r\n    dnd.doBlend = async function (sId) {\r\n        let blended = [];\r\n        let blender = [];\r\n        dnd.workingSet.forEach((w) => {\r\n            /// if an id is specified, then that is the item to apply to the rest of the set\r\n            /// if an id isn't specified, then the blender list will be any tag, event, group, or role\r\n            if ((sId && w.objectId == sId) || (!sId && w[am7model.jsonModelKey].match(/^(data\\.tag|olio\\.event|auth\\.group|auth\\.role)$/gi) && (!w[am7model.jsonModelKey].match(/^auth\\.group$/gi) || w.type.match(/^(person|account|bucket)$/gi)))) {\r\n                blender.push(w);\r\n            }\r\n            else {\r\n                blended.push(w);\r\n            }\r\n        });\r\n        let aP = [];\r\n        let filt = {};\r\n        blender.forEach((b) => {\r\n            blended.forEach((b2) => {\r\n                let actor = b2[am7model.jsonModelKey].match(/^identity\\.account|identity\\.person|olio\\.charPerson|system\\.user$/gi);\r\n                if ((b[am7model.jsonModelKey] == 'data.data' || b[am7model.jsonModelKey] == 'olio.charPerson') && (b2[am7model.jsonModelKey] == 'data.data' || b2[am7model.jsonModelKey] == 'olio.charPerson') && b[am7model.jsonModelKey] != b2[am7model.jsonModelKey]) {\r\n                    let p = b;\r\n                    let d = b2;\r\n                    if (p[am7model.jsonModelKey] == 'data.data') {\r\n                        p = b2;\r\n                        d = b;\r\n                    }\r\n\r\n                }\r\n                switch (b[am7model.jsonModelKey]) {\r\n\r\n                    case \"olio.llm.promptConfig\":\r\n                    case \"olio.llm.chatConfig\":\r\n                        if ((b2[am7model.jsonModelKey] == \"olio.llm.promptConfig\" || b2[am7model.jsonModelKey] == \"olio.llm.chatConfig\") && b2[am7model.jsonModelKey] != b[am7model.jsonModelKey]) {\r\n                            let cfg = {};\r\n                            cfg[b2[am7model.jsonModelKey]] = b2;\r\n                            cfg[b[am7model.jsonModelKey]] = b;\r\n                            page.context().contextObjects[\"chatConfig\"] = cfg;\r\n                            m.route.set(\"/chat\");\r\n                            break;\r\n                        }\r\n                    case \"auth.role\":\r\n                        if (actor && b.type == b2[am7model.jsonModelKey]) {\r\n                            aP.push(page.member(b[am7model.jsonModelKey], b.objectId, b2[am7model.jsonModelKey], b2.objectId, true));\r\n                            filt[b2.objectId] = true;\r\n                        }\r\n                        else {\r\n                            console.warn(\"Skip actor type: \" + b2[am7model.jsonModelKey] + \" for role \" + b.type);\r\n                        }\r\n                        break;\r\n                    case \"auth.group\":\r\n                        if ((actor && b2[am7model.jsonModelKey] == b.type) || (b.type == \"bucket\" && b2[am7model.jsonModelKey] != \"auth.group\")) {\r\n                            aP.push(page.member(b[am7model.jsonModelKey], b.objectId, b2[am7model.jsonModelKey], b2.objectId, true));\r\n                            filt[b2.objectId] = true;\r\n                        }\r\n                        else {\r\n                            console.warn(\"Skip actor type: \" + b2[am7model.jsonModelKey] + \" for group \" + b.type);\r\n                        }\r\n                        break;\r\n                    case \"data.tag\":\r\n                        if ((actor || b2[am7model.jsonModelKey].match(/^data\\.data$/gi)) && b2[am7model.jsonModelKey] == b.type) {\r\n                            // aP.push(page.tag(b2, b, true));\r\n                            aP.push(page.member(b[am7model.jsonModelKey], b.objectId, b2[am7model.jsonModelKey], b2.objectId, true));\r\n                            filt[b2.objectId] = true;\r\n                        }\r\n                        else {\r\n                            console.warn(\"Skip object type: \" + b2[am7model.jsonModelKey] + \" for tag type \" + b.type);\r\n                            console.warn(blender);\r\n                            console.warn(b);\r\n                        }\r\n                        break;\r\n                    /// Need to populate these in order to obtain contactInformation\r\n                    case \"system.user\":\r\n                    case \"identity.account\":\r\n                    case \"olio.charPerson\":\r\n                    case \"identity.person\":\r\n                        let bUp = false;\r\n                        console.log(b, b2);\r\n                        if (b2[am7model.jsonModelKey].match(/^identity\\.contact$/gi)) {\r\n                            b.contactInformation.contacts.push(b2);\r\n                            bUp = true;\r\n                        }\r\n                        if (b2[am7model.jsonModelKey].match(/^identity\\.address$/gi)) {\r\n                            b.contactInformation.addresses.push(b2);\r\n                            bUp = true;\r\n                        }\r\n                        if (bUp) {\r\n                            aP.push(page.patchObject(b));\r\n                        }\r\n\r\n                        console.log(\"Blend \" + b[am7model.jsonModelKey] + \" with \" + b2[am7model.jsonModelKey]);\r\n                        break;\r\n                    default:\r\n                        console.warn(\"Unhandled\", b[am7model.jsonModelKey]);\r\n                        break;\r\n\r\n                }\r\n            });\r\n\r\n\r\n        });\r\n        await Promise.all(aP);\r\n        dnd.workingSet = dnd.workingSet.filter((o) => !filt[o.objectId]);\r\n\r\n        console.log(\"Blended\", blender);\r\n\r\n    };\r\n    dnd.doDragDecorate = function (object) {\r\n        let cls;\r\n        if (!object || !object.objectId) return cls;\r\n        if (dnd.dragTarget && dnd.dragTarget.objectId == object.objectId) {\r\n            cls = \"hover:bg-orange-200\";\r\n        }\r\n        else if (dnd.overTarget && dnd.overTarget.objectId == object.objectId && dnd.dragTarget.objectId != object.objectId) {\r\n            let modType = am7model.getModel(object[am7model.jsonModelKey]);\r\n            if (dnd.overTarget[am7model.jsonModelKey].match(/^auth\\.group$/gi) || am7model.inherits(modType, \"common.parent\")) {\r\n                cls = \"hover:bg-green-200 bg-green-200\";\r\n            }\r\n        }\r\n        return cls;\r\n    }\r\n\r\n    dnd.doDragStart = function (e, obj) {\r\n        e.dataTransfer.setData('text', obj.objectId);\r\n        dnd.dragTarget = obj;\r\n    }\r\n\r\n    dnd.doDragOver = function (e, obj) {\r\n        if (obj && dnd.dragTarget) {\r\n\r\n            if (typeof obj === \"string\") {\r\n                dnd.overTarget = obj;\r\n            }\r\n            if (obj.objectId != dnd.dragTarget.objectId) {\r\n                dnd.overTarget = obj;\r\n            }\r\n        }\r\n    }\r\n    dnd.doDragEnd = function (e, obj) {\r\n        dnd.dragTarget = undefined;\r\n        dnd.overTarget = undefined;\r\n    }\r\n    dnd.doDrop = async function (e, obj) {\r\n        let ret = false;\r\n        if (obj && dnd.dragTarget) {\r\n            let dragGroup = dnd.dragTarget[am7model.jsonModelKey].match(/^auth\\.group$/gi);\r\n            let dragParent = am7model.isParent(dnd.dragTarget[am7model.jsonModelKey]);\r\n\r\n            let dragModType = am7model.getModel(dnd.dragTarget[am7model.jsonModelKey]);\r\n            if (typeof obj === \"string\") {\r\n                if (obj === \"set\") {\r\n                    let aL = dnd.workingSet.filter((o) => { if (o.objectId == dnd.dragTarget.objectId) return true; });\r\n                    if (aL.length) {\r\n                        console.warn(\"Already in set\");\r\n                    }\r\n                    else {\r\n                        dnd.workingSet.push(dnd.dragTarget);\r\n                        ret = true;\r\n                    }\r\n                }\r\n            }\r\n            else if (dnd.overTarget) {\r\n                let overParent = am7model.isParent(dnd.overTarget[am7model.jsonModelKey]);\r\n                let dropGroup = dnd.overTarget[am7model.jsonModelKey].match(/^auth\\.group$/gi);\r\n                console.log(dnd.dragTarget, dnd.overTarget, dragParent, overParent);\r\n                if ((dragGroup && dropGroup) || (dragParent && overParent)) {\r\n                    ret = await page.reparentObject(dnd.dragTarget, dnd.overTarget);\r\n                }\r\n                else if (dropGroup && am7model.isGroup(dragModType)) {\r\n                    ret = await page.moveObject(dnd.dragTarget, dnd.overTarget);\r\n                }\r\n                else {\r\n                    console.warn(\"Don't know what to do: Drop: \" + dnd.dragTarget.name + \" on \" + dnd.overTarget.name);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n\r\n    }\r\n\r\n    let totalUpCount = 0;\r\n    let currentUpCount = 0;\r\n    let maxUpload = 10;\r\n    dnd.uploadFiles = async function(inst, files) {\r\n        let entity = inst?.entity;\r\n        if(!entity){\r\n            return;\r\n        }\r\n\r\n        totalUpCount = files.length;\r\n        currentUpCount = 0;\r\n\r\n        let pb = am7model.prepareInstance(am7model.newPrimitive(\"progress\"), am7model.forms.progress);\r\n        //let pb = am7model.newPrimitive(\"progress\");\r\n        pb.api.label(\"Uploading \" + files.length + \" files\");\r\n        pb.api.progress(0);\r\n        page.components.dialog.showProgress(pb.entity, pb);\r\n\r\n        let aP = [];\r\n        if(inst.model.name != \"data.data\"){\r\n            \r\n            return new Promise((res, rej) =>{\r\n                //for(let i = 0; i < files.length; i++){\r\n                    var fileReader = new FileReader();  \r\n                    fileReader.onload = function() {\r\n                        //if(files[i].name.match(/\\.json$/gi)){\r\n                            let obj = JSON.parse(this.result);\r\n                            let clearFlds = [\"objectId\", \"id\", \"ownerId\", \"urn\", \"groupPath\", \"organizationId\", \"organizationPath\", \"vaultId\", \"vaulted\", \"keyId\"];\r\n                            for(let f in clearFlds){\r\n                                delete obj[f];\r\n                            }\r\n\r\n                            if(inst.api.groupId){\r\n                                console.warn(\"Creating\");\r\n                                obj.groupId = inst.api.groupId();\r\n                                obj.groupPath = inst.api.groupPath();\r\n                                page.createObject(obj).then((o) => {\r\n                                    let uri = \"/view/\" + obj.schema + \"/\" + o.objectId;\r\n                                    m.route.set(uri, {key: o.objectId});\r\n                                });\r\n                            }\r\n                            else{\r\n                                logger.warn(\"Need a group\");\r\n                            }\r\n\r\n                        //}\r\n                        //else{\r\n                          //  console.warn(\"Skipped \" + files[i].name);\r\n                        //}\r\n                    };\r\n                    fileReader.readAsText(files[0]);\r\n                    page.components.dialog.endDialog();\r\n\r\n                //}\r\n                res();\r\n            });\r\n        }\r\n        for (var i = 0; i < files.length; i++) {\r\n            if(i > 0){\r\n                pb.api.label(\"Uploading (\" + i + \" of \" + files.length + \")\");\r\n                pb.api.progress(parseInt((i / files.length) * 100));\r\n                console.log(pb.api.label() + \" \" + pb.api.progress() + \"%\");\r\n                m.redraw();\r\n            }\r\n            var formData = new FormData();\r\n            formData.append(\"organizationPath\", am7client.currentOrganization);\r\n            formData.append(\"groupPath\", entity.groupPath);\r\n            let fname = files[i].name;\r\n            formData.append(\"name\", files[i].name);\r\n            formData.append(\"dataFile\", files[i]);\r\n            aP.push(new Promise((res, rej)=>{\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.withCredentials = true;\r\n                console.log(\"Posting: \" + g_application_path + '/mediaForm');\r\n                xhr.open('POST', g_application_path + '/mediaForm');\r\n                xhr.onload = function(v){\r\n                    res(fname);\r\n                };\r\n                xhr.upload.onprogress = function(event){\r\n                    ///ctl.updateWaitingCount();\r\n                };\r\n                xhr.send(formData);\r\n            }));\r\n            if(i > 0 && (i % maxUpload) == 0){\r\n                await Promise.all(aP);\r\n                aP = [];\r\n            }\r\n\r\n        }\r\n        return new Promise((res2, rej2)=>{\r\n            Promise.all(aP).then((aD)=>{\r\n                page.components.dialog.endDialog();\r\n                if(aD.length == 1){\r\n                    page.findObject(\"auth.group\", \"data\", entity.groupPath).then((oG)=>{\r\n                        if(!oG){\r\n                            page.toast(\"error\", \"Failed to lookup group\", oG);\r\n                        }\r\n                        else{\r\n                            page.openObjectByName(\"data.data\", oG.objectId, aD[0]).then((oD)=>{\r\n                                if(!oD){\r\n                                    page.toast(\"error\", \"Failed to lookup data\");\r\n                                }\r\n                                else{\r\n                                    let uri = \"/view/data.data/\" + oD.objectId;\r\n                                    m.route.set(uri, {key: oD.objectId});\r\n                                    res2();\r\n                                }\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n                else{\r\n                    res2();\r\n                }\r\n            });\r\n        });\r\n\r\n    }\r\n\r\n    function handleDragLeave(evt) {\r\n        evt.preventDefault();\r\n    }\r\n    function handleDragEnter(evt) {\r\n        evt.preventDefault();\r\n    }\r\n    function handleDragOver(evt) {\r\n        evt.preventDefault();\r\n    }\r\n    function handleDrop(inst, evt) {\r\n        evt.preventDefault();\r\n        dnd.uploadFiles(inst, evt.dataTransfer.files);\r\n    }\r\n\r\n    dnd.dropProps = function(inst){\r\n        return {\r\n            ondrop: function(e){ handleDrop(inst, e); },\r\n            ondragover: handleDragOver,\r\n            ondragenter: handleDragEnter,\r\n            ondragleave: handleDragLeave\r\n        };\r\n    };\r\n\r\n    dnd.dragProps = function(p){\r\n        return {\r\n          ondragover: function (e) { dnd.doDragOver(e, p); },\r\n          ondragend: function (e) { dnd.doDragEnd(e, p); },\r\n          ondragstart: function (e) { dnd.doDragStart(e, p); },\r\n          ondrop: function (e) { dnd.doDrop(e, p); }\r\n        };\r\n      };\r\n\r\n    page.components.dnd = dnd;\r\n}());\r\n\r\n\n\n;/* === client/components/pdf.js === */\n(function(){\r\nlet viewers = {};\r\nfunction pdfViewer(inInst){\r\n\r\n    if(typeof inInst == \"string\"){\r\n        return viewers[inInst];\r\n    }\r\n\r\n    let eventBus;\r\n\r\n    let currentPage = 1;\r\n    let pageCount = 0;\r\n    let scale = 1.0;\r\n    let raster = [];\r\n    let pdfDocument;\r\n    let inst = inInst;\r\n    let didInit = false;\r\n    function pdfControls(){\r\n\r\n        let cls = \"button\";\r\n        let fp = page.iconButton(\"button ml-4\", \"keyboard_double_arrow_left\", \"\", function(){\r\n            document.querySelector(\"#pdfContainer\").innerHTML = \"\";\r\n           render(1, scale);\r\n        });\r\n\r\n        let zoom = [m(\"input\", {type: \"range\", step: 5, max: 300, min: 25, class: \"inline-block ml-2 h-10 range-field-full\", value: (scale * 100), onchange: function(e){\r\n\t\t\t    document.querySelector(\"#pdfContainer\").innerHTML = \"\";    \r\n                scale = parseInt(e.target.value) / 100;\r\n                render(currentPage, scale);\r\n            }}),\r\n            m(\"span\", {\"class\": \"inline-block text-content mr-2 mt-0 mb-0\"}, (scale * 100).toFixed(0) + \"%\"),\r\n            m(\"span\", {\"class\": \"inline-block text-content w-72 ml-2 mr-2 mt-0 mb-0\"}, \"Page \" + currentPage + \" of \" + pageCount)\r\n        ];\r\n\r\n        \r\n        \r\n        let pb = page.iconButton(\"button\", \"chevron_left\", \"\", function(){\r\n            document.querySelector(\"#pdfContainer\").innerHTML = \"\";\r\n            render(Math.max(1, currentPage - 1), scale);\r\n        });\r\n        let lp = page.iconButton(\"button\", \"keyboard_double_arrow_right\", \"\", function(){\r\n            document.querySelector(\"#pdfContainer\").innerHTML = \"\";\r\n            render(pageCount, scale);\r\n         });\r\n         \r\n         let np = page.iconButton(\"button\", \"chevron_right\", \"\", function(){\r\n            document.querySelector(\"#pdfContainer\").innerHTML = \"\";\r\n             render(Math.min(pageCount, currentPage + 1), scale);\r\n         });\r\n\r\n        return m(\"div\",{class: \"result-nav-outer\"},[\r\n            m(\"div\",{class: \"result-nav-inner\"},[\r\n                m(\"div\",{class: \"result-nav\"},\r\n                    [\r\n                        fp, pb, zoom, np, lp\r\n                    ]\r\n                )\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function pdfContainer(){\r\n        return[pdfControls(), m(\"div\", {id: 'pdfContainer', class: \"pdfViewer singlePageView\"})];\r\n    }\r\n    async function loadPdf(){\r\n        if(pdfDocument){\r\n            return pdfDocument\r\n        }\r\n        if(!eventBus){\r\n            eventBus = new pdfjsViewer.EventBus();\r\n        }\r\n        if(!pdfjsLib.GlobalWorkerOptions.workerSrc){\r\n            pdfjsLib.GlobalWorkerOptions.workerSrc = \"/node_modules/pdfjs-dist/build/webpack/pdf.worker.bundle.js\";\r\n        }\r\n\r\n        let bits = am7model.base64ToUint8(inst.entity.dataBytesStore);\r\n        let loadingTask = pdfjsLib.getDocument(bits);\r\n        pdfDocument = await loadingTask.promise;\r\n        return pdfDocument;\r\n    }\r\n    \r\n    async function init(scale){\r\n        let container = document.querySelector(\"#pdfContainer\");\r\n        if(container && inst && !didInit){\r\n            didInit = true;\r\n            await render(1, scale || 1.0);\r\n        }\r\n        else if(didInit){\r\n            // console.warn(\"PDF already initialized.\");\r\n        }\r\n    }\r\n\r\n    async function render(pdfPageNum, pdfScale){\r\n    \r\n        if(!inst || !inst.model.name == \"data.data\"){\r\n            console.error(\"Invalid instance or model name.\", inst);\r\n            return;\r\n        }\r\n        if(!inst.entity.dataBytesStore){\r\n            console.info(\"Data is empty.\", inst);\r\n            return;\r\n        }\r\n        if(pdfPageNum){\r\n            currentPage = pdfPageNum;\r\n        }\r\n        if(pdfScale){\r\n            scale = pdfScale;\r\n        }\r\n\r\n        let container = document.querySelector(\"#pdfContainer\");\r\n        if(container != null){\r\n            let doc = await loadPdf(inst);\r\n            if(!doc){\r\n                console.error(\"Failed to load pdf document.\");\r\n            }\r\n\r\n            pageCount = doc.numPages;\r\n            let pdfPage = await doc.getPage(currentPage);\r\n            if(!pdfPage){\r\n                console.error(\"Failed to load page \" + currentPage);\r\n                return;\r\n            }\r\n\r\n           let viewport = pdfPage.getViewport({ scale: scale });\r\n            let pdfPageView = new pdfjsViewer.PDFPageView({\r\n                container,\r\n                id: pdfPageNum,\r\n                scale: scale,\r\n                defaultViewport: viewport,\r\n                eventBus,\r\n            });\r\n            pdfPageView.setPdfPage(pdfPage);\r\n            pdfPageView.draw();\r\n            currentPage = pdfPageNum;\r\n        }\r\n\r\n    }\r\n\r\n    let pdf = {\r\n        controls: pdfControls,\r\n        init,\r\n        render,\r\n        container: pdfContainer,\r\n        clear: function(){\r\n            didInit = false;\r\n            /*\r\n            if(inst && inst.entity.objectId){\r\n                delete viewers[inst.entity.objectId];\r\n            }\r\n            */\r\n        }\r\n    }\r\n    if(inst && inst.entity.objectId){\r\n        viewers[inst.entity.objectId] = pdf;\r\n    }\r\n\r\n    return pdf;\r\n}\r\n    page.components.pdf = {\r\n        viewer: pdfViewer,\r\n        viewers,\r\n        clear: function(objectId){\r\n            if(!objectId){\r\n                for(let k in viewers){\r\n                    viewers[k].clear();\r\n                }\r\n            }\r\n            else if(viewers[objectId]){\r\n                viewers[objectId].clear();\r\n            }\r\n        }\r\n    };\r\n}())\n\n;/* === client/components/olio.js === */\n(function () {\r\n    async function dressUp(object, inst, name){\r\n        if(inst.model.name == \"olio.charPerson\"){\r\n            await dressCharacter(inst, true);\r\n        }\r\n        else if(inst.model.name == \"olio.apparel\"){\r\n            await dressApparel(inst.entity, true);\r\n        }\r\n    }\r\n    async function dressDown(object, inst, name){\r\n        if(inst.model.name == \"olio.charPerson\"){\r\n            await dressCharacter(inst, false);\r\n        }\r\n        else if(inst.model.name == \"olio.apparel\"){\r\n            await dressApparel(inst.entity, false);\r\n        }\r\n    }\r\n\r\n    async function setApparelDescription(app, wears){\r\n        let wdesc = wears.filter((w) => w.inuse).map((w) => describeWearable(w)).join(\", \");\r\n        app.description = \"Worn apparel includes \" + wdesc + \".\";\r\n        if(wdesc.length == 0){\r\n            app.description = \"No apparel worn.\";\r\n        }\r\n        console.log(\"Setting description to \" + app.description);\r\n        await page.patchObject({schema: 'olio.apparel', id: app.id, description: app.description}); \r\n        m.redraw();\r\n    }\r\n\r\n    function describeWearable(wear){\r\n\r\n        let qual = wear.qualities ? wear.qualities[0] : null;\r\n        let opac = qual?.opacity || 0.0;\r\n        let shin = qual?.shininess || 0.0;\r\n        let smoo = qual?.smoothness || 0.0;\r\n        let col = wear?.color?.name.toLowerCase() || \"\";        \r\n       \r\n        if(col){\r\n            col = col.replaceAll(/([\\^\\(\\)]*)/g, \"\");\r\n        }\r\n        let fab = wear?.fabric?.toLowerCase() || \"\";\r\n        let pat = wear?.pattern?.name.toLowerCase() || \"\";\r\n        let loc = wear?.location[0]?.toLowerCase() || \"\"\r\n        let name = wear?.name;\r\n        if(name.indexOf(\"pierc\") > -1) {\r\n            name = loc + \" piercing\";\r\n            pat = \"\";\r\n        }\r\n        let opacs = \"\";\r\n        if(opac > 0.0 && opac <= 0.25) {\r\n            opacs = \" see-through\";\r\n        }\r\n        let shins = \"\";\r\n        if(shin >= 0.7) {\r\n            shins = \" shiny\";\r\n        }\r\n    \r\n        return (shins + opacs + \" \" + col + \" \" + pat + \" \" + fab + \" \" + name).replaceAll(\"  \", \" \").trim();\r\n    \r\n    }\r\n\r\n    async function dressCharacter(inst, dressUp){\r\n        let sto = await page.searchFirst(\"olio.store\", undefined, undefined, inst.api.store().objectId);\r\n        let appl = sto.apparel;\r\n        if(!appl || !appl.length){\r\n            page.toast(\"error\", \"No apparel found in store \" + sto.name);\r\n            return;\r\n        }\r\n        let bdress = await dressApparel(appl[0], dressUp);\r\n        if(bdress){\r\n            await am7model.forms.commands.narrate(undefined, inst);\r\n        }\r\n    }\r\n    async function dressApparel(vapp, dressUp){\r\n        am7client.clearCache(\"olio.apparel\");\r\n        let aq = am7view.viewQuery(\"olio.apparel\");\r\n        aq.field(\"objectId\", vapp.objectId);\r\n        let aqr = await page.search(aq);\r\n        let app;\r\n        if(aqr && aqr.results && aqr.results.length){\r\n            app = aqr.results[0];\r\n        }\r\n        else{\r\n            page.toast(\"error\", \"No apparel found for \" + vapp.objectId);\r\n            return;\r\n        }\r\n\r\n        if(!app){\r\n            page.toast(\"error\", \"No apparel found for \" + vapp.objectId);\r\n            return;\r\n        }\r\n\r\n        let wear = app.wearables;\r\n        if(!wear || !wear.length){ \r\n            page.toast(\"error\", \"No wearables found in apparel \" + app.name);\r\n        }\r\n\r\n        let q = am7view.viewQuery(\"olio.wearable\");\r\n        q.range(0, 20);\r\n        let oids = wear.map((a) => { return a.objectId; }).join(\",\");\r\n        q.field(\"groupId\", wear[0].groupId);\r\n        let fld = q.field(\"objectId\", oids);\r\n        fld.comparator = \"in\";\r\n\r\n        let qr = await page.search(q);\r\n        if(!qr || !qr.results || !qr.results.length){\r\n            page.toast(\"error\", \"No wearables found in apparel \" + app.name);\r\n            return;\r\n        }\r\n        let wears = qr.results;\r\n\r\n        \r\n        let minLevel = 3;\r\n        let availMin = am7model.enums.wearLevelEnumType.findIndex(we => we == \"UNKNOWN\");\r\n        let maxLevel = minLevel;\r\n        let lvls = [...new Set(wears.sort((a, b) => {\r\n            let aL = am7model.enums.wearLevelEnumType.findIndex(we => we == a.level.toUpperCase());\r\n            let bL = am7model.enums.wearLevelEnumType.findIndex(we => we == b.level.toUpperCase());\r\n            return aL < bL ? -1 : aL > bL ? 1 : 0;\r\n        }).map((w) => w.level.toUpperCase()))];\r\n        \r\n        wears.forEach((w) => {\r\n            if(w.level){\r\n                let lvl = am7model.enums.wearLevelEnumType.findIndex(we => we == w.level.toUpperCase());\r\n                if(w.inuse){\r\n                    maxLevel = Math.max(maxLevel, lvl);\r\n                }\r\n                \r\n                else{\r\n                    availMin = Math.min(availMin, lvl);\r\n                }\r\n            }\r\n        });\r\n\r\n        let ulevel = (dressUp ? availMin : maxLevel);\r\n        let maxLevelName = am7model.enums.wearLevelEnumType[ulevel];\r\n        let maxLevelIdx = lvls.findIndex((l) => l == maxLevelName);\r\n\r\n        if(!lvls.includes(maxLevelName) || maxLevelIdx == -1){\r\n            page.toast(\"info\", \"No wearables found in apparel \" + app.name + \" for level \" + maxLevelName);\r\n            return false;\r\n        }\r\n\r\n        console.log(\"Max level is \" + maxLevelName + \" at index \" + maxLevelIdx + \" of \" + lvls.length);\r\n        if(dressUp && maxLevelIdx >= lvls.length){\r\n            page.toast(\"info\", \"Already dressed up to max level\");\r\n            return false; // Can't dress up anymore\r\n        }\r\n        else if(!dressUp && maxLevelIdx < 0){\r\n            page.toast(\"info\", \"Already dressed down to min level\");\r\n            return false; // Can't dress down anymore\r\n        }\r\n\r\n        let newLevel = am7model.enums.wearLevelEnumType.findIndex(we => we == lvls[maxLevelIdx + (dressUp ? 0 : -1)]);\r\n        let patch = [];\r\n        wears.forEach((w) => {\r\n            if(w.level){\r\n                let lvl = am7model.enums.wearLevelEnumType.findIndex(we => we == w.level.toUpperCase());\r\n                if(lvl > newLevel && w.inuse){\r\n                    w.inuse = false;\r\n                    patch.push({schema: 'olio.wearable', id: w.id, inuse: false});\r\n                }\r\n                else if(lvl <= newLevel && !w.inuse){\r\n                    w.inuse = true;\r\n                    patch.push({schema: 'olio.wearable', id: w.id, inuse: true});\r\n                }\r\n            }\r\n        });\r\n\r\n        if(patch.length || !app.description){\r\n            await setApparelDescription(app, wears);\r\n            vapp.description = app.description;\r\n        }\r\n\r\n        if(!patch.length){\r\n            page.toast(\"info\", \"No changes to make to \" + app.name + \" for level \" + newLevel);\r\n            // No changes but may still be able to continue dressing\r\n            return true;\r\n        }\r\n        \r\n        console.log(\"Patching \" + patch.length + \" items to level \" + newLevel);\r\n        let aP = [];\r\n        patch.forEach((p) => {\r\n            aP.push(page.patchObject(p));\r\n        });\r\n        /*\r\n        await am7client.clearCache(\"olio.wearable\");\r\n        await am7client.clearCache(\"olio.apparel\");\r\n        await am7client.clearCache(\"olio.store\");\r\n        await am7client.clearCache(\"olio.charPerson\");\r\n        await am7client.clearCache(\"olio.narrative\");\r\n        */\r\n        await am7client.clearCache();\r\n        await Promise.all(aP);\r\n        return true;\r\n    }\r\n\r\n    async function setNarDescription(inst, cinst){\r\n        am7client.clearCache(\"olio.narrative\");\r\n        let nar = await page.searchFirst(\"olio.narrative\", undefined, undefined, inst.api.narrative().objectId);\r\n        let pro = (inst.api.gender() == \"male\" ? \"He\" : \"She\");\r\n        cinst.api.description(inst.api.firstName() + \" is a \" + nar.physicalDescription + \" \" + pro + \" is \" + nar.outfitDescription + \".\");\r\n    }\r\n\r\n    let am7olio = {\r\n        dressUp,\r\n        dressDown,\r\n        dressCharacter,\r\n        dressApparel,\r\n        setNarDescription\r\n    };\r\n\r\n    if (typeof module != \"undefined\") {\r\n        module.am7olio = am7olio;\r\n    } else {\r\n        window.am7olio = am7olio;\r\n    }\r\n}());\n\n;/* === client/formDef.js === */\n(function () {\r\n    /// TODO: Currently out of date\r\n    let forms = {\r\n        access: {},\r\n        auth: {},\r\n        common: {},\r\n        crypto: {},\r\n        data: {},\r\n        identity: {},\r\n        message: {},\r\n        olio: {},\r\n        policy: {},\r\n        system: {}\r\n    };\r\n\r\n    forms.nameIdType = {\r\n        fields: [\"name\"]\r\n    };\r\n    forms.attribute = {\r\n        label: \"Attribute\",\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n\r\n        fields: {\r\n            valueType: {\r\n                layout: \"one\"\r\n            },\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            value: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.control = {\r\n        label: \"Control\",\r\n        requiredAttributes: [],\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n\r\n        fields: {\r\n            controlType: {\r\n                layout: \"third\"\r\n            },\r\n            controlId: {\r\n                layout: \"third\"\r\n            },\r\n            action: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    };\r\n    forms.controls = {\r\n        label: \"Controls\",\r\n        format: \"table\",\r\n        fields: {\r\n            controls: {\r\n                layout: 'half',\r\n                form: forms.control\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.requestList = {\r\n        label: \"Request\",\r\n        requiredAttributes: [\"objectId\"],\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n\r\n        fields: {\r\n            approvalStatus: {\r\n                layout: \"one\"\r\n            },\r\n            entitlementType: {\r\n                layout: \"one\"\r\n            },\r\n            entitlementrel: {\r\n                layout: \"third\"\r\n            },\r\n            requestorrel: {\r\n                layout: \"third\"\r\n            }\r\n            /*\r\n            ,\r\n            referencerel : {\r\n                layout : \"third\"\r\n            }\r\n            */\r\n        }\r\n    };\r\n    forms.requestsList = {\r\n        label: \"Requests\",\r\n        fields: {\r\n            requests: {\r\n                layout: 'half',\r\n                form: forms.requestList\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.request = {\r\n        label: \"Requests\",\r\n        fields: {\r\n            approvalStatus: {\r\n                layout: \"one\"\r\n            },\r\n            entitlementType: {\r\n                layout: \"one\"\r\n            },\r\n            entitlementrel: {\r\n                layout: \"third\"\r\n            },\r\n            requestorrel: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"dateinfo\", \"attributes\"]\r\n    };\r\n\r\n\r\n\r\n    forms.attributes = {\r\n        label: \"Attributes\",\r\n        format: \"table\",\r\n        /*requiredAttributes : [\"objectId\"],*/\r\n        fields: {\r\n            attributes: {\r\n                layout: 'full',\r\n                form: forms.attribute\r\n            }\r\n        }\r\n    };\r\n    \r\n\r\n\r\n    forms.ctlattributes = {\r\n        label: \"Controls and Attributes\",\r\n        /*requiredAttributes : [\"objectId\"],*/\r\n        fields: {\r\n            attributes: {\r\n                layout: 'half',\r\n                form: forms.attribute\r\n            },\r\n            controls: {\r\n                /*requiredAttributes : [\"objectId\"],*/\r\n                layout: \"half\",\r\n                form: forms.control\r\n            }\r\n        }\r\n    };\r\n    forms.reqattributes = {\r\n        label: \"Requests and Attributes\",\r\n        /*requiredAttributes : [\"objectId\"],*/\r\n        fields: {\r\n            attributes: {\r\n                layout: 'half',\r\n                form: forms.attribute\r\n            },\r\n            requestsList: {\r\n                requiredAttributes: [\"objectId\"],\r\n                layout: \"half\",\r\n                form: forms.requestList\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    forms.elementValues = {\r\n        label: \"Select Option\",\r\n        requiredAttributes: [\"elementType\"],\r\n        requiredValues: [\"SELECT|MULTIPLE_SELECT\"],\r\n        referField: true,\r\n        commands: {\r\n            new: {\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            textValue: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.dateinfo = {\r\n        label: \"Info\",\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            urn: {\r\n                layout: \"third\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            expiryDate: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    };\r\n    /*\r\n    forms.subdateinfo = {\r\n        label : \"Info\",\r\n        fields : {\r\n            uri : {\r\n                layout : \"half\"\r\n            },\r\n            objectId : {\r\n                layout : \"half\"\r\n            },\r\n            createdDate : {\r\n                layout : \"third\"\r\n            },\r\n            modifiedDate : {\r\n                layout : \"third\"\r\n            },\r\n            expiryDate : {\r\n                layout : \"third\"\r\n            }\r\n        }\r\n    };\r\n    */\r\n    forms.messageMeta = {\r\n        label: \"Message Meta\",\r\n        fields: {\r\n            senderType: {\r\n                layout: \"one\"\r\n            },\r\n            senderId: {\r\n                layout: \"third\"\r\n            },\r\n            recipientType: {\r\n                layout: \"one\"\r\n            },\r\n            recipientId: {\r\n                layout: \"third\"\r\n            },\r\n            expires: {\r\n                layout: \"one\"\r\n            },\r\n            uri: {\r\n                layout: \"half\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            expiryDate: {\r\n                layout: \"third\"\r\n            },\r\n            transportType: {\r\n                layout: \"one\"\r\n            },\r\n            transportId: {\r\n                layout: \"third\"\r\n            },\r\n            referenceType: {\r\n                layout: \"one\"\r\n            },\r\n            referenceId: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    };\r\n    forms.message = {\r\n        label: \"Message\",\r\n        fields: {\r\n\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            valueType: {\r\n                layout: \"half\"\r\n            },\r\n            spoolBucketType: {\r\n                layout: \"third\"\r\n            },\r\n            spoolBucketName: {\r\n                layout: \"third\"\r\n            },\r\n            spoolStatus: {\r\n                layout: \"third\"\r\n            },\r\n            data: {\r\n                layout: \"full\"\r\n            }\r\n        },\r\n        forms: [\"messageMeta\"]\r\n    };\r\n\r\n\r\n    forms.groupdateinfo = {\r\n        label: \"Info\",\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            urn: {\r\n                layout: \"third\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            expiryDate: {\r\n                layout: \"third\"\r\n            },\r\n            groupPath: {\r\n                layout: \"half\"\r\n            }\r\n        }\r\n    };\r\n    forms.groupinfo = {\r\n        label: \"Info\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            urn: {\r\n                layout: \"third\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            groupPath: {\r\n                layout: \"half\"\r\n            }\r\n        }\r\n    }\r\n    forms.lightgroupinfo = {\r\n        label: \"Info\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            groupPath: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    }\r\n    forms.parentinfo = {\r\n        label: \"Info\",\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            urn: {\r\n                layout: \"third\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            path: {\r\n                layout: \"half\"\r\n            }\r\n        }\r\n    }\r\n    forms.grouptypeinfo = {\r\n        label: \"Info\",\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            /*\r\n            urn : {\r\n                layout : \"third\"\r\n            },\r\n            */\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            },\r\n            groupPath: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    }\r\n\r\n    am7model.models.push(\r\n        {\r\n            name: \"executeExt\",\r\n            fields: [\r\n                {\r\n                    name: \"execute\",\r\n                    label: 'Execute',\r\n                    virtual: true,\r\n                    ephemeral: true,\r\n                    type: 'form',\r\n                    function: 'objectExecute',\r\n                    format: 'form'\r\n                }\r\n            ]\r\n        }\r\n    );\r\n\r\n\r\n    /// TEMPORARY: Move this directly to the form config setting to override the model, versus modifying the model definition\r\n    ///\r\n    am7model.enums.mimeTypeEnumType = [\"application/binhex\", \"application/book\", \"application/cdf\", \"application/clariscad\", \"application/commonground\", \"application/drafting\", \"application/envoy\", \"application/excel\", \"application/fractals\", \"application/freeloader\", \"application/futuresplash\", \"application/groupwise\", \"application/hlp\", \"application/hta\", \"application/i-deas\", \"application/inf\", \"application/json\", \"application/lha\", \"application/marc\", \"application/mbedlet\", \"application/mcad\", \"application/mime\", \"application/mspowerpoint\", \"application/msword\", \"application/mswrite\", \"application/netmc\", \"application/octet-stream\", \"application/oda\", \"application/pdf\", \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"application/pkix-cert\", \"application/pkix-crl\", \"application/postscript\", \"application/ringing-tones\", \"application/sdp\", \"application/sea\", \"application/set\", \"application/sla\", \"application/smil\", \"application/solids\", \"application/sounder\", \"application/step\", \"application/streamingmedia\", \"application/toolbook\", \"application/vda\", \"application/vocaltec-media-desc\", \"application/vocaltec-media-file\", \"application/wordperfect\", \"application/x-aim\", \"application/x-authorware-bin\", \"application/x-authorware-map\", \"application/x-authorware-seg\", \"application/x-bcpio\", \"application/x-bsh\", \"application/x-bzip\", \"application/x-cdlink\", \"application/x-chat\", \"application/x-cocoa\", \"application/x-compressed\", \"application/x-conference\", \"application/x-cpio\", \"application/x-cpt\", \"application/x-deepv\", \"application/x-director\", \"application/x-dvi\", \"application/x-elc\", \"application/x-envoy\", \"application/x-esrehber\", \"application/x-excel\", \"application/x-freelance\", \"application/x-gsp\", \"application/x-gss\", \"application/x-gtar\", \"application/x-gzip\", \"application/x-hdf\", \"application/x-helpfile\", \"application/x-httpd-imap\", \"application/x-ima\", \"application/x-inventor\", \"application/x-java-class\", \"application/x-java-commerce\", \"application/x-javascript\", \"application/x-koan\", \"application/x-ksh\", \"application/x-latex\", \"application/x-livescreen\", \"application/x-lotus\", \"application/x-mif\", \"application/x-mix-transfer\", \"application/x-msexcel\", \"application/x-navi-animation\", \"application/x-navidoc\", \"application/x-navimap\", \"application/x-netcdf\", \"application/x-newton-compatible-pkg\", \"application/x-omc\", \"application/x-omcdatamaker\", \"application/x-omcregerator\", \"application/x-pagemaker\", \"application/x-pcl\", \"application/x-pixclscript\", \"application/x-project\", \"application/x-qpro\", \"application/x-seelogo\", \"application/x-shockwave-flash\", \"application/x-sprite\", \"application/x-stuffit\", \"application/x-tar\", \"application/x-tbook\", \"application/x-tcl\", \"application/x-tex\", \"application/x-texinfo\", \"application/x-troff\", \"application/x-troff-man\", \"application/x-troff-me\", \"application/x-troff-ms\", \"application/x-ustar\", \"application/x-visio\", \"application/x-wais-source\", \"application/x-wintalk\", \"application/x-world\", \"audio/aiff\", \"audio/basic\", \"audio/it\", \"audio/make\", \"audio/mid\", \"audio/midi\", \"audio/mod\", \"audio/mpeg\", \"audio/nspaudio\", \"audio/tsp-audio\", \"audio/tsplayer\", \"audio/voc\", \"audio/voxware\", \"audio/wav\", \"audio/weba\", \"audio/x-au\", \"audio/x-gsm\", \"audio/x-jam\", \"audio/x-liveaudio\", \"audio/x-mpequrl\", \"audio/x-pn-realaudio\", \"audio/x-pn-realaudio-plugin\", \"audio/x-psid\", \"audio/x-realaudio\", \"audio/x-twinvq\", \"audio/x-twinvq-plugin\", \"audio/xm\", \"chemical/x-pdb\", \"i-world/i-vrml\", \"image/bmp\", \"image/cmu-raster\", \"image/fif\", \"image/florian\", \"image/gif\", \"image/ief\", \"image/jpeg\", \"image/jutvision\", \"image/naplps\", \"image/pict\", \"image/png\", \"image/tiff\", \"image/x-dwg\", \"image/x-icon\", \"image/x-jg\", \"image/x-jps\", \"image/x-niff\", \"image/x-pcx\", \"image/x-pict\", \"image/x-portable-anymap\", \"image/x-portable-bitmap\", \"image/x-portable-graymap\", \"image/x-portable-pixmap\", \"image/x-quicktime\", \"image/x-rgb\", \"image/x-xpixmap\", \"image/x-xwindowdump\", \"image/xbm\", \"image/xpm\", \"model/iges\", \"model/vrml\", \"model/x-pov\", \"multipart/x-zip\", \"music/x-karaoke\", \"paleovu/x-pv\", \"text/asp\", \"text/css\", \"text/csv\", \"text/html\", \"text/mcf\", \"text/pascal\", \"text/plain\", \"text/richtext\", \"text/scriplet\", \"text/sgml\", \"text/tab-separated-values\", \"text/uri-list\", \"text/webviewhtml\", \"text/x-asm\", \"text/x-audiosoft-intra\", \"text/x-c\", \"text/x-component\", \"text/x-fortran\", \"text/x-h\", \"text/x-java-source\", \"text/x-la-asf\", \"text/x-m\", \"text/x-pascal\", \"text/x-script\", \"text/x-server-parsed-html\", \"text/x-setext\", \"text/x-speech\", \"text/x-uil\", \"text/x-uuencode\", \"text/x-vcalendar\", \"text/xml\", \"video/animaflex\", \"video/avi\", \"video/avs-video\", \"video/fli\", \"video/gl\", \"video/3gpp\", \"video/mp4\", \"video/mpeg\", \"video/quicktime\", \"video/vdo\", \"video/vivo\", \"video/webm\", \"video/webp\", \"video/x-amt-demorun\", \"video/x-amt-showrun\", \"video/x-dl\", \"video/x-dv\", \"video/x-flv\", \"video/x-isvideo\", \"video/x-motion-jpeg\", \"video/x-ms-asf\", \"video/x-ms-wmv\", \"video/x-qtc\", \"video/x-scm\", \"video/x-sgi-movie\", \"windows/metafile\", \"www/mime\", \"x-conference/x-cooltalk\", \"x-world/x-vrt\", \"xgl/drawing\", \"xgl/movie\"];\r\n    //let nameId = am7model.getModel(\"common.nameId\");\r\n    //nameId\r\n    let sysId = am7model.getModel(\"system.primaryKey\");\r\n    sysId.fields.push({\r\n        name: \"uri\",\r\n        label: 'URI',\r\n        type: 'link',\r\n        virtual: true,\r\n        ephemeral: true,\r\n        format: 'object-link'\r\n    },\r\n        {\r\n            name: am7model.jsonModelKey,\r\n            label: \"Model\",\r\n            type: \"string\",\r\n            virtual: true,\r\n            ephemeral: true,\r\n            function: 'getModel'\r\n        }\r\n\r\n    );\r\n\r\n\r\n    let role = am7model.getModel(\"auth.role\");\r\n    role.fields.push({\r\n        name: \"members\",\r\n        label: 'Members',\r\n        type: 'list',\r\n        baseType: \"model\",\r\n        baseModel: \"$flex\",\r\n        function : 'objectMembers',\r\n        promise: true,\r\n        foreignType: \"type\",\r\n        virtual: true,\r\n        ephemeral: true,\r\n        format: 'table'\r\n    });\r\n\r\n    let dataM = am7model.getModel(\"data.data\");\r\n    dataM.inherits.push(\"executeExt\");\r\n    //dataM.query.push(\"groupPath\");\r\n    let ctf = am7model.getModelField(dataM, \"contentType\");\r\n    ctf.type = \"enum\";\r\n    ctf.default = \"text/plain\";\r\n    ctf.enum = am7model.enums.mimeTypeEnumType;\r\n    ctf.filter = /(^text\\/(plain|css|csv|html|xml)$|\\/json$|javascript$|^video\\/(webm|webp|mpeg|avi|mp4|3gpp)$|^audio\\/(wav|mp3|mp4)|^image\\/(gif|jpeg|png)|application\\/vnd.openxmlformats-officedocument.wordprocessingml.document)/;\r\n\r\n    let tagM = am7model.getModel(\"data.tag\");\r\n    let tagf = am7model.getModelField(tagM, \"type\");\r\n    tagf.type = \"enum\";\r\n    tagf.default = am7model.enums.modelNames[0];\r\n    tagf.enum = am7model.enums.modelNames.sort();\r\n\r\n    forms.data = {\r\n        label: \"Data\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        query: [\"stream\", \"compressionType\", \"vaulted\", \"enciphered\"],\r\n        fields: {\r\n            name: {\r\n                label: \"Name\",\r\n                layout: \"half\"\r\n            },\r\n            contentType: {\r\n                layout: \"one\"\r\n            },\r\n            vectorize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'polyline',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Vectorize\",\r\n                    command: page.components.dialog.vectorize\r\n                }\r\n            },\r\n            summarize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'summarize',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Summarize\",\r\n                    command: page.components.dialog.summarize\r\n                }\r\n            },\r\n\r\n            /*\r\n            compressionType: {\r\n                layout : \"one\",\r\n                readOnly: true\r\n            },\r\n            \r\n            vaulted: {\r\n                layout: \"one\"\r\n            },\r\n            vaultId: {\r\n                layout: \"one\"\r\n            },\r\n            */\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            dataBytesStore: {\r\n                layout: \"full\",\r\n                label: \"Data\",\r\n                dragAndDrop: true,\r\n                format: \"contentType\"\r\n            }\r\n        },\r\n        //[\"name\", \"description\", \"createdDate\", \"modifiedDate\", \"expiryDate\", \"mimeType\", \"dataBytesStore\"],\r\n        forms: [\"groupdateinfo\", \"tags\", \"ctlattributes\", \"execute\"]\r\n    };\r\n\r\n\r\n    am7model.models.push({\r\n        name: \"summarizeSettings\",\r\n        icon: \"polyline\",\r\n        label: \"Settings\",\r\n        fields: [\r\n\r\n        {\r\n            \"name\": \"chat\",\r\n            \"label\": \"Chat Config\",\r\n            \"type\": \"list\",\r\n        },\r\n        {\r\n            \"name\": \"prompt\",\r\n            \"label\": \"Prompt Config\",\r\n            \"type\": \"list\",\r\n        },\r\n        {\r\n            name: \"chunkType\",\r\n            label: \"Chunk Type\",\r\n            type: 'string',\r\n            baseType: \"string\",\r\n            default: \"word\"\r\n        },\r\n        {\r\n            name: \"chunk\",\r\n            label: \"Chunk\",\r\n            type: 'int',\r\n            default: 25\r\n        }\r\n        ]\r\n    });\r\n\r\n    forms.summarizeSettings = {\r\n        label: \"Summarize Options\",\r\n        fields: {\r\n            chat: {\r\n                layout: 'third',\r\n               format: \"select\"\r\n            },\r\n            prompt: {\r\n                layout: 'third',\r\n               format: \"select\"\r\n            },\r\n            chunkType: {\r\n                layout: 'one',\r\n                label: 'Chunk Type',\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['Sentence', 'Chapter', 'Word']\r\n                }\r\n            },\r\n            chunk: {\r\n                layout: 'one'\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    forms.sdConfig = {\r\n        label: \"SD Config\",\r\n        fields: {\r\n            description: {\r\n                label: \"Description\",\r\n                layout: \"full\",\r\n                format: \"print\"\r\n            },\r\n            randomSeed: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'casino',\r\n                field: {\r\n                    label: \"Random\",\r\n                    command: undefined\r\n                }\r\n            },\r\n            seed:{\r\n                label: 'Seed',\r\n                layout: 'one'\r\n            },\r\n            /*\r\n            imageCount: {\r\n                label: 'Count',\r\n                layout: 'one'\r\n            },\r\n            */\r\n            hires: {\r\n                label: 'Hi-Res',\r\n                layout: 'one'\r\n            },\r\n            randomConfig: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                field: {\r\n                    label: \"New Config\",\r\n                    command: undefined\r\n                }\r\n            },\r\n            dressUp: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'add',\r\n                field: {\r\n                    label: \"Dress Up\",\r\n                    command: undefined\r\n                }\r\n            },\r\n            dressDown: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'remove',\r\n                field: {\r\n                    label: \"Dress Down\",\r\n                    command: undefined\r\n                }\r\n            },\r\n            /*\r\n            blank : {\r\n                layout : \"one\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            */\r\n            bodyStyle: {\r\n                label: 'Composition',\r\n                layout: 'third'\r\n            },\r\n            imageAction: {\r\n                label: 'Action',\r\n                layout: 'third'\r\n            },\r\n            imageSetting: {\r\n                label: 'Setting',\r\n                layout: 'third'\r\n            },\r\n            style: {\r\n                layout: 'one',\r\n                label: 'Style',\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['art', 'movie', 'photograph']\r\n                }\r\n            },\r\n            artStyle: {\r\n                label: 'Art Style',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"art\"],\r\n            },\r\n            director: {\r\n                label: 'Director',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"movie\"],\r\n            },\r\n            photographer: {\r\n                label: 'Photographer',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"photograph\"],\r\n            },\r\n            blank2 : {\r\n                layout : \"third\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            stillCamera: {\r\n                label: 'Still Camera',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"photograph\"],\r\n            },\r\n            lens: {\r\n                label: 'Lens',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"photograph\"],\r\n            },\r\n            film: {\r\n                label: 'Film',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"photograph\"],\r\n            },\r\n            colorProcess: {\r\n                label: 'Process',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"movie|photograph\"],\r\n            },\r\n            movieCamera: {\r\n                label: 'Movie Camera',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"movie\"],\r\n            },\r\n            movieFilm: {\r\n                label: 'Movie Film',\r\n                layout: 'one',\r\n                referField: true,\r\n                requiredAttributes: [\"style\"],\r\n                requiredValues: [\"movie\"],\r\n            },\r\n            model: {\r\n                layout: 'third',\r\n                label: 'Model',\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['juggernautXL_ragnarokBy.safetensors','dreamshaperXL_v21TurboDPMSDE','chilloutmix_Ni','realismFromHadesXL_lightningV3','realmixXL_V10.safetensors', 'lustifySDXLNSFW_endgame.safetensors', 'ponyRealism_V22.safetensors', 'sdXL_v10VAEFix']\r\n                }\r\n            },\r\n            steps: {\r\n                label: 'Steps',\r\n                layout: 'one'\r\n            },\r\n            refinerModel: {\r\n                layout: 'third',\r\n                label: 'Refiner Model',\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['juggernautXL_ragnarokBy.safetensors','dreamshaperXL_v21TurboDPMSDE','chilloutmix_Ni','realismFromHadesXL_lightningV3','realmixXL_V10.safetensors', 'lustifySDXLNSFW_endgame.safetensors', 'ponyRealism_V22.safetensors', 'sdXL_v10VAEFix']\r\n                }\r\n            },\r\n            refinerSteps: {\r\n                label: 'Refiner Steps',\r\n                layout: 'one'\r\n            },\r\n            cfg: {\r\n                label: 'CFG',\r\n                layout: 'half',\r\n                format: 'range'\r\n            },\r\n            refinerCfg: {\r\n                label: 'Refiner CFG',\r\n                layout: 'half',\r\n                format: 'range'\r\n            \r\n            },\r\n            imageCount:{\r\n                label: \"Count\",\r\n                layout: \"one\"\r\n            },\r\n            shared: {\r\n                label: \"Use Shared\",\r\n                layout: 'one'\r\n            },\r\n            loadShared: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'open_in_new',\r\n                field: {\r\n                    label: \"Load Shared\",\r\n                    command: undefined\r\n                },\r\n                referField: true,\r\n                requiredAttributes: [\"shared\"],\r\n                requiredValues: [\"true\"],\r\n            },\r\n            createApparelSequence: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'apparel',\r\n                field: {\r\n                    label: \"Sequence\",\r\n                    command: undefined\r\n                }\r\n            }\r\n\r\n\r\n\r\n        }\r\n    };\r\n\r\n    am7model.models.push(\r\n        {\r\n            name: \"vectorOptions\", icon: \"polyline\", fields: [\r\n                {\r\n                    name: \"chunkType\",\r\n                    label: \"Chunk Type\",\r\n                    type: 'string',\r\n                    baseType: \"string\",\r\n                    default: \"word\"\r\n                },\r\n                {\r\n                    name: \"chunk\",\r\n                    label: \"Chunk\",\r\n                    type: 'int',\r\n                    default: 25\r\n                }\r\n            ]\r\n        }\r\n    );\r\n\r\n    forms.vectorOptions = {\r\n        label: \"Vector Options\",\r\n        fields: {\r\n            chunkType: {\r\n                layout: 'one',\r\n                label: 'Chunk Type',\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['Sentence', 'Chapter', 'Word']\r\n                }\r\n            },\r\n            chunk: {\r\n                layout: 'one'\r\n            }\r\n        }\r\n    };\r\n\r\n    \r\n    am7model.models.push(\r\n        {\r\n            name: \"characterWizard\", icon: \"person\", fields: [\r\n                {\r\n                    name: \"firstName\",\r\n                    label: \"First Name\",\r\n                    type: 'string'\r\n                },\r\n                {\r\n                    name: \"middleName\",\r\n                    label: \"Middle Name\",\r\n                    type: 'string'\r\n                },\r\n                {\r\n                    name: \"lastName\",\r\n                    label: \"Last Name\",\r\n                    type: 'string'\r\n                },\r\n                {\r\n                    name: \"gender\",\r\n                    label: \"Gender\",\r\n                    type: 'string',\r\n                    default: \"male\"\r\n                },\r\n                {\r\n                    name: \"age\",\r\n                    label: \"Age\",\r\n                    type: 'int',\r\n                    default: 25\r\n                }\r\n            ]\r\n        }\r\n    );\r\n\r\n    forms.characterWizard = {\r\n        label: \"Character Wizard\",\r\n        fields: {\r\n            gender: {\r\n                layout: 'one',\r\n                field: {\r\n                    label: 'Gender',\r\n                    type: 'list',\r\n                    limit: ['male', 'female', 'random']\r\n                }\r\n            },\r\n            firstName: {\r\n                layout: 'one'\r\n            },\r\n            middleName: {\r\n                layout: 'one'\r\n            },\r\n            lastName: {\r\n                layout: 'one'\r\n            },\r\n            age: {\r\n                layout: 'one'\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    am7model.models.push(\r\n        {\r\n            name: \"progress\", icon: \"pending\", fields: [\r\n                {\r\n                    name: \"label\",\r\n                    label: \"Label\",\r\n                    type: 'string'\r\n                },\r\n                {\r\n                    name: \"progress\",\r\n                    label: \"Progress\",\r\n                    type: 'int',\r\n                    minValue: 0,\r\n                    maxValue: 100\r\n                }\r\n            ]\r\n        }\r\n    );\r\n\r\n    forms.progress = {\r\n        label: \"Progress\",\r\n        fields: {\r\n            label: {\r\n                layout: 'third',\r\n                format: 'print'\r\n\r\n            },\r\n            progress: {\r\n                layout: 'two-thirds',\r\n                format: 'progress'\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.control = {\r\n        label: \"Control\",\r\n        fields: {\r\n            controlType: {\r\n                layout: \"one\"\r\n            },\r\n            action: {\r\n                layout: \"third\"\r\n            },\r\n            referenceType: {\r\n                layout: \"one\"\r\n            },\r\n            referenceId: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        //[\"name\", \"description\", \"createdDate\", \"modifiedDate\", \"expiryDate\", \"mimeType\", \"dataBytesStore\"],\r\n        forms: [\"info\"]\r\n    };\r\n\r\n    forms.info = {\r\n        label: \"Info\",\r\n        fields: {\r\n            uri: {\r\n                layout: \"full\"\r\n            },\r\n            urn: {\r\n                layout: \"third\"\r\n            },\r\n            objectId: {\r\n                layout: \"third\"\r\n            },\r\n            organizationPath: {\r\n                layout: \"third\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.user = {\r\n        label: \"User\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            type: {\r\n                layout: \"third\"\r\n            },\r\n            status: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"info\", \"contactinfo\", \"tags\", \"reqattributes\"]\r\n    };\r\n\r\n\r\n    forms.person = {\r\n        label: \"Person\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            gender: {\r\n                layout: 'one',\r\n                field: {\r\n                    label: 'Gender',\r\n                    type: 'list',\r\n                    limit: ['male', 'female', 'unisex']\r\n                }\r\n            },\r\n            birthDate: {\r\n                layout: \"one\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            title: {\r\n                layout: \"third\"\r\n            },\r\n            prefix: {\r\n                layout: \"third\"\r\n            },\r\n            suffix: {\r\n                layout: \"third\"\r\n            },\r\n            firstName: {\r\n                layout: \"third\"\r\n            },\r\n            middleName: {\r\n                layout: \"third\"\r\n            },\r\n            lastName: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"contactinfo\", \"personrel\", \"groupinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.account = {\r\n        label: \"Account\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            type: {\r\n                layout: \"third\"\r\n            },\r\n            status: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"contactinfo\", \"groupinfo\", \"tags\", \"reqattributes\"]\r\n    };\r\n\r\n    forms.childlist = {\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addChild',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteChild',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.entitylist2 = {\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addEntity',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntity',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.entitylist = {\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addEntity',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntity',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.memberlist = {\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addMember',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteMember',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.memberlist2 = {\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addMember',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteMember',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    }\r\n\r\n    forms.contactinfo = {\r\n        label: \"Contact\",\r\n        requiredAttributes: [\"objectId\"],\r\n        model: true,\r\n        property: \"contactInformation\",\r\n        fields: {\r\n            contactInformation: {\r\n                layout: \"full\",\r\n                form: forms.contactInformation\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    forms.contactInformation = {\r\n        label: \"Contact\",\r\n        fields: {\r\n            contacts: {\r\n                layout: 'half',\r\n                format: \"table\",\r\n                form: forms.entitylist\r\n            },\r\n            addresses: {\r\n                layout: 'half',\r\n                format: \"table\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.address = {\r\n        label: \"Address\",\r\n        fields: {\r\n            name: {\r\n                layout: 'two-thirds',\r\n            },\r\n            locationType: {\r\n                layout: 'one'\r\n            },\r\n            preferred: {\r\n                layout: 'one'\r\n            },\r\n            street: {\r\n                layout: 'full'\r\n            },\r\n            street2: {\r\n                layout: 'full'\r\n            },\r\n            city: {\r\n                layout: 'third'\r\n            },\r\n            state: {\r\n                layout: 'third'\r\n            },\r\n            postalCode: {\r\n                layout: 'third'\r\n            },\r\n            country: {\r\n                layout: 'third'\r\n            }\r\n\r\n\r\n\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.contact = {\r\n        label: \"Contact\",\r\n        fields: {\r\n            name: {\r\n                layout: 'third'\r\n            },\r\n            contactType: {\r\n                layout: 'third'\r\n            },\r\n            locationType: {\r\n                layout: 'third'\r\n            },\r\n            preferred: {\r\n                layout: 'one'\r\n            },\r\n            contactValue: {\r\n                layout: 'fifth'\r\n            },\r\n            description: {\r\n                layout: 'full'\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.personrel = {\r\n        label: \"Relations\",\r\n        fields: {\r\n            partners: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            dependents: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            accounts: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n    forms.role = {\r\n        label: \"Role\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            type: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"parentinfo\", \"rolemembers\", \"attributes\"]\r\n    };\r\n\r\n    forms.permission = {\r\n        label: \"Permission\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            type: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"parentinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.event = {\r\n        label: \"Event\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            parent: {\r\n                layout: \"third\"\r\n            },\r\n            location: {\r\n                layout: \"third\"\r\n            },\r\n            eventType: {\r\n                layout: \"third\"\r\n            },\r\n            startDate: {\r\n                layout: \"third\"\r\n            },\r\n            endDate: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            childEvents: {\r\n                layout: \"third\",\r\n                form: forms.childlist\r\n            },\r\n            entryTraits: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            exitTraits: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"eventpart\", \"eventobj\", \"grouptypeinfo\", \"attributes\"]\r\n    };\r\n    forms.eventpart = {\r\n        label: \"Participants\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            actors: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            orchestrators: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            influencers: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            observers: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n\r\n        }\r\n    };\r\n    forms.eventobj = {\r\n        label: \"Objects\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            things: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            },\r\n            groups: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n    forms.location = {\r\n        label: \"Location\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            geographyType: {\r\n                layout: \"one\"\r\n            },\r\n            latitude: {\r\n                layout: \"one\"\r\n            },\r\n            longitude: {\r\n                layout: \"one\"\r\n            },\r\n\r\n            classification: {\r\n                layout: \"half\"\r\n            },\r\n            parent: {\r\n                layout: \"half\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            }\r\n        },\r\n        forms: [\"locationrel\", \"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    /// TEMPORARY: Move this directly to the form config setting to override the model, versus modifying the model definition\r\n    ///\r\n    let parent = am7model.getModel(\"common.parent\");\r\n    parent.fields.push({\r\n        name: \"parent\",\r\n        label: \"Parent\",\r\n        type: \"string\",\r\n        format: \"picker\",\r\n        pickerType: \"self\",\r\n        pickerProperty: {\r\n            selected: \"id\",\r\n            entity: \"parentId\"\r\n        },\r\n        virtual: true,\r\n        ephemeral: true\r\n    });\r\n\r\n    forms.note = {\r\n        label: \"Note\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            parent: {\r\n                layout: \"half\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            vectorize: {\r\n                format: \"button\",\r\n                layout: \"third\",\r\n                icon: 'polyline',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Vectorize\",\r\n                    command: page.components.dialog.vectorize\r\n                }\r\n            },\r\n            text: {\r\n                layout: \"full\",\r\n                format: \"textarea\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n    forms.trait = {\r\n        label: \"Trait\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            traitType: {\r\n                layout: \"third\"\r\n            },\r\n            alignment: {\r\n                layout: \"third\",\r\n                field:{\r\n                    label: \"Alignment\",\r\n                    type: \"list\",\r\n                    default: \"neutral\",\r\n                    \"limit\": [\"neutralevil\", \"lawfulevil\", \"chaoticevil\", \"chaoticneutral\", \"neutral\", \"lawfulneutral\", \"chaoticgood\", \"neutralgood\", \"lawfulgood\"]\r\n                }\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.tag = {\r\n        label: \"Tag\",\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addMember',\r\n                properties: {\r\n                    picker: true\r\n                }\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteMember',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            type: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.tagattributes = {\r\n        label: \"Tags and Attributes\",\r\n        fields: {\r\n            attributes: {\r\n                layout: 'half',\r\n                form: forms.attribute\r\n            },\r\n            tags: {\r\n                layout: \"half\",\r\n                form: forms.tag\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.locationrel = {\r\n        label: \"Relation\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            childLocations: {\r\n                layout: \"third\",\r\n                form: forms.childlist\r\n            },\r\n            borders: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            boundaries: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n    forms.notechildren = {\r\n        label: \"Children\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            childNotes: {\r\n                layout: \"full\",\r\n                form: forms.childlist\r\n            }\r\n        }\r\n    };\r\n    forms.eventObject = {\r\n        label: \"Events\",\r\n        commands: {\r\n            view: {\r\n                label: 'View',\r\n                icon: 'file_open',\r\n                function: 'openEntity',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            schema: {\r\n                layout: \"half\"\r\n            }\r\n        }\r\n    };\r\n    forms.rolemember = {\r\n        label: \"Member\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                function: 'addMember',\r\n                properties: {\r\n                    picker: true,\r\n                    typeAttribute: 'type'\r\n                }\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteMember',\r\n                condition: ['select']\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            schema: {\r\n                layout: \"half\"\r\n            }\r\n            /*\r\n            roleType: {\r\n                layout : \"half\"\r\n            }\r\n            */\r\n        }\r\n    };\r\n\r\n    forms.rolemembers = {\r\n        label: \"Members\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            members: {\r\n                layout: 'half',\r\n                form: forms.rolemember\r\n                /*\r\n                field : {\r\n                    label : 'Members',\r\n                    name: \"members\",\r\n                    virtual : true,\r\n                    ephemeral: true,\r\n                    type : 'list',\r\n                    baseType: \"model\",\r\n                    baseModel : '$flex',\r\n                    foreignType: \"type\",\r\n                    function : 'objectMembers',\r\n                    typeAttribute : 'type',\r\n                    foreign : true,\r\n                    format : 'table'\r\n                }\r\n                */\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.eventtags = {\r\n        label: \"Events and Tags\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            tags: {\r\n                layout: 'one',\r\n                form: forms.tag\r\n            },\r\n            /*\r\n            events : {\r\n                layout : 'one',\r\n                form : forms.eventObject\r\n            },\r\n            */\r\n            actors: {\r\n                layout: 'one',\r\n                form: forms.eventObject\r\n            },\r\n            orchestrators: {\r\n                layout: 'one',\r\n                form: forms.eventObject\r\n            },\r\n            influencers: {\r\n                layout: 'one',\r\n                form: forms.eventObject\r\n            },\r\n            observers: {\r\n                layout: 'one',\r\n                form: forms.eventObject\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.tags = {\r\n        label: \"Tags\",\r\n        requiredAttributes: [],\r\n        format: \"table\",\r\n        fields: {\r\n            tags: {\r\n                layout: 'full',\r\n                form: forms.tag\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.group = {\r\n        label: \"Group\",\r\n        commands: {\r\n            fact: {\r\n                label: 'Fact',\r\n                icon: 'fact_check',\r\n                function: 'makeFact',\r\n                requiredAttribute: \"objectId\"\r\n            }\r\n        },\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            type: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        //[\"name\", \"description\", \"createdDate\", \"modifiedDate\", \"expiryDate\", \"mimeType\", \"dataBytesStore\"],\r\n        forms: [\"parentinfo\", \"tags\", \"ctlattributes\"]\r\n    };\r\n\r\n    forms.form = {\r\n        label: \"Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            description: {\r\n                layout: \"half\"\r\n            },\r\n            isTemplate: {\r\n                layout: \"one\"\r\n            },\r\n            isGrid: {\r\n                layout: \"one\",\r\n                requiredAttributes: [\"isTemplate\"],\r\n                referField: true\r\n            },\r\n            viewTemplate: {\r\n                layout: \"third\",\r\n                requiredAttributes: [\"!isTemplate\"],\r\n                referField: true\r\n            },\r\n            template: {\r\n                layout: \"third\",\r\n                requiredAttributes: [\"!isTemplate\"],\r\n                referField: true\r\n            },\r\n            childForms: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            },\r\n            elements: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.formelement = {\r\n        label: \"Form Element\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            description: {\r\n                layout: \"half\"\r\n            },\r\n            elementName: {\r\n                layout: \"third\"\r\n            },\r\n            elementLabel: {\r\n                layout: \"third\"\r\n            },\r\n            elementType: {\r\n                layout: \"third\"\r\n            },\r\n            viewTemplate: {\r\n                layout: \"half\"\r\n            },\r\n            validationRule: {\r\n                layout: \"half\"\r\n            },\r\n            elementValues: {\r\n                layout: \"full\",\r\n                form: forms.elementValues,\r\n                requiredAttributes: [\"elementType\"],\r\n                requiredValues: [\"SELECT|MULTIPLE_SELECT\"],\r\n                referField: true\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.validationRule = {\r\n        label: \"Validation Rule\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            validationType: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"third\"\r\n            },\r\n            isRuleSet: {\r\n                layout: \"third\"\r\n            },\r\n            allowNull: {\r\n                layout: \"third\"\r\n            },\r\n            comparison: {\r\n                layout: \"third\",\r\n                requiredAttributes: [\"validationType\"],\r\n                referField: true,\r\n                requiredValues: [\"BOOLEAN\"],\r\n            },\r\n            expression: {\r\n                layout: \"third\"\r\n            },\r\n            replacementValue: {\r\n                layout: \"third\",\r\n                requiredAttributes: [\"validationType\"],\r\n                referField: true,\r\n                requiredValues: [\"REPLACEMENT\"],\r\n            },\r\n            errorMessage: {\r\n                layout: \"third\"\r\n            },\r\n            rules: {\r\n                layout: \"full\",\r\n                form: forms.entitylist,\r\n                requiredAttributes: [\"isRuleSet\"],\r\n                referField: true\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.policy = {\r\n        label: \"Policy Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            expiryDate: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            condition: {\r\n                layout: \"third\"\r\n            },\r\n            enabled: {\r\n                layout: \"one\"\r\n            },\r\n            decisionAge: {\r\n                layout: \"one\"\r\n            },\r\n            order: {\r\n                layout: \"one\"\r\n            },\r\n            score: {\r\n                layout: \"one\"\r\n            },\r\n            rules: {\r\n                layout: \"full\",\r\n                form: forms.entitylist,\r\n                requiredAttributes: [],\r\n                referField: true\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"evaluate\"]\r\n    };\r\n\r\n    forms.rule = {\r\n        label: \"Rule Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            ruleType: {\r\n                layout: \"third\"\r\n            },\r\n            condition: {\r\n                layout: \"third\"\r\n            },\r\n            score: {\r\n                layout: \"one\"\r\n            },\r\n            order: {\r\n                layout: \"one\"\r\n            },\r\n\r\n            rules: {\r\n                layout: \"half\",\r\n                form: forms.entitylist,\r\n                requiredAttributes: [],\r\n                referField: true\r\n            },\r\n\r\n            patterns: {\r\n                layout: \"half\",\r\n                form: forms.entitylist,\r\n                requiredAttributes: [],\r\n                referField: true\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.pattern = {\r\n        label: \"Pattern Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            type: {\r\n                layout: \"third\"\r\n            },\r\n            operation: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"Operation\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"policy.operation\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"operation\"\r\n                    }\r\n                }\r\n            },\r\n            score: {\r\n                layout: \"one\"\r\n            },\r\n            order: {\r\n                layout: \"one\"\r\n            },\r\n            fact: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"Fact\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"policy.fact\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"fact\"\r\n                    }\r\n                }\r\n            },\r\n            comparator: {\r\n                layout: \"third\"\r\n            },\r\n            match: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"Match\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"policy.fact\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"match\"\r\n                    }\r\n                }\r\n            },\r\n\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.fact = {\r\n        label: \"Fact Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            type: {\r\n                layout: \"third\"\r\n            },\r\n            score: {\r\n                layout: \"third\"\r\n            },\r\n\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            factType: {\r\n                layout: \"third\"\r\n            },\r\n            modelType: {\r\n                layout: \"third\"\r\n            },\r\n            sourceDataType: {\r\n                layout: \"third\"\r\n            },\r\n            sourceUrn: {\r\n                layout: \"third\"\r\n            },\r\n            sourceUrl: {\r\n                layout: \"third\"\r\n            },\r\n            factData: {\r\n                layout: \"third\"\r\n            },\r\n            promptConfig: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                field: {\r\n                format: 'picker',\r\n                pickerType: \"olio.llm.promptConfig\",\r\n                pickerProperty: {\r\n                    selected: \"{object}\",\r\n                    entity: \"promptConfig\"\r\n                },\r\n                label: \"Prompt Config\"\r\n                }\r\n            },\r\n            chatConfig: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                field: {\r\n                format: 'picker',\r\n                pickerType: \"olio.llm.chatConfig\",\r\n                pickerProperty: {\r\n                    selected: \"{object}\",\r\n                    entity: \"chatConfig\"\r\n                },\r\n                label: \"Chat Config\"\r\n                }\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.operation = {\r\n        label: \"Operation Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            score: {\r\n                layout: \"third\"\r\n            },\r\n            operationType: {\r\n                layout: \"third\"\r\n            },\r\n            operationrel: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n\r\n    forms.function = {\r\n        label: \"Fact Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            functionType: {\r\n                layout: \"third\"\r\n            },\r\n            order: {\r\n                layout: \"third\"\r\n            },\r\n            score: {\r\n                layout: \"third\"\r\n            },\r\n            sourceurnrel: {\r\n                layout: \"half\"\r\n            },\r\n            sourceUrl: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n    am7model.models.push({ name: \"confirmation\", fields: [{ name: \"textData\", type: \"string\" }] });\r\n    forms.confirmation = {\r\n        label: \"Confirm\",\r\n        fields: {\r\n            textData: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.models.push(\r\n        {\r\n            name: \"userProfile\", icon: \"work\", fields: [\r\n                {\r\n                    name: \"profilePortrait\",\r\n                    label: \"Portrait\",\r\n                    type: \"string\",\r\n                    format: \"picker\",\r\n                    pickerType: \"data.data\",\r\n                    pickerProperty: {\r\n                        selected: \"objectId\",\r\n                        entity: \"profilePortrait\",\r\n                        path: \"~/Gallery\"\r\n                    },\r\n                    virtual: true\r\n                }\r\n            ]\r\n        }\r\n    );\r\n    forms.userProfile = {\r\n        label: \"Profile\",\r\n        fields: {\r\n            profilePortrait: {\r\n                layout: 'full',\r\n                format: 'picker',\r\n                label: \"Portrait\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.data\",\r\n                    pickerProperty: {\r\n                        selected: \"objectId\",\r\n                        entity: \"profilePortrait\",\r\n                        path: \"~/Gallery\"\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        forms: []\r\n    };\r\n\r\n\r\n    forms.evaluaterel = {\r\n        label: \"Evaluate\",\r\n        requiredRoles: [\"scriptExecutor\"],\r\n        requiredAttributes: [\"objectId\"],\r\n        commands: {\r\n            exec: {\r\n                label: 'Evaluate',\r\n                icon: 'run_circle',\r\n                function: 'evaluate'\r\n            }\r\n        },\r\n        fields: {\r\n            evaluate: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.evaluate = {\r\n        label: \"Evaluate\",\r\n        requiredRoles: [\"scriptExecutor\"],\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            evaluate: {\r\n                layout: \"full\",\r\n                form: forms.evaluaterel,\r\n                properties: {\r\n                    prepare: \"define\"\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.executerel = {\r\n        label: \"Execute\",\r\n        requiredRoles: [\"scriptExecutor\"],\r\n        requiredAttributes: [\"contentType\", \"objectId\"],\r\n        requiredValues: [\"application/x-javascript\"],\r\n        referField: true,\r\n        commands: {\r\n            exec: {\r\n                label: 'Execute',\r\n                icon: 'run_circle',\r\n                function: 'execute'\r\n            }\r\n        },\r\n        fields: {\r\n            execute: {\r\n                layout: \"full\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.execute = {\r\n        label: \"Execute\",\r\n        requiredRoles: [\"scriptExecutor\"],\r\n        requiredAttributes: [\"contentType\", \"objectId\"],\r\n        requiredValues: [\"application/x-javascript\"],\r\n        referField: true,\r\n        fields: {\r\n            execute: {\r\n                layout: \"full\",\r\n                form: forms.executerel\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.cost = {\r\n        label: \"Cost\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            currencyType: {\r\n                layout: \"third\"\r\n            },\r\n            value: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.time = {\r\n        label: \"Time\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            basisType: {\r\n                layout: \"third\"\r\n            },\r\n            value: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.estimate = {\r\n        label: \"Estimate\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            estimateType: {\r\n                layout: \"half\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            time: {\r\n                layout: \"half\"\r\n            },\r\n            cost: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n    forms.budget = {\r\n        label: \"Budget\",\r\n        fields: {\r\n            name: {\r\n                layout: \"half\"\r\n            },\r\n            budgetType: {\r\n                layout: \"half\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            time: {\r\n                layout: \"half\"\r\n            },\r\n            cost: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.schedule = {\r\n        label: \"Schedule\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            startTime: {\r\n                layout: \"third\"\r\n            },\r\n            endTime: {\r\n                layout: \"third\"\r\n            },\r\n            goals: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n    forms.resource = {\r\n        label: \"Resource\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            resourceType: {\r\n                layout: \"third\"\r\n            },\r\n            resourceDataId: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            utilization: {\r\n                layout: \"third\"\r\n            },\r\n            estimate: {\r\n                layout: \"third\"\r\n            },\r\n            schedule: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"ctlattributes\"]\r\n    };\r\n    forms.artifact = {\r\n        label: \"Artifact\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            artifactType: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            artifactDataId: {\r\n                layout: \"third\"\r\n            },\r\n            previousTransitionId: {\r\n                layout: \"third\"\r\n            },\r\n            nextTransitionId: {\r\n                layout: \"third\"\r\n            }\r\n\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.requirement = {\r\n        label: \"Requirement\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            requirementType: {\r\n                layout: \"third\"\r\n            },\r\n            requirementStatus: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            order: {\r\n                layout: \"third\"\r\n            },\r\n            note: {\r\n                layout: \"third\"\r\n            },\r\n            form: {\r\n                layout: \"third\"\r\n            }\r\n        },\r\n        forms: [\"groupinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n\r\n    forms.taskrel = {\r\n        label: \"Relationships\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            childTasks: {\r\n                layout: \"third\",\r\n                form: forms.childlist\r\n            },\r\n            actualCost: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            actualTime: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.taskacts = {\r\n        label: \"Activities\",\r\n        requiredAttributes: [\"objectId\"],\r\n        fields: {\r\n            requirements: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            dependencies: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            resources: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            artifacts: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            notes: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            work: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.task = {\r\n        label: \"Task\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            parent: {\r\n                layout: \"third\"\r\n            },\r\n            taskStatus: {\r\n                layout: \"one\"\r\n            },\r\n            order: {\r\n                layout: \"one\"\r\n            },\r\n            startDate: {\r\n                layout: \"third\"\r\n            },\r\n            dueDate: {\r\n                layout: \"third\"\r\n            },\r\n            completedDate: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            }\r\n        },\r\n        forms: [\"taskrel\", \"taskacts\", \"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.ticket = {\r\n        label: \"Task\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            ticketStatus: {\r\n                layout: \"one\"\r\n            },\r\n            priority: {\r\n                layout: \"one\"\r\n            },\r\n            severity: {\r\n                layout: \"one\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            assignedResource: {\r\n                layout: \"third\"\r\n            },\r\n            estimate: {\r\n                layout: \"third\"\r\n            },\r\n            actualTime: {\r\n                layout: \"one\"\r\n            },\r\n            actualCost: {\r\n                layout: \"one\"\r\n            },\r\n            createdDate: {\r\n                layout: \"third\"\r\n            },\r\n            modifiedDate: {\r\n                layout: \"third\"\r\n            },\r\n            dueDate: {\r\n                layout: \"third\"\r\n            },\r\n            artifacts: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            dependencies: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            notes: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            requiredResources: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            forms: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.model = {\r\n        label: \"Model\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            cases: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            requirements: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            dependencies: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            artifacts: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            models: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.processstep = {\r\n        label: \"Process Step\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            order: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            goals: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            budgets: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            requirements: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.process = {\r\n        label: \"Process\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            order: {\r\n                layout: \"third\"\r\n            },\r\n            iterates: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            steps: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            },\r\n            budgets: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.methodology = {\r\n        label: \"Methodology\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            processes: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            },\r\n            budgets: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.goal = {\r\n        label: \"Goal\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            order: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            budget: {\r\n                layout: \"third\"\r\n            },\r\n            schedule: {\r\n                layout: \"third\"\r\n            },\r\n            assigned: {\r\n                layout: \"third\"\r\n            },\r\n            requirements: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            dependencies: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            cases: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n    forms.case = {\r\n        label: \"Case\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            caseType: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            actors: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            prerequisites: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            sequence: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            diagrams: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.module = {\r\n        label: \"Module\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            moduleType: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            time: {\r\n                layout: \"half\"\r\n            },\r\n            cost: {\r\n                layout: \"half\"\r\n            },\r\n            artifacts: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            },\r\n            work: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.lifecycle = {\r\n        label: \"Lifecycle\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            goals: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            schedules: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            budgets: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            projects: {\r\n                layout: \"half\",\r\n                form: forms.entitylist\r\n            }\r\n\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.project = {\r\n        label: \"Project\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            schedule: {\r\n                layout: \"third\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            requirements: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            modules: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            stages: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"projectassets\", \"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.projectassets = {\r\n        label: \"Assets\",\r\n        fields: {\r\n            dependencies: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            artifacts: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            blueprints: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n    forms.work = {\r\n        label: \"Work\",\r\n        fields: {\r\n            name: {\r\n                layout: \"full\"\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            tasks: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            resources: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            dependencies: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            },\r\n            artifacts: {\r\n                layout: \"one\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n\r\n    forms.stage = {\r\n        label: \"Stage\",\r\n        fields: {\r\n            name: {\r\n                layout: \"two-thirds\"\r\n            },\r\n            order: {\r\n                layout: \"third\",\r\n            },\r\n            description: {\r\n                layout: \"full\"\r\n            },\r\n            schedule: {\r\n                layout: \"half\"\r\n            },\r\n            methodology: {\r\n                layout: \"half\"\r\n            },\r\n            work: {\r\n                layout: \"half\"\r\n            },\r\n            budget: {\r\n                layout: \"half\"\r\n            }\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\", \"tags\"]\r\n    };\r\n    \r\n    async function cleanupTestVoice(data){\r\n        page.toast(\"info\", \"Cleaning up test voice data for \" + data.objectId);\r\n        await page.deleteObject(data[am7model.jsonModelKey], data.objectId);\r\n    }\r\n\r\n    async function testVoice(object, inst, name) {\r\n        let refId = \"Test Voice - \" + page.uid();\r\n        let cnt = inst.api.sampleText() || \"Hello, this is a test of the voice synthesis system.\";\r\n        let vprops = {\"text\": cnt, \"speed\": 1.2, engine: inst.api.engine(), speaker: inst.api.speaker(), speaker_id: inst.api.speakerId()};\r\n        if(inst.api.engine() == \"xtts\" && inst.api.voiceSample()){\r\n            let sinst = am7model.newInstance(\"data.data\");\r\n            let q = am7client.newQuery(\"data.data\");\r\n            q.entity.request = am7view.viewFields(sinst);\r\n            q.field(\"organizationId\", page.user.organizationId);\r\n            q.field(\"objectId\", inst.api.voiceSample().objectId);\r\n            let sdr = await page.search(q);\r\n            let sd;\r\n            if(sdr && sdr.results && sdr.results.length > 0){\r\n                sd = sdr.results[0];\r\n            }\r\n            \r\n            if(!sd || !sd.dataBytesStore || sd.dataBytesStore.length == 0){\r\n                page.toast(\"error\", \"No voice sample data found for \" + inst.api.voiceSample().objectId);\r\n                return;\r\n            }\r\n            vprops.voice_sample = sd.dataBytesStore;\r\n        }\r\n        \r\n        let d = await m.request({method: 'POST', url: g_application_path + \"/rest/voice/\" + refId, withCredentials: true, body: vprops});\r\n        inst.api.sampleAudio(d);\r\n        if(d){\r\n            page.toast(\"success\", \"Voice synthesis test successful\");\r\n            /// If there is already an audio component, then update it:\r\n            let aud = document.querySelector(\"#sampleAudio\");\r\n            if(aud){\r\n                let apath = g_application_path + \"/media/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + d.groupPath + \"/\" + d.name;\r\n                let amt = d.contentType;\r\n                if (amt.match(/mpeg3$/)) amt = \"audio/mpeg\";\r\n                aud.src = apath;\r\n            }\r\n            setTimeout(() => {cleanupTestVoice(d);}, 20000);\r\n        }\r\n        else{\r\n            page.toast(\"error\", \"Voice synthesis test failed\");\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    async function pickProfile(object, inst, name) {\r\n        //console.log(\"~/GalleryHome/Characters/\" + inst.api.name());\r\n        //inst.change(\"portrait\");\r\n        //inst.change(\"profile\");\r\n        // \" + inst.api.name()\r\n        //console.warn(\"Need to update profile.portrait after picking, and/or fix the child object property not being updated\");\r\n        let n = \"\";\r\n        let p = object.caller();\r\n        let np = \"\";\r\n        //console.log(p.getInstance()?.entity?.groupPath);\r\n        if (p && p.getInstance()?.entity?.name) {\r\n            let pe = p.getInstance().entity;\r\n            let gp = \"/Gallery\";\r\n            let tp = pe.groupPath.substring(0, pe.groupPath.lastIndexOf(\"/\"));\r\n\r\n            n = \"/\" + pe.name;\r\n            np = tp + gp + \"/Characters\" + n;\r\n        }\r\n        /// \"~/GalleryHome/Characters\" + n\r\n        //page.components.picker.fieldPicker(inst, inst.formField(\"portrait\")?.field, undefined, undefined, np, function (objectPage, inst, field, useName, data) {\r\n        object.picker(inst.formField(\"portrait\")?.field, undefined, undefined, np, function (objectPage, inst, field, useName, data) {\r\n            if (p && p.getInstance()?.entity?.profile) {\r\n                let od = {id: p.getInstance().entity.profile.id, portrait: {id: data.id}};\r\n                p.getInstance().entity.profile.portrait = data;\r\n                od[am7model.jsonModelKey] = \"identity.profile\";\r\n                page.patchObject(od);\r\n               \r\n            }\r\n        });\r\n    };\r\n\r\n      async function pickVoice(object, inst, name) {\r\n        let n = \"\";\r\n        let p = object.caller();\r\n        let np = \"\";\r\n        if (p && p.getInstance()?.entity?.name) {\r\n            let pe = p.getInstance().entity;\r\n            let gp = \"/Voices\";\r\n            let tp = pe.groupPath.substring(0, pe.groupPath.lastIndexOf(\"/\"));\r\n            np = tp + gp;\r\n        }\r\n        console.info(inst.formField(\"voice\"));\r\n        object.picker(inst.formField(\"voice\")?.field, undefined, undefined, np, function (objectPage, inst, field, useName, data) {\r\n            if (p && p.getInstance()?.entity?.profile) {\r\n                let od = {id: p.getInstance().entity.profile.id, voice: {id: data.id}};\r\n                p.getInstance().entity.profile.voice = data;\r\n                od[am7model.jsonModelKey] = \"identity.voice\";\r\n                page.patchObject(od);\r\n               \r\n            }\r\n        });\r\n    };\r\n \r\n\r\n\r\n\r\n\r\n    async function narrate(object, inst) {\r\n        if (!inst || inst.model.name != \"olio.charPerson\") {\r\n            page.toast(\"warn\", \"Invalid object instance\");\r\n            return;\r\n        }\r\n        page.toast(\"info\", \"Updating narrative ...\");\r\n        let x = await m.request({ method: 'GET', url: am7client.base() + \"/olio/\" + inst.model.name + \"/\" + inst.api.objectId() + \"/narrate\", withCredentials: true });\r\n        if (x && x != null) {\r\n            inst.api.narrative(x);\r\n            page.toast(\"success\", \"Updated narrative\");\r\n        }\r\n        else{\r\n            page.toast(\"error\", \"Failed to update narrative\");\r\n        }\r\n    }\r\n\r\n    async function character(name, gender, age, race, profUrl, op){\r\n\r\n        let obj = await am7model.forms.commands.rollCharacter(undefined, undefined, gender);\r\n        obj.age = age;\r\n        obj.race = [race];\r\n        if(name && name.length > 0) {\r\n            obj.name = name;\r\n            let nms = name.split(\" \");\r\n            if(nms.length){\r\n                obj.firstName = nms[0];\r\n                obj.lastName = nms[nms.length - 1];\r\n                if(nms.length > 2){\r\n                    obj.middleName = nms[1];\r\n                }\r\n                else obj.middleName = null;\r\n            }\r\n            else{\r\n                obj.firstName = name;\r\n                obj.middleName = null;\r\n                obj.lastName = null;\r\n            }\r\n        }\r\n\r\n        let char = await createCharacter(obj, profUrl);\r\n        if(op && char.objectId){\r\n            m.route.set(\"/view/\" + char[am7model.jsonModelKey] + \"/\" + char.objectId);\r\n        }\r\n        return char;\r\n\r\n    }\r\n    \r\n    async function createCharacter(obj, profUrl){\r\n        if(!obj){\r\n            obj = await am7model.forms.commands.rollCharacter();\r\n        }\r\n\r\n        let cdir = await page.makePath(\"auth.group\", \"data\", \"~/Characters\");\r\n        let char = await page.searchFirst(\"olio.charPerson\", cdir.id, obj.name); \r\n\r\n        if(char == null){\r\n            \r\n            let charN = am7model.prepareEntity(obj, \"olio.charPerson\", true);\r\n            let w = charN.store.apparel[0].wearables;\r\n            for(let i = 0; i < w.length; i++){\r\n                w[i] = am7model.prepareEntity(w[i], \"olio.wearable\", false);\r\n                w[i].qualities[0] = am7model.prepareEntity(w[i].qualities[0], \"olio.quality\", false);\r\n            }\r\n    \r\n            char = await page.createObject(charN);\r\n    \r\n            if(char != null){\r\n                char = await page.searchFirst(\"olio.charPerson\", cdir.id, obj.name); \r\n                if(char == null){\r\n                    console.error(\"Failed to find character\", cdir.id, obj.name);\r\n                    return null;\r\n                }\r\n            }\r\n            else{\r\n                console.error(\"Failed to create character \" + obj.name, char);\r\n                return null;\r\n            }\r\n        }\r\n        if(char == null){\r\n            console.error(\"Character is null\", char);\r\n            return null;\r\n        }\r\n        if(!char.profile.portrait){\r\n\r\n            let dir = await page.makePath(\"auth.group\", \"data\", \"~/Gallery\");\r\n            if(!profUrl){\r\n                profUrl = \"/media/\" + char.gender + \"Silhouette.png\";\r\n            }\r\n            let datName = profUrl.substring(profUrl.lastIndexOf(\"/\") + 1);\r\n            let img;\r\n            try{\r\n                img = await page.openObjectByName(\"data.data\", dir.objectId, datName);\r\n            }\r\n            catch(e){\r\n                console.warn(e);\r\n            }\r\n            if(!img){\r\n                img = am7model.newInstance(\"data.data\").entity;\r\n                img.groupPath = dir.path;\r\n                img.name = datName;\r\n                img.contentType = \"image/png\";\r\n                img.dataBytesStore = await getProfUrl(profUrl);\r\n                img = await page.createObject(img);\r\n            }\r\n\r\n            char.profile.portrait = {id: img.id};\r\n            await page.patchObject(char.profile);\r\n        }\r\n        let inst = am7model.prepareInstance(char);\r\n        await am7model.forms.commands.narrate(undefined, inst);\r\n        return char;\r\n    }\r\n    async function getProfUrl(url){\r\n    \r\n        let x;\r\n        try{\r\n            x = await m.request({ method: 'GET', responseType: 'blob', url});\r\n        }\r\n        catch(e){\r\n            console.error(\"Error loading \" + url);\r\n        }\r\n        return new Promise((res, rej) => {\r\n            if(!x){\r\n                rej()\r\n            }\r\n            else{\r\n                var reader = new FileReader();\r\n                reader.onloadend = function() {\r\n                       res(reader.result.split(',', 2)[1]);\r\n                }\r\n                reader.readAsDataURL(x);\r\n            }\r\n        });\r\n    }\r\n\r\n    function characterWizard(){\r\n\r\n            let entity = am7model.newPrimitive(\"characterWizard\");\r\n            let cfg = {\r\n                label: \"Character Wizard\",\r\n                entityType: \"characterWizard\",\r\n                size: 50,\r\n                data: {entity},\r\n                confirm: async function (data) {\r\n                    page.toast(\"info\", \"Generating ...\");\r\n                    let o = data.entity;\r\n                    let name = o.firstName;\r\n                    if(o.middleName && o.middleName.length) name += \" \" + o.middleName;\r\n                    if(o.lastName && o.lastName.length) name += \" \" + o.lastName;\r\n                    await character(name, (o.gender == 'random' ? undefined : o.gender), o.age, \"E\", undefined, true);\r\n                    page.components.dialog.endDialog();\r\n                },\r\n                cancel: async function (data) {\r\n                    page.components.dialog.endDialog();\r\n                }\r\n            };\r\n            page.components.dialog.setDialog(cfg);\r\n        \r\n\r\n    }\r\n\r\n    async function rollCharacter(object, inst, gender) {\r\n        let x = await m.request({ method: 'GET', url: am7client.base() + \"/olio/roll\" + (gender ? \"/\" + gender : \"\"), withCredentials: true });\r\n        if (x && x != null) {\r\n            if(object){\r\n                object.mergeEntity(x);\r\n            }\r\n        }\r\n        return x;\r\n    }\r\n    async function getSystemPrompt(object, inst) {\r\n        if (!inst) {\r\n            return;\r\n        }\r\n        let x = await m.request({ method: 'GET', url: am7client.base() + \"/chat/prompt\", withCredentials: true });\r\n        if (x && x != null) {\r\n            object.mergeEntity(x);\r\n        }\r\n    }\r\n\r\n    forms.color = {\r\n        label: \"Color\",\r\n        fields: {\r\n            name: {\r\n                layout: \"third\"\r\n            },\r\n            hex: {\r\n                layout: \"one\",\r\n                format: \"color\"\r\n            },\r\n            red: {\r\n                layout: \"one\",\r\n                readOnly: true\r\n            },\r\n            green: {\r\n                layout: \"one\",\r\n                readOnly: true\r\n            },\r\n            blue: {\r\n                layout: \"one\",\r\n                readOnly: true\r\n            }\r\n\r\n\r\n        },\r\n        forms: [\"lightgroupinfo\"]\r\n    };\r\n\r\n    forms.charPerson = {\r\n        label: \"Character\",\r\n        fields: {\r\n            profile: {\r\n                layout: \"one\",\r\n                field: {\r\n                    label: \"Profile\"\r\n                },\r\n                format: \"image\"\r\n            },\r\n            name: {\r\n                layout: \"one\"\r\n            },\r\n            firstName: {\r\n                layout: \"one\"\r\n            },\r\n            middleName: {\r\n                layout: \"one\"\r\n            },\r\n            lastName: {\r\n                layout: \"one\"\r\n            },\r\n            gender: {\r\n                layout: 'one',\r\n                field: {\r\n                    label: 'Gender',\r\n                    type: 'list',\r\n                    limit: ['male', 'female', 'unisex']\r\n                }\r\n            },\r\n\r\n            eyeColor: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                label: \"Eye Color\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.color\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"eyeColor\"\r\n                    }\r\n                }\r\n            },\r\n            hairColor: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                label: \"Hair Color\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.color\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"hairColor\"\r\n                    }\r\n                }\r\n\r\n            },\r\n            hairStyle: {\r\n                layout: 'one'\r\n            },\r\n            birthDate: {\r\n                layout: \"one\"\r\n            },\r\n            age: {\r\n                layout: \"one\"\r\n            },\r\n            alignment: {\r\n                layout: \"one\",\r\n                field:{\r\n                    label: \"Alignment\",\r\n                    type: \"list\",\r\n                    default: \"neutral\",\r\n                    \"limit\": [\"neutralevil\", \"lawfulevil\", \"chaoticevil\", \"chaoticneutral\", \"neutral\", \"lawfulneutral\", \"chaoticgood\", \"neutralgood\", \"lawfulgood\"]\r\n                }\r\n            },\r\n\r\n            /*\r\n            blank : {\r\n                layout : \"full\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            */\r\n            /*\r\n             pickProfile: {\r\n                 format: \"button\",\r\n                 layout: \"one\",\r\n                 icon: 'run_circle',\r\n                 requiredAttributes : [\"objectId\"],\r\n                 field: {\r\n                     label: \"Pick Profile\",\r\n                     command: pickProfile\r\n                 }\r\n             },\r\n             */\r\n            reimage: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Reimage\",\r\n                    command: page.components.dialog.reimage\r\n                }\r\n            },\r\n            narrate: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Narrate\",\r\n                    command: narrate\r\n                }\r\n            },\r\n            vectorize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'polyline',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Vectorize\",\r\n                    command: page.components.dialog.vectorize\r\n                }\r\n            },\r\n            blank: {\r\n                layout: \"one\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n\r\n            /*\r\n            roll: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [\"!objectId\"],\r\n                field: {\r\n                    label: \"Roll\",\r\n                    command: rollCharacter\r\n                }\r\n            },\r\n            */\r\n            summarize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'summarize',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Summarize\",\r\n                    command: page.components.dialog.summarize\r\n                }\r\n            },\r\n            description: {\r\n                layout: \"full\",\r\n            },\r\n            trades: {\r\n                layout: \"third\",\r\n                format: \"textlist\"\r\n            },\r\n            race: {\r\n                layout: \"third\",\r\n                format: \"textlist\"\r\n            },\r\n            ethnicity: {\r\n                layout: \"third\",\r\n                format: \"textlist\"\r\n            }\r\n        },\r\n        forms: [\"personalityRef\", \"statisticsRef\", \"storeRef\", \"narrativeRef\", \"profileRef\", \"groupinfo\", \"tagattributes\"]\r\n    };\r\n\r\n    forms.storeRef = {\r\n        label: \"Store\",\r\n        model: true,\r\n        property: \"store\",\r\n        fields: {\r\n            store: {\r\n                layout: \"full\",\r\n                form: forms.store\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    forms.store = {\r\n        label: \"Store\",\r\n        fields: {\r\n            apparel: {\r\n                layout: 'half',\r\n                format: \"table\",\r\n                form: forms.entitylist\r\n            },\r\n            items: {\r\n                layout: 'half',\r\n                format: \"table\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n\r\n    let apparel = am7model.getModel(\"olio.apparel\");\r\n    apparel.fields.push({\r\n        name: \"designerRef\",\r\n        label: \"Designer\",\r\n        type: \"string\",\r\n        format: \"picker\",\r\n        pickerType: \"olio.charPerson\",\r\n        pickerProperty: {\r\n            selected: \"id\",\r\n            entity: \"designer\"\r\n        },\r\n        virtual: true,\r\n        ephemeral: true\r\n    });\r\n    forms.apparel = {\r\n        label: \"Apparel\",\r\n        fields: {\r\n            name: {\r\n                layout: 'half'\r\n            },\r\n            type: {\r\n                layout: 'one'\r\n            },\r\n            category: {\r\n                layout: 'one'\r\n            },\r\n            gender: {\r\n                layout: 'one',\r\n                field: {\r\n                    label: 'Gender',\r\n                    type: 'list',\r\n                    limit: ['male', 'female', 'unisex']\r\n                }\r\n            },\r\n            inuse: {\r\n                layout: 'one'\r\n            },\r\n            designerRef: {\r\n                layout: 'one'\r\n            },\r\n            manufacturer: {\r\n                layout: 'one'\r\n            },\r\n            dressUp: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'add',\r\n                field: {\r\n                    label: \"Dress Up\",\r\n                    command: am7olio.dressUp\r\n                }\r\n            },\r\n            dressDown: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'remove',\r\n                field: {\r\n                    label: \"Dress Down\",\r\n                    command: am7olio.dressDown\r\n                }\r\n            },\r\n            description: {\r\n                layout: 'full'\r\n            },\r\n            wearables: {\r\n                layout: 'full',\r\n                format: \"table\",\r\n                form: forms.entitylist\r\n            }\r\n        },\r\n        forms: [\"lightgroupinfo\"]\r\n    };\r\n\r\n    forms.quality = {\r\n        label: \"Quality\",\r\n        fields: {\r\n            unit: {\r\n                layout: 'one'\r\n            },\r\n            valueAdjustment: {\r\n                layout: 'one'\r\n            },\r\n            width: {\r\n                layout: 'one'\r\n            },\r\n            height: {\r\n                layout: 'one'\r\n            },\r\n            weight: {\r\n                layout: 'one'\r\n            },\r\n            length: {\r\n                layout: 'one'\r\n            },\r\n            opacity: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            elasticity: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            glossiness: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            viscocity: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            sliminess: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            blank: {\r\n                layout: \"one\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            smoothness: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            hardness: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            toughness: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            defensive: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            offensive: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            range: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            waterresistance: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            heatresistance: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            insulation: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            skill: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            }\r\n        },\r\n        forms: [\"lightgroupinfo\"]\r\n    };\r\n\r\n    forms.item = {\r\n        label: \"Item\",\r\n        fields: {\r\n            name: {\r\n                layout: 'third'\r\n            },\r\n            quality: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            category: {\r\n                layout: 'one'\r\n            },\r\n            type: {\r\n                layout: 'one'\r\n            },\r\n            inuse: {\r\n                layout: 'one'\r\n            },\r\n            qualities: {\r\n                layout: 'half',\r\n                format: 'table',\r\n                form: forms.entitylist2\r\n\r\n            }\r\n        },\r\n        forms: [\"itemStatisticsRef\", \"lightgroupinfo\"]\r\n    };\r\n\r\n    forms.wearable = {\r\n        label: \"Wearable\",\r\n        fields: {\r\n            name: {\r\n                layout: 'third'\r\n            },\r\n            level: {\r\n                layout: 'third',\r\n                label: \"Level\",\r\n                field: {\r\n                    type: \"list\",\r\n                    limit: [\"NONE\", \"INTERNAL\", \"UNDER\", \"ON\", \"BASE\", \"ACCENT\", \"SUIT\", \"GARNITURE\", \"ACCESSORY\", \"OVER\", \"OUTER\", \"FULL_BODY\", \"ENCLOSURE\", \"UNKNOWN\"],\r\n                    default: \"BASE\"\r\n                }\r\n            },\r\n            gender: {\r\n                layout: 'third',\r\n                field: {\r\n                    label: 'Gender',\r\n                    type: 'list',\r\n                    limit: ['male', 'female', 'unisex']\r\n                }\r\n            },\r\n            category: {\r\n                layout: 'one',\r\n                label: \"Category\",\r\n                field: {\r\n                    default: \"clothing\"\r\n                }\r\n            },\r\n            fabric: {\r\n                label: \"Fabric\",\r\n                layout: 'one'\r\n            },\r\n            color: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"Color\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.color\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"color\"\r\n                    }\r\n                }\r\n            },\r\n            pattern: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                label: \"Pattern\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.data\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"pattern\"\r\n                    }\r\n                }\r\n            },\r\n\r\n            inuse: {\r\n                layout: 'one'\r\n            },\r\n            qualities: {\r\n                layout: 'half',\r\n                format: 'table',\r\n                autocreate: true,\r\n                form: forms.entitylist2\r\n            },\r\n            location: {\r\n                layout: \"half\",\r\n                format: \"textlist\"\r\n            }\r\n\r\n\r\n        },\r\n        forms: [\"lightgroupinfo\"]\r\n    };\r\n    forms.itemStatisticsRef = {\r\n        label: \"Statistics\",\r\n        model: true,\r\n        property: \"statistics\",\r\n        fields: {\r\n            statistics: {\r\n                layout: \"full\",\r\n                form: forms.itemStatistics\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.itemStatistics = {\r\n        label: \"Statistics\",\r\n        fields: {\r\n            damage: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            protection: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            range: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.statisticsRef = {\r\n        label: \"Statistics\",\r\n        model: true,\r\n        property: \"statistics\",\r\n        fields: {\r\n            statistics: {\r\n                layout: \"full\",\r\n                form: forms.statistics\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    forms.statistics = {\r\n        label: \"Statistics\",\r\n        fields: {\r\n            physicalStrength: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            physicalEndurance: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            manualDexterity: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            agility: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            speed: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            mentalStrength: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            mentalEndurance: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            intelligence: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            wisdom: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            perception: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            creativity: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            spirituality: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            charisma: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            luck: {\r\n                layout: 'one',\r\n                format: 'range'\r\n            },\r\n            magic: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            science: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            willpower: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            reaction: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            save: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            health: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            },\r\n            maximumHealth: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                readOnly: true\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    forms.narrativeRef = {\r\n        label: \"Narrative\",\r\n        model: true,\r\n        property: \"narrative\",\r\n        fields: {\r\n            narrative: {\r\n                layout: \"full\",\r\n                form: forms.narrative\r\n            }\r\n        }\r\n    }\r\n    forms.personalityRef = {\r\n        label: \"Personality\",\r\n        model: true,\r\n        property: \"personality\",\r\n        fields: {\r\n            personality: {\r\n                layout: \"full\",\r\n                form: forms.personality\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.profileRef = {\r\n        label: \"Profile\",\r\n        model: true,\r\n        property: \"profile\",\r\n        fields: {\r\n            profile: {\r\n                layout: \"full\",\r\n                form: forms.profile\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.profile = {\r\n        label: \"Profile\",\r\n        fields: {\r\n            portrait: {\r\n                layout: 'one',\r\n                format: 'image',\r\n                field: {\r\n                    label: \"Profile\",\r\n                    pickerType: \"data.data\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"portrait\"\r\n                    }\r\n                }\r\n            },\r\n            pickProfile: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [],\r\n                field: {\r\n                    label: \"Pick Profile\",\r\n                    command: pickProfile\r\n                }\r\n            },\r\n            pickVoice: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [],\r\n                field: {\r\n                    label: \"Pick Voice\",\r\n                    pickerType: \"identity.voice\",\r\n                    command: pickVoice\r\n                }\r\n            },\r\n            voice: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                label: \"Voice\",\r\n                field: {\r\n                    readOnly: false,\r\n                    requiredAttributes: [],\r\n                    pickerType: \"identity.voice\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"voice\",\r\n                        path: \"~/Voices\"\r\n                    }\r\n                }\r\n            }\r\n            \r\n        }\r\n    };\r\n\r\n    forms.personality = {\r\n        label: \"Personality\",\r\n        fields: {\r\n            openness: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            conscientiousness: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            extraversion: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            agreeableness: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            neuroticism: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            blank: {\r\n                layout: \"one\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            machiavellianism: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            narcissism: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            psychopathy: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            sadism: {\r\n                layout: 'one',\r\n                format: 'range',\r\n                skipValidation: true\r\n            },\r\n            sloanKey: {\r\n                layout: 'one',\r\n                readOnly: true\r\n            },\r\n            sloanCardinal: {\r\n                layout: 'one',\r\n                readOnly: true\r\n\r\n            },\r\n            mbtiKey: {\r\n                layout: 'one',\r\n                readOnly: true\r\n            },\r\n            darkTetradKey: {\r\n                layout: 'one',\r\n                readOnly: true\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.narrative = {\r\n        label: \"Narrative\",\r\n        fields: {\r\n            objectId: {\r\n                layout: 'full',\r\n                label: \"Object Id\",\r\n                readOnly: true\r\n            },\r\n            physicalDescription: {\r\n                layout: 'full',\r\n                label: \"Description\",\r\n                format: 'print'\r\n            },\r\n            statisticsDescription: {\r\n                layout: 'full',\r\n                label: \"Statistics\",\r\n                format: 'print'\r\n            },\r\n            outfitDescription: {\r\n                layout: 'full',\r\n                label: \"Current Outfit\",\r\n                format: 'print'\r\n            },\r\n            armamentDescription: {\r\n                layout: 'full',\r\n                label: \"Armament\",\r\n                format: 'print'\r\n            },\r\n            alignmentDescription: {\r\n                layout: 'full',\r\n                label: \"Alignment\",\r\n                format: 'print'\r\n            },\r\n            darkTetradDescription: {\r\n                layout: 'full',\r\n                label: \"Dark Tetrad\",\r\n                format: 'print'\r\n            },\r\n            sloanDescription: {\r\n                layout: 'full',\r\n                label: \"Sloan\",\r\n                format: 'print'\r\n            },\r\n            mbtiDescription: {\r\n                layout: 'full',\r\n                label: \"Meyers-Briggs\",\r\n                format: 'print'\r\n            },\r\n            sdPrompt: {\r\n                layout: 'full',\r\n                label: \"SD Prompt\",\r\n                format: 'print'\r\n            },\r\n            sdNegativePrompt: {\r\n                layout: 'full',\r\n                label: \"SD Negative Prompt\",\r\n                format: 'print'\r\n            }\r\n        }\r\n    };\r\n\r\n    /// TODO: This whole nonsense is a WIP while migrating from the old to new model definition, and the UI updates being made around those changes.\r\n    let prc = am7model.getModel(\"olio.llm.promptRaceConfig\");\r\n    let prcr = am7model.getModelField(prc, \"raceType\");\r\n    prcr.type = \"list\";\r\n    prcr.limit = [\"L\", \"W\", \"X\", \"Y\", \"Z\", \"R\", \"S\", \"M\"];\r\n    forms.races = {\r\n        form: forms.promptRaceConfig,\r\n        standardUpdate: true\r\n    };\r\n    forms.promptRaceConfig = {\r\n        label: \"Race\",\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            }\r\n\r\n        },\r\n\r\n        fields: {\r\n            raceType: {\r\n                layout: \"third\",\r\n                field: {\r\n                    type: \"list\",\r\n                    label: \"Race\",\r\n                    limit: [\"L\", \"W\", \"X\", \"Y\", \"Z\", \"R\", \"S\"]\r\n                }\r\n            },\r\n            race: {\r\n                layout: \"two-thirds\",\r\n                format: \"textlist\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.promptConfig = {\r\n        label: \"Prompt\",\r\n        fields: {\r\n            name: {\r\n                layout: \"one\",\r\n                dragAndDrop: true\r\n            },\r\n            systemPrompt: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [\"!objectId\"],\r\n                field: {\r\n                    label: \"Load Default\",\r\n                    command: getSystemPrompt\r\n                }\r\n            },\r\n            blank: {\r\n                layout: \"two-thirds\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            setting: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            scene: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            races: {\r\n                format: \"table\",\r\n                layout: \"full\",\r\n                form: forms.promptRaceConfig\r\n            }\r\n        },\r\n        forms: [\"systemPromptConfig\", \"assistantPromptConfig\", \"userPromptConfig\", \"groupinfo\", \"attributes\"]\r\n    };\r\n    forms.systemPromptConfig = {\r\n        label: \"System Prompt\",\r\n        fields: {\r\n            system: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            systemCensorWarning: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            systemNlp: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            systemAnalyze: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            malePerspective: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            femalePerspective: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            episodeRule: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            }\r\n        },\r\n        forms: []\r\n    };\r\n    forms.assistantPromptConfig = {\r\n        label: \"Assistant Prompt\",\r\n        fields: {\r\n            assistant: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            assistantCensorWarning: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            assistantNlp: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            assistantAnalyze: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            assistantReminder: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            }\r\n        },\r\n        forms: []\r\n    };\r\n\r\n    forms.userPromptConfig = {\r\n        label: \"User Prompt\",\r\n        fields: {\r\n            user: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userConsentPrefix: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userConsentRating: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userConsentNlp: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userAnalyze: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userReminder: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            },\r\n            userCitation: {\r\n                layout: \"full\",\r\n                format: \"textlist\"\r\n            }\r\n        },\r\n        forms: []\r\n    };\r\n    forms.chatOptionsRef = {\r\n        label: \"Options\",\r\n        model: true,\r\n        property: \"chatOptions\",\r\n        fields: {\r\n            chatOptions: {\r\n                layout: \"full\",\r\n                form: forms.chatOptions\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    forms.chatOptions = {\r\n        label: \"Options\",\r\n        fields: {\r\n            temperature: {\r\n                label: \"Temperature\",\r\n                layout: 'third',\r\n                format: \"range\"\r\n            },\r\n            top_p: {\r\n                label: \"Top P\",\r\n                layout: 'third',\r\n                format: \"range\"\r\n            },\r\n            num_ctx: {\r\n                label: \"Maximum Tokens\",\r\n                layout: 'third',\r\n                format: \"range\"\r\n            },\r\n            typical_p: {\r\n                label: \"Presence Penalty\",\r\n                layout: 'third',\r\n                format: \"range\"\r\n            },\r\n            repeat_penalty: {\r\n                label: \"Frequency Penalty\",\r\n                layout: 'third',\r\n                format: \"range\"\r\n            }\r\n\r\n        }\r\n    };\r\n    forms.chatConfig = {\r\n        label: \"Chat Configuration\",\r\n        fields: {\r\n            name: {\r\n                layout: \"one\",\r\n                dragAndDrop: true\r\n            },\r\n            model: {\r\n                layout: \"one\",\r\n                label: \"Model Name\"\r\n            },\r\n            analyzeModel: {\r\n                layout: \"one\",\r\n                label: \"Analyze Model\"\r\n            },\r\n            rating: {\r\n                layout: \"one\",\r\n                field: {\r\n                    type: \"list\",\r\n                    label: \"Rating\",\r\n                    limit: [\"E\", \"E10\", \"T\", \"M\", \"AO\", \"RC\"]\r\n                }\r\n            },\r\n            startMode: {\r\n                layout: \"one\",\r\n                field: {\r\n                    label: 'Who Starts?',\r\n                    type: 'list',\r\n                    limit: ['none', 'system', 'user']\r\n                }\r\n            },\r\n            /*\r\n            blank : {\r\n                layout : \"one\",\r\n                format: \"blank\",\r\n                field: {\r\n                    label: \"\",\r\n                    readOnly: true\r\n                }\r\n            },\r\n            */\r\n            policy: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                field: {\r\n                    format: 'picker',\r\n                    pickerType: \"policy.policy\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"policy\"\r\n                    },\r\n                    label: \"Policy\"\r\n                }\r\n            },\r\n            serverUrl:{\r\n                layout: \"third\"\r\n            },\r\n            apiVersion: {\r\n                layout: \"one\"\r\n            },\r\n            serviceType: {\r\n                layout: \"one\",\r\n                label: \"Service Type\",\r\n                field:{\r\n                    type: \"list\",\r\n                    limit: [\"OPENAI\", \"OLLAMA\"]\r\n                }\r\n            },\r\n            apiKey:{\r\n                layout: \"third\",\r\n                type: \"password\"\r\n            },\r\n            systemCharacter: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"System Character\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"olio.charPerson\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"systemCharacter\"\r\n                    }\r\n                }\r\n            },\r\n            userCharacter: {\r\n                layout: 'third',\r\n                format: 'picker',\r\n                label: \"User Character\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"olio.charPerson\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"userCharacter\"\r\n                    }\r\n                }\r\n            },\r\n            setting: {\r\n                layout: \"third\",\r\n                label: \"Setting\"\r\n            },\r\n            stream: {\r\n                layout: \"one\"\r\n            },\r\n            assist: {\r\n                layout: \"one\"\r\n            },\r\n\r\n            prune: {\r\n                layout: \"one\"\r\n            },\r\n            remindEvery: {\r\n                layout: \"one\",\r\n                label: \"Remind Every\"\r\n            },\r\n            keyframeEvery: {\r\n                layout: \"one\",\r\n                label: \"Keyframe Every\"\r\n            },\r\n            messageTrim: {\r\n                layout: \"one\",\r\n                label: \"Message Trim\"\r\n            },\r\n\r\n            includeScene: {\r\n                layout: \"one\",\r\n                label: \"Include Scene\"\r\n            },\r\n            scene: {\r\n                layout: \"third\",\r\n                label: \"Scene\"\r\n            },\r\n            useNLP: {\r\n                layout: \"one\"\r\n            },\r\n            nlpCommand: {\r\n                layout: \"third\",\r\n                label: \"Command\"\r\n            },\r\n\r\n        },\r\n        forms: [\"episodectl\", \"chatOptionsRef\", \"groupinfo\", \"attributes\"]\r\n\r\n    };\r\n\r\n    forms.episodes = {\r\n        label: \"Episodes\",\r\n        format: \"table\",\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n        fields: {\r\n            number: {\r\n                layout: \"one\",\r\n                label: \"Number\"\r\n            },\r\n            completed: {\r\n                layout: \"one\",\r\n                label: \"Completed\"\r\n            },\r\n            name: {\r\n                layout: \"one\",\r\n                label: \"Name\"\r\n            },\r\n            theme: {\r\n                layout: \"one\",\r\n                label: \"Theme\"\r\n            },\r\n            stages: {\r\n                layout: \"full\",\r\n                format: \"textlist\",\r\n                label: \"Stages\"\r\n            }\r\n        }\r\n    };\r\n    forms.episodectl = {\r\n        label: \"Episodes\",\r\n        format: \"table\",\r\n        fields: {\r\n            episodes: {\r\n                layout: 'full',\r\n                form: forms.episodes\r\n            }\r\n        }\r\n    };\r\n    forms.charPersonRel = {\r\n        label: \"Relations\",\r\n        fields: {\r\n            partners: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            dependents: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            },\r\n            accounts: {\r\n                layout: \"third\",\r\n                form: forms.entitylist\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.models.push({\r\n        name: \"imageView\",\r\n        icon: \"image\",\r\n        label: \"Image\",\r\n        fields: [\r\n            { name: \"image\", type: \"model\", baseModel: \"data.data\" }\r\n        ]\r\n    });\r\n\r\n    forms.imageView = {\r\n        label: \"Image\",\r\n        fields: {\r\n            image: {\r\n                layout: \"full\",\r\n                format: \"image\"\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.models.push({\r\n        name: \"imageGallery\",\r\n        icon: \"photo_library\",\r\n        label: \"Gallery\",\r\n        fields: [\r\n            { name: \"images\", type: \"list\", baseModel: \"data.data\" },\r\n            { name: \"currentIndex\", type: \"int\", default: 0 }\r\n        ]\r\n    });\r\n\r\n    forms.imageGallery = {\r\n        label: \"Gallery\",\r\n        fields: {\r\n            images: {\r\n                layout: \"full\",\r\n                format: \"gallery\"\r\n            }\r\n        }\r\n    };\r\n\r\n    forms.openaiRequest = {\r\n        label: \"OpenAI Request\",\r\n        fields: {\r\n            model: {\r\n                layout: 'one'\r\n            },\r\n            vectorize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'polyline',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Vectorize\",\r\n                    command: page.components.dialog.vectorize\r\n                }\r\n            },\r\n            summarize: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'summarize',\r\n                requiredAttributes: [\"objectId\"],\r\n                field: {\r\n                    label: \"Summarize\",\r\n                    command: page.components.dialog.summarize\r\n                }\r\n            }\r\n            /*\r\n            ,\r\n            messages: {\r\n                format: \"table\",\r\n                form: forms.openaiMessages\r\n            }\r\n            */\r\n        },\r\n        forms: [\"openaiMessages\", \"lightgroupinfo\", \"attributes\"]\r\n    }\r\n\r\n\r\n\r\n    forms.openaiMessage = {\r\n        label: \"Chat Message\",\r\n        format: \"table\",\r\n        standardUpdate: true,\r\n        commands: {\r\n            new: {\r\n                label: 'New',\r\n                icon: 'add',\r\n                altIcon: 'check',\r\n                altCondition: ['edit'],\r\n                function: 'newEntry',\r\n                altFunction: 'checkEntry'\r\n            },\r\n            edit: {\r\n                label: 'Edit',\r\n                icon: 'edit',\r\n                function: 'editEntry',\r\n                condition: ['select']\r\n            },\r\n            cancel: {\r\n                label: 'Cancel',\r\n                icon: 'cancel',\r\n                function: 'cancelEntry',\r\n                condition: ['select', 'edit']\r\n            },\r\n            delete: {\r\n                label: 'Delete',\r\n                icon: 'delete_outline',\r\n                function: 'deleteEntry',\r\n                condition: ['select']\r\n            }\r\n\r\n        },\r\n        fields: {\r\n            role: {\r\n                layout: \"one\"\r\n            },\r\n            pruned: {\r\n                layout: \"one\"\r\n            },\r\n            content: {\r\n                layout: \"two-thirds\",\r\n                format: \"textarea\"\r\n            }\r\n        }\r\n    };\r\n    \r\n    forms.openaiMessages = {\r\n        label: \"Chat Messages\",\r\n        format: \"table\",\r\n        fields: {\r\n            messages: {\r\n                layout: 'full',\r\n                form: forms.openaiMessage\r\n            }\r\n        }\r\n    };\r\n\r\n    let voice = am7model.getModel(\"identity.voice\");\r\n    voice.fields.push({\r\n        name: \"sampleText\",\r\n        label: \"Sample Text\",\r\n        type: \"string\",\r\n        default: \"My voice is my passport, verify me.\",\r\n        virtual: true,\r\n        ephemeral: true\r\n    });\r\n    voice.fields.push({\r\n        name: \"sampleAudio\",\r\n        label: \"Sample Audio\",\r\n        type: \"model\",\r\n        baseModel: \"data.data\",\r\n        virtual: true,\r\n        ephemeral: true\r\n    });\r\n\r\n   forms.voice = {\r\n        label: \"Voice Form\",\r\n        fields: {\r\n            name: {\r\n                layout: \"one\"\r\n            },\r\n            engine: {\r\n                label: \"Engine\",\r\n                layout: \"one\",\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['piper', 'xtts']\r\n                }\r\n            },\r\n            speaker: {\r\n                label: \"Speaker\",\r\n                layout: \"one\",\r\n                field: {\r\n                    type: 'list',\r\n                    limit: ['Unknown', 'jenny', 'cori-high', 'clean100', 'en_US-libritts_r-medium', 'en_GB-alba-medium', 'en_US-kristin-medium']\r\n                }\r\n            },\r\n            speakerId: {\r\n                label: \"Speaker Id\",\r\n                layout: \"one\"\r\n            },\r\n            voiceSample: {\r\n                layout: 'one',\r\n                format: 'picker',\r\n                label: \"Voice Sample\",\r\n                field: {\r\n                    format: \"picker\",\r\n                    pickerType: \"data.data\",\r\n                    pickerProperty: {\r\n                        selected: \"{object}\",\r\n                        entity: \"voiceSample\",\r\n                        path: \"~/Voices\"\r\n                    }\r\n                }\r\n            },\r\n            speed: {\r\n                label: \"Speed\",\r\n                layout: \"one\",\r\n                format: \"range\"\r\n            },\r\n            sampleText:{\r\n                layout: \"third\"\r\n            },\r\n            createSample: {\r\n                format: \"button\",\r\n                layout: \"one\",\r\n                icon: 'run_circle',\r\n                requiredAttributes: [],\r\n                field: {\r\n                    label: \"Test Voice\",\r\n                    command: testVoice\r\n                }\r\n            },\r\n            sampleAudio: {\r\n                layout: 'one',\r\n                format: 'audio'\r\n            }\r\n\r\n\r\n        },\r\n        forms: [\"grouptypeinfo\", \"attributes\"]\r\n    };\r\n\r\n    forms.commands = {\r\n        character,\r\n        createCharacter,\r\n        characterWizard,\r\n        rollCharacter,\r\n        narrate\r\n    };\r\n    am7model.forms = forms;\r\n}());\n\n;/* === client/view.js === */\n(function () {\r\n\r\n    function getDefaultValuesForField(field) {\r\n        let v = [];\r\n        switch (field.type) {\r\n            case \"list\":\r\n                v = field.limit || [];\r\n                break;\r\n            case \"enum\":\r\n                if (field.filter) v = field.enum.filter((v) => v.match(field.filter));\r\n                else if (field.baseClass) {\r\n                    let jsName = field.baseClass.substring(field.baseClass.lastIndexOf(\".\") + 1);\r\n                    v = am7model.enums[jsName.substring(0, 1).toLowerCase() + jsName.substring(1)];\r\n                }\r\n                else v = field.enum;\r\n\r\n                break;\r\n            default:\r\n                // console.warn(\"Unhandled type\", field.type);\r\n                break;\r\n        }\r\n        return v;\r\n    }\r\n\r\n\r\n    function getFormatForType(type) {\r\n        let format = \"text\";\r\n        switch (type) {\r\n            case \"list\":\r\n            case \"enum\":\r\n                format = \"select\";\r\n                break;\r\n            case \"zonetime\":\r\n            case \"timestamp\":\r\n            case \"datetime\":\r\n                format = \"datetime-local\";\r\n                break;\r\n            case \"boolean\":\r\n                format = \"checkbox\";\r\n                break;\r\n            default:\r\n                /// console.log(\"Default \" + type + \" to \" + format);\r\n                break;\r\n        }\r\n        return format;\r\n    }\r\n\r\n    function getActionView(fld, inst) {\r\n        let a = inst.form.commands[fld];\r\n        return m(\"div\", [\r\n            m(\"button\", {\r\n                class: \"page-dialog-button\",\r\n                onclick: function () {\r\n                    inst.action(a.action);\r\n                }\r\n            }, [\r\n                m(\"span\", {\r\n                    class: \"material-symbols-outlined material-symbols-outlined-white md-18 mr-4\"\r\n                }, [a.icon]),\r\n                m(\"span\", {\r\n                    class: \"\"\r\n                }, [a.label]),\r\n            ])\r\n        ])\r\n    }\r\n\r\n    function getValidationErrorLabel(txt){\r\n        return m(\"span\", {class: \"p-1 block text-sm rounded bg-red-400\"}, txt)\r\n    }\r\n\r\n    function getFieldView(fld, inst) {\r\n        let f = inst.field(fld);\r\n        let ff = inst.formField(fld);\r\n        if(ff && ff.hide){\r\n            return m(\"span\", \"\");\r\n        }\r\n        let annot = \"\";\r\n        if(inst.validationErrors[fld]){\r\n            annot = getValidationErrorLabel(inst.validationErrors[fld]);\r\n        }\r\n        return m(\"div\", [\r\n            m(\"label\", {\r\n                class: \"block\",\r\n                for: fld\r\n            }, [\r\n                inst.label(fld)\r\n            ]),\r\n            (f ? getField(fld, inst) : m(\"span\", { class: \"bold\" }, \"Invalid field: \" + fld)),\r\n            annot\r\n        ]);\r\n    }\r\n    function getField(fld, inst) {\r\n        let props = {\r\n            oninput: inst.handleChange(fld),\r\n            placeholder: inst.placeholder(fld),\r\n            name: fld\r\n        };\r\n        let fprops = inst.viewProperties(fld);\r\n        if (fprops) {\r\n            props = Object.assign(fprops, props);\r\n        }\r\n        let defVal;\r\n        if (inst.api[fld]) {\r\n            defVal = inst.api[fld]();\r\n        }\r\n\r\n        let type = inst.formField(fld, \"format\") || inst.formField(fld, \"type\") || \"text\";\r\n        let cls = \"text-field-full\";\r\n        let useType = type;\r\n        if (type == \"list\") {\r\n            let ofld = inst.formField(fld, \"limit\") || inst.formField(fld, \"values\") || [];\r\n            if(inst.field(fld).type == \"list\" && ofld.length == 0 && defVal instanceof Array){\r\n                ofld = defVal;\r\n            }\r\n            return m(\"select\", { onchange: inst.handleChange(fld), class: \"select-field-full\" },\r\n                ofld.map((o, i) => m(\"option\", { value: o, selected: (o == inst.api[fld]()) }, o)),\r\n            );\r\n        }\r\n        if (type == \"boolean\") {\r\n            useType = \"checkbox\";\r\n            cls = \"check-field\";\r\n        }\r\n        let iprops = {\r\n            class: cls,\r\n            type: useType,\r\n            value: defVal\r\n        };\r\n        if (useType == \"checkbox\") {\r\n            props.oninput = undefined;\r\n            props.onchange = inst.handleChange(fld);\r\n            iprops.checked = defVal;\r\n        }\r\n        return m(\"input\", Object.assign(iprops, props));\r\n    }\r\n\r\n    function form(inst) {\r\n\r\n        let vf = inst.form;\r\n\r\n        let el = Array.from(Object.entries(vf.fields).map(([k, f]) => {\r\n            let x = inst.design(k);\r\n            if (!x) {\r\n                x = getFieldView(k, inst);\r\n            }\r\n            return [k, x];\r\n        }), ([key, value]) => value);\r\n        let el2 = Array.from(Object.entries(vf.commands || {}).map(([k, c]) => {\r\n            return [k, getActionView(k, inst)];\r\n        }), ([key, value]) => value);\r\n        el.push(...el2);\r\n\r\n        let v = [m(\"h3\", {\r\n            class: \"box-title\"\r\n        }, [\r\n            icon(inst),\r\n            label(inst)\r\n        ]),\r\n        m(\"div\", {\r\n            class: \"mt-4\"\r\n        },\r\n            el\r\n        )\r\n        ];\r\n        return v;\r\n    }\r\n\r\n    function icon(v) {\r\n        if (v.icon()) {\r\n            return m(\"span\", {\r\n                class: \"material-symbols-outlined mr-4\"\r\n            }, [v.icon()]);\r\n        }\r\n        return \"\";\r\n    }\r\n    function label(v) {\r\n        if (v.label()) {\r\n            return m(\"span\", {}, [v.label()]);\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    let basePath = \"~\";\r\n\r\n    function getBasePathByType(s) {\r\n        let m = am7model.getModel(s);\r\n        if (!m || !m.group) return basePath;\r\n        return basePath + \"/\" + m.group;\r\n    }\r\n    let worldView = {\r\n        \"Population\": \"olio.charPerson\",\r\n        \"Characters\": \"olio.charPerson\"\r\n    }\r\n    function getTypeByPath(sPath) {\r\n        let subPath = sPath.substring(sPath.lastIndexOf(\"/\") + 1);\r\n        let outT;\r\n        let aP = am7model.models.filter(m => m.group && m.group == subPath);\r\n        if (aP.length) outT = aP[0].name;\r\n        if (!outT && worldView[subPath]) {\r\n            outT = worldView[subPath];\r\n        }\r\n        return outT;\r\n    }\r\n\r\n    function getPathForType(type) {\r\n        let path = getBasePathByType(type);\r\n        if (path != null) path = path.replace(/^~/, page.user.homeDirectory.path);\r\n        return path;\r\n    }\r\n\r\n    function viewQuery(inst) {\r\n        if (typeof inst == \"string\") inst = am7model.newInstance(inst);\r\n        let q = am7client.newQuery(inst.model.name);\r\n        q.entity.request = getViewFields(inst);\r\n\r\n        let oidf = inst.fields.filter(f => f.name == \"objectId\");\r\n        let idf = inst.fields.filter(f => f.name == \"id\");\r\n        let id;\r\n        if (oidf.length) {\r\n            id = oidf[0];\r\n        }\r\n        else if (idf.length) {\r\n            id = idf[0];\r\n        }\r\n        let idv;\r\n        if (id && inst.api[id.name] && (idv = inst.api[id.name]()) && idv != null) {\r\n            q.field(id.name, inst.api[id.name]());\r\n        }\r\n        /*\r\n        if(page.user){\r\n            q.field(\"organizationId\", page.user.organizationId);\r\n        }\r\n        */\r\n        return q;\r\n    }\r\n\r\n    function getViewFields(inst) {\r\n        if (typeof inst == \"string\") inst = am7model.newInstance(inst);\r\n        return getFormFieldNames(inst.model.name, inst.form);\r\n    }\r\n\r\n    function getFormFieldNames(model, form) {\r\n        let a = [];\r\n        if (!form || !form.fields) return a;\r\n        a = Object.keys(form.fields).filter(f => {\r\n            let mf = am7model.getModelField(model, f);\r\n            return (mf && !mf.ephemeral);\r\n        }).map(k => k);\r\n        if (form.query) a.push(...form.query);\r\n\r\n        if (am7model.inherits(model, \"system.organizationExt\")) {\r\n            a.push(\"organizationPath\");\r\n            a.push(\"organizationId\");\r\n        }\r\n        if (am7model.inherits(model, \"system.primaryKey\")) {\r\n            a.push(\"id\");\r\n        }\r\n\r\n        if (am7model.isParent(model)) {\r\n            if (am7model.hasField(model, \"path\")) a.push(\"path\");\r\n            a.push(\"parentId\");\r\n        }\r\n        if (am7model.isGroup(model) && model != 'auth.group') {\r\n            a.push(\"groupPath\");\r\n            a.push(\"groupId\");\r\n        }\r\n        if (form.forms) {\r\n            form.forms.forEach(f => {\r\n                a.push(...getFormFieldNames(model, am7model.forms[f]));\r\n            });\r\n        }\r\n        return a.filter((v, i, z) => z.indexOf(v) == i);\r\n    }\r\n\r\n    function getFormField(form, name) {\r\n        let field;\r\n        if (form) {\r\n            field = form.fields[name];\r\n            if (!field) {\r\n                let ff = (form.forms || []);\r\n                for (let fo in ff) {\r\n                    let f = ff[fo];\r\n                    field = am7model.forms[f].fields[name];\r\n                    if (field) {\r\n                        break;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        return field;\r\n    }\r\n\r\n    function typeToModel(type) {\r\n        let ot = type;\r\n        if (!type) {\r\n            return type;\r\n        }\r\n        switch (type.toLowerCase()) {\r\n            case \"account\":\r\n                ot = \"identity.account\";\r\n                break;\r\n            case \"user\":\r\n                ot = \"system.user\";\r\n                break;\r\n            case \"person\":\r\n                ot = \"identity.person\";\r\n                break;\r\n            case \"unknown\":\r\n                ot = \"common.nameId\";\r\n                break;\r\n        }\r\n        return ot;\r\n    }\r\n\r\n    /// TODO: There's currently a bug where if a picker is based on a type, and restricted by the type value, then if the type list displays initially without being redrawn, the type\r\n    /// value will still be the default - currently the work around is display these fields on a secondary tab\r\n    function showField(inst, ref, useName) {\r\n        let show = true;\r\n        let entity = inst?.entity;\r\n\r\n        if (ref.requiredRoles) {\r\n            show = false;\r\n            let rctx = page.context().roles;\r\n            ref.requiredRoles.forEach((a, i) => {\r\n                if (rctx[a] === true) show = true;\r\n            });\r\n        }\r\n        if (show && entity && ref.requiredAttributes) {\r\n            let showCount = 0;\r\n            ref.requiredAttributes.forEach((a, i) => {\r\n                let a2 = a;\r\n                let invert = (a2.match(/^!/) != null);\r\n                if (invert) {\r\n                    a2 = a2.replace(/^!/, \"\");\r\n                }\r\n\r\n                let reqVal;\r\n                if (ref.requiredValues) {\r\n                    reqVal = ref.requiredValues[i];\r\n                }\r\n                if (ref.referField) {\r\n                    let mat;\r\n                    if (useName && (mat = useName.match(/(-\\d+)$/)) != null) {\r\n                        a2 = a2 + mat[1];\r\n                    }\r\n                    let e = document.querySelector('[name=' + a2 + ']');\r\n                    if (e && e.type == 'checkbox') {\r\n                        if (e.checked || invert) showCount++;\r\n                    }\r\n                    else if (e) {\r\n                        let reqVals = (reqVal ? reqVal.split(\"|\") : [undefined]);\r\n                        let showTotal = 0;\r\n                        reqVals.forEach((v2) => {\r\n                            if (\r\n                                (v2 && e.value == v2)\r\n                                ||\r\n                                (!v2 && e.value)\r\n                            ) {\r\n                                showTotal++;\r\n                            }\r\n                        });\r\n                        if (reqVal) {\r\n                            if (reqVal.indexOf(\"|\") > -1 && showTotal > 0) showCount++;\r\n                            else if (showTotal == reqVals.length) showCount++;\r\n                        }\r\n                        else if (showTotal > 0) {\r\n                            showCount++;\r\n                        }\r\n                    }\r\n                    else {\r\n                        //console.log(\"Else: \" + a2);\r\n                    }\r\n                }\r\n                else if ((reqVal && entity[a2] != reqVal) || (!reqVal && ((!invert && !entity[a2]) || (invert && entity[a2])))) {\r\n                    //console.log(\"Else...\");\r\n                    //show = false;\r\n                }\r\n                else {\r\n                    showCount++;\r\n                }\r\n            });\r\n            show = ref.requiredAttributes.length == showCount;\r\n        }\r\n        return show;\r\n    }\r\n\r\n    function isBinary(entity, mt){\r\n        let contentType = mt;\r\n        if(contentType || (entity && (contentType = entity.contentType))){\r\n            return (\r\n                !contentType.match(/^text/gi)\r\n                &&\r\n                !contentType.match(/application\\/json/)\r\n                &&\r\n                !contentType.match(/javascript$/gi)\r\n            );\r\n        }\r\n        return false;\r\n    }\r\n\r\n    let am7view = {\r\n        errorLabel: getValidationErrorLabel,\r\n        form,\r\n        fieldView: getFieldView,\r\n        formField: getFormField,\r\n        viewFields: getViewFields,\r\n        field: getField,\r\n        label,\r\n        icon,\r\n        viewQuery,\r\n        fieldNames: getFormFieldNames,\r\n        path: getBasePathByType,\r\n        pathForType: getPathForType,\r\n        typeByPath: getTypeByPath,\r\n        typeToModel,\r\n        defaultValuesForField: getDefaultValuesForField,\r\n        getFormatForType,\r\n        showField,\r\n        basePath: (s) => {\r\n            if (s) {\r\n                basePath = s;\r\n            }\r\n            return basePath;\r\n        },\r\n        isBinary\r\n    };\r\n\r\n    if (typeof module != \"undefined\") {\r\n        module.am7view = am7view;\r\n    } else {\r\n        window.am7view = am7view;\r\n    }\r\n}());\n\n;/* === client/viewExtensions.js === */\n(function () {\r\n    /// Extensions to am7view to support custom field renderers\r\n    /// This allows formats like \"image\", \"video\", \"pdf\" etc. to use custom rendering logic\r\n\r\n    /// Storage for custom renderers\r\n    if (!am7view.customRenderers) {\r\n        am7view.customRenderers = {};\r\n    }\r\n\r\n    /// Register a custom renderer for a format type\r\n    am7view.registerCustomRenderer = function(formatName, renderFunction) {\r\n        am7view.customRenderers[formatName] = renderFunction;\r\n    };\r\n\r\n    /// Enhanced getField that checks for custom renderers\r\n    let originalGetField = am7view.field;\r\n\r\n    am7view.field = function(fld, inst) {\r\n        // Get the format for this field\r\n        let format = inst.formField(fld, \"format\");\r\n\r\n        // Check if there's a custom renderer for this format\r\n        if (format && am7view.customRenderers[format]) {\r\n            return am7view.customRenderers[format](inst, fld);\r\n        }\r\n\r\n        // Fall back to original implementation\r\n        return originalGetField(fld, inst);\r\n    };\r\n\r\n    /// Enhanced fieldView that supports custom renderers\r\n    let originalFieldView = am7view.fieldView;\r\n\r\n    am7view.fieldView = function(fld, inst) {\r\n        let f = inst.field(fld);\r\n        let ff = inst.formField(fld);\r\n\r\n        if (ff && ff.hide) {\r\n            return m(\"span\", \"\");\r\n        }\r\n\r\n        // Check for custom renderer\r\n        let format = inst.formField(fld, \"format\");\r\n        if (format && am7view.customRenderers[format]) {\r\n            let annot = \"\";\r\n            if (inst.validationErrors[fld]) {\r\n                annot = am7view.errorLabel(inst.validationErrors[fld]);\r\n            }\r\n\r\n            // For custom renderers, wrap in a div with label if showLabel is not false\r\n            let showLabel = ff ? (ff.showLabel !== false) : true;\r\n\r\n            if (showLabel) {\r\n                return m(\"div\", [\r\n                    m(\"label\", {\r\n                        class: \"block\",\r\n                        for: fld\r\n                    }, [\r\n                        inst.label(fld)\r\n                    ]),\r\n                    am7view.customRenderers[format](inst, fld),\r\n                    annot\r\n                ]);\r\n            } else {\r\n                return m(\"div\", [\r\n                    am7view.customRenderers[format](inst, fld),\r\n                    annot\r\n                ]);\r\n            }\r\n        }\r\n\r\n        // Fall back to original implementation\r\n        return originalFieldView(fld, inst);\r\n    };\r\n\r\n    /// Helper to determine renderer based on object properties\r\n    am7view.selectObjectRenderer = function(object) {\r\n        // Check for portrait\r\n        if (object.profile && object.profile.portrait && object.profile.portrait.contentType) {\r\n            return \"portrait\";\r\n        }\r\n\r\n        // Check model\r\n        let model = object[am7model.jsonModelKey];\r\n        if (model) {\r\n            switch(model) {\r\n                case 'note':\r\n                    return \"markdown\";\r\n                case 'form':\r\n                    return \"form\";\r\n                case 'message':\r\n                    return \"messageContent\";\r\n            }\r\n        }\r\n\r\n        // Check content type\r\n        let mt = object.contentType || \"\";\r\n        if (mt.match(/^image/) || mt.match(/webp$/)) {\r\n            return \"image\";\r\n        }\r\n        if (mt.match(/^video/)) {\r\n            return \"video\";\r\n        }\r\n        if (mt.match(/^audio/)) {\r\n            return \"audio\";\r\n        }\r\n        if (mt.match(/^text/)) {\r\n            return \"text\";\r\n        }\r\n        if (mt.match(/pdf$/)) {\r\n            return \"pdf\";\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /// Create an instance for object viewing\r\n    am7view.prepareObjectView = function(object, attrs) {\r\n        let model = attrs[am7model.jsonModelKey] || object[am7model.jsonModelKey];\r\n\r\n        if (!model) {\r\n            console.warn(\"No model specified for object view\");\r\n            return null;\r\n        }\r\n\r\n        // Determine the appropriate renderer\r\n        let rendererType = am7view.selectObjectRenderer(object);\r\n\r\n        if (!rendererType) {\r\n            console.warn(\"No renderer found for object\", object);\r\n            return null;\r\n        }\r\n\r\n        // Create a synthetic entity for the view\r\n        let entity = {\r\n            [am7model.jsonModelKey]: \"view.objectDisplay\",\r\n            objectId: object.objectId,\r\n            active: attrs.active !== false,\r\n            maxMode: attrs.maxMode || false,\r\n            viewType: rendererType,\r\n            _sourceObject: object\r\n        };\r\n\r\n        // Merge object properties\r\n        Object.assign(entity, object);\r\n\r\n        // Get appropriate form\r\n        let formName = rendererType + \"View\";\r\n        let form = am7model.forms[formName];\r\n\r\n        if (!form) {\r\n            console.warn(\"No form found for renderer type:\", rendererType);\r\n            return null;\r\n        }\r\n\r\n        // Prepare instance\r\n        let inst = am7model.prepareInstance(entity, form);\r\n\r\n        return inst;\r\n    };\r\n\r\n}());\r\n\n\n;/* === client/decorator.js === */\n(function () {\r\n\r\n    function getFileTypeIcon(p, i) {\r\n        let mtIco = \"\";\r\n        if (p.contentType && p.name.indexOf(\".\") > 0) {\r\n            let ext = p.name.substring(p.name.lastIndexOf(\".\") + 1, p.name.length).toLowerCase();\r\n            mtIco = m(\"span\", { class: \"fontLabel\" + (i && i > 0 ? \"-\" + i : \"\") + \" fiv-cla fiv-icon-\" + ext });\r\n        }\r\n        return mtIco;\r\n    }\r\n\r\n    function getThumbnail(ctl, p){\r\n        let type = am7model.getModel(p[am7model.jsonModelKey]);\r\n        let ico = \"question_mark\";\r\n        if (type && type.icon) ico = type.icon;\r\n        let gridMode = ctl.gridMode;\r\n        let icon;\r\n        if (p.profile && p.profile.portrait && p.profile.portrait.contentType) {\r\n          let pp = p.profile.portrait;\r\n          let icoPath = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/\" + (gridMode == 1 ? \"256x256\" : \"512x512\");\r\n          if (gridMode == 2 && (pp.contentType.match(/gif$/) || pp.contentType.match(/webp$/))) icoPath = g_application_path + \"/media/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name;\r\n          let icoCls = \"image-grid-image carousel-item-img\";\r\n          icon = m(\"img\", { class: icoCls, src: icoPath });\r\n        }\r\n        else if (p.contentType && p.contentType.match(/^image/)) {\r\n          let icoPath = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + p.groupPath + \"/\" + p.name + \"/\" + (gridMode == 1 ? \"256x256\" : \"512x512\");\r\n          if(p.dataBytesStore && p.dataBytesStore.length){\r\n            icoPath = \"data:\" + p.contentType + \";base64,\" + p.dataBytesStore;\r\n          }\r\n          if (gridMode == 2 && (p.contentType.match(/gif$/) || p.contentType.match(/webp$/))) icoPath = g_application_path + \"/media/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + p.groupPath + \"/\" + p.name;\r\n          let icoCls = \"image-grid-image carousel-item-img\";\r\n          icon = m(\"img\", { class: icoCls, src: icoPath });\r\n        }\r\n        else if(p.contentType && p.name.indexOf(\".\") > 0){\r\n           let ext = p.name.substring(p.name.lastIndexOf(\".\") + 1, p.name.length);\r\n            icon = m(\"span\", { class: \"fontLabel-\" + (gridMode == 1 ? \"6\" : \"10\") + \" fiv-cla fiv-icon-\" + ext });\r\n        }\r\n        else {\r\n          //icon = m(\"span\", { class: \"material-symbols-outlined material-icons-48\" }, ico);\r\n        let icoCls = \"material-symbols-outlined\";\r\n        let col = \"\";\r\n        let sty = \"\";\r\n        if (p.hex) {\r\n            icoCls = \"material-icons\";\r\n            col = \" stroke-slate-50\";\r\n            sty = \"color: \" + p.hex + \";\";\r\n        }\r\n\r\n        icon = m(\"span\", { style: sty, class: icoCls + \" material-icons-72\" + (icoCls ? \" \" + icoCls : \"\") + col }, ico);\r\n        \r\n        }\r\n        return icon;\r\n    }\r\n\r\n    function getIcon(p) {\r\n        let type = am7model.getModel(p[am7model.jsonModelKey]);\r\n        let ico = \"question_mark\";\r\n        if (type && type.icon) ico = type.icon;\r\n        let icon;\r\n        let icoCls = \"\";\r\n        if (p[am7model.jsonModelKey] == \"message.spool\") {\r\n            if (p.spoolStatus == \"ERROR\") {\r\n                icoCls = \"text-red-600\";\r\n                ico = \"quickreply\";\r\n            }\r\n            else if (p.spoolStates == \"ACKNOWLEGED_RECEIPT\") {\r\n                ico = \"mark_chat_read\";\r\n            }\r\n            else if (p.spoolStates == \"TRANSMITTED\" || p.spoolStatus == \"SPOOLED\") {\r\n                icoCls = \"text-green-600\";\r\n                ico = \"mark_chat_unread\";\r\n            }\r\n\r\n        }\r\n        if (p.profile && p.profile.portrait && p.profile.portrait.contentType) {\r\n            let icoPath = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + p.profile.portrait.groupPath + \"/\" + p.profile.portrait.name + \"/48x48\";\r\n\r\n            icon = m(\"img\", { height: 48, width: 48, src: icoPath });\r\n        }\r\n        else if (p.contentType && p.contentType.match(/^image/)) {\r\n            let icoPath = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + p.groupPath + \"/\" + p.name + \"/48x48\";\r\n            if (p.dataBytesStore && p.dataBytesStore.length) {\r\n                icoPath = \"data:\" + p.contentType + \";base64,\" + p.dataBytesStore;\r\n            }\r\n            icon = m(\"img\", { height: 48, width: 48, src: icoPath });\r\n        }\r\n        else if(p.contentType && p.name && p.name.indexOf(\".\") > 0){\r\n            icon = getFileTypeIcon(p, 3);\r\n        }\r\n        else {\r\n            icoCls = \"material-symbols-outlined\";\r\n            let col = \"\";\r\n            let sty = \"\";\r\n            if (p.hex) {\r\n                icoCls = \"material-icons\";\r\n                col = \" stroke-slate-50\";\r\n                sty = \"color: \" + p.hex + \";\";\r\n            }\r\n\r\n            icon = m(\"span\", { style: sty, class: icoCls + \" material-icons-48\" + (icoCls ? \" \" + icoCls : \"\") + col }, ico);\r\n        }\r\n        return icon;\r\n    };\r\n\r\n\r\n\r\n    function getFavoriteStyle(p) {\r\n        let isFavcls = \"\";\r\n        if (page.isFavorite(p)) {\r\n            isFavcls = \" material-symbols-outlined-red filled\";\r\n        }\r\n        return isFavcls\r\n    }\r\n\r\n    function getPolarListItem(ctl, p) {\r\n        let icon = am7decorator.icon(p);\r\n        let cls = \"result-item\";\r\n        let dcls;\r\n        let dnd = page.components.dnd;\r\n        let pagination = ctl.pagination;\r\n        dcls = dnd.doDragDecorate(p);\r\n        if (dcls) cls += \" \" + dcls;\r\n\r\n        if (!dcls && pagination.state(p).checked) {\r\n            cls += \" result-item-active\";\r\n        }\r\n        let useName = am7client.getAttributeValue(p, 'name', p.name) || (p.objectId);\r\n\r\n        let supplData = \"\";\r\n        if (p.contentType) supplData = p.contentType;\r\n        else if (p.type) supplData = p.type;\r\n        else if (p.description) supplData = p.description;\r\n        else if (p.spoolStatus) supplData = p.spoolStatus;\r\n        let attr = \"\";\r\n        let dndProp = page.components.dnd.dragProps(p);\r\n        attr = \"[draggable]\";\r\n        let isFavcls = getFavoriteStyle(p);\r\n        let mtIco = am7decorator.fileIcon(p);\r\n        return m(\"li\" + attr, dndProp,\r\n            [\r\n                m(\"div\", {\r\n                    rid: \"item-\" + p.objectId,\r\n                    onselectstart: function () { return false; },\r\n                    ondblclick: function () { if (ctl.containerMode) ctl.down(p); else ctl.open(p); },\r\n                    onclick: function () { ctl.select(p) },\r\n                    class: cls\r\n                }, [\r\n                    m(\"div\", { class: \"flex-polar\" }, [\r\n                        m(\"div\", { class: \"label\" }, [useName]),\r\n                        m(\"div\", { class: \"label\" }, [\"Tags\"]),\r\n                        m(\"div\", { class: \"polar-label\" }, [\r\n                            m(\"span\", { class: \"tweak-box\" }, [\r\n                                mtIco\r\n                            ])\r\n                        ])\r\n                    ]),\r\n                    m(\"div\", { class: \"flex-polar-2\" }, [\r\n                        m(\"div\", { class: \"meta-container\" }, [\r\n                            m(\"div\", { class: \"meta-item\" }, [\r\n                                icon,\r\n                                m(\"span\", { class: \"ml-2\" }, supplData),\r\n                                m(\"span\", { class: \"ml-2\" }, (p.modifiedDate ? \" \" + (new Date(p.modifiedDate)).toLocaleDateString(\"en-US\", { weekday: 'short', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric' }) : \"\"))\r\n                            ])\r\n                        ]),\r\n                        m(\"div\", { class: \"annotation\" }, [\r\n                            m(\"span\", {\r\n                                class: \"cursor-pointer material-symbols-outlined\" + isFavcls, onclick: function (e) {\r\n                                    e.preventDefault();\r\n                                    page.favorite(p).then((b) => {\r\n                                        m.redraw();\r\n                                    });\r\n                                    return false;\r\n                                }\r\n                            }, \"favorite\")\r\n                        ])\r\n                    ])\r\n                ])\r\n            ]);\r\n    }\r\n\r\n    function getPolarListView(ctl, rset){\r\n      let results = (rset || []).map((p) => {\r\n        return getPolarListItem(ctl, p);\r\n      });\r\n      return m(\"ul\", { rid: 'resultList', onscroll: ctl.onscroll, class: \"list-results-overflow\" }, results);\r\n    }\r\n\r\n    let defaultHeaderMap = [\r\n        \"_rowNum\",\r\n        \"_icon\",\r\n        \"id\",\r\n        \"name\",\r\n        \"modifiedDate\",\r\n        \"age\",\r\n        \"gender\",\r\n        /// Need to correctly plan out embedded fields\r\n        //\"userCharacter.name\",\r\n        // \"_thumbnail\",\r\n        \"_tags\",\r\n        \"_favorite\"\r\n    ];\r\n    \r\n    function getHeaders(type, map){\r\n        return (map || defaultHeaderMap).filter((h) => am7model.hasField(type, h) || h.match(/^_/));\r\n    }\r\n\r\n    function getHeadersView(ctl, map){\r\n        let type = ctl.listType;\r\n        let mod = am7model.getModel(type);\r\n        let pages = ctl.pagination.pages();\r\n        let headers = getHeaders(type, map).map((h) => {\r\n            \r\n            let fld = am7model.getModelField(type, h);\r\n            let lbl = fld?.label || h;\r\n            if(h.match(/^_/)){\r\n                lbl = \"\";\r\n                if(h == \"_tags\"){\r\n                    lbl = \"Tags\";\r\n                }\r\n            }\r\n            let ico = \"\";\r\n            if (h == \"_icon\" && mod.icon) {\r\n                ico = m(\"span\", { class: \"material-icons-cm material-symbols-outlined\" }, mod.icon);\r\n            }\r\n            else if(h == \"_rowNum\"){\r\n                \r\n                function selectHandler(){\r\n                    let pages = ctl.pagination.pages();\r\n                    pages.pageResults[pages.currentPage].forEach((v) => {\r\n                        pages.pageState[v.objectId] = {checked:true};\r\n                    });\r\n                }\r\n                ico = m(\"span\", { onclick: selectHandler, class: \"material-icons-cm material-symbols-outlined\" }, \"tag\");\r\n            }\r\n            let cw = getCellStyle(ctl, h);\r\n            let sortButton = \"\";\r\n            //if(pages.sort == h){\r\n            if(!h.match(/^_/)){\r\n                let sico = \"swap_vert\";\r\n                let icoCls = \"text-red-200\";\r\n                if(pages.sort == h){\r\n                    sico = (pages.order == \"ascending\" ? \"arrow_upward\" : \"arrow_downward\");\r\n                    icoCls = \"text-blue-700\";\r\n                }\r\n                sortButton = m(\"span\", { class: \"mr-2 material-icons-cm material-symbols-outlined \" + icoCls, onclick: function(){\r\n                    if(pages.sort == h){\r\n                        pages.order = (pages.order == \"ascending\" ? \"descending\" : \"ascending\");\r\n                    }\r\n                    else{\r\n                        pages.sort = h;\r\n                        pages.order = \"ascending\";\r\n                    }\r\n                }}, sico);\r\n            }\r\n            return m(\"th\", {class: cw}, [ico, sortButton, lbl]);\r\n        });\r\n        return m(\"thead\", m(\"tr\", {class: \"tabular-header\"}, headers));\r\n    }\r\n\r\n    function getTabularRow(ctl, p, idx, map) {\r\n        let isFavcls = getFavoriteStyle(p);\r\n        let dcls = page.components.dnd.doDragDecorate(p);\r\n        let cls = \"tabular-row\";\r\n        if(ctl.pagination.state(p).checked){\r\n            cls += \" tabular-row-active\";\r\n        }\r\n        if (dcls) cls += \" \" + dcls;\r\n        let props = Object.assign(page.components.dnd.dragProps(p), {\r\n            class: cls,\r\n            onselectstart: function () { return false; },\r\n            ondblclick: function () { if (ctl.containerMode) ctl.down(p); else ctl.open(p); },\r\n            onclick: function () { ctl.select(p) }\r\n        });\r\n        let attr = \"[draggable]\";\r\n        return m(\"tr\" + attr, props, getHeaders(ctl.listType, map).map((h) => {\r\n            let cw = getCellStyle(ctl, h);\r\n            if(h == \"_thumbnail\") {\r\n                return m(\"td\", { class: {class: cw}, }, [getThumbnail(ctl, p)]);\r\n            }\r\n            else if(h == \"_icon\") {\r\n                return m(\"td\", { class: cw}, [getIcon(p)]);\r\n            }\r\n            else if(h == \"_tags\"){\r\n                let rawTags = p.tags || [];\r\n                // Filter out null/undefined tags or tags without names\r\n                let allTags = rawTags.filter((t) => {\r\n                    if (!t || !t.name) {\r\n                        console.warn(\"Invalid tag found on object:\", p.objectId || p.id, \"tag:\", t);\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                let maxVisible = 3;\r\n                let visibleTags = allTags.slice(0, maxVisible);\r\n                let remainingCount = allTags.length - maxVisible;\r\n\r\n                let tagElements = visibleTags.map((t) => {\r\n                    return m(\"span\", { class: \"tag-pill\", title: t.name }, t.name);\r\n                });\r\n\r\n                if (remainingCount > 0) {\r\n                    tagElements.push(m(\"span\", {\r\n                        class: \"tag-pill tag-more\",\r\n                        title: allTags.slice(maxVisible).map(t => t.name).join(\", \")\r\n                    }, \"+\" + remainingCount));\r\n                }\r\n\r\n                return m(\"td\", { class: cw + \" tags-cell\" }, tagElements);\r\n            }\r\n            else if(h == \"_favorite\"){\r\n                return m(\"td\", {class: cw},  m(\"span\", {\r\n                    class: \"cursor-pointer material-symbols-outlined\" + isFavcls, onclick: function (e) {\r\n                        e.preventDefault();\r\n                        page.favorite(p).then((b) => {\r\n                            m.redraw();\r\n                        });\r\n                        return false;\r\n                    }\r\n                }, \"favorite\"));\r\n            }\r\n            else if(h == \"_rowNum\"){\r\n                return m(\"td\", {class: cw}, (parseInt(ctl.pagination.pages().startRecord) + 1) + idx);\r\n            };\r\n            \r\n\r\n            return m(\"td\",{class: cw}, getFormattedValue(ctl, p, h));\r\n        }));\r\n    \r\n    }\r\n    \r\n    function getCellStyle(ctl, h){\r\n        let w = \"\";\r\n        if(h == \"_icon\" || h == \"id\" || h == \"_rowNum\"){\r\n            w = \"w-14\";\r\n        }\r\n        else if(h == \"_favorite\"){\r\n            w = \"w-12\"\r\n        }\r\n\r\n        if(h == \"id\" || h == \"_rowNum\"){\r\n            w += \" align-right\";\r\n        }\r\n        else{\r\n            w += \" align-center\";\r\n        }\r\n        return w;\r\n    }\r\n\r\n    function getFormattedValue(ctl, p, h){\r\n        if(h.match(/^_/)){\r\n            console.warn(\"Unhandled special column: \" + h);\r\n            return \"\";\r\n        }\r\n        let ah = h.split(\".\");\r\n        let lastFld;\r\n        let val;\r\n        let om = p;\r\n        for(let i = 0; i < ah.length; i++){\r\n            let um;\r\n            if(lastFld){\r\n                um = am7model.getModelField(lastFld.baseModel, ah[i]);\r\n            }\r\n            else{\r\n                um = am7model.getModelField(p[am7model.jsonModelKey], ah[i]);\r\n            }\r\n\r\n            if(!um){\r\n                console.warn(\"Couldn't find field\", ah[i]);\r\n                return;\r\n            }\r\n\r\n            if(um.type == \"timestamp\"){\r\n                //  { weekday: 'short', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric' }\r\n                val = (om[um.name] ? \" \" + (new Date(om[um.name])).toLocaleDateString(\"en-US\", {year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric' }) : \"\");\r\n            }\r\n\r\n            else if(um.type == \"model\"){\r\n                if(!om[um.name]){\r\n                    console.warn(\"Couldn't find model for field\", um.name, \"in\", p);\r\n                    return \"\";\r\n                }\r\n                lastFld = um;\r\n                om = om[um.name];\r\n            }\r\n            else{\r\n                val = om[um.name];\r\n            }\r\n\r\n        }\r\n        return val;\r\n    }\r\n\r\n    function getTabularView(ctl, rset){\r\n        let results = (rset || []).map((p, i) => {\r\n          return getTabularRow(ctl, p, i);\r\n        });\r\n        if(results.length == 0){\r\n            return \"\";\r\n        }\r\n\r\n        let table = m(\"table\", { class: \"tabular-results-table\" }, [ getHeadersView(ctl), m(\"tbody\", results)]);\r\n\r\n\r\n        return m(\"div\", { rid: 'resultList', onscroll: ctl.onscroll, class: \"tabular-results-overflow\" },\r\n            table\r\n        );\r\n      }\r\n\r\n    function getGridListItem(ctl, p) {\r\n        let type = am7model.getModel(p[am7model.jsonModelKey]);\r\n        let ico = \"question_mark\";\r\n        let gridMode = ctl.gridMode;\r\n        let showInfo = ctl.info;\r\n        if (type && type.icon) ico = type.icon;\r\n        let icon = getThumbnail(ctl, p);\r\n\r\n        let cls = (gridMode == 1 ? \"image-grid-item-tile\" : \"image-grid-item-1\");\r\n        if (ctl.pagination.state(p).checked) {\r\n          cls += \" image-grid-item-active\";\r\n        }\r\n        let title = \"\";\r\n        let footer = \"\";\r\n        if (showInfo) {\r\n          title = m(\"p\", { class: \"card-title\" }, p.name);\r\n          if (ctl.showIconFooter) footer = m(\"p\", { class: \"card-footer\" }, 'footer');\r\n        }\r\n\r\n        let gridCellCls = \"image-grid-item-content-32\";\r\n        if (gridMode == 2) gridCellCls = \"image-grid-item-1\";\r\n        let attr = \"\";\r\n        let props = Object.assign(page.components.dnd.dragProps(p),{\r\n          ondblclick: function () {\r\n            if (ctl.containerMode) ctl.down(p);\r\n            else ctl.open(p);\r\n          },\r\n          onclick: function () {\r\n            ctl.select(p);\r\n          },\r\n          class: cls\r\n        });\r\n        attr = \"[draggable]\";\r\n\r\n        return m(\"div\" + attr, props, [title, m(\"div\", { class: gridCellCls }, icon), footer]);\r\n    }\r\n\r\n    function displayIndicators(ctl) {\r\n        let results = [];\r\n        let pages = ctl.pagination.pages();\r\n        if (pages.pageResults[pages.currentPage]) results = pages.pageResults[pages.currentPage].map((p, i) => {\r\n          let cls = \"material-symbols-outlined carousel-bullet\";\r\n          let ico = \"radio_button_unchecked\";\r\n          if (i == pages.currentItem) {\r\n            cls += \" carousel-bullet-active\";\r\n            ico = \"radio_button_checked\";\r\n          }\r\n          return m(\"li\", { onclick: function () { ctl.moveTo(i); }, class: \"carousel-indicator\" }, [\r\n            m(\"span\", { class: cls }, ico)\r\n          ]);\r\n        });\r\n  \r\n        return m(\"ul\", { class: \"carousel-indicators\" }, [\r\n          m(\"li\", { onclick: function () { ctl.pagination.prev(ctl.embeddedMode || ctl.pickerMode); }, class: \"carousel-indicator\" }, [\r\n            m(\"span\", { class: \"material-symbols-outlined carousel-bullet\" }, \"arrow_back\")\r\n          ]),\r\n          results,\r\n          m(\"li\", { onclick: function () { ctl.pagination.next(ctl.embeddedMode || ctl.pickerMode); }, class: \"carousel-indicator\" }, [\r\n            m(\"span\", { class: \"material-symbols-outlined carousel-bullet\" }, \"arrow_forward\")\r\n          ])\r\n        ]);\r\n      }\r\n\r\n      function displayObjects(ctl) {\r\n  \r\n        let results = [];\r\n        let pages = ctl.pagination.pages();\r\n        let pr = pages.pageResults[pages.currentPage];\r\n        /// let cls = 'carousel-item carousel-item-abs';\r\n        if (pr) {\r\n          results = pr.map((p, i) => {\r\n            return m(page.components.object, { view: ctl.listPage, app:undefined, object: p, model: ctl.listType, active: (pages.currentItem == i), maxMode: ctl.maxMode, inner: true });\r\n          });\r\n        }\r\n        return results;\r\n  \r\n      }\r\n\r\n    function getGridListView(ctl) {\r\n        let results = [];\r\n        let gridMode = ctl.gridMode;\r\n        let pages = ctl.pagination.pages();\r\n        if (pages.pageResults[pages.currentPage]) results = pages.pageResults[pages.currentPage].map((p, i) => {\r\n         return getGridListItem(ctl, p);\r\n        });\r\n  \r\n        return m(\"div\", { class: 'h-full overflow-hidden' }, m(\"div\", { class: (gridMode == 1 ? 'image-grid-tile' : 'image-grid-5') }, results));\r\n    }\r\n    function getCarouselItem(ctl) {\r\n        let pages = ctl.pagination.pages();\r\n        let pr = ctl.results();\r\n        let uimarkers = [];\r\n        if (!ctl.embeddedMode || ctl.fullMode) {\r\n            uimarkers = [\r\n            m(\"span\", { onclick: ctl.toggleCarouselFull, class: \"carousel-full\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, (ctl.fullMode ? \"close_fullscreen\" : \"open_in_new\"))]),\r\n            m(\"span\", { onclick: ctl.toggleCarouselMax, class: \"carousel-max\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, (ctl.maxMode ? \"photo_size_select_small\" : \"aspect_ratio\"))]),\r\n            m(\"span\", { onclick: ctl.toggleInfo, class: \"carousel-info\" }, [m(\"span\", { class: \"material-symbols-outlined\" + (ctl.info ? \"\" : \"-outlined\") }, (ctl.info ? \"info\" : \"info\"))]),\r\n            m(\"span\", { onclick: function () { ctl.edit(pr[pages.currentItem]); }, class: \"carousel-edit\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"edit\")]),\r\n            m(\"span\", { onclick: ctl.toggleCarousel, class: \"carousel-exit\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"close\")]),\r\n            m(\"span\", { onclick: function () { ctl.move(-1); }, class: \"carousel-prev\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_back\")]),\r\n            m(\"span\", { onclick: function () { ctl.move(1); }, class: \"carousel-next\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_forward\")]),\r\n            ];\r\n        }\r\n        return m(\"div\", { class: \"carousel\" }, [\r\n            m(\"div\", { class: \"carousel-inner\" },\r\n            [\r\n                displayObjects(ctl),\r\n                uimarkers,\r\n                displayIndicators(ctl)\r\n            ]\r\n            )\r\n        ]);\r\n\r\n    }\r\n\r\n    function getCarouselView(ctl) {\r\n\r\n        /// set the current item value to the end of the array when paginating back while in carousel mode\r\n        // console.log(\"Current item: \" + pages.currentItem + \" / \" + pagination.requesting);\r\n        return m(\"div\", { class: \"content-outer\" }, [(ctl.fullMode ? \"\" : m(page.components.navigation)),\r\n        m(\"div\", { class: \"content-main\" }, [\r\n          getCarouselItem(ctl)\r\n        ])\r\n        ]);\r\n      }\r\n    \r\n\r\n    let am7dec = {\r\n        map: () => defaultHeaderMap,\r\n        icon: getIcon,\r\n        fileIcon: getFileTypeIcon,\r\n        tabularView: getTabularView,\r\n        polarListItem: getPolarListItem,\r\n        polarListView: getPolarListView,\r\n        gridListView: getGridListView,\r\n        gridListItem: getGridListItem,\r\n        carouselView: getCarouselView,\r\n        carouselItem: getCarouselItem\r\n    };\r\n\r\n    if (typeof module != \"undefined\") {\r\n        module.am7decorator = am7dec;\r\n    } else {\r\n        window.am7decorator = am7dec;\r\n    }\r\n}());\n\n;/* === client/chat.js === */\n(function () {\r\n\r\n    async function deleteChat(s, force, fHandler) {\r\n        async function chatHandler() {\r\n            if (s.session) {\r\n            let q = am7client.newQuery(s.sessionType);\r\n            q.field(\"id\", s.session.id);\r\n            try {\r\n                let qr = await page.search(q);\r\n                if (qr && qr.results && qr.results.length > 0) {\r\n                page.toast(\"info\", \"Deleting session data - \" + qr.results[0].objectId);\r\n                await page.deleteObject(s.sessionType, qr.results[0].objectId);\r\n                }\r\n                else {\r\n                page.toast(\"error\", \"Failed to find session data to delete\", 5000);\r\n                console.error(\"Failed to delete session data\", qr);\r\n                }\r\n            }\r\n            catch (e) {\r\n                page.toast(\"error\", \"Error deleting session data\", 5000);\r\n                console.error(\"Error deleting session data\", e);\r\n            }\r\n\r\n            }\r\n            else {\r\n            console.warn(\"No session data found\");\r\n            }\r\n            // console.log(\"Deleting request\", s.objectId);\r\n            await page.deleteObject(s[am7model.jsonModelKey], s.objectId);\r\n            if (fHandler) fHandler(s);\r\n        }\r\n        if(!force){\r\n            page.components.dialog.confirm(\"Delete chat \" + s + \"?\", chatHandler);\r\n        }\r\n        else{\r\n            chatHandler();\r\n        }\r\n    }\r\n\r\n\r\n    async function getChatRequest(requestName, chatCfg, promptCfg) {\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"~/ChatRequests\");\r\n        let q = am7view.viewQuery(am7model.newInstance(\"olio.llm.chatRequest\", am7model.forms.chatRequest));\r\n        q.field(\"groupId\", grp.id);\r\n        q.field(\"name\", requestName);\r\n        q.cache(false);\r\n        q.entity.request.push(\"session\", \"sessionType\", \"chatConfig\", \"promptConfig\", \"objectId\");\r\n        let req;\r\n        let qr = await page.search(q);\r\n        if (!qr || !qr.results || qr.results.length == 0) {\r\n            let chatReq = {\r\n                schema: \"olio.llm.chatRequest\",\r\n                name: requestName,\r\n                chatConfig: { objectId: chatCfg.objectId },\r\n                promptConfig: { objectId: promptCfg.objectId },\r\n                uid: page.uid()\r\n            };\r\n\r\n            req = await m.request({ method: 'POST', url: g_application_path + \"/rest/chat/new\", withCredentials: true, body: chatReq });\r\n        }\r\n        else if (qr && qr.results && qr.results.length > 0) {\r\n            req = qr.results[0];\r\n        }\r\n        console.log(req);\r\n\r\n        return req;\r\n\r\n    }\r\n\r\n    async function makeChat(sName, sModel, sServerUrl, sServiceType){\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"~/Chat\");\r\n        let q = am7view.viewQuery(am7model.newInstance(\"olio.llm.chatConfig\"));\r\n        q.field(\"groupId\", grp.id);\r\n        q.field(\"name\", sName);\r\n        q.cache(false);\r\n        let cfg;\r\n        let qr = await page.search(q);\r\n        if(!qr || !qr.results || qr.results.length == 0){\r\n            let icfg = am7model.newInstance(\"olio.llm.chatConfig\");\r\n            icfg.api.groupId(grp.id);\r\n            icfg.api.groupPath(grp.path);\r\n            icfg.api.name(sName);\r\n            icfg.api.model(sModel);\r\n            icfg.api.messageTrim(6);\r\n            icfg.api.serverUrl(sServerUrl);\r\n            icfg.api.serviceType(sServiceType);\r\n            await page.createObject(icfg.entity);\r\n            qr = await page.search(q);\r\n        }\r\n        if(qr?.results.length > 0){\r\n            cfg = qr.results[0];\r\n        }\r\n\r\n        if(!cfg){\r\n            page.toast(\"Error\", \"Could not create chat config\");\r\n        }\r\n\r\n        return cfg;\r\n    }\r\n\r\n    async function makePrompt(sName, aSystem){\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"~/Chat\");\r\n        let q = am7view.viewQuery(am7model.newInstance(\"olio.llm.promptConfig\"));\r\n        q.field(\"groupId\", grp.id);\r\n        q.field(\"name\", sName);\r\n        q.cache(false);\r\n        let cfg;\r\n        let qr = await page.search(q);\r\n        if(!qr || !qr.results || qr.results.length == 0){\r\n            let icfg = am7model.newInstance(\"olio.llm.promptConfig\");\r\n            icfg.api.groupId(grp.id);\r\n            icfg.api.groupPath(grp.path);\r\n            icfg.api.name(sName);\r\n            icfg.entity.system = aSystem;\r\n            await page.createObject(icfg.entity);\r\n            qr = await page.search(q);\r\n        }\r\n        if(qr?.results.length > 0){\r\n            cfg = qr.results[0];\r\n        }\r\n\r\n        if(!cfg){\r\n            page.toast(\"Error\", \"Could not create prompt config\");\r\n        }\r\n\r\n        return cfg;\r\n    }\r\n\r\n    async function chat(chat, msg) {\r\n        if (!chat) {\r\n            page.toast(\"error\", \"Chat request is not defined.\");\r\n            return;\r\n        }\r\n        if (!chat.chatConfig || !chat.promptConfig) {\r\n            page.toast(\"error\", \"Chat request is missing the prompt or chat config.\");\r\n            return;\r\n        }\r\n        chat.message = msg;\r\n        chat.uid = page.uid();\r\n        //console.log(chat);\r\n        return await m.request({ method: 'POST', url: g_application_path + \"/rest/chat/text\", withCredentials: true, body: chat });\r\n    }\r\n\r\n    let am7chat = {\r\n        makePrompt,\r\n        makeChat,\r\n        getChatRequest,\r\n        deleteChat,\r\n        chat\r\n    };\r\n\r\n    if (typeof module != \"undefined\") {\r\n        module.am7chat = am7chat;\r\n    } else {\r\n        window.am7chat = am7chat;\r\n    }\r\n}());\n\n;/* === client/view/cardGame.js === */\n// Card Game Interface\r\n// Character cards, card stacks, and deck management\r\n\r\n(function(){\r\n    // Configuration\r\n    let gridPath = \"/Olio/Universes/My Grid Universe/Worlds/My Grid World\";\r\n\r\n    // State\r\n    let deck = [];           // Draw pile - cards to draw from\r\n    let userHand = [];       // User's hand - limited to 1 character\r\n    let gameHand = [];       // Game/AI hand - can have multiple characters\r\n    let discard = [];        // Discard pile - cards that have been discarded\r\n    let selectedCard = null; // Currently selected card for detail view\r\n    let previewCard = null;  // Card being previewed in deck (not drawn)\r\n    let cardView = 'profile'; // profile, stats, traits, narrative, instincts, apparel\r\n    let isLoading = false;\r\n    let fullMode = false;\r\n    let previewIndex = 0;    // Current index in deck for preview/flip through\r\n\r\n    // Game rules\r\n    const USER_HAND_LIMIT = 1;   // User can only have 1 character\r\n    const GAME_HAND_LIMIT = 3;   // Game can have up to 3 characters\r\n\r\n    // Drag state\r\n    let draggedCard = null;\r\n    let dragSource = null;   // 'deck', 'userHand', 'gameHand', 'discard'\r\n    let dropTarget = null;   // 'userHand', 'gameHand', 'discard', 'selected'\r\n\r\n    // Action deck state\r\n    let actionDeck = [];        // Action cards available to draw\r\n    let actionHand = [];        // User's action cards in hand (not yet played)\r\n    let actionHandIndex = 0;    // Index of currently viewed card in action hand\r\n    let systemActionHand = [];  // System's action cards in hand\r\n    let systemActionHandIndex = 0; // Index for system's action hand\r\n    let playedActions = [];     // User's played actions (interaction objects)\r\n    let systemPlayedActions = []; // System's played actions (interaction objects)\r\n    let actionDiscard = [];     // Discarded action cards\r\n    let actionPreview = null;   // Preview card in action deck\r\n    let actionPreviewIndex = 0; // Current preview index\r\n    let selectedAction = null;  // Currently selected action for execution\r\n    let pendingInteraction = null; // Interaction being set up\r\n\r\n    // Item deck state\r\n    let itemDeck = [];          // Item cards available to draw\r\n    let itemHand = [];          // User's items in hand (drawn but not played to tray)\r\n    let itemTray = [];          // User's items played to tray\r\n    let systemItems = [];       // System's items in hand\r\n    let systemItemHandIndex = 0; // Index for system's item hand\r\n    let itemDiscard = [];       // Discarded items\r\n    let itemPreviewIndex = 0;   // Current preview index in deck\r\n    let itemHandIndex = 0;      // Current preview index in hand\r\n\r\n    // Apparel deck state\r\n    let apparelDeck = [];       // Apparel cards available to draw\r\n    let apparelHand = [];       // User's apparel in hand (drawn but not played to tray)\r\n    let apparelTray = [];       // User's apparel played to tray\r\n    let systemApparel = [];     // System's apparel in hand\r\n    let systemApparelHandIndex = 0; // Index for system's apparel hand\r\n    let apparelDiscard = [];    // Discarded apparel\r\n    let apparelPreviewIndex = 0; // Current preview index in deck\r\n    let apparelHandIndex = 0;   // Current preview index in hand\r\n\r\n    // Selected card for detail view (can be action, item, or apparel)\r\n    let selectedDetailCard = null;  // The card being viewed in detail\r\n    let selectedDetailType = null;  // 'action', 'item', or 'apparel'\r\n\r\n    // Fully loaded narrative for the selected character\r\n    let loadedNarrative = null;     // Full narrative object loaded from server\r\n    let loadedNarrativeCharId = null; // objectId of character whose narrative is loaded\r\n    let narrativeLoading = false;   // Loading state for narrative\r\n\r\n    // Active pile selection for consolidated view\r\n    let activePile = 'character'; // 'character', 'action', 'item', 'apparel'\r\n\r\n    // Action card types (these become cards in the action deck)\r\n    // Each action appears twice in the deck\r\n    const ACTION_CARD_TYPES = [\r\n        {type: \"TALK\", label: \"Talk\", icon: \"forum\", description: \"Have a conversation\"},\r\n        {type: \"BEFRIEND\", label: \"Befriend\", icon: \"handshake\", description: \"Attempt to make a friend\"},\r\n        {type: \"BARTER\", label: \"Trade\", icon: \"swap_horiz\", description: \"Exchange goods or services\"},\r\n        {type: \"COMBAT\", label: \"Fight\", icon: \"swords\", description: \"Engage in combat\"},\r\n        {type: \"DEFEND\", label: \"Defend\", icon: \"shield\", description: \"Take a defensive stance\"},\r\n        {type: \"HELP\", label: \"Help\", icon: \"volunteer_activism\", description: \"Offer assistance\"},\r\n        {type: \"COOPERATE\", label: \"Cooperate\", icon: \"group_work\", description: \"Work together on a task\"},\r\n        {type: \"COMPETE\", label: \"Compete\", icon: \"trophy\", description: \"Challenge to a contest\"},\r\n        {type: \"INVESTIGATE\", label: \"Investigate\", icon: \"search\", description: \"Examine or question\"},\r\n        {type: \"ENTERTAIN\", label: \"Entertain\", icon: \"theater_comedy\", description: \"Provide amusement\"},\r\n        {type: \"COERCE\", label: \"Coerce\", icon: \"gavel\", description: \"Force compliance\"},\r\n        {type: \"THREATEN\", label: \"Threaten\", icon: \"warning\", description: \"Make a threat\"},\r\n        {type: \"ROMANCE\", label: \"Romance\", icon: \"favorite\", description: \"Show romantic interest\"},\r\n        {type: \"SOCIALIZE\", label: \"Socialize\", icon: \"groups\", description: \"General social interaction\"},\r\n        {type: \"MENTOR\", label: \"Mentor\", icon: \"school\", description: \"Teach or guide\"},\r\n        {type: \"NEGOTIATE\", label: \"Negotiate\", icon: \"balance\", description: \"Reach an agreement\"}\r\n    ];\r\n\r\n    // Chat dialog state\r\n    let chatDialogOpen = false;\r\n    let chatSession = null;      // Current chat request\r\n    let chatMessages = [];       // Chat message history\r\n    let chatPending = false;     // Waiting for response\r\n    let chatActor = null;        // User's character\r\n    let chatTarget = null;       // Target character\r\n\r\n    // Save game state\r\n    let currentSave = null;      // Current save game object\r\n    let savedGames = [];         // List of available saves\r\n    let saveDialogOpen = false;  // Save dialog visibility\r\n    let saveDialogMode = 'list'; // 'list', 'save', 'new'\r\n    let newSaveName = '';        // Name for new save\r\n\r\n    // Tag filter state\r\n    let activeTags = [];         // Active tags to filter characters by (e.g., [\"nude\"])\r\n\r\n    // Card dimensions (3x5 aspect ratio)\r\n    const CARD_WIDTH = 240;\r\n    const CARD_HEIGHT = 400;\r\n\r\n    // ==========================================\r\n    // Utility Functions\r\n    // ==========================================\r\n\r\n    function getAge(char) {\r\n        if (!char) return \"?\";\r\n        // Use age property directly (game date is event-based, not real time)\r\n        return char.age !== undefined && char.age !== null ? char.age : \"?\";\r\n    }\r\n\r\n    // Get display name for apparel (uses name directly)\r\n    function getApparelDisplayName(apparel) {\r\n        if (!apparel) return \"Apparel\";\r\n        return apparel.name || apparel.type || apparel.category || \"Apparel\";\r\n    }\r\n\r\n    function getPortraitUrl(char, size) {\r\n        if (!char || !char.profile || !char.profile.portrait) return null;\r\n        let pp = char.profile.portrait;\r\n        if (!pp.groupPath || !pp.name) return null;\r\n        return g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) +\r\n               \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/\" + (size || \"256x256\");\r\n    }\r\n\r\n    function shuffleArray(array) {\r\n        let shuffled = [...array];\r\n        for (let i = shuffled.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\r\n        }\r\n        return shuffled;\r\n    }\r\n\r\n    function formatStatValue(val) {\r\n        if (val === undefined || val === null) return \"-\";\r\n        return val;\r\n    }\r\n\r\n    function getStatColor(val, max) {\r\n        if (val === undefined || val === null) return \"bg-gray-300\";\r\n        let pct = (val / max) * 100;\r\n        if (pct >= 80) return \"bg-green-500\";\r\n        if (pct >= 60) return \"bg-blue-500\";\r\n        if (pct >= 40) return \"bg-yellow-500\";\r\n        if (pct >= 20) return \"bg-orange-500\";\r\n        return \"bg-red-500\";\r\n    }\r\n\r\n    function getInstinctColor(val) {\r\n        if (val === undefined || val === null) return \"bg-gray-300\";\r\n        if (val > 50) return \"bg-red-500\";\r\n        if (val > 20) return \"bg-orange-400\";\r\n        if (val > -20) return \"bg-gray-400\";\r\n        if (val > -50) return \"bg-blue-400\";\r\n        return \"bg-blue-600\";\r\n    }\r\n\r\n    // ==========================================\r\n    // Data Loading\r\n    // ==========================================\r\n\r\n    async function loadCharacters() {\r\n        if (isLoading) return;\r\n        isLoading = true;\r\n\r\n        try {\r\n            let popDir = await page.findObject(\"auth.group\", \"data\", gridPath + \"/Population\");\r\n            if (!popDir) {\r\n                page.toast(\"error\", \"Population directory not found\");\r\n                isLoading = false;\r\n                return;\r\n            }\r\n\r\n            let q = am7view.viewQuery(\"olio.charPerson\");\r\n            q.field(\"groupId\", popDir.id);\r\n            q.range(0, 50);\r\n            // Request basic fields needed for card backs\r\n            q.entity.request.push(\"profile\", \"name\", \"gender\", \"objectId\", \"tags\");\r\n\r\n            // Apply tag filters if any are active\r\n            if (activeTags.length > 0) {\r\n                activeTags.forEach(function(tag) {\r\n                    q.field(\"tags.name\", tag);\r\n                });\r\n            }\r\n\r\n            let qr = await page.search(q);\r\n            if (qr && qr.results) {\r\n                deck = qr.results;\r\n                userHand = [];\r\n                gameHand = [];\r\n                discard = [];\r\n                previewIndex = 0;\r\n                selectedCard = null;\r\n                previewCard = null;\r\n                let tagMsg = activeTags.length > 0 ? \" (filtered by: \" + activeTags.join(\", \") + \")\" : \"\";\r\n                page.toast(\"success\", \"Loaded \" + deck.length + \" characters into deck\" + tagMsg);\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load characters\", e);\r\n            page.toast(\"error\", \"Failed to load characters\");\r\n        }\r\n\r\n        isLoading = false;\r\n        m.redraw();\r\n    }\r\n\r\n    async function loadFullCharacter(char) {\r\n        if (!char || !char.objectId) {\r\n            console.warn(\"loadFullCharacter: invalid char or missing objectId\", char);\r\n            return char;\r\n        }\r\n        try {\r\n            let q = am7view.viewQuery(\"olio.charPerson\");\r\n            q.field(\"objectId\", char.objectId);\r\n            // Request narrative and other needed fields including objectId\r\n            q.entity.request.push(\"objectId\", \"narrative\", \"statistics\", \"store\", \"instinct\", \"personality\");\r\n            let qr = await page.search(q);\r\n            if (qr && qr.results && qr.results.length > 0) {\r\n                let full = qr.results[0];\r\n                am7model.applyModelNames(full);\r\n\r\n                // Load nested statistics model reference if it exists but isn't fully loaded\r\n                if (full.statistics && full.statistics.objectId && !full.statistics.physicalStrength) {\r\n                    let sq = am7view.viewQuery(\"olio.statistics\");\r\n                    sq.field(\"objectId\", full.statistics.objectId);\r\n                    let sqr = await page.search(sq);\r\n                    if (sqr && sqr.results && sqr.results.length > 0) {\r\n                        full.statistics = sqr.results[0];\r\n                    }\r\n                }\r\n\r\n                return full;\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load full character\", e);\r\n        }\r\n        return char;\r\n    }\r\n\r\n    // Load a character's store (items and apparel) and return them\r\n    async function loadCharacterStore(char) {\r\n        let result = { items: [], apparel: [] };\r\n        if (!char || !char.store || !char.store.objectId) {\r\n            return result;\r\n        }\r\n\r\n        try {\r\n            // Load the full store object with items and apparel lists\r\n            let sq = am7view.viewQuery(\"olio.store\");\r\n            sq.field(\"objectId\", char.store.objectId);\r\n            sq.entity.request.push(\"items\", \"apparel\", \"inventory\");\r\n            let sqr = await page.search(sq);\r\n\r\n            if (sqr && sqr.results && sqr.results.length > 0) {\r\n                let store = sqr.results[0];\r\n\r\n                // Load full item data for each item in store\r\n                if (store.items && store.items.length > 0) {\r\n                    for (let itemRef of store.items) {\r\n                        if (itemRef && itemRef.id) {\r\n                            let iq = am7view.viewQuery(\"olio.item\");\r\n                            iq.field(\"id\", itemRef.id);\r\n                            // Explicitly request display fields including statistics and objectId\r\n                            iq.entity.request.push(\"objectId\", \"name\", \"description\", \"category\", \"statistics\", \"qualities\");\r\n                            let iqr = await page.search(iq);\r\n                            if (iqr && iqr.results && iqr.results.length > 0) {\r\n                                let item = iqr.results[0];\r\n                                // Load nested statistics if present\r\n                                if (item.statistics && item.statistics.id && !item.statistics.damage) {\r\n                                    let sq = am7view.viewQuery(\"olio.itemStatistics\");\r\n                                    sq.field(\"id\", item.statistics.id);\r\n                                    let sqr = await page.search(sq);\r\n                                    if (sqr && sqr.results && sqr.results.length > 0) {\r\n                                        item.statistics = sqr.results[0];\r\n                                    }\r\n                                }\r\n                                result.items.push(item);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Load full apparel data for each apparel in store\r\n                if (store.apparel && store.apparel.length > 0) {\r\n                    for (let apparelRef of store.apparel) {\r\n                        if (apparelRef && apparelRef.id) {\r\n                            let aq = am7view.viewQuery(\"olio.apparel\");\r\n                            aq.field(\"id\", apparelRef.id);\r\n                            aq.entity.request.push(\"objectId\", \"name\", \"type\", \"category\", \"description\", \"wearables\");\r\n                            let aqr = await page.search(aq);\r\n                            if (aqr && aqr.results && aqr.results.length > 0) {\r\n                                let apparel = aqr.results[0];\r\n                                result.apparel.push(apparel);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load character store:\", e);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    async function loadItems() {\r\n        try {\r\n            let itemDir = await page.findObject(\"auth.group\", \"data\", gridPath + \"/Items\");\r\n            if (!itemDir) {\r\n                return;\r\n            }\r\n\r\n            let q = am7view.viewQuery(\"olio.item\");\r\n            q.field(\"groupId\", itemDir.id);\r\n            q.range(0, 100);\r\n            q.entity.request.push(\"name\", \"type\", \"category\", \"objectId\", \"description\", \"statistics\");\r\n\r\n            let qr = await page.search(q);\r\n            if (qr && qr.results) {\r\n                itemDeck = qr.results;\r\n                itemHand = [];\r\n                itemDiscard = [];\r\n                itemPreviewIndex = 0;\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load items\", e);\r\n        }\r\n    }\r\n\r\n    async function loadApparel() {\r\n        try {\r\n            let apparelDir = await page.findObject(\"auth.group\", \"data\", gridPath + \"/Apparel\");\r\n            if (!apparelDir) {\r\n                return;\r\n            }\r\n\r\n            let q = am7view.viewQuery(\"olio.apparel\");\r\n            q.field(\"groupId\", apparelDir.id);\r\n            q.range(0, 100);\r\n            q.entity.request.push(\"name\", \"type\", \"category\", \"objectId\", \"description\", \"wearables\");\r\n\r\n            let qr = await page.search(q);\r\n            if (qr && qr.results) {\r\n                apparelDeck = qr.results;\r\n                apparelHand = [];\r\n                apparelDiscard = [];\r\n                apparelPreviewIndex = 0;\r\n\r\n                // Generate descriptions for apparel that don't have one\r\n                for (let app of apparelDeck) {\r\n                    if (!app.description && app.wearables && app.wearables.length > 0) {\r\n                        await generateApparelDescription(app);\r\n                    }\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load apparel\", e);\r\n        }\r\n    }\r\n\r\n    // Generate a description for apparel based on its wearables (like setApparelDescription in olio.js)\r\n    async function generateApparelDescription(app) {\r\n        try {\r\n            // Load full wearable data\r\n            let wearOids = app.wearables.map(w => w.objectId).join(\",\");\r\n            let wq = am7view.viewQuery(\"olio.wearable\");\r\n            wq.field(\"groupId\", app.wearables[0].groupId);\r\n            let fld = wq.field(\"objectId\", wearOids);\r\n            fld.comparator = \"in\";\r\n            wq.range(0, 50);\r\n            // Request the fields needed for description\r\n            wq.entity.request.push(\"name\", \"objectId\", \"inuse\", \"color\", \"fabric\", \"pattern\", \"location\", \"qualities\");\r\n\r\n            let wqr = await page.search(wq);\r\n            if (!wqr || !wqr.results || !wqr.results.length) {\r\n                return;\r\n            }\r\n\r\n            let wears = wqr.results;\r\n            // Filter to only wearables that are in use\r\n            let inuseWears = wears.filter(w => w.inuse);\r\n\r\n            if (inuseWears.length === 0) {\r\n                app.description = \"No apparel worn.\";\r\n            } else {\r\n                let wdesc = inuseWears.map(w => describeWearable(w)).join(\", \");\r\n                app.description = \"Worn apparel includes \" + wdesc + \".\";\r\n            }\r\n\r\n            // Persist the description using the same pattern as olio.js\r\n            await page.patchObject({\r\n                schema: \"olio.apparel\",\r\n                id: app.id,\r\n                description: app.description\r\n            });\r\n        } catch (e) {\r\n            console.error(\"Failed to generate apparel description\", e);\r\n        }\r\n    }\r\n\r\n    // Describe a single wearable (from olio.js)\r\n    function describeWearable(wear) {\r\n        let qual = wear.qualities ? wear.qualities[0] : null;\r\n        let opac = qual?.opacity || 0.0;\r\n        let shin = qual?.shininess || 0.0;\r\n        let col = wear?.color?.name?.toLowerCase() || \"\";\r\n\r\n        if (col) {\r\n            col = col.replaceAll(/([\\^\\(\\)]*)/g, \"\");\r\n        }\r\n        let fab = wear?.fabric?.toLowerCase() || \"\";\r\n        let pat = wear?.pattern?.name?.toLowerCase() || \"\";\r\n        let loc = wear?.location?.[0]?.toLowerCase() || \"\";\r\n        let name = wear?.name;\r\n        if (name && name.indexOf(\"pierc\") > -1) {\r\n            name = loc + \" piercing\";\r\n            pat = \"\";\r\n        }\r\n        let opacs = \"\";\r\n        if (opac > 0.0 && opac <= 0.25) {\r\n            opacs = \" see-through\";\r\n        }\r\n        let shins = \"\";\r\n        if (shin >= 0.7) {\r\n            shins = \" shiny\";\r\n        }\r\n\r\n        return (shins + opacs + \" \" + col + \" \" + pat + \" \" + fab + \" \" + name).replaceAll(\"  \", \" \").trim();\r\n    }\r\n\r\n    // ==========================================\r\n    // Character Card Component\r\n    // ==========================================\r\n\r\n    // Full card - shown when selected\r\n    function CharacterCard() {\r\n        return {\r\n            view: function(vnode) {\r\n                let char = vnode.attrs.character;\r\n                let isSelected = vnode.attrs.selected;\r\n                let onClick = vnode.attrs.onclick;\r\n\r\n                if (!char) return \"\";\r\n\r\n                let cardClass = \"cg-card-full \" + (isSelected ? \"cg-card-selected\" : \"cg-card-unselected\");\r\n\r\n                return m(\"div\", {\r\n                    class: cardClass,\r\n                    style: \"width: \" + CARD_WIDTH + \"px; height: \" + CARD_HEIGHT + \"px;\",\r\n                    onclick: onClick\r\n                }, [\r\n                    renderCardContent(char)\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    function renderCardContent(char) {\r\n        switch (cardView) {\r\n            case 'stats':\r\n                return renderStatsView(char);\r\n            case 'traits':\r\n                return renderTraitsView(char);\r\n            case 'narrative':\r\n                return renderNarrativeView(char);\r\n            case 'instincts':\r\n                return renderInstinctsView(char);\r\n            case 'apparel':\r\n                return renderApparelView(char);\r\n            default:\r\n                return renderProfileView(char);\r\n        }\r\n    }\r\n\r\n    function renderProfileView(char) {\r\n        let portraitUrl = getPortraitUrl(char, \"256x256\");\r\n        let age = getAge(char);\r\n        let alignment = char.alignment || \"Neutral\";\r\n        let trades = (char.trades || []).slice(0, 2).join(\", \") || \"None\";\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header with name\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title-truncate\"}, char.name || \"Unknown\"),\r\n                m(\"div\", {class: \"text-xs text-gray-600 dark:text-gray-400\"}, char.title || \"\")\r\n            ]),\r\n\r\n            // Portrait\r\n            m(\"div\", {class: \"cg-card-body\"}, [\r\n                portraitUrl ?\r\n                    m(\"div\", {class: \"relative max-h-full max-w-full\"}, [\r\n                        m(\"img\", {\r\n                            class: \"max-h-full max-w-full object-contain rounded shadow-md cursor-pointer hover:opacity-90\",\r\n                            src: portraitUrl,\r\n                            onclick: function(e) { e.stopPropagation(); openPortraitView(char); }\r\n                        }),\r\n                        // Reimage overlay button\r\n                        m(\"button\", {\r\n                            class: \"cg-portrait-overlay-btn\",\r\n                            onclick: function(e) { e.stopPropagation(); generatePortrait(); },\r\n                            title: \"Regenerate portrait\"\r\n                        }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"refresh\"))\r\n                    ]) :\r\n                    m(\"div\", {class: \"flex flex-col items-center\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-6xl text-gray-400 dark:text-gray-500 mb-2\"}, \"person\"),\r\n                        m(\"button\", {\r\n                            class: \"cg-btn-primary\",\r\n                            onclick: function(e) { e.stopPropagation(); generatePortrait(); }\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"add_photo_alternate\"),\r\n                            m(\"span\", {}, \"Generate Portrait\")\r\n                        ])\r\n                    ])\r\n            ]),\r\n\r\n            // Info section\r\n            m(\"div\", {class: \"p-2 bg-amber-100 dark:bg-gray-800 space-y-1\"}, [\r\n                m(\"div\", {class: \"flex justify-between text-sm\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Age:\"),\r\n                    m(\"span\", {class: \"text-gray-800 dark:text-gray-200\"}, age + \" years\")\r\n                ]),\r\n                m(\"div\", {class: \"flex justify-between text-sm\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Gender:\"),\r\n                    m(\"span\", {class: \"text-gray-800 dark:text-gray-200 capitalize\"}, char.gender || \"Unknown\")\r\n                ]),\r\n                m(\"div\", {class: \"flex justify-between text-sm\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Alignment:\"),\r\n                    m(\"span\", {class: \"text-gray-800 dark:text-gray-200\"}, alignment)\r\n                ]),\r\n                m(\"div\", {class: \"flex justify-between text-sm\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Trade:\"),\r\n                    m(\"span\", {class: \"text-gray-800 dark:text-gray-200 truncate ml-2\"}, trades)\r\n                ]),\r\n                // Appearance\r\n                char.eyeColor || char.hairColor ? m(\"div\", {class: \"cg-card-divider-alt\"}, [\r\n                    char.eyeColor ? m(\"span\", {}, (char.eyeColor.name || \"\") + \" eyes\") : \"\",\r\n                    char.eyeColor && char.hairColor ? \" / \" : \"\",\r\n                    char.hairColor ? m(\"span\", {}, (char.hairColor.name || \"\") + \" hair\") : \"\"\r\n                ]) : \"\"\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function renderStatsView(char) {\r\n        let stats = char.statistics || {};\r\n        let statFields = [\r\n            {name: \"physicalStrength\", label: \"STR\", icon: \"fitness_center\"},\r\n            {name: \"physicalEndurance\", label: \"END\", icon: \"favorite\"},\r\n            {name: \"agility\", label: \"AGI\", icon: \"directions_run\"},\r\n            {name: \"speed\", label: \"SPD\", icon: \"speed\"},\r\n            {name: \"manualDexterity\", label: \"DEX\", icon: \"touch_app\"},\r\n            {name: \"mentalStrength\", label: \"MEN\", icon: \"psychology\"},\r\n            {name: \"mentalEndurance\", label: \"WIL\", icon: \"self_improvement\"},\r\n            {name: \"intelligence\", label: \"INT\", icon: \"lightbulb\"},\r\n            {name: \"wisdom\", label: \"WIS\", icon: \"school\"},\r\n            {name: \"charisma\", label: \"CHA\", icon: \"groups\"}\r\n        ];\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title\"}, \"Statistics\"),\r\n                m(\"div\", {class: \"text-xs text-gray-600 dark:text-gray-400 truncate\"}, char.name)\r\n            ]),\r\n\r\n            // Stats list\r\n            m(\"div\", {class: \"flex-1 overflow-y-auto p-2 space-y-2\"},\r\n                statFields.map(function(sf) {\r\n                    let val = stats[sf.name];\r\n                    let pct = val !== undefined ? (val / 20) * 100 : 0;\r\n\r\n                    return m(\"div\", {class: \"flex items-center space-x-2\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined cg-stat-icon\"}, sf.icon),\r\n                        m(\"span\", {class: \"w-8 text-xs text-gray-700 dark:text-gray-300\"}, sf.label),\r\n                        m(\"div\", {class: \"cg-stat-bar-container\"}, [\r\n                            m(\"div\", {\r\n                                class: \"h-full \" + getStatColor(val, 20),\r\n                                style: \"width: \" + pct + \"%\"\r\n                            })\r\n                        ]),\r\n                        m(\"span\", {class: \"cg-stat-label\"}, formatStatValue(val))\r\n                    ]);\r\n                })\r\n            ),\r\n\r\n            // Derived stats footer\r\n            m(\"div\", {class: \"cg-card-footer-section text-xs\"}, [\r\n                m(\"div\", {class: \"flex justify-between\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Health:\"),\r\n                    m(\"span\", {class: \"text-green-600 dark:text-green-400\"}, formatStatValue(stats.health))\r\n                ]),\r\n                m(\"div\", {class: \"flex justify-between\"}, [\r\n                    m(\"span\", {class: \"text-gray-600 dark:text-gray-400\"}, \"Power:\"),\r\n                    m(\"span\", {class: \"text-blue-600 dark:text-blue-400\"}, formatStatValue(stats.power))\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function renderTraitsView(char) {\r\n        let traits = char.traits || [];\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title\"}, \"Traits\"),\r\n                m(\"div\", {class: \"cg-nav-label truncate\"}, char.name)\r\n            ]),\r\n\r\n            // Traits list\r\n            m(\"div\", {class: \"flex-1 overflow-y-auto p-2\"}, [\r\n                traits.length === 0 ?\r\n                    m(\"div\", {class: \"text-center text-gray-500 dark:text-gray-400 py-4\"}, \"No traits defined\") :\r\n                    m(\"div\", {class: \"flex flex-wrap gap-2\"},\r\n                        traits.map(function(trait) {\r\n                            let tname = trait.name || trait;\r\n                            return m(\"span\", {class: \"cg-trait-tag\"}, tname);\r\n                        })\r\n                    )\r\n            ]),\r\n\r\n            // Alignment section\r\n            m(\"div\", {class: \"cg-card-footer-section\"}, [\r\n                m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Alignment\"),\r\n                m(\"div\", {class: \"text-sm text-gray-800 dark:text-gray-200\"}, char.alignment || \"Neutral\")\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    // Load full narrative object from server\r\n    async function loadFullNarrative(char) {\r\n        if (!char || !char.narrative || !char.narrative.objectId) {\r\n            loadedNarrative = null;\r\n            loadedNarrativeCharId = null;\r\n            return;\r\n        }\r\n\r\n        // Skip if already loaded for this character\r\n        if (loadedNarrativeCharId === char.objectId && loadedNarrative) {\r\n            return;\r\n        }\r\n\r\n        narrativeLoading = true;\r\n        m.redraw();\r\n\r\n        try {\r\n            let q = am7view.viewQuery(\"olio.narrative\");\r\n            q.field(\"objectId\", char.narrative.objectId);\r\n            let qr = await page.search(q);\r\n            if (qr && qr.results && qr.results.length > 0) {\r\n                loadedNarrative = qr.results[0];\r\n                loadedNarrativeCharId = char.objectId;\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load full narrative:\", e);\r\n        }\r\n\r\n        narrativeLoading = false;\r\n        m.redraw();\r\n    }\r\n\r\n    function renderNarrativeView(char) {\r\n        // Use loaded narrative if available and matches current character, otherwise use char.narrative\r\n        let narrative = (loadedNarrativeCharId === char.objectId && loadedNarrative)\r\n            ? loadedNarrative\r\n            : (char.narrative || {});\r\n        let hasNarrative = narrative.physicalDescription || narrative.outfitDescription || narrative.statisticsDescription;\r\n\r\n        // Trigger load of full narrative if not loaded yet\r\n        if (char.narrative && char.narrative.objectId && loadedNarrativeCharId !== char.objectId && !narrativeLoading) {\r\n            loadFullNarrative(char);\r\n        }\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title\"}, \"Narrative\"),\r\n                m(\"div\", {class: \"cg-nav-label truncate\"}, char.name)\r\n            ]),\r\n\r\n            // Narrative content\r\n            m(\"div\", {class: \"flex-1 overflow-y-auto p-2 space-y-3 text-sm\"}, [\r\n                // Loading indicator\r\n                narrativeLoading ? m(\"div\", {class: \"flex items-center justify-center py-4\"}, [\r\n                    m(\"span\", {class: \"material-symbols-outlined text-2xl text-gray-400 animate-spin\"}, \"progress_activity\"),\r\n                    m(\"span\", {class: \"ml-2 text-gray-500\"}, \"Loading narrative...\")\r\n                ]) : \"\",\r\n\r\n                !narrativeLoading && narrative.physicalDescription ? m(\"div\", {}, [\r\n                    m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Physical\"),\r\n                    m(\"div\", {class: \"text-gray-800 dark:text-gray-200\"}, narrative.physicalDescription)\r\n                ]) : \"\",\r\n\r\n                !narrativeLoading && narrative.outfitDescription ? m(\"div\", {}, [\r\n                    m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Outfit\"),\r\n                    m(\"div\", {class: \"text-gray-800 dark:text-gray-200\"}, narrative.outfitDescription)\r\n                ]) : \"\",\r\n\r\n                !narrativeLoading && narrative.statisticsDescription ? m(\"div\", {}, [\r\n                    m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Abilities\"),\r\n                    m(\"div\", {class: \"text-gray-800 dark:text-gray-200\"}, narrative.statisticsDescription)\r\n                ]) : \"\",\r\n\r\n                !narrativeLoading && !hasNarrative ?\r\n                    m(\"div\", {class: \"flex flex-col items-center justify-center py-8\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-5xl text-gray-400 dark:text-gray-500 mb-3\"}, \"auto_stories\"),\r\n                        m(\"div\", {class: \"text-gray-500 dark:text-gray-400 mb-3\"}, \"No narrative generated\"),\r\n                        m(\"button\", {\r\n                            class: \"cg-btn-primary text-sm flex items-center space-x-1\",\r\n                            onclick: function(e) { e.stopPropagation(); generateNarrative(); }\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"edit_note\"),\r\n                            m(\"span\", {}, \"Generate Narrative\")\r\n                        ])\r\n                    ]) : \"\"\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function renderInstinctsView(char) {\r\n        let instinct = char.instinct || {};\r\n        let instinctFields = [\r\n            {name: \"fight\", label: \"Fight\", icon: \"swords\"},\r\n            {name: \"flight\", label: \"Flight\", icon: \"directions_run\"},\r\n            {name: \"feed\", label: \"Feed\", icon: \"restaurant\"},\r\n            {name: \"drink\", label: \"Drink\", icon: \"water_drop\"},\r\n            {name: \"sleep\", label: \"Sleep\", icon: \"bedtime\"},\r\n            {name: \"hide\", label: \"Hide\", icon: \"visibility_off\"},\r\n            {name: \"mate\", label: \"Mate\", icon: \"favorite\"},\r\n            {name: \"herd\", label: \"Herd\", icon: \"groups\"},\r\n            {name: \"protect\", label: \"Protect\", icon: \"shield\"},\r\n            {name: \"cooperate\", label: \"Cooperate\", icon: \"handshake\"}\r\n        ];\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title\"}, \"Instincts\"),\r\n                m(\"div\", {class: \"cg-nav-label truncate\"}, char.name)\r\n            ]),\r\n\r\n            // Instincts list\r\n            m(\"div\", {class: \"flex-1 overflow-y-auto p-2 space-y-2\"},\r\n                instinctFields.map(function(inst) {\r\n                    let val = instinct[inst.name];\r\n                    // Instincts range from -100 to 100, center at 0\r\n                    let displayVal = val !== undefined ? val : 0;\r\n                    let leftPct = displayVal < 0 ? 50 + (displayVal / 2) : 50;\r\n                    let widthPct = Math.abs(displayVal) / 2;\r\n\r\n                    return m(\"div\", {class: \"flex items-center space-x-2\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined cg-stat-icon\"}, inst.icon),\r\n                        m(\"span\", {class: \"w-16 text-xs text-gray-700 dark:text-gray-300\"}, inst.label),\r\n                        m(\"div\", {class: \"cg-stat-bar-thin\"}, [\r\n                            // Center line\r\n                            m(\"div\", {class: \"absolute left-1/2 top-0 bottom-0 w-px bg-gray-400 dark:bg-gray-500\"}),\r\n                            // Value bar\r\n                            m(\"div\", {\r\n                                class: \"absolute h-full \" + getInstinctColor(displayVal),\r\n                                style: \"left: \" + leftPct + \"%; width: \" + widthPct + \"%\"\r\n                            })\r\n                        ]),\r\n                        m(\"span\", {class: \"cg-stat-label-wide\"}, val !== undefined ? Math.round(val) : \"-\")\r\n                    ]);\r\n                })\r\n            )\r\n        ]);\r\n    }\r\n\r\n    function renderApparelView(char) {\r\n        // Try to find apparel from different sources - apparelHand/apparelTray have full data\r\n        let apparel = null;\r\n        if (apparelHand.length > 0) {\r\n            apparel = apparelHand[0];\r\n        } else if (apparelTray.length > 0) {\r\n            apparel = apparelTray[0];\r\n        } else if (char.store && char.store.apparel && char.store.apparel.length > 0) {\r\n            apparel = char.store.apparel[0];\r\n        }\r\n        let outfitDesc = char.narrative ? char.narrative.outfitDescription : null;\r\n\r\n        return m(\"div\", {class: \"h-full flex flex-col\"}, [\r\n            // Header\r\n            m(\"div\", {class: \"cg-card-header\"}, [\r\n                m(\"div\", {class: \"cg-card-title\"}, \"Apparel\"),\r\n                m(\"div\", {class: \"cg-nav-label truncate\"}, char.name)\r\n            ]),\r\n\r\n            // Apparel content\r\n            m(\"div\", {class: \"flex-1 overflow-y-auto p-2 space-y-3 text-sm\"}, [\r\n                // Outfit description from narrative\r\n                outfitDesc ? m(\"div\", {}, [\r\n                    m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Current Outfit\"),\r\n                    m(\"div\", {class: \"text-gray-800 dark:text-gray-200 text-xs leading-relaxed\"}, outfitDesc)\r\n                ]) : m(\"div\", {class: \"text-gray-500 dark:text-gray-400 text-center py-2\"}, \"No outfit description\"),\r\n\r\n                // Apparel info\r\n                apparel ? m(\"div\", {class: \"cg-card-divider\"}, [\r\n                    m(\"div\", {class: \"cg-nav-label mb-1\"}, \"Apparel Details\"),\r\n                    apparel.description ?\r\n                        m(\"div\", {class: \"text-gray-800 dark:text-gray-200 text-xs\"}, apparel.description) :\r\n                        m(\"div\", {class: \"text-gray-500 dark:text-gray-400 text-xs italic\"}, \"No description set\")\r\n                ]) : \"\"\r\n            ]),\r\n\r\n            // Dress up/down buttons\r\n            m(\"div\", {class: \"cg-card-footer-section\"}, [\r\n                m(\"div\", {class: \"cg-nav-label mb-2 text-center\"}, \"Change Clothing Level\"),\r\n                m(\"div\", {class: \"flex justify-center space-x-2\"}, [\r\n                    m(\"button\", {\r\n                        class: \"cg-btn-primary text-xs flex items-center space-x-1\",\r\n                        onclick: function(e) { e.stopPropagation(); dressCharacterUp(); },\r\n                        title: \"Add more clothing\"\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"add\"),\r\n                        m(\"span\", {}, \"Dress Up\")\r\n                    ]),\r\n                    m(\"button\", {\r\n                        class: \"cg-btn-orange text-xs flex items-center space-x-1\",\r\n                        onclick: function(e) { e.stopPropagation(); dressCharacterDown(); },\r\n                        title: \"Remove clothing\"\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"remove\"),\r\n                        m(\"span\", {}, \"Dress Down\")\r\n                    ])\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    // ==========================================\r\n    // Card Stack Components\r\n    // ==========================================\r\n\r\n    // Drag/drop handlers\r\n    function handleDragStart(e, card, source) {\r\n        draggedCard = card;\r\n        dragSource = source;\r\n        e.dataTransfer.effectAllowed = 'move';\r\n        // Use objectId for items/apparel, id for action cards\r\n        e.dataTransfer.setData('text/plain', card.objectId || card.id || '');\r\n        e.target.style.opacity = '0.5';\r\n    }\r\n\r\n    function handleDragEnd(e) {\r\n        e.target.style.opacity = '1';\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDragOver(e, target) {\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'move';\r\n        if (dropTarget !== target) {\r\n            dropTarget = target;\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n    function handleDragLeave(e) {\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnUserHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && (dragSource === 'deck' || dragSource === 'characterDeck')) {\r\n            // Check user hand limit\r\n            if (userHand.length >= USER_HAND_LIMIT) {\r\n                page.toast(\"warn\", \"Your hand is full (limit: \" + USER_HAND_LIMIT + \")\");\r\n            } else {\r\n                // Draw the dragged card from deck to user hand\r\n                let idx = deck.findIndex(c => c.objectId === draggedCard.objectId);\r\n                if (idx > -1) {\r\n                    let drawn = deck.splice(idx, 1)[0];\r\n                    userHand.push(drawn);\r\n                    if (previewIndex >= deck.length && deck.length > 0) {\r\n                        previewIndex = 0;\r\n                    }\r\n                    previewCard = deck.length > 0 ? deck[previewIndex] : null;\r\n                    selectCard(drawn);\r\n                    page.toast(\"info\", \"Drew: \" + drawn.name);\r\n                }\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnGameHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && (dragSource === 'deck' || dragSource === 'characterDeck')) {\r\n            // Check game hand limit\r\n            if (gameHand.length >= GAME_HAND_LIMIT) {\r\n                page.toast(\"warn\", \"Game hand is full (limit: \" + GAME_HAND_LIMIT + \")\");\r\n            } else {\r\n                // Draw the dragged card from deck to game hand\r\n                let idx = deck.findIndex(c => c.objectId === draggedCard.objectId);\r\n                if (idx > -1) {\r\n                    let drawn = deck.splice(idx, 1)[0];\r\n                    gameHand.push(drawn);\r\n                    if (previewIndex >= deck.length && deck.length > 0) {\r\n                        previewIndex = 0;\r\n                    }\r\n                    previewCard = deck.length > 0 ? deck[previewIndex] : null;\r\n                    page.toast(\"info\", \"Game drew: \" + drawn.name);\r\n                }\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnDiscard(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && (dragSource === 'userHand' || dragSource === 'gameHand')) {\r\n            discardCard(draggedCard, dragSource);\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnSelected(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && (dragSource === 'userHand' || dragSource === 'gameHand')) {\r\n            selectCard(draggedCard);\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnActionHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'actionDeck') {\r\n            // Draw from deck to hand\r\n            let idx = actionDeck.findIndex(a => a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let action = actionDeck.splice(idx, 1)[0];\r\n                actionHand.push(action);\r\n                updateActionPreview();\r\n                page.toast(\"info\", \"Drew: \" + action.label);\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnPlayedActions(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'actionHand') {\r\n            // Play action from hand - creates an interaction object\r\n            let idx = actionHand.findIndex(a => a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let action = actionHand.splice(idx, 1)[0];\r\n                let interaction = createInteractionFromAction(action);\r\n                playedActions.push(interaction);\r\n                page.toast(\"info\", \"Played: \" + action.label);\r\n                // Clear detail view after playing\r\n                selectedDetailCard = null;\r\n                selectedDetailType = null;\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnItemHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'itemDeck') {\r\n            // Find and move from item deck to item hand\r\n            let idx = itemDeck.findIndex(i => i.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let item = itemDeck.splice(idx, 1)[0];\r\n                itemHand.push(item);\r\n                page.toast(\"info\", \"Drew item: \" + (item.name || \"Unknown\"));\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnApparelHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'apparelDeck') {\r\n            // Find and move from apparel deck to apparel hand\r\n            let idx = apparelDeck.findIndex(a => a.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let apparel = apparelDeck.splice(idx, 1)[0];\r\n                apparelHand.push(apparel);\r\n                page.toast(\"info\", \"Drew apparel: \" + (apparel.name || \"Unknown\"));\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnItemTray(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'itemHand') {\r\n            // Move from item hand to item tray\r\n            let idx = itemHand.findIndex(i => i.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let item = itemHand.splice(idx, 1)[0];\r\n                itemTray.push(item);\r\n                page.toast(\"info\", \"Played item: \" + (item.name || \"Unknown\"));\r\n                // Clear detail view after playing\r\n                selectedDetailCard = null;\r\n                selectedDetailType = null;\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnApparelTray(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'apparelHand') {\r\n            // Move from apparel hand to apparel tray\r\n            let idx = apparelHand.findIndex(a => a.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let apparel = apparelHand.splice(idx, 1)[0];\r\n                apparelTray.push(apparel);\r\n                page.toast(\"info\", \"Played apparel: \" + (apparel.name || \"Unknown\"));\r\n                // Clear detail view after playing\r\n                selectedDetailCard = null;\r\n                selectedDetailType = null;\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    // System hand drop handlers\r\n    function handleDropOnSystemActionHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'actionDeck') {\r\n            let idx = actionDeck.findIndex(a => a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let action = actionDeck.splice(idx, 1)[0];\r\n                systemActionHand.push(action);\r\n                page.toast(\"info\", \"System drew: \" + action.label);\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnSystemItemHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'itemDeck') {\r\n            let idx = itemDeck.findIndex(i => i.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let item = itemDeck.splice(idx, 1)[0];\r\n                systemItems.push(item);\r\n                page.toast(\"info\", \"System drew item: \" + (item.name || \"Unknown\"));\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    function handleDropOnSystemApparelHand(e) {\r\n        e.preventDefault();\r\n        if (draggedCard && dragSource === 'apparelDeck') {\r\n            let idx = apparelDeck.findIndex(a => a.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let apparel = apparelDeck.splice(idx, 1)[0];\r\n                systemApparel.push(apparel);\r\n                page.toast(\"info\", \"System drew apparel: \" + (apparel.name || \"Unknown\"));\r\n            }\r\n        }\r\n        draggedCard = null;\r\n        dragSource = null;\r\n        dropTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    // Universal discard handler - discards any card type and shuffles back into appropriate deck\r\n    function handleUniversalDiscard() {\r\n        if (!draggedCard || !dragSource) return;\r\n\r\n        let cardName = \"\";\r\n\r\n        // Determine card type from dragSource and handle accordingly\r\n        if (dragSource === 'userHand' || dragSource === 'gameHand') {\r\n            // Character card - find and remove from hand, shuffle into deck\r\n            let sourceHand = dragSource === 'userHand' ? userHand : gameHand;\r\n            let idx = sourceHand.findIndex(c => c.objectId === draggedCard.objectId);\r\n            if (idx > -1) {\r\n                let card = sourceHand.splice(idx, 1)[0];\r\n                cardName = card.name || \"Character\";\r\n                deck.push(card);\r\n                deck = shuffleArray(deck);\r\n                if (selectedCard && selectedCard.objectId === card.objectId) {\r\n                    selectedCard = null;\r\n                }\r\n            }\r\n        } else if (dragSource === 'actionHand' || dragSource === 'playedActions') {\r\n            // Action card from user\r\n            let sourceArray = dragSource === 'actionHand' ? actionHand : playedActions;\r\n            let idx = sourceArray.findIndex(a => a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = sourceArray.splice(idx, 1)[0];\r\n                cardName = card.label || \"Action\";\r\n                // Convert interaction back to action card if from playedActions\r\n                let actionCard = dragSource === 'playedActions' ?\r\n                    ACTION_CARD_TYPES.find(a => a.type === card.type) || card : card;\r\n                actionDeck.push({...actionCard, id: Date.now() + Math.random()});\r\n                actionDeck = shuffleArray(actionDeck);\r\n            }\r\n        } else if (dragSource === 'systemActionHand' || dragSource === 'systemPlayedActions') {\r\n            // Action card from system\r\n            let sourceArray = dragSource === 'systemActionHand' ? systemActionHand : systemPlayedActions;\r\n            let idx = sourceArray.findIndex(a => a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = sourceArray.splice(idx, 1)[0];\r\n                cardName = card.label || \"Action\";\r\n                let actionCard = dragSource === 'systemPlayedActions' ?\r\n                    ACTION_CARD_TYPES.find(a => a.type === card.type) || card : card;\r\n                actionDeck.push({...actionCard, id: Date.now() + Math.random()});\r\n                actionDeck = shuffleArray(actionDeck);\r\n            }\r\n        } else if (dragSource === 'itemHand' || dragSource === 'itemTray') {\r\n            // Item card from user\r\n            let sourceArray = dragSource === 'itemHand' ? itemHand : itemTray;\r\n            let idx = sourceArray.findIndex(i => i.objectId === draggedCard.objectId || i.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = sourceArray.splice(idx, 1)[0];\r\n                cardName = card.name || \"Item\";\r\n                itemDeck.push(card);\r\n                itemDeck = shuffleArray(itemDeck);\r\n            }\r\n        } else if (dragSource === 'systemItems') {\r\n            // Item card from system\r\n            let idx = systemItems.findIndex(i => i.objectId === draggedCard.objectId || i.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = systemItems.splice(idx, 1)[0];\r\n                cardName = card.name || \"Item\";\r\n                itemDeck.push(card);\r\n                itemDeck = shuffleArray(itemDeck);\r\n            }\r\n        } else if (dragSource === 'apparelHand' || dragSource === 'apparelTray') {\r\n            // Apparel card from user\r\n            let sourceArray = dragSource === 'apparelHand' ? apparelHand : apparelTray;\r\n            let idx = sourceArray.findIndex(a => a.objectId === draggedCard.objectId || a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = sourceArray.splice(idx, 1)[0];\r\n                cardName = getApparelDisplayName(card);\r\n                apparelDeck.push(card);\r\n                apparelDeck = shuffleArray(apparelDeck);\r\n            }\r\n        } else if (dragSource === 'systemApparel') {\r\n            // Apparel card from system\r\n            let idx = systemApparel.findIndex(a => a.objectId === draggedCard.objectId || a.id === draggedCard.id);\r\n            if (idx > -1) {\r\n                let card = systemApparel.splice(idx, 1)[0];\r\n                cardName = getApparelDisplayName(card);\r\n                apparelDeck.push(card);\r\n                apparelDeck = shuffleArray(apparelDeck);\r\n            }\r\n        }\r\n\r\n        // Clear detail view if discarded card was selected\r\n        if (selectedDetailCard && (selectedDetailCard.objectId === draggedCard.objectId || selectedDetailCard.id === draggedCard.id)) {\r\n            selectedDetailCard = null;\r\n            selectedDetailType = null;\r\n        }\r\n\r\n        if (cardName) {\r\n            page.toast(\"info\", \"Discarded \" + cardName + \" and shuffled into deck\");\r\n        }\r\n\r\n        draggedCard = null;\r\n        dragSource = null;\r\n    }\r\n\r\n    // Card selection functions - opens detail view for action/item/apparel cards\r\n    function selectActionCard(card) {\r\n        selectedDetailCard = card;\r\n        selectedDetailType = 'action';\r\n        // Clear character selection when selecting action/item/apparel\r\n        selectedCard = null;\r\n        m.redraw();\r\n    }\r\n\r\n    async function selectItemCard(card) {\r\n        selectedDetailType = 'item';\r\n        selectedCard = null;\r\n        // Load full item data including statistics\r\n        if (card && (card.objectId || card.id)) {\r\n            try {\r\n                let q = am7view.viewQuery(\"olio.item\");\r\n                // Query by objectId if available, otherwise by id\r\n                if (card.objectId) {\r\n                    q.field(\"objectId\", card.objectId);\r\n                } else {\r\n                    q.field(\"id\", card.id);\r\n                }\r\n                // Explicitly request display fields including objectId\r\n                q.entity.request.push(\"objectId\", \"name\", \"description\", \"category\", \"statistics\", \"qualities\");\r\n                let qr = await page.search(q);\r\n                if (qr && qr.results && qr.results.length > 0) {\r\n                    let full = qr.results[0];\r\n                    am7model.applyModelNames(full);\r\n\r\n                    // Load nested itemStatistics model reference if it exists but isn't fully loaded\r\n                    if (full.statistics && full.statistics.objectId && full.statistics.damage === undefined) {\r\n                        let sq = am7view.viewQuery(\"olio.itemStatistics\");\r\n                        sq.field(\"objectId\", full.statistics.objectId);\r\n                        let sqr = await page.search(sq);\r\n                        if (sqr && sqr.results && sqr.results.length > 0) {\r\n                            full.statistics = sqr.results[0];\r\n                        }\r\n                    }\r\n\r\n                    selectedDetailCard = full;\r\n                } else {\r\n                    selectedDetailCard = card;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to load full item:\", e);\r\n                selectedDetailCard = card;\r\n            }\r\n        } else {\r\n            selectedDetailCard = card;\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    async function selectApparelCard(card) {\r\n        selectedDetailType = 'apparel';\r\n        selectedCard = null;\r\n        // Load full apparel data\r\n        if (card && card.id) {\r\n            try {\r\n                let q = am7view.viewQuery(\"olio.apparel\");\r\n                q.field(\"id\", card.id);\r\n                // Explicitly request display fields including objectId\r\n                q.entity.request.push(\"objectId\", \"name\", \"type\", \"category\", \"description\", \"wearables\");\r\n                let qr = await page.search(q);\r\n                if (qr && qr.results && qr.results.length > 0) {\r\n                    let full = qr.results[0];\r\n                    am7model.applyModelNames(full);\r\n                    selectedDetailCard = full;\r\n                } else {\r\n                    selectedDetailCard = card;\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Failed to load full apparel:\", e);\r\n                selectedDetailCard = card;\r\n            }\r\n        } else {\r\n            selectedDetailCard = card;\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    // Mini card for stack display - responsive scaling\r\n    // cardType: 'character', 'item', 'location', 'event' (for future use)\r\n    // useResponsive: true for cards in hand areas that should scale with container\r\n    function renderMiniCard(card, onClick, isHighlight, source, cardType, useResponsive) {\r\n        let portraitUrl = card ? getPortraitUrl(card, \"128x128\") : null;\r\n        let borderClass = isHighlight ? \"cg-card-selected\" : \"border-gray-400 dark:border-gray-500\";\r\n        let isDragging = draggedCard && draggedCard.objectId === card?.objectId;\r\n        let typeIcon = cardType === 'character' ? 'person' : cardType === 'item' ? 'inventory_2' : cardType === 'location' ? 'location_on' : 'event';\r\n        let cardClass = useResponsive ? \"cg-card-mini-responsive\" : \"cg-card-mini\";\r\n\r\n        return m(\"div\", {\r\n            class: cardClass + \" \" + borderClass + (isDragging ? \" opacity-50\" : \"\"),\r\n            style: useResponsive ? \"\" : \"width: 60px; height: 85px;\",\r\n            onclick: onClick,\r\n            draggable: source ? true : false,\r\n            ondragstart: source ? function(e) { handleDragStart(e, card, source); } : null,\r\n            ondragend: source ? handleDragEnd : null\r\n        }, [\r\n            m(\"div\", {class: \"cg-mini-portrait flex-1\"}, [\r\n                portraitUrl ?\r\n                    m(\"img\", {src: portraitUrl, class: \"w-full h-full object-cover\", draggable: false}) :\r\n                    m(\"span\", {class: \"material-symbols-outlined cg-mini-portrait-icon\"}, \"person\"),\r\n                // Card type icon overlay\r\n                m(\"div\", {class: \"cg-mini-badge\"}, [\r\n                    m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 10px\"}, typeIcon)\r\n                ])\r\n            ]),\r\n            m(\"div\", {class: \"cg-mini-name\"}, [\r\n                m(\"div\", {class: \"cg-mini-name-text text-xs md:text-sm\"},\r\n                    card ? card.name.split(\" \")[0] : \"?\")\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    // Card back for deck stacks (no portrait, just type icon)\r\n    // Responsive: smaller on mobile (60x85), larger on desktop (80x110)\r\n    function renderCardBack(cardType) {\r\n        let typeIcon = cardType === 'character' ? 'person' : cardType === 'item' ? 'inventory_2' : cardType === 'location' ? 'location_on' : 'event';\r\n        let typeName = cardType.charAt(0).toUpperCase() + cardType.slice(1);\r\n\r\n        return m(\"div\", {\r\n            class: \"cg-card-back\",\r\n            style: \"width: 60px; height: 85px;\"\r\n        }, [\r\n            m(\"div\", {class: \"h-full flex flex-col items-center justify-center\"}, [\r\n                m(\"span\", {class: \"material-symbols-outlined text-3xl text-blue-300\"}, typeIcon),\r\n                m(\"div\", {class: \"font-bold text-blue-300 mt-0.5\", style: \"font-size: 9px\"}, typeName)\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    // Draw Pile (Deck)\r\n    function DrawPile() {\r\n        return {\r\n            view: function() {\r\n                let topCard = previewCard || (deck.length > 0 ? deck[previewIndex] : null);\r\n\r\n                return m(\"div\", {class: \"cg-panel\"}, [\r\n                    // Header\r\n                    m(\"div\", {class: \"cg-header-blue\"}, [\r\n                        m(\"div\", {class: \"flex items-center space-x-1\"}, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"person\"),\r\n                            m(\"span\", {class: \"text-sm font-medium\"}, \"Characters\"),\r\n                            m(\"span\", {class: \"text-xs opacity-75\"}, \"(\" + deck.length + \")\")\r\n                        ]),\r\n                        m(\"button\", {\r\n                            class: \"p-1 rounded hover:bg-blue-500\",\r\n                            onclick: shuffleDeck,\r\n                            title: \"Shuffle\"\r\n                        }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"shuffle\"))\r\n                    ]),\r\n\r\n                    // Stack display\r\n                    m(\"div\", {class: \"flex-1 flex items-center justify-center p-2\"}, [\r\n                        deck.length === 0 ?\r\n                            m(\"div\", {class: \"text-center text-gray-400 text-xs\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-3xl block mb-1\"}, \"person_off\"),\r\n                                \"Empty\"\r\n                            ]) :\r\n                            m(\"div\", {class: \"relative\"}, [\r\n                                // Stack shadows with card backs\r\n                                deck.length > 2 ? m(\"div\", {\r\n                                    class: \"cg-stack-shadow-blue\",\r\n                                    style: \"width: 60px; height: 85px; top: 3px; left: 3px;\"\r\n                                }, [\r\n                                    m(\"div\", {class: \"h-full flex items-center justify-center\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-xl text-blue-400/50\"}, \"person\")\r\n                                    ])\r\n                                ]) : \"\",\r\n                                deck.length > 1 ? m(\"div\", {\r\n                                    class: \"cg-stack-shadow-blue\",\r\n                                    style: \"width: 60px; height: 85px; top: 1.5px; left: 1.5px;\"\r\n                                }, [\r\n                                    m(\"div\", {class: \"h-full flex items-center justify-center\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-xl text-blue-400/50\"}, \"person\")\r\n                                    ])\r\n                                ]) : \"\",\r\n                                // Top card (preview card) - draggable\r\n                                renderMiniCard(topCard, drawToUserHand, false, 'deck', 'character')\r\n                            ])\r\n                    ]),\r\n\r\n                    // Navigation and actions\r\n                    m(\"div\", {class: \"cg-footer\"}, [\r\n                        // Flip through controls\r\n                        m(\"div\", {class: \"flex items-center justify-center space-x-1 mb-1\"}, [\r\n                            m(\"button\", {\r\n                                class: \"cg-nav-btn cg-nav-btn-text\",\r\n                                onclick: previewPrevCard,\r\n                                disabled: deck.length === 0\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-xs\"}, \"chevron_left\")),\r\n                            m(\"span\", {class: \"cg-nav-label min-w-12 text-center\"},\r\n                                deck.length > 0 ? (previewIndex + 1) + \"/\" + deck.length : \"-\"),\r\n                            m(\"button\", {\r\n                                class: \"cg-nav-btn cg-nav-btn-text\",\r\n                                onclick: previewNextCard,\r\n                                disabled: deck.length === 0\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-xs\"}, \"chevron_right\"))\r\n                        ]),\r\n                        // Draw buttons\r\n                        m(\"div\", {class: \"flex space-x-1\"}, [\r\n                            m(\"button\", {\r\n                                class: \"cg-btn-action-green\",\r\n                                onclick: drawToUserHand,\r\n                                disabled: deck.length === 0 || userHand.length >= USER_HAND_LIMIT,\r\n                                title: \"Draw to your hand\"\r\n                            }, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"person\"),\r\n                                m(\"span\", {}, \"You\")\r\n                            ]),\r\n                            m(\"button\", {\r\n                                class: \"cg-btn-action-red\",\r\n                                onclick: drawToGameHand,\r\n                                disabled: deck.length === 0 || gameHand.length >= GAME_HAND_LIMIT,\r\n                                title: \"Draw to game hand\"\r\n                            }, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"smart_toy\"),\r\n                                m(\"span\", {}, \"Game\")\r\n                            ])\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // User's Hand (limited to 1 character)\r\n    function UserHandPile() {\r\n        return {\r\n            view: function() {\r\n                let isCharDropTarget = dropTarget === 'userHand' && dragSource === 'deck';\r\n                let isActionDropTarget = dropTarget === 'userActionHand' && dragSource === 'actionDeck';\r\n                let isItemDropTarget = dropTarget === 'userItemHand' && dragSource === 'itemDeck';\r\n                let isApparelDropTarget = dropTarget === 'userApparelHand' && dragSource === 'apparelDeck';\r\n                let isPlayedDrop = (dropTarget === 'playedActions' && dragSource === 'actionHand') || (dragSource === 'actionHand' && dropTarget === 'playedActions');\r\n                let isDraggingAction = dragSource === 'actionHand';\r\n\r\n                return m(\"div\", {class: \"cg-panel-overflow\"}, [\r\n                    // Main content - character card with surrounding card stacks\r\n                    // Responsive: smaller cards and tighter gaps on mobile\r\n                    m(\"div\", {class: \"cg-hand-content\"}, [\r\n                        // Left side - Action cards stack\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isActionDropTarget ? \"bg-purple-200 dark:bg-purple-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'userActionHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnActionHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-action\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"bolt\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, actionHand.length)\r\n                            ]),\r\n                            actionHand.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isActionDropTarget ? \"cg-dropzone-action-active\" : \"cg-dropzone-action-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-purple-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectActionCard(actionHand[actionHandIndex]); }}, [\r\n                                    // Top card - responsive\r\n                                    m(\"div\", {\r\n                                        class: \"cg-mini-action\",\r\n                                        draggable: true,\r\n                                        ondragstart: function(e) { handleDragStart(e, actionHand[actionHandIndex], 'actionHand'); },\r\n                                        ondragend: handleDragEnd\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-purple text-2xl md:text-3xl\"}, actionHand[actionHandIndex].icon),\r\n                                        m(\"span\", {class: \"cg-mini-text-purple text-xs md:text-sm\"}, actionHand[actionHandIndex].label),\r\n                                        actionHand.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-purple-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, actionHand.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ]),\r\n\r\n                        // Center - Character card (drop zone)\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isCharDropTarget ? \"bg-green-200 dark:bg-green-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'userHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnUserHand\r\n                        }, [\r\n                            userHand.length === 0 ?\r\n                                m(\"div\", {class: \"text-center text-gray-400 flex-1 flex items-center justify-center h-full\"}, [\r\n                                    m(\"div\", {\r\n                                        class: \"cg-dropzone-char w-24 h-32 md:w-32 md:h-44 lg:w-40 lg:h-56 \" + (isCharDropTarget ? \"cg-dropzone-green-active\" : \"border-gray-400\")\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-3xl md:text-4xl lg:text-5xl\"}, \"person_add\"),\r\n                                        m(\"span\", {class: \"text-xs md:text-sm\"}, \"Drop\")\r\n                                    ])\r\n                                ]) :\r\n                                m(\"div\", {class: \"flex-1 flex items-center justify-center h-full\"},\r\n                                    userHand.map(function(card) {\r\n                                        let isSelected = selectedCard && selectedCard.objectId === card.objectId;\r\n                                        return renderMiniCard(card, function() { selectCard(card); }, isSelected, 'userHand', 'character', true);\r\n                                    })\r\n                                )\r\n                        ]),\r\n\r\n                        // Right side - Item cards stack\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isItemDropTarget ? \"bg-emerald-200 dark:bg-emerald-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'userItemHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnItemHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-item\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"inventory_2\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, itemHand.length)\r\n                            ]),\r\n                            itemHand.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isItemDropTarget ? \"cg-dropzone-item-active\" : \"cg-dropzone-item-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-emerald-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectItemCard(itemHand[itemHandIndex]); }}, [\r\n                                    m(\"div\", {\r\n                                        class: \"cg-mini-item\",\r\n                                        draggable: true,\r\n                                        ondragstart: function(e) { handleDragStart(e, itemHand[itemHandIndex], 'itemHand'); },\r\n                                        ondragend: handleDragEnd\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-emerald text-2xl md:text-3xl\"}, \"inventory_2\"),\r\n                                        m(\"span\", {class: \"cg-mini-text-emerald text-xs md:text-sm\"}, itemHand[itemHandIndex].name ? itemHand[itemHandIndex].name.substring(0, 8) : \"Item\"),\r\n                                        itemHand.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-emerald-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, itemHand.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ]),\r\n\r\n                        // Far right - Apparel cards stack\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isApparelDropTarget ? \"bg-pink-200 dark:bg-pink-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'userApparelHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnApparelHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-apparel\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"checkroom\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, apparelHand.length)\r\n                            ]),\r\n                            apparelHand.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isApparelDropTarget ? \"cg-dropzone-apparel-active\" : \"cg-dropzone-apparel-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-pink-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectApparelCard(apparelHand[apparelHandIndex]); }}, [\r\n                                    m(\"div\", {\r\n                                        class: \"cg-mini-apparel\",\r\n                                        draggable: true,\r\n                                        ondragstart: function(e) { handleDragStart(e, apparelHand[apparelHandIndex], 'apparelHand'); },\r\n                                        ondragend: handleDragEnd\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-pink text-2xl md:text-3xl\"}, \"checkroom\"),\r\n                                        m(\"span\", {class: \"cg-mini-text-pink text-xs md:text-sm\"}, getApparelDisplayName(apparelHand[apparelHandIndex]).substring(0, 8)),\r\n                                        apparelHand.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, apparelHand.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ])\r\n                    ]),\r\n\r\n                    // Footer with action tray - green header with played actions\r\n                    m(\"div\", {class: \"cg-header-green\"}, [\r\n                        // Pending interaction display (if active)\r\n                        pendingInteraction ? m(\"div\", {class: \"cg-pending-bar\"}, [\r\n                            m(\"div\", {class: \"flex items-center space-x-2\"}, [\r\n                                m(\"span\", {class: \"font-medium\"}, userHand.length > 0 ? userHand[0].name.split(\" \")[0] : \"?\"),\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, pendingInteraction.icon),\r\n                                m(\"span\", {class: \"font-medium\"}, pendingInteraction.label),\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"arrow_forward\"),\r\n                                m(\"span\", {class: \"text-purple-200\"},\r\n                                    selectedCard && gameHand.find(c => c.objectId === selectedCard.objectId)\r\n                                        ? selectedCard.name.split(\" \")[0]\r\n                                        : \"Select target...\")\r\n                            ]),\r\n                            m(\"div\", {class: \"flex space-x-1\"}, [\r\n                                m(\"button\", {\r\n                                    class: \"cg-btn-sm-green\",\r\n                                    onclick: executeAction,\r\n                                    disabled: !selectedCard || gameHand.findIndex(c => c.objectId === selectedCard?.objectId) === -1\r\n                                }, \"Go\"),\r\n                                m(\"button\", {\r\n                                    class: \"cg-btn-sm-red\",\r\n                                    onclick: cancelAction\r\n                                }, \"X\")\r\n                            ])\r\n                        ]) : \"\",\r\n                        // Header row with title and played actions - whole bar is drop target\r\n                        m(\"div\", {\r\n                            class: \"flex items-center px-2 py-1 text-white transition-all \" +\r\n                                (isPlayedDrop ? \"bg-green-500 ring-2 ring-white ring-inset\" :\r\n                                 isDraggingAction ? \"bg-green-500/80\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); e.stopPropagation(); handleDragOver(e, 'playedActions'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnPlayedActions\r\n                        }, [\r\n                            m(\"div\", {class: \"flex items-center space-x-1 flex-shrink-0\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"person\"),\r\n                                m(\"span\", {class: \"text-sm font-medium\"}, \"Your Hand\")\r\n                            ]),\r\n                            // Played actions area\r\n                            m(\"div\", {class: \"flex-1 flex items-center ml-3 space-x-1 overflow-x-auto\"}, [\r\n                                // Played action cards (compact)\r\n                                playedActions.map(function(action) {\r\n                                    let isSelected = selectedAction && selectedAction.id === action.id;\r\n                                    return m(\"div\", {\r\n                                        class: \"cg-played-action \" + (isSelected ? \"cg-played-action-selected\" : \"cg-played-action-unselected\"),\r\n                                        onclick: function() { selectPlayedAction(action); }\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-sm\"}, action.icon),\r\n                                        m(\"span\", {class: \"text-xs ml-1\"}, action.label),\r\n                                        m(\"button\", {\r\n                                            class: \"ml-1 hover:text-red-300\",\r\n                                            onclick: function(e) { e.stopPropagation(); discardPlayedAction(action); },\r\n                                            title: \"Discard\"\r\n                                        }, m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 12px\"}, \"close\"))\r\n                                    ]);\r\n                                }),\r\n                                // Drop target guide/placeholder at the end\r\n                                isDraggingAction ? m(\"div\", {\r\n                                    class: \"cg-played-drop-zone \" +\r\n                                        (isPlayedDrop ? \"border-white bg-green-400\" : \"border-green-300 bg-green-500/50 animate-pulse\"),\r\n                                    style: \"width: 40px; height: 28px;\"\r\n                                }, [\r\n                                    m(\"span\", {class: \"material-symbols-outlined text-sm text-white\"}, \"add\")\r\n                                ]) : \"\"\r\n                            ])\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Game's Hand (can have multiple characters)\r\n    function GameHandPile() {\r\n        return {\r\n            view: function() {\r\n                let isCharDropTarget = dropTarget === 'gameHand' && dragSource === 'deck';\r\n                let isActionDropTarget = dropTarget === 'systemActionHand' && dragSource === 'actionDeck';\r\n                let isItemDropTarget = dropTarget === 'systemItemHand' && dragSource === 'itemDeck';\r\n                let isApparelDropTarget = dropTarget === 'systemApparelHand' && dragSource === 'apparelDeck';\r\n\r\n                // Index for system hands\r\n                let sysActionIdx = Math.min(systemActionHandIndex, Math.max(0, systemActionHand.length - 1));\r\n                let sysItemIdx = Math.min(systemItemHandIndex, Math.max(0, systemItems.length - 1));\r\n                let sysApparelIdx = Math.min(systemApparelHandIndex, Math.max(0, systemApparel.length - 1));\r\n\r\n                return m(\"div\", {class: \"cg-panel-overflow\"}, [\r\n                    // Header with action tray - red header with system played actions\r\n                    m(\"div\", {class: \"cg-header-red\"}, [\r\n                        m(\"div\", {class: \"flex items-center px-2 py-1 text-white\"}, [\r\n                            m(\"div\", {class: \"flex items-center space-x-1 flex-shrink-0\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"smart_toy\"),\r\n                                m(\"span\", {class: \"text-sm font-medium\"}, \"System Hand\")\r\n                            ]),\r\n                            // System played actions area\r\n                            m(\"div\", {class: \"flex-1 flex items-center ml-3 space-x-1 overflow-x-auto\"}, [\r\n                                systemPlayedActions.length === 0 ?\r\n                                    m(\"span\", {class: \"text-red-200 text-xs\"}, \"No actions\") :\r\n                                    systemPlayedActions.map(function(action) {\r\n                                        return m(\"div\", {class: \"cg-played-action-system\"}, [\r\n                                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, action.icon),\r\n                                            m(\"span\", {class: \"text-xs ml-1\"}, action.label)\r\n                                        ]);\r\n                                    })\r\n                            ])\r\n                        ])\r\n                    ]),\r\n\r\n                    // Main content - character card with surrounding card stacks\r\n                    // Responsive: smaller gaps on mobile\r\n                    m(\"div\", {class: \"cg-hand-content\"}, [\r\n                        // Left side - Action cards stack (system)\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isActionDropTarget ? \"bg-purple-200 dark:bg-purple-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'systemActionHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnSystemActionHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-action\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"bolt\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, systemActionHand.length)\r\n                            ]),\r\n                            systemActionHand.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isActionDropTarget ? \"cg-dropzone-action-active\" : \"cg-dropzone-action-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-purple-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectActionCard(systemActionHand[sysActionIdx]); }}, [\r\n                                    m(\"div\", {class: \"cg-mini-action\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-purple text-2xl md:text-3xl\"}, systemActionHand[sysActionIdx].icon),\r\n                                        m(\"span\", {class: \"cg-mini-text-purple text-xs md:text-sm\"}, systemActionHand[sysActionIdx].label),\r\n                                        systemActionHand.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-purple-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, systemActionHand.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ]),\r\n\r\n                        // Center - Character cards (drop zone)\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isCharDropTarget ? \"bg-red-200 dark:bg-red-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'gameHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnGameHand\r\n                        }, [\r\n                            gameHand.length === 0 ?\r\n                                m(\"div\", {class: \"text-center text-gray-400 flex-1 flex items-center justify-center h-full\"}, [\r\n                                    m(\"div\", {\r\n                                        class: \"cg-dropzone-char w-24 h-32 md:w-32 md:h-44 lg:w-40 lg:h-56 \" + (isCharDropTarget ? \"cg-dropzone-red-active\" : \"border-gray-400\")\r\n                                    }, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-3xl md:text-4xl lg:text-5xl\"}, \"smart_toy\"),\r\n                                        m(\"span\", {class: \"text-xs md:text-sm\"}, \"Drop\")\r\n                                    ])\r\n                                ]) :\r\n                                m(\"div\", {class: \"flex space-x-1 flex-1 items-center justify-center h-full\"},\r\n                                    gameHand.map(function(card) {\r\n                                        let isSelected = selectedCard && selectedCard.objectId === card.objectId;\r\n                                        return renderMiniCard(card, function() { selectCard(card); }, isSelected, 'gameHand', 'character', true);\r\n                                    })\r\n                                )\r\n                        ]),\r\n\r\n                        // Right side - Item cards stack (system)\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isItemDropTarget ? \"bg-emerald-200 dark:bg-emerald-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'systemItemHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnSystemItemHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-item\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"inventory_2\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, systemItems.length)\r\n                            ]),\r\n                            systemItems.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isItemDropTarget ? \"cg-dropzone-item-active\" : \"cg-dropzone-item-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-emerald-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectItemCard(systemItems[sysItemIdx]); }}, [\r\n                                    m(\"div\", {class: \"cg-mini-item\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-emerald text-2xl md:text-3xl\"}, \"inventory_2\"),\r\n                                        m(\"span\", {class: \"cg-mini-text-emerald text-xs md:text-sm\"}, systemItems[sysItemIdx].name ? systemItems[sysItemIdx].name.substring(0, 8) : \"Item\"),\r\n                                        systemItems.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-emerald-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, systemItems.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ]),\r\n\r\n                        // Far right - Apparel cards stack (system)\r\n                        m(\"div\", {\r\n                            class: \"cg-card-section \" + (isApparelDropTarget ? \"bg-pink-200 dark:bg-pink-800\" : \"\"),\r\n                            ondragover: function(e) { e.preventDefault(); handleDragOver(e, 'systemApparelHand'); },\r\n                            ondragleave: handleDragLeave,\r\n                            ondrop: handleDropOnSystemApparelHand\r\n                        }, [\r\n                            m(\"div\", {class: \"cg-label-apparel\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"checkroom\"),\r\n                                m(\"span\", {class: \"cg-label-count\"}, systemApparel.length)\r\n                            ]),\r\n                            systemApparel.length === 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-dropzone \" + (isApparelDropTarget ? \"cg-dropzone-apparel-active\" : \"cg-dropzone-apparel-inactive\"),\r\n                                    style: \"min-width: 80px; min-height: 112px;\"\r\n                                }, m(\"span\", {class: \"material-symbols-outlined text-pink-400 text-2xl md:text-3xl\"}, \"add\")) :\r\n                                m(\"div\", {class: \"relative cursor-pointer flex-1 flex items-center justify-center h-full\", onclick: function() { selectApparelCard(systemApparel[sysApparelIdx]); }}, [\r\n                                    m(\"div\", {class: \"cg-mini-apparel\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined cg-mini-icon-pink text-2xl md:text-3xl\"}, \"checkroom\"),\r\n                                        m(\"span\", {class: \"cg-mini-text-pink text-xs md:text-sm\"}, getApparelDisplayName(systemApparel[sysApparelIdx]).substring(0, 8)),\r\n                                        systemApparel.length > 1 ? m(\"div\", {class: \"absolute -top-1 -right-1 bg-pink-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\"}, systemApparel.length) : \"\"\r\n                                    ])\r\n                                ])\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Action Deck Pile - goes in left panel with character piles\r\n    function ActionDeckPile() {\r\n        return {\r\n            view: function() {\r\n                let topCard = actionPreview;\r\n\r\n                return m(\"div\", {class: \"cg-panel\"}, [\r\n                    // Header\r\n                    m(\"div\", {class: \"cg-header-purple\"}, [\r\n                        m(\"div\", {class: \"flex items-center space-x-1\"}, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"bolt\"),\r\n                            m(\"span\", {class: \"text-sm font-medium\"}, \"Actions\"),\r\n                            m(\"span\", {class: \"text-xs opacity-75\"}, \"(\" + actionDeck.length + \")\")\r\n                        ]),\r\n                        m(\"div\", {class: \"flex items-center space-x-1\"}, [\r\n                            m(\"button\", {\r\n                                class: \"p-0.5 rounded hover:bg-purple-500\",\r\n                                onclick: shuffleActionDeck,\r\n                                title: \"Shuffle\"\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"shuffle\")),\r\n                            m(\"button\", {\r\n                                class: \"p-0.5 rounded hover:bg-purple-500\",\r\n                                onclick: reshuffleActionDeck,\r\n                                disabled: actionDiscard.length === 0,\r\n                                title: \"Reshuffle discard (\" + actionDiscard.length + \")\"\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"replay\"))\r\n                        ])\r\n                    ]),\r\n\r\n                    // Deck display\r\n                    m(\"div\", {class: \"flex-1 flex flex-col items-center justify-center p-2\"}, [\r\n                        // Stacked deck visual\r\n                        m(\"div\", {class: \"relative mb-2\"}, [\r\n                            // Shadow cards\r\n                            actionDeck.length > 2 ? m(\"div\", {\r\n                                class: \"cg-stack-shadow-purple\",\r\n                                style: \"width: 70px; height: 90px; top: 4px; left: 4px;\"\r\n                            }) : \"\",\r\n                            actionDeck.length > 1 ? m(\"div\", {\r\n                                class: \"cg-stack-shadow-purple\",\r\n                                style: \"width: 70px; height: 90px; top: 2px; left: 2px;\"\r\n                            }) : \"\",\r\n                            // Top card (preview or back)\r\n                            actionDeck.length > 0 ?\r\n                                m(\"div\", {\r\n                                    class: \"cg-action-deck-card\",\r\n                                    style: \"width: 70px; height: 90px;\"\r\n                                }, [\r\n                                    topCard ? [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-xl text-purple-200\"}, topCard.icon),\r\n                                        m(\"span\", {class: \"text-xs mt-1 text-purple-200 text-center\"}, topCard.label)\r\n                                    ] : [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-2xl text-purple-300\"}, \"bolt\"),\r\n                                        m(\"span\", {class: \"text-xs mt-1 text-purple-300\"}, \"Action\")\r\n                                    ]\r\n                                ]) :\r\n                                m(\"div\", {\r\n                                    class: \"cg-action-deck-empty\",\r\n                                    style: \"width: 70px; height: 90px;\"\r\n                                }, \"Empty\")\r\n                        ]),\r\n\r\n                        // Navigation buttons\r\n                        m(\"div\", {class: \"flex items-center space-x-2 mb-2\"}, [\r\n                            m(\"button\", {\r\n                                class: \"cg-nav-btn\",\r\n                                onclick: prevActionPreview,\r\n                                disabled: actionDeck.length === 0\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-sm text-gray-700 dark:text-gray-300\"}, \"chevron_left\")),\r\n                            m(\"span\", {class: \"cg-nav-label\"},\r\n                                actionDeck.length > 0 ? (actionPreviewIndex + 1) + \"/\" + actionDeck.length : \"-\"),\r\n                            m(\"button\", {\r\n                                class: \"cg-nav-btn\",\r\n                                onclick: nextActionPreview,\r\n                                disabled: actionDeck.length === 0\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-sm text-gray-700 dark:text-gray-300\"}, \"chevron_right\"))\r\n                        ]),\r\n\r\n                        // Draw button\r\n                        m(\"button\", {\r\n                            class: \"cg-action-deck-btn\",\r\n                            onclick: drawActionToTray,\r\n                            disabled: actionDeck.length === 0\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"play_arrow\"),\r\n                            m(\"span\", {}, \"Play to Tray\")\r\n                        ])\r\n                    ]),\r\n\r\n                    // Discard info\r\n                    m(\"div\", {class: \"cg-footer text-center\"}, [\r\n                        m(\"span\", {class: \"text-xs text-orange-600 dark:text-orange-400\"}, \"Discard: \" + actionDiscard.length)\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Render a mini item card\r\n    function renderItemCard(item) {\r\n        return m(\"div\", {\r\n            class: \"cg-render-item-card\",\r\n            style: \"width: 50px; height: 60px;\",\r\n            title: item.name || \"Item\"\r\n        }, [\r\n            m(\"span\", {class: \"material-symbols-outlined cg-item-icon\"}, \"inventory_2\"),\r\n            m(\"span\", {class: \"cg-item-text\"}, item.name ? item.name.substring(0, 6) : \"?\")\r\n        ]);\r\n    }\r\n\r\n    // Render a mini apparel card\r\n    function renderApparelCard(apparel) {\r\n        let displayName = getApparelDisplayName(apparel);\r\n        return m(\"div\", {\r\n            class: \"cg-render-apparel-card\",\r\n            style: \"width: 50px; height: 60px;\",\r\n            title: displayName\r\n        }, [\r\n            m(\"span\", {class: \"material-symbols-outlined cg-apparel-icon\"}, \"checkroom\"),\r\n            m(\"span\", {class: \"cg-apparel-text\"}, displayName.substring(0, 6))\r\n        ]);\r\n    }\r\n\r\n    // Render item statistics (itemStatistics model - damage, protection, range, etc.)\r\n    function renderItemStatistics(item) {\r\n        // Get statistics - it's a single object, not an array\r\n        let stats = item.statistics;\r\n\r\n        if (!stats) {\r\n            return m(\"div\", {class: \"mt-2 text-xs text-gray-500 text-center\"}, \"No statistics\");\r\n        }\r\n\r\n        // Item statistics properties from olio.itemStatistics model\r\n        let statProps = [\r\n            {key: 'damage', label: 'Damage', icon: 'swords', max: 20},\r\n            {key: 'protection', label: 'Protection', icon: 'shield', max: 20},\r\n            {key: 'entrapment', label: 'Entrapment', icon: 'trap', max: 20},\r\n            {key: 'range', label: 'Range', icon: 'radar', unit: 'm'},\r\n            {key: 'consumption', label: 'Consumption', icon: 'local_fire_department'},\r\n            {key: 'replenishment', label: 'Replenish', icon: 'add_circle'}\r\n        ];\r\n\r\n        // Filter to only show non-zero/non-null values\r\n        let activeProps = statProps.filter(function(p) {\r\n            return stats[p.key] !== undefined && stats[p.key] !== null && stats[p.key] !== 0;\r\n        });\r\n\r\n        // Also check for type fields\r\n        let hasConsumptionType = stats.consumptionType && stats.consumptionType.length > 0;\r\n        let hasReplenishmentType = stats.replenishmentType && stats.replenishmentType.length > 0;\r\n\r\n        if (activeProps.length === 0 && !hasConsumptionType && !hasReplenishmentType) {\r\n            return m(\"div\", {class: \"mt-2 text-xs text-gray-500 text-center\"}, \"No stat data\");\r\n        }\r\n\r\n        return m(\"div\", {class: \"mt-2 text-xs text-emerald-700 dark:text-emerald-300 overflow-y-auto\", style: \"max-height: 80px;\"}, [\r\n            // Show stat bars for numeric values\r\n            activeProps.map(function(p) {\r\n                let val = stats[p.key];\r\n                let displayVal = val;\r\n                if (p.unit) {\r\n                    displayVal = val + p.unit;\r\n                }\r\n\r\n                // For stats with max values, show a bar\r\n                if (p.max) {\r\n                    let pct = Math.min(100, (val / p.max) * 100);\r\n                    return m(\"div\", {class: \"px-1 py-0.5\"}, [\r\n                        m(\"div\", {class: \"flex items-center justify-between mb-0.5\"}, [\r\n                            m(\"span\", {class: \"flex items-center\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined mr-1\", style: \"font-size: 10px\"}, p.icon),\r\n                                m(\"span\", {}, p.label)\r\n                            ]),\r\n                            m(\"span\", {class: \"font-medium\"}, val + \"/\" + p.max)\r\n                        ]),\r\n                        m(\"div\", {class: \"w-full h-1.5 bg-gray-300 dark:bg-gray-600 rounded\"}, [\r\n                            m(\"div\", {\r\n                                class: \"h-full rounded \" + (p.key === 'damage' ? \"bg-red-500\" : p.key === 'protection' ? \"bg-blue-500\" : \"bg-yellow-500\"),\r\n                                style: \"width: \" + pct + \"%\"\r\n                            })\r\n                        ])\r\n                    ]);\r\n                }\r\n\r\n                return m(\"div\", {class: \"flex items-center justify-between px-1 py-0.5\"}, [\r\n                    m(\"span\", {class: \"flex items-center\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined mr-1\", style: \"font-size: 10px\"}, p.icon),\r\n                        m(\"span\", {}, p.label)\r\n                    ]),\r\n                    m(\"span\", {class: \"font-medium\"}, displayVal)\r\n                ]);\r\n            }),\r\n            // Show consumption/replenishment types if present\r\n            hasConsumptionType ? m(\"div\", {class: \"flex items-center justify-between px-1 py-0.5 border-t border-emerald-300 dark:border-emerald-700 mt-1 pt-1\"}, [\r\n                m(\"span\", {}, \"Consumes\"),\r\n                m(\"span\", {class: \"font-medium\"}, stats.consumptionType)\r\n            ]) : \"\",\r\n            hasReplenishmentType ? m(\"div\", {class: \"flex items-center justify-between px-1 py-0.5\"}, [\r\n                m(\"span\", {}, \"Replenishes\"),\r\n                m(\"span\", {class: \"font-medium\"}, stats.replenishmentType)\r\n            ]) : \"\"\r\n        ]);\r\n    }\r\n\r\n    // Discard Pile\r\n    function DiscardPile() {\r\n        return {\r\n            view: function() {\r\n                let topCard = discard.length > 0 ? discard[discard.length - 1] : null;\r\n                let isDropTarget = dropTarget === 'discard' && (dragSource === 'userHand' || dragSource === 'gameHand');\r\n\r\n                return m(\"div\", {\r\n                    class: \"cg-panel-transition \" + (isDropTarget ? \"bg-orange-100 dark:bg-orange-900/30\" : \"\"),\r\n                    ondragover: function(e) { handleDragOver(e, 'discard'); },\r\n                    ondragleave: handleDragLeave,\r\n                    ondrop: handleDropOnDiscard\r\n                }, [\r\n                    // Header\r\n                    m(\"div\", {class: \"flex items-center justify-between px-2 py-1 bg-orange-600 text-white\"}, [\r\n                        m(\"div\", {class: \"flex items-center space-x-1\"}, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"delete\"),\r\n                            m(\"span\", {class: \"text-sm font-medium\"}, \"Discard\"),\r\n                            m(\"span\", {class: \"text-xs opacity-75\"}, \"(\" + discard.length + \")\")\r\n                        ]),\r\n                        m(\"button\", {\r\n                            class: \"p-1 rounded hover:bg-orange-500 disabled:opacity-50\",\r\n                            onclick: reshuffleDiscard,\r\n                            disabled: discard.length === 0,\r\n                            title: \"Reshuffle into deck\"\r\n                        }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"replay\"))\r\n                    ]),\r\n\r\n                    // Stack display\r\n                    m(\"div\", {class: \"flex-1 flex items-center justify-center p-2\"}, [\r\n                        discard.length === 0 ?\r\n                            m(\"div\", {class: \"text-center text-gray-400 text-xs\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-3xl block mb-1\"}, \"delete_outline\"),\r\n                                isDropTarget ? \"Drop to discard\" : \"Empty\"\r\n                            ]) :\r\n                            m(\"div\", {class: \"relative\"}, [\r\n                                // Stack shadows with card backs\r\n                                discard.length > 2 ? m(\"div\", {\r\n                                    class: \"cg-stack-shadow-orange\",\r\n                                    style: \"width: 60px; height: 85px; top: 3px; left: 3px;\"\r\n                                }, [\r\n                                    m(\"div\", {class: \"h-full flex items-center justify-center\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-xl text-orange-400/50\"}, \"person\")\r\n                                    ])\r\n                                ]) : \"\",\r\n                                discard.length > 1 ? m(\"div\", {\r\n                                    class: \"cg-stack-shadow-orange\",\r\n                                    style: \"width: 60px; height: 85px; top: 1.5px; left: 1.5px;\"\r\n                                }, [\r\n                                    m(\"div\", {class: \"h-full flex items-center justify-center\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-xl text-orange-400/50\"}, \"person\")\r\n                                    ])\r\n                                ]) : \"\",\r\n                                // Top card (not draggable from discard)\r\n                                renderMiniCard(topCard, null, false, null, 'character')\r\n                            ])\r\n                    ]),\r\n\r\n                    // Reshuffle button\r\n                    m(\"div\", {class: \"cg-footer\"}, [\r\n                        m(\"button\", {\r\n                            class: \"w-full cg-btn-action-orange\",\r\n                            onclick: reshuffleDiscard,\r\n                            disabled: discard.length === 0\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"replay\"),\r\n                            m(\"span\", {}, \"Reshuffle\")\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Consolidated Draw Piles - Simple grid of all card type stacks\r\n    function ConsolidatedDecks() {\r\n        return {\r\n            view: function() {\r\n                // Horizontal on mobile, vertical on desktop\r\n                return m(\"div\", {class: \"cg-decks-panel\"}, [\r\n                    // Horizontal row on mobile / Vertical stack on desktop of draw piles\r\n                    m(\"div\", {class: \"cg-decks-row\"}, [\r\n                        // Character pile\r\n                        renderDrawPile(\"Characters\", \"person\", \"blue\", deck, discard, \"characterDeck\",\r\n                            function() { drawToUserHand(); }, shuffleDeck, reshuffleDiscard),\r\n\r\n                        // Action pile\r\n                        renderDrawPile(\"Actions\", \"bolt\", \"purple\", actionDeck, actionDiscard, \"actionDeck\",\r\n                            drawActionToHand, shuffleActionDeck, reshuffleActionDeck),\r\n\r\n                        // Item pile\r\n                        renderDrawPile(\"Items\", \"inventory_2\", \"emerald\", itemDeck, itemDiscard, \"itemDeck\",\r\n                            drawItemToHand, shuffleItemDeck, reshuffleItemDeck),\r\n\r\n                        // Apparel pile\r\n                        renderDrawPile(\"Apparel\", \"checkroom\", \"pink\", apparelDeck, apparelDiscard, \"apparelDeck\",\r\n                            drawApparelToHand, shuffleApparelDeck, reshuffleApparelDeck)\r\n                    ]),\r\n\r\n                    // Universal discard drop zone\r\n                    m(\"div\", {\r\n                        class: \"cg-discard-zone \" + (dropTarget === 'universalDiscard' ? \"cg-discard-active\" : \"cg-discard-inactive\"),\r\n                        style: \"min-width: 50px; min-height: 40px;\",\r\n                        ondragover: function(e) {\r\n                            e.preventDefault();\r\n                            dropTarget = 'universalDiscard';\r\n                            m.redraw();\r\n                        },\r\n                        ondragleave: function() {\r\n                            if (dropTarget === 'universalDiscard') dropTarget = null;\r\n                            m.redraw();\r\n                        },\r\n                        ondrop: function(e) {\r\n                            e.preventDefault();\r\n                            handleUniversalDiscard();\r\n                            dropTarget = null;\r\n                            m.redraw();\r\n                        }\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-lg \" + (dropTarget === 'universalDiscard' ? \"text-red-500\" : \"text-gray-500 dark:text-gray-400\")}, \"delete\")\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    function renderDrawPile(label, icon, color, deckArray, discardArray, dragSourceType, onDraw, onShuffle, onReshuffle) {\r\n        const colorMap = {\r\n            blue: {bg: 'bg-blue-600', hover: 'hover:bg-blue-500', card: 'from-blue-700 to-blue-900', border: 'border-blue-500'},\r\n            purple: {bg: 'bg-purple-600', hover: 'hover:bg-purple-500', card: 'from-purple-700 to-purple-900', border: 'border-purple-500'},\r\n            emerald: {bg: 'bg-emerald-600', hover: 'hover:bg-emerald-500', card: 'from-emerald-700 to-emerald-900', border: 'border-emerald-500'},\r\n            pink: {bg: 'bg-pink-600', hover: 'hover:bg-pink-500', card: 'from-pink-700 to-pink-900', border: 'border-pink-500'}\r\n        };\r\n        let c = colorMap[color] || colorMap.blue;\r\n        let deckCount = deckArray.length;\r\n        let discardCount = discardArray.length;\r\n        let topCard = deckCount > 0 ? deckArray[0] : null;\r\n\r\n        return m(\"div\", {class: \"cg-draw-pile\"}, [\r\n            // Label\r\n            m(\"div\", {class: \"cg-draw-pile-label\"}, label),\r\n\r\n            // Card stack visual - draggable\r\n            m(\"div\", {class: \"relative mb-1\", style: \"width: 50px; height: 65px;\"}, [\r\n                deckCount > 2 ? m(\"div\", {\r\n                    class: \"absolute rounded bg-gradient-to-b \" + c.card + \" border \" + c.border,\r\n                    style: \"width: 50px; height: 65px; top: 3px; left: 3px;\"\r\n                }) : \"\",\r\n                deckCount > 1 ? m(\"div\", {\r\n                    class: \"absolute rounded bg-gradient-to-b \" + c.card + \" border \" + c.border,\r\n                    style: \"width: 50px; height: 65px; top: 1.5px; left: 1.5px;\"\r\n                }) : \"\",\r\n                m(\"div\", {\r\n                    class: \"relative flex flex-col items-center justify-center rounded bg-gradient-to-b \" + c.card + \" border \" + c.border + \" cursor-grab \" + c.hover,\r\n                    style: \"width: 50px; height: 65px;\",\r\n                    onclick: deckCount > 0 ? onDraw : null,\r\n                    draggable: deckCount > 0,\r\n                    ondragstart: deckCount > 0 ? function(e) {\r\n                        handleDragStart(e, topCard, dragSourceType);\r\n                    } : null,\r\n                    ondragend: handleDragEnd\r\n                }, [\r\n                    m(\"span\", {class: \"material-symbols-outlined text-xl text-white/80\"}, icon),\r\n                    m(\"span\", {class: \"text-xs text-white/80 font-bold\"}, deckCount)\r\n                ])\r\n            ]),\r\n\r\n            // Buttons row\r\n            m(\"div\", {class: \"flex space-x-1\"}, [\r\n                m(\"button\", {\r\n                    class: \"cg-btn-icon\",\r\n                    onclick: onShuffle,\r\n                    disabled: deckCount === 0,\r\n                    title: \"Shuffle\"\r\n                }, m(\"span\", {class: \"material-symbols-outlined text-xs text-gray-700 dark:text-gray-300\"}, \"shuffle\")),\r\n                m(\"button\", {\r\n                    class: \"cg-btn-icon-orange\",\r\n                    onclick: onReshuffle,\r\n                    disabled: discardCount === 0,\r\n                    title: \"Reshuffle discard (\" + discardCount + \")\"\r\n                }, m(\"span\", {class: \"material-symbols-outlined text-xs\"}, \"replay\"))\r\n            ]),\r\n\r\n            // Discard count\r\n            discardCount > 0 ? m(\"div\", {class: \"text-xs text-orange-600 dark:text-orange-400 mt-0.5\"}, \"(\" + discardCount + \")\") : \"\"\r\n        ]);\r\n    }\r\n\r\n    // Item deck functions\r\n    function shuffleItemDeck() {\r\n        itemDeck = shuffleArray(itemDeck);\r\n        itemPreviewIndex = 0;\r\n        m.redraw();\r\n    }\r\n\r\n    function nextItemPreview() {\r\n        if (itemDeck.length === 0) return;\r\n        itemPreviewIndex = (itemPreviewIndex + 1) % itemDeck.length;\r\n        m.redraw();\r\n    }\r\n\r\n    function prevItemPreview() {\r\n        if (itemDeck.length === 0) return;\r\n        itemPreviewIndex = (itemPreviewIndex - 1 + itemDeck.length) % itemDeck.length;\r\n        m.redraw();\r\n    }\r\n\r\n    function drawItemToHand() {\r\n        if (itemDeck.length === 0) return;\r\n        let item = itemDeck.splice(itemPreviewIndex, 1)[0];\r\n        itemHand.push(item);\r\n        if (itemPreviewIndex >= itemDeck.length) itemPreviewIndex = 0;\r\n        page.toast(\"info\", \"Drew item: \" + (item.name || \"Unknown\"));\r\n        m.redraw();\r\n    }\r\n\r\n    function reshuffleItemDeck() {\r\n        itemDeck.push(...itemDiscard);\r\n        itemDiscard = [];\r\n        shuffleItemDeck();\r\n        page.toast(\"info\", \"Reshuffled item deck\");\r\n    }\r\n\r\n    // Apparel deck functions\r\n    function shuffleApparelDeck() {\r\n        apparelDeck = shuffleArray(apparelDeck);\r\n        apparelPreviewIndex = 0;\r\n        m.redraw();\r\n    }\r\n\r\n    function nextApparelPreview() {\r\n        if (apparelDeck.length === 0) return;\r\n        apparelPreviewIndex = (apparelPreviewIndex + 1) % apparelDeck.length;\r\n        m.redraw();\r\n    }\r\n\r\n    function prevApparelPreview() {\r\n        if (apparelDeck.length === 0) return;\r\n        apparelPreviewIndex = (apparelPreviewIndex - 1 + apparelDeck.length) % apparelDeck.length;\r\n        m.redraw();\r\n    }\r\n\r\n    function drawApparelToHand() {\r\n        if (apparelDeck.length === 0) return;\r\n        let apparel = apparelDeck.splice(apparelPreviewIndex, 1)[0];\r\n        apparelHand.push(apparel);\r\n        if (apparelPreviewIndex >= apparelDeck.length) apparelPreviewIndex = 0;\r\n        page.toast(\"info\", \"Drew apparel: \" + (apparel.name || \"Unknown\"));\r\n        m.redraw();\r\n    }\r\n\r\n    function reshuffleApparelDeck() {\r\n        apparelDeck.push(...apparelDiscard);\r\n        apparelDiscard = [];\r\n        shuffleApparelDeck();\r\n        page.toast(\"info\", \"Reshuffled apparel deck\");\r\n    }\r\n\r\n    // ==========================================\r\n    // Card View Tabs\r\n    // ==========================================\r\n\r\n    function CardViewTabs() {\r\n        return {\r\n            view: function() {\r\n                let tabs = [\r\n                    {id: 'profile', label: 'Profile', icon: 'person'},\r\n                    {id: 'stats', label: 'Stats', icon: 'bar_chart'},\r\n                    {id: 'traits', label: 'Traits', icon: 'psychology'},\r\n                    {id: 'narrative', label: 'Story', icon: 'auto_stories'},\r\n                    {id: 'instincts', label: 'Instincts', icon: 'pets'},\r\n                    {id: 'apparel', label: 'Apparel', icon: 'checkroom'}\r\n                ];\r\n\r\n                return m(\"div\", {class: \"cg-tabs-container\"}, [\r\n                    tabs.map(function(tab) {\r\n                        let isActive = cardView === tab.id;\r\n                        return m(\"button\", {\r\n                            class: isActive ? \"cg-tab-active\" : \"cg-tab-inactive\",\r\n                            onclick: function() { cardView = tab.id; m.redraw(); },\r\n                            title: tab.label\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, tab.icon),\r\n                            m(\"span\", {class: \"text-xs\"}, tab.label)\r\n                        ]);\r\n                    }),\r\n                    // Open Object Page link at bottom of tabs\r\n                    selectedCard ? m(\"a\", {\r\n                        class: \"cg-tab-link\",\r\n                        href: \"/#!/view/olio.charPerson/\" + (selectedCard.objectId || selectedCard.id || \"\"),\r\n                        target: \"_blank\",\r\n                        title: \"Open full object page in new tab\"\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"open_in_new\"),\r\n                        m(\"span\", {class: \"text-xs\"}, \"Object\")\r\n                    ]) : \"\"\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // ==========================================\r\n    // Selected Card Detail View\r\n    // ==========================================\r\n\r\n    function SelectedCardView() {\r\n        return {\r\n            view: function() {\r\n                let isDropTarget = dropTarget === 'selected' && dragSource === 'hand';\r\n\r\n                // Check if we have a detail card (action/item/apparel) selected\r\n                if (selectedDetailCard && selectedDetailType) {\r\n                    return renderDetailCardView();\r\n                }\r\n\r\n                if (!selectedCard) {\r\n                    return m(\"div\", {\r\n                        class: \"cg-empty-state \" + (isDropTarget ? \"bg-purple-100 dark:bg-purple-900/30\" : \"\"),\r\n                        ondragover: function(e) { handleDragOver(e, 'selected'); },\r\n                        ondragleave: handleDragLeave,\r\n                        ondrop: handleDropOnSelected\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-6xl mb-2\"}, \"touch_app\"),\r\n                        m(\"div\", {}, isDropTarget ? \"Drop to view card\" : \"Click a card to view\")\r\n                    ]);\r\n                }\r\n                return m(\"div\", {\r\n                    class: \"cg-panel-transition \" + (isDropTarget ? \"bg-purple-100 dark:bg-purple-900/30\" : \"\"),\r\n                    ondragover: function(e) { handleDragOver(e, 'selected'); },\r\n                    ondragleave: handleDragLeave,\r\n                    ondrop: handleDropOnSelected\r\n                }, [\r\n                    // Main content area - tabs on left, card on right\r\n                    m(\"div\", {class: \"flex-1 flex overflow-hidden\"}, [\r\n                        // Vertical tabs on left\r\n                        m(\"div\", {class: \"cg-tabs-panel\"}, [\r\n                            m(CardViewTabs)\r\n                        ]),\r\n\r\n                        // Card display\r\n                        m(\"div\", {class: \"cg-card-display\"}, [\r\n                            m(CharacterCard, {\r\n                                character: selectedCard,\r\n                                selected: true\r\n                            })\r\n                        ])\r\n                    ]),\r\n\r\n                    // Action buttons - flex-shrink-0 prevents clipping\r\n                    m(\"div\", {class: \"cg-footer-actions\"}, [\r\n                        m(\"button\", {\r\n                            class: \"cg-btn-primary\",\r\n                            onclick: function() { openCharacterView(selectedCard); }\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"open_in_full\"),\r\n                            m(\"span\", {}, \"Full View\")\r\n                        ]),\r\n                        m(\"button\", {\r\n                            class: \"cg-btn-secondary\",\r\n                            onclick: function() { refreshSelectedCard(); }\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"refresh\")\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Render detail view for action/item/apparel cards\r\n    // Uses the same layout as character card view (tabs on left, card on right)\r\n    function renderDetailCardView() {\r\n        let card = selectedDetailCard;\r\n        let type = selectedDetailType;\r\n\r\n        // Determine colors based on type\r\n        let colors = {\r\n            action: { bg: \"purple\", icon: \"bolt\" },\r\n            item: { bg: \"emerald\", icon: \"inventory_2\" },\r\n            apparel: { bg: \"pink\", icon: \"checkroom\" }\r\n        }[type] || { bg: \"gray\", icon: \"help\" };\r\n\r\n        // Check if this card is in the user's hand (draggable to tray)\r\n        let isInUserHand = false;\r\n        let handArray = null;\r\n        let handIndex = null;\r\n        if (type === 'action') {\r\n            isInUserHand = actionHand.some(a => a.id === card.id);\r\n            handArray = actionHand;\r\n            handIndex = actionHand.findIndex(a => a.id === card.id);\r\n        } else if (type === 'item') {\r\n            isInUserHand = itemHand.some(i => i.objectId === card.objectId);\r\n            handArray = itemHand;\r\n            handIndex = itemHand.findIndex(i => i.objectId === card.objectId);\r\n        } else if (type === 'apparel') {\r\n            isInUserHand = apparelHand.some(a => a.objectId === card.objectId);\r\n            handArray = apparelHand;\r\n            handIndex = apparelHand.findIndex(a => a.objectId === card.objectId);\r\n        }\r\n\r\n        // Build tabs for this card type - similar to CardViewTabs for character\r\n        let detailTabs = [\r\n            {id: 'info', label: 'Info', icon: 'info'}\r\n        ];\r\n        // Add type-specific tabs\r\n        if (type === 'item') {\r\n            // Items use itemStatistics model (damage, protection, range, etc.)\r\n            detailTabs.push({id: 'itemStats', label: 'Stats', icon: 'bar_chart'});\r\n        } else {\r\n            // Actions and apparel use generic stats tab\r\n            detailTabs.push({id: 'stats', label: 'Stats', icon: 'bar_chart'});\r\n        }\r\n\r\n        // State for detail card view tab (default to 'info')\r\n        if (!window._detailCardView) window._detailCardView = 'info';\r\n\r\n        return m(\"div\", {class: \"cg-panel-transition\"}, [\r\n            // Main content area - tabs on left, card on right (same as character view)\r\n            m(\"div\", {class: \"flex-1 flex overflow-hidden\"}, [\r\n                // Vertical tabs on left (matching character view layout)\r\n                m(\"div\", {class: \"cg-tabs-panel\"}, [\r\n                    m(\"div\", {class: \"cg-tabs-container\"}, [\r\n                        // Type header\r\n                        m(\"div\", {class: \"flex items-center space-x-1 px-2 py-1 text-\" + colors.bg + \"-600 dark:text-\" + colors.bg + \"-400 border-b border-gray-300 dark:border-gray-600 mb-1\"}, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, colors.icon),\r\n                            m(\"span\", {class: \"text-xs font-medium\"}, type.charAt(0).toUpperCase() + type.slice(1))\r\n                        ]),\r\n                        // Tab buttons\r\n                        detailTabs.map(function(tab) {\r\n                            let isActive = window._detailCardView === tab.id;\r\n                            return m(\"button\", {\r\n                                class: isActive ? \"cg-tab-active\" : \"cg-tab-inactive\",\r\n                                onclick: function() { window._detailCardView = tab.id; m.redraw(); },\r\n                                title: tab.label\r\n                            }, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-sm\"}, tab.icon),\r\n                                m(\"span\", {class: \"text-xs\"}, tab.label)\r\n                            ]);\r\n                        }),\r\n                        // Navigation if in hand with multiple cards\r\n                        isInUserHand && handArray && handArray.length > 1 ? [\r\n                            m(\"div\", {class: \"border-t border-gray-300 dark:border-gray-600 mt-2 pt-2\"}, [\r\n                                m(\"div\", {class: \"cg-nav-label text-center mb-1\"}, (handIndex + 1) + \"/\" + handArray.length),\r\n                                m(\"div\", {class: \"flex justify-center space-x-1\"}, [\r\n                                    m(\"button\", {\r\n                                        class: \"cg-nav-btn-alt\",\r\n                                        onclick: function() {\r\n                                            if (handIndex > 0) {\r\n                                                if (type === 'action') { actionHandIndex = handIndex - 1; selectActionCard(actionHand[actionHandIndex]); }\r\n                                                else if (type === 'item') { itemHandIndex = handIndex - 1; selectItemCard(itemHand[itemHandIndex]); }\r\n                                                else if (type === 'apparel') { apparelHandIndex = handIndex - 1; selectApparelCard(apparelHand[apparelHandIndex]); }\r\n                                            }\r\n                                        },\r\n                                        disabled: handIndex <= 0\r\n                                    }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"chevron_left\")),\r\n                                    m(\"button\", {\r\n                                        class: \"cg-nav-btn-alt\",\r\n                                        onclick: function() {\r\n                                            if (handIndex < handArray.length - 1) {\r\n                                                if (type === 'action') { actionHandIndex = handIndex + 1; selectActionCard(actionHand[actionHandIndex]); }\r\n                                                else if (type === 'item') { itemHandIndex = handIndex + 1; selectItemCard(itemHand[itemHandIndex]); }\r\n                                                else if (type === 'apparel') { apparelHandIndex = handIndex + 1; selectApparelCard(apparelHand[apparelHandIndex]); }\r\n                                            }\r\n                                        },\r\n                                        disabled: handIndex >= handArray.length - 1\r\n                                    }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"chevron_right\"))\r\n                                ])\r\n                            ])\r\n                        ] : \"\",\r\n                        // Open Object Page link at bottom of tabs (for items/apparel with objectId)\r\n                        (card.objectId || card.id) ? m(\"a\", {\r\n                            class: \"cg-tab-link\",\r\n                            href: \"/#!/view/olio.\" + type + \"/\" + (card.objectId || card.id),\r\n                            target: \"_blank\",\r\n                            title: \"Open full object page in new tab\"\r\n                        }, [\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"open_in_new\"),\r\n                            m(\"span\", {class: \"text-xs\"}, \"Object\")\r\n                        ]) : \"\"\r\n                    ])\r\n                ]),\r\n\r\n                // Card display area (matching character view layout)\r\n                m(\"div\", {class: \"cg-card-display\"}, [\r\n                    // Large draggable card\r\n                    m(\"div\", {\r\n                        class: \"flex flex-col items-center justify-center p-4 rounded-xl border-4 bg-gradient-to-b from-\" + colors.bg + \"-100 to-\" + colors.bg + \"-200 dark:from-\" + colors.bg + \"-800 dark:to-\" + colors.bg + \"-900 border-\" + colors.bg + \"-400 dark:border-\" + colors.bg + \"-600 shadow-lg \" + (isInUserHand ? \"cursor-grab\" : \"\"),\r\n                        style: \"width: 180px; height: 240px;\",\r\n                        draggable: isInUserHand,\r\n                        ondragstart: isInUserHand ? function(e) { handleDragStart(e, card, type + 'Hand'); } : null,\r\n                        ondragend: isInUserHand ? handleDragEnd : null\r\n                    }, [\r\n                        m(\"span\", {class: \"material-symbols-outlined text-5xl text-\" + colors.bg + \"-600 dark:text-\" + colors.bg + \"-400 mb-2\"}, card.icon || colors.icon),\r\n                        // For apparel use type, for items use name, for actions use label\r\n                        m(\"span\", {class: \"text-lg font-bold text-\" + colors.bg + \"-800 dark:text-\" + colors.bg + \"-200 text-center\"},\r\n                            type === 'action' ? (card.label || \"Unknown\") :\r\n                            type === 'apparel' ? getApparelDisplayName(card) :\r\n                            (card.name || \"Unknown\")),\r\n                        card.description ? m(\"p\", {class: \"text-xs text-\" + colors.bg + \"-700 dark:text-\" + colors.bg + \"-300 text-center mt-2 px-2 overflow-y-auto\", style: \"max-height: 100px;\"}, card.description) : \"\",\r\n                        // Show additional info based on selected tab\r\n                        window._detailCardView === 'stats' && type === 'item' && card.type ? m(\"div\", {class: \"mt-2 text-xs text-\" + colors.bg + \"-600 dark:text-\" + colors.bg + \"-400\"}, [\r\n                            m(\"span\", {class: \"font-medium\"}, \"Type: \"),\r\n                            m(\"span\", {}, card.type)\r\n                        ]) : \"\",\r\n                        window._detailCardView === 'stats' && type === 'apparel' ? m(\"div\", {class: \"mt-2 text-xs text-\" + colors.bg + \"-600 dark:text-\" + colors.bg + \"-400\"}, [\r\n                            card.type ? m(\"div\", {}, [m(\"span\", {class: \"font-medium\"}, \"Type: \"), m(\"span\", {}, card.type)]) : \"\",\r\n                            card.category ? m(\"div\", {}, [m(\"span\", {class: \"font-medium\"}, \"Category: \"), m(\"span\", {}, card.category)]) : \"\"\r\n                        ]) : \"\",\r\n                        // Item statistics tab (damage, protection, range, etc.)\r\n                        window._detailCardView === 'itemStats' && type === 'item' ? renderItemStatistics(card) : \"\"\r\n                    ]),\r\n                    // Drag hint\r\n                    isInUserHand ? m(\"div\", {class: \"mt-2 text-xs text-gray-500 flex items-center space-x-1\"}, [\r\n                        m(\"span\", {class: \"material-symbols-outlined\", style: \"font-size: 14px\"}, \"drag_indicator\"),\r\n                        m(\"span\", {}, \"Drag to tray to play\")\r\n                    ]) : \"\"\r\n                ])\r\n            ]),\r\n\r\n            // Action buttons (same position as character view)\r\n            m(\"div\", {class: \"cg-footer-actions\"}, [\r\n                isInUserHand ? m(\"button\", {\r\n                    class: \"cg-btn-warning\",\r\n                    onclick: function() {\r\n                        if (type === 'action') discardActionFromHand(card);\r\n                        else if (type === 'item') discardItemFromHand(card);\r\n                        else if (type === 'apparel') discardApparelFromHand(card);\r\n                        selectedDetailCard = null;\r\n                        selectedDetailType = null;\r\n                    }\r\n                }, [\r\n                    m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"delete\"),\r\n                    m(\"span\", {}, \"Discard\")\r\n                ]) : \"\",\r\n                m(\"button\", {\r\n                    class: \"cg-btn-secondary\",\r\n                    onclick: function() {\r\n                        selectedDetailCard = null;\r\n                        selectedDetailType = null;\r\n                        m.redraw();\r\n                    }\r\n                }, [\r\n                    m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"close\"),\r\n                    m(\"span\", {}, \"Close\")\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    // ==========================================\r\n    // Actions\r\n    // ==========================================\r\n\r\n    function shuffleDeck() {\r\n        deck = shuffleArray(deck);\r\n        previewIndex = 0;\r\n        previewCard = deck.length > 0 ? deck[0] : null;\r\n        page.toast(\"info\", \"Deck shuffled!\");\r\n        m.redraw();\r\n    }\r\n\r\n    function reshuffleDiscard() {\r\n        if (discard.length === 0) {\r\n            page.toast(\"warn\", \"No cards in discard pile\");\r\n            return;\r\n        }\r\n        deck = deck.concat(shuffleArray(discard));\r\n        discard = [];\r\n        previewIndex = 0;\r\n        previewCard = deck.length > 0 ? deck[0] : null;\r\n        page.toast(\"info\", \"Discard pile reshuffled into deck!\");\r\n        m.redraw();\r\n    }\r\n\r\n    function previewNextCard() {\r\n        if (deck.length === 0) return;\r\n        previewIndex = (previewIndex + 1) % deck.length;\r\n        previewCard = deck[previewIndex];\r\n        m.redraw();\r\n    }\r\n\r\n    function previewPrevCard() {\r\n        if (deck.length === 0) return;\r\n        previewIndex = (previewIndex - 1 + deck.length) % deck.length;\r\n        previewCard = deck[previewIndex];\r\n        m.redraw();\r\n    }\r\n\r\n    async function drawToUserHand() {\r\n        if (deck.length === 0) {\r\n            page.toast(\"warn\", \"No cards in deck\");\r\n            return;\r\n        }\r\n        if (userHand.length >= USER_HAND_LIMIT) {\r\n            page.toast(\"warn\", \"Your hand is full (limit: \" + USER_HAND_LIMIT + \")\");\r\n            return;\r\n        }\r\n        // Draw from current preview position (or top if not previewing)\r\n        let drawn = deck.splice(previewIndex, 1)[0];\r\n        // Load full character to get store reference\r\n        drawn = await loadFullCharacter(drawn);\r\n        userHand.push(drawn);\r\n        // Adjust preview index if needed\r\n        if (previewIndex >= deck.length && deck.length > 0) {\r\n            previewIndex = 0;\r\n        }\r\n        previewCard = deck.length > 0 ? deck[previewIndex] : null;\r\n\r\n        // Load character's store items and apparel\r\n        let store = await loadCharacterStore(drawn);\r\n        if (store.items.length > 0) {\r\n            itemHand.push(...store.items);\r\n        }\r\n        if (store.apparel.length > 0) {\r\n            apparelHand.push(...store.apparel);\r\n        }\r\n\r\n        // Select the drawn card\r\n        await selectCard(drawn);\r\n        page.toast(\"info\", \"Drew: \" + drawn.name);\r\n    }\r\n\r\n    async function drawToGameHand() {\r\n        if (deck.length === 0) {\r\n            page.toast(\"warn\", \"No cards in deck\");\r\n            return;\r\n        }\r\n        if (gameHand.length >= GAME_HAND_LIMIT) {\r\n            page.toast(\"warn\", \"Game hand is full (limit: \" + GAME_HAND_LIMIT + \")\");\r\n            return;\r\n        }\r\n        // Draw random card for game\r\n        let randIdx = Math.floor(Math.random() * deck.length);\r\n        let drawn = deck.splice(randIdx, 1)[0];\r\n        // Load full character to get store reference\r\n        drawn = await loadFullCharacter(drawn);\r\n        gameHand.push(drawn);\r\n        // Adjust preview index if needed\r\n        if (previewIndex >= deck.length && deck.length > 0) {\r\n            previewIndex = 0;\r\n        }\r\n        previewCard = deck.length > 0 ? deck[previewIndex] : null;\r\n\r\n        // Load character's store items and apparel\r\n        let store = await loadCharacterStore(drawn);\r\n        if (store.items.length > 0) {\r\n            systemItems.push(...store.items);\r\n        }\r\n        if (store.apparel.length > 0) {\r\n            systemApparel.push(...store.apparel);\r\n        }\r\n\r\n        page.toast(\"info\", \"Game drew: \" + drawn.name);\r\n        m.redraw();\r\n    }\r\n\r\n    function discardCard(card, source) {\r\n        if (!card) return;\r\n        // Determine which hand to remove from\r\n        let hand = source === 'gameHand' ? gameHand : userHand;\r\n        let idx = hand.findIndex(c => c.objectId === card.objectId);\r\n        if (idx > -1) {\r\n            hand.splice(idx, 1);\r\n            discard.push(card);\r\n            // Clear selection if discarded card was selected\r\n            if (selectedCard && selectedCard.objectId === card.objectId) {\r\n                selectedCard = null;\r\n            }\r\n            page.toast(\"info\", \"Discarded: \" + card.name);\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n    function discardFromUserHand() {\r\n        if (!selectedCard) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        let idx = userHand.findIndex(c => c.objectId === selectedCard.objectId);\r\n        if (idx > -1) {\r\n            discardCard(selectedCard, 'userHand');\r\n        } else {\r\n            page.toast(\"warn\", \"Selected card is not in your hand\");\r\n        }\r\n    }\r\n\r\n    function discardFromGameHand() {\r\n        if (!selectedCard) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        let idx = gameHand.findIndex(c => c.objectId === selectedCard.objectId);\r\n        if (idx > -1) {\r\n            discardCard(selectedCard, 'gameHand');\r\n        } else {\r\n            page.toast(\"warn\", \"Selected card is not in game hand\");\r\n        }\r\n    }\r\n\r\n    function discardSelectedCard() {\r\n        if (!selectedCard) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        discardCard(selectedCard);\r\n    }\r\n\r\n    async function selectCard(card) {\r\n        // Clear detail card view when selecting a character\r\n        selectedDetailCard = null;\r\n        selectedDetailType = null;\r\n        // Clear cached narrative if selecting a different character\r\n        if (!card || !selectedCard || card.objectId !== selectedCard.objectId) {\r\n            loadedNarrative = null;\r\n            loadedNarrativeCharId = null;\r\n        }\r\n        selectedCard = await loadFullCharacter(card);\r\n        m.redraw();\r\n    }\r\n\r\n    function selectHandCard(card) {\r\n        selectCard(card);\r\n    }\r\n\r\n    async function refreshSelectedCard() {\r\n        if (!selectedCard) return;\r\n        page.toast(\"info\", \"Refreshing card data...\");\r\n        am7client.clearCache(\"olio.charPerson\");\r\n        selectedCard = await loadFullCharacter(selectedCard);\r\n        page.toast(\"success\", \"Card refreshed\");\r\n        m.redraw();\r\n    }\r\n\r\n    function openCharacterView(char) {\r\n        if (!char || !char.objectId) return;\r\n        m.route.set(\"/view/olio.charPerson/\" + char.objectId);\r\n    }\r\n\r\n    function openPortraitView(char) {\r\n        if (!char || !char.profile || !char.profile.portrait) {\r\n            page.toast(\"warn\", \"No portrait available\");\r\n            return;\r\n        }\r\n        let pp = char.profile.portrait;\r\n        page.imageView(pp);\r\n    }\r\n\r\n    function toggleFullMode() {\r\n        fullMode = !fullMode;\r\n        m.redraw();\r\n    }\r\n\r\n    async function generatePortrait() {\r\n        if (!selectedCard || !selectedCard.objectId) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        // First generate narrative if not present (reimage needs it)\r\n        let narrative = selectedCard.narrative;\r\n        if (!narrative || (!narrative.physicalDescription && !narrative.outfitDescription)) {\r\n            page.toast(\"info\", \"Generating narrative first...\");\r\n            let inst = am7model.prepareInstance(selectedCard);\r\n            await am7model.forms.commands.narrate(undefined, inst);\r\n            // Reload character to get the narrative\r\n            am7client.clearCache(\"olio.charPerson\");\r\n            selectedCard = await loadFullCharacter(selectedCard);\r\n            m.redraw();\r\n        }\r\n        // Now open reimage dialog\r\n        let inst = am7model.prepareInstance(selectedCard);\r\n        page.components.dialog.reimage(selectedCard, inst);\r\n    }\r\n\r\n    async function generateNarrative() {\r\n        if (!selectedCard || !selectedCard.objectId) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        page.toast(\"info\", \"Generating narrative...\");\r\n        try {\r\n            // Use the same approach as formDef.js\r\n            let inst = am7model.prepareInstance(selectedCard);\r\n            await am7model.forms.commands.narrate(undefined, inst);\r\n            // Clear cache and reload the character\r\n            am7client.clearCache(\"olio.charPerson\");\r\n            am7client.clearCache(\"olio.narrative\");\r\n            selectedCard = await loadFullCharacter(selectedCard);\r\n            page.toast(\"success\", \"Narrative generated\");\r\n        } catch (e) {\r\n            console.error(\"Narrative generation failed:\", e);\r\n            page.toast(\"error\", \"Narrative generation failed\");\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    async function dressCharacterUp() {\r\n        if (!selectedCard || !selectedCard.objectId) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        page.toast(\"info\", \"Dressing up...\");\r\n        let inst = am7model.prepareInstance(selectedCard);\r\n        await am7olio.dressUp(selectedCard, inst, selectedCard.name);\r\n        // Clear cache and reload the character to get updated narrative\r\n        am7client.clearCache(\"olio.charPerson\");\r\n        am7client.clearCache(\"olio.apparel\");\r\n        am7client.clearCache(\"olio.store\");\r\n        selectedCard = await loadFullCharacter(selectedCard);\r\n        m.redraw();\r\n    }\r\n\r\n    async function dressCharacterDown() {\r\n        if (!selectedCard || !selectedCard.objectId) {\r\n            page.toast(\"warn\", \"No card selected\");\r\n            return;\r\n        }\r\n        page.toast(\"info\", \"Dressing down...\");\r\n        let inst = am7model.prepareInstance(selectedCard);\r\n        await am7olio.dressDown(selectedCard, inst, selectedCard.name);\r\n        // Clear cache and reload the character to get updated narrative\r\n        am7client.clearCache(\"olio.charPerson\");\r\n        am7client.clearCache(\"olio.apparel\");\r\n        am7client.clearCache(\"olio.store\");\r\n        selectedCard = await loadFullCharacter(selectedCard);\r\n        m.redraw();\r\n    }\r\n\r\n    // ==========================================\r\n    // Action Card Functions\r\n    // ==========================================\r\n\r\n    // Initialize the action deck with 2 copies of each action\r\n    function initActionDeck() {\r\n        actionDeck = [];\r\n        // Add 2 copies of each action type\r\n        ACTION_CARD_TYPES.forEach(a => {\r\n            actionDeck.push({...a, id: a.type + \"_1\"});\r\n            actionDeck.push({...a, id: a.type + \"_2\"});\r\n        });\r\n        shuffleActionDeck();\r\n        actionPreviewIndex = 0;\r\n        updateActionPreview();\r\n    }\r\n\r\n    function shuffleActionDeck() {\r\n        // Fisher-Yates shuffle\r\n        for (let i = actionDeck.length - 1; i > 0; i--) {\r\n            let j = Math.floor(Math.random() * (i + 1));\r\n            [actionDeck[i], actionDeck[j]] = [actionDeck[j], actionDeck[i]];\r\n        }\r\n        actionPreviewIndex = 0;\r\n        updateActionPreview();\r\n        m.redraw();\r\n    }\r\n\r\n    function updateActionPreview() {\r\n        if (actionDeck.length > 0 && actionPreviewIndex < actionDeck.length) {\r\n            actionPreview = actionDeck[actionPreviewIndex];\r\n        } else {\r\n            actionPreview = null;\r\n        }\r\n    }\r\n\r\n    function nextActionPreview() {\r\n        if (actionDeck.length === 0) return;\r\n        actionPreviewIndex = (actionPreviewIndex + 1) % actionDeck.length;\r\n        updateActionPreview();\r\n        m.redraw();\r\n    }\r\n\r\n    function prevActionPreview() {\r\n        if (actionDeck.length === 0) return;\r\n        actionPreviewIndex = (actionPreviewIndex - 1 + actionDeck.length) % actionDeck.length;\r\n        updateActionPreview();\r\n        m.redraw();\r\n    }\r\n\r\n    function reshuffleActionDeck() {\r\n        // Move all discarded actions back to deck and shuffle\r\n        actionDeck.push(...actionDiscard);\r\n        actionDiscard = [];\r\n        shuffleActionDeck();\r\n        page.toast(\"info\", \"Reshuffled \" + actionDeck.length + \" action cards\");\r\n    }\r\n\r\n    function drawActionToHand() {\r\n        if (actionDeck.length === 0) {\r\n            page.toast(\"warn\", \"No actions in deck\");\r\n            return;\r\n        }\r\n        // Draw the previewed card (or top card)\r\n        let card;\r\n        if (actionPreviewIndex < actionDeck.length) {\r\n            card = actionDeck.splice(actionPreviewIndex, 1)[0];\r\n        } else {\r\n            card = actionDeck.pop();\r\n        }\r\n        actionHand.push(card);\r\n        actionPreviewIndex = Math.min(actionPreviewIndex, actionDeck.length - 1);\r\n        if (actionPreviewIndex < 0) actionPreviewIndex = 0;\r\n        updateActionPreview();\r\n        page.toast(\"info\", \"Drew \" + card.label + \" to hand\");\r\n        m.redraw();\r\n    }\r\n\r\n    function selectPlayedAction(action) {\r\n        if (userHand.length === 0) {\r\n            page.toast(\"warn\", \"You need a character in your hand first\");\r\n            return;\r\n        }\r\n        if (gameHand.length === 0) {\r\n            page.toast(\"warn\", \"Game needs a character in hand first\");\r\n            return;\r\n        }\r\n\r\n        selectedAction = action;\r\n        pendingInteraction = {\r\n            type: action.type,\r\n            label: action.label,\r\n            icon: action.icon,\r\n            description: action.description,\r\n            actor: userHand[0],\r\n            interactor: null,\r\n            actionId: action.id\r\n        };\r\n\r\n        // Auto-select first game hand character as target\r\n        if (gameHand.length >= 1) {\r\n            pendingInteraction.interactor = gameHand[0];\r\n        }\r\n\r\n        // For Talk action, auto-execute if both hands have characters\r\n        if (action.type === 'TALK' && userHand.length >= 1 && gameHand.length >= 1) {\r\n            executeAction();\r\n            return;\r\n        }\r\n\r\n        page.toast(\"info\", \"Select a target character from the game hand\");\r\n        m.redraw();\r\n    }\r\n\r\n    function discardActionFromHand(action) {\r\n        let idx = actionHand.findIndex(a => a.id === action.id);\r\n        if (idx !== -1) {\r\n            actionHand.splice(idx, 1);\r\n            actionDiscard.push(action);\r\n            page.toast(\"info\", \"Discarded \" + action.label);\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function discardPlayedAction(action) {\r\n        let idx = playedActions.findIndex(a => a.id === action.id);\r\n        if (idx !== -1) {\r\n            playedActions.splice(idx, 1);\r\n            // Played actions are interaction objects, don't return the card to discard\r\n            // The card is already consumed when creating the interaction\r\n            page.toast(\"info\", \"Discarded \" + action.label);\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function discardUsedAction() {\r\n        // Discard the action that was just used\r\n        if (selectedAction && selectedAction.id) {\r\n            let idx = playedActions.findIndex(a => a.id === selectedAction.id);\r\n            if (idx !== -1) {\r\n                playedActions.splice(idx, 1);\r\n                actionDiscard.push(selectedAction);\r\n            }\r\n        }\r\n    }\r\n\r\n    function discardItemFromHand(item) {\r\n        let idx = itemHand.findIndex(i => i.objectId === item.objectId);\r\n        if (idx !== -1) {\r\n            itemHand.splice(idx, 1);\r\n            itemDiscard.push(item);\r\n            page.toast(\"info\", \"Discarded \" + (item.name || \"item\"));\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function discardItem(item) {\r\n        // Discard from tray\r\n        let idx = itemTray.findIndex(i => i.objectId === item.objectId);\r\n        if (idx !== -1) {\r\n            itemTray.splice(idx, 1);\r\n            itemDiscard.push(item);\r\n            page.toast(\"info\", \"Discarded \" + (item.name || \"item\"));\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function discardApparelFromHand(apparel) {\r\n        let idx = apparelHand.findIndex(a => a.objectId === apparel.objectId);\r\n        if (idx !== -1) {\r\n            apparelHand.splice(idx, 1);\r\n            apparelDiscard.push(apparel);\r\n            page.toast(\"info\", \"Discarded \" + (apparel.name || \"apparel\"));\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function discardApparel(apparel) {\r\n        // Discard from tray\r\n        let idx = apparelTray.findIndex(a => a.objectId === apparel.objectId);\r\n        if (idx !== -1) {\r\n            apparelTray.splice(idx, 1);\r\n            apparelDiscard.push(apparel);\r\n            page.toast(\"info\", \"Discarded \" + (apparel.name || \"apparel\"));\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function cancelAction() {\r\n        selectedAction = null;\r\n        pendingInteraction = null;\r\n        m.redraw();\r\n    }\r\n\r\n    async function executeAction() {\r\n        if (!pendingInteraction) {\r\n            page.toast(\"warn\", \"No action selected\");\r\n            return;\r\n        }\r\n\r\n        // Use already-set interactor, or selectedCard, or first game hand character\r\n        let target = pendingInteraction.interactor || selectedCard;\r\n        if (!target && gameHand.length > 0) {\r\n            target = gameHand[0];\r\n        }\r\n        if (!target || gameHand.findIndex(c => c.objectId === target.objectId) === -1) {\r\n            page.toast(\"warn\", \"Select a target from the game hand\");\r\n            return;\r\n        }\r\n\r\n        pendingInteraction.interactor = target;\r\n\r\n        let actor = pendingInteraction.actor;\r\n        let interactor = pendingInteraction.interactor;\r\n\r\n        // Handle TALK action specially - opens dialog instead of creating interaction\r\n        if (pendingInteraction.type === \"TALK\") {\r\n            // Keep TALK action - either leave in tray or move back to hand if other actions played\r\n            if (playedActions.length > 1 && selectedAction) {\r\n                // Move talk action back to hand since there are other actions in play\r\n                let idx = playedActions.findIndex(a => a.id === selectedAction.id);\r\n                if (idx !== -1) {\r\n                    let talkAction = playedActions.splice(idx, 1)[0];\r\n                    actionHand.push(talkAction);\r\n                }\r\n            }\r\n            // If only TALK is in tray, leave it there for reuse\r\n\r\n            // Reset action state before opening dialog\r\n            selectedAction = null;\r\n            pendingInteraction = null;\r\n\r\n            // Open the chat dialog\r\n            openChatDialog(actor, interactor);\r\n            return;\r\n        }\r\n\r\n        page.toast(\"info\", actor.name.split(\" \")[0] + \" uses \" + pendingInteraction.label + \" on \" + interactor.name.split(\" \")[0] + \"...\");\r\n\r\n        try {\r\n            // Create interaction object\r\n            let interaction = await createInteraction(pendingInteraction);\r\n\r\n            if (interaction) {\r\n                page.toast(\"success\", \"Interaction created: \" + pendingInteraction.label);\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to create interaction:\", e);\r\n            page.toast(\"error\", \"Failed to execute action\");\r\n        }\r\n\r\n        // Discard the used action card from tray\r\n        discardUsedAction();\r\n\r\n        // Reset action state\r\n        selectedAction = null;\r\n        pendingInteraction = null;\r\n        m.redraw();\r\n    }\r\n\r\n    async function createInteraction(pending) {\r\n        // Build the interaction object based on olio.interaction schema\r\n        let actor = pending.actor;\r\n        let interactor = pending.interactor;\r\n\r\n        // For now, create a local interaction object to demonstrate the flow\r\n        // In a full implementation, this would save to the server\r\n        let interaction = {\r\n            schema: \"olio.interaction\",\r\n            name: pending.label + \": \" + actor.name + \" -> \" + interactor.name,\r\n            description: actor.name + \" \" + pending.label.toLowerCase() + \"s \" + interactor.name,\r\n            type: pending.type.toLowerCase(),\r\n            state: \"pending\",\r\n            actorType: \"olio.charPerson\",\r\n            actor: {objectId: actor.objectId, name: actor.name},\r\n            interactorType: \"olio.charPerson\",\r\n            interactor: {objectId: interactor.objectId, name: interactor.name},\r\n            actorOutcome: \"unknown\",\r\n            interactorOutcome: \"unknown\"\r\n        };\r\n\r\n        // Determine outcome based on simple logic (could be expanded with stats comparison)\r\n        let outcomes = determineOutcome(pending.type, actor, interactor);\r\n        interaction.actorOutcome = outcomes.actorOutcome;\r\n        interaction.interactorOutcome = outcomes.interactorOutcome;\r\n        interaction.description += \" - \" + formatOutcome(outcomes);\r\n\r\n        page.toast(\"info\", formatOutcome(outcomes));\r\n\r\n        return interaction;\r\n    }\r\n\r\n    function determineOutcome(actionType, actor, interactor) {\r\n        // Simple outcome determination based on action type and random chance\r\n        // Could be expanded to use character stats, traits, etc.\r\n        let roll = Math.random();\r\n        let actorStats = actor.statistics || {};\r\n        let interactorStats = interactor.statistics || {};\r\n\r\n        let outcomes = {\r\n            actorOutcome: \"equilibrium\",\r\n            interactorOutcome: \"equilibrium\",\r\n            description: \"\"\r\n        };\r\n\r\n        // Use relevant stats based on action type\r\n        let actorStat = 10;\r\n        let interactorStat = 10;\r\n\r\n        switch (actionType) {\r\n            case \"COMBAT\":\r\n            case \"DEFEND\":\r\n                actorStat = (actorStats.physicalStrength || 10) + (actorStats.agility || 10);\r\n                interactorStat = (interactorStats.physicalStrength || 10) + (interactorStats.agility || 10);\r\n                break;\r\n            case \"COMMUNICATE\":\r\n            case \"BEFRIEND\":\r\n            case \"SOCIALIZE\":\r\n            case \"ROMANCE\":\r\n                actorStat = (actorStats.charisma || 10) + (actorStats.wisdom || 10);\r\n                interactorStat = (interactorStats.charisma || 10) + (interactorStats.wisdom || 10);\r\n                break;\r\n            case \"COERCE\":\r\n            case \"THREATEN\":\r\n                actorStat = (actorStats.mentalStrength || 10) + (actorStats.charisma || 10);\r\n                interactorStat = (interactorStats.mentalEndurance || 10) + (interactorStats.wisdom || 10);\r\n                break;\r\n            case \"BARTER\":\r\n            case \"NEGOTIATE\":\r\n                actorStat = (actorStats.intelligence || 10) + (actorStats.charisma || 10);\r\n                interactorStat = (interactorStats.intelligence || 10) + (interactorStats.wisdom || 10);\r\n                break;\r\n            case \"INVESTIGATE\":\r\n                actorStat = (actorStats.intelligence || 10) + (actorStats.wisdom || 10);\r\n                interactorStat = 10; // Target doesn't actively resist\r\n                break;\r\n            case \"MENTOR\":\r\n                actorStat = (actorStats.wisdom || 10) + (actorStats.intelligence || 10);\r\n                interactorStat = (interactorStats.intelligence || 10);\r\n                break;\r\n            default:\r\n                actorStat = actorStats.charisma || 10;\r\n                interactorStat = interactorStats.charisma || 10;\r\n        }\r\n\r\n        // Calculate outcome based on stat comparison and roll\r\n        let statDiff = actorStat - interactorStat;\r\n        let threshold = 0.5 + (statDiff / 100); // Adjust threshold by stat difference\r\n\r\n        if (roll > threshold + 0.2) {\r\n            // Very favorable for actor\r\n            outcomes.actorOutcome = \"very_favorable\";\r\n            outcomes.interactorOutcome = \"unfavorable\";\r\n            outcomes.description = \"Great success!\";\r\n        } else if (roll > threshold) {\r\n            // Favorable for actor\r\n            outcomes.actorOutcome = \"favorable\";\r\n            outcomes.interactorOutcome = \"equilibrium\";\r\n            outcomes.description = \"Success\";\r\n        } else if (roll > threshold - 0.2) {\r\n            // Equilibrium\r\n            outcomes.actorOutcome = \"equilibrium\";\r\n            outcomes.interactorOutcome = \"equilibrium\";\r\n            outcomes.description = \"Neutral outcome\";\r\n        } else if (roll > threshold - 0.4) {\r\n            // Unfavorable for actor\r\n            outcomes.actorOutcome = \"unfavorable\";\r\n            outcomes.interactorOutcome = \"favorable\";\r\n            outcomes.description = \"Failed\";\r\n        } else {\r\n            // Very unfavorable for actor\r\n            outcomes.actorOutcome = \"very_unfavorable\";\r\n            outcomes.interactorOutcome = \"very_favorable\";\r\n            outcomes.description = \"Critical failure!\";\r\n        }\r\n\r\n        return outcomes;\r\n    }\r\n\r\n    function formatOutcome(outcomes) {\r\n        return outcomes.description + \" (\" + outcomes.actorOutcome.replace(/_/g, \" \") + \")\";\r\n    }\r\n\r\n    // ==========================================\r\n    // Chat Dialog Functions\r\n    // ==========================================\r\n\r\n    async function openChatDialog(actor, target) {\r\n        if (!actor || !target) {\r\n            page.toast(\"warn\", \"Need both characters for chat\");\r\n            return;\r\n        }\r\n\r\n        chatActor = actor;\r\n        chatTarget = target;\r\n        chatMessages = [];\r\n        chatPending = false;\r\n        chatDialogOpen = true;\r\n\r\n        page.toast(\"info\", \"Setting up chat between \" + actor.name + \" and \" + target.name + \"...\");\r\n\r\n        try {\r\n            // Load available chat and prompt configs from ~/Chat\r\n            let chatDir = await page.findObject(\"auth.group\", \"DATA\", \"~/Chat\");\r\n            let chatConfigs = await am7client.list(\"olio.llm.chatConfig\", chatDir.objectId, null, 0, 0);\r\n            let promptConfigs = await am7client.list(\"olio.llm.promptConfig\", chatDir.objectId, null, 0, 0);\r\n\r\n            // Find template config \"Open Chat\" and prompt \"Chat Prompt\"\r\n            let templateCfg = chatConfigs.find(c => c.name === \"Open Chat\");\r\n            let promptCfg = promptConfigs.find(c => c.name === \"Quick Chat Prompt\");\r\n\r\n            if (!templateCfg) {\r\n                page.toast(\"error\", \"Template 'Open Chat' not found in ~/Chat\");\r\n                chatDialogOpen = false;\r\n                return;\r\n            }\r\n            if (!promptCfg) {\r\n                page.toast(\"error\", \"Prompt 'Chat Prompt' not found in ~/Chat\");\r\n                chatDialogOpen = false;\r\n                return;\r\n            }\r\n\r\n            // Create unique chat config name for this character pair\r\n            // systemCharacter = target (AI), userCharacter = actor (player)\r\n            let actorFirst = actor.firstName || actor.name.split(\" \")[0];\r\n            let targetFirst = target.firstName || target.name.split(\" \")[0];\r\n            let chatConfigName = \"CardGame: \" + actorFirst + \" x \" + targetFirst;\r\n\r\n            // Search for existing chatConfig by name (more reliable than cached list)\r\n            let chatCfg;\r\n            let q = am7view.viewQuery(\"olio.llm.chatConfig\");\r\n            q.field(\"groupId\", chatDir.id);\r\n            q.field(\"name\", chatConfigName);\r\n            q.cache(false);\r\n            let qr = await page.search(q);\r\n\r\n            if (qr && qr.results && qr.results.length > 0) {\r\n                // Use existing config\r\n                chatCfg = qr.results[0];\r\n            } else {\r\n                // Load full template to get all fields\r\n                let fullTemplate = await am7client.getFull(\"olio.llm.chatConfig\", templateCfg.objectId);\r\n\r\n                // Copy template like doCopy in object.js - copy all fields, clear identity\r\n                let newChatCfg = JSON.parse(JSON.stringify(fullTemplate));\r\n\r\n                // Clear identity fields (like doCopy)\r\n                newChatCfg.objectId = undefined;\r\n                newChatCfg.id = undefined;\r\n                newChatCfg.urn = undefined;\r\n                delete newChatCfg.vaultId;\r\n                delete newChatCfg.vaulted;\r\n                delete newChatCfg.keyId;\r\n\r\n                // Set new location and name\r\n                newChatCfg.groupId = chatDir.id;\r\n                newChatCfg.groupPath = chatDir.path;\r\n                newChatCfg.name = chatConfigName;\r\n\r\n                // Assign characters: target = system (AI), actor = user (player)\r\n                newChatCfg.systemCharacter = { objectId: target.objectId };\r\n                newChatCfg.userCharacter = { objectId: actor.objectId };\r\n\r\n                // Create the new chatConfig\r\n                chatCfg = await page.createObject(newChatCfg);\r\n                if (!chatCfg) {\r\n                    page.toast(\"error\", \"Failed to create chat config\");\r\n                    chatDialogOpen = false;\r\n                    return;\r\n                }\r\n                page.toast(\"success\", \"Created chat config: \" + chatConfigName);\r\n            }\r\n\r\n            // Create chat request name\r\n            let requestName = \"CardGame Chat: \" + actorFirst + \" x \" + targetFirst;\r\n\r\n            // Search for existing chat request first\r\n            let reqDir = await page.findObject(\"auth.group\", \"data\", \"~/ChatRequests\");\r\n            let reqQuery = am7view.viewQuery(\"olio.llm.chatRequest\");\r\n            reqQuery.field(\"groupId\", reqDir.id);\r\n            reqQuery.field(\"name\", requestName);\r\n            reqQuery.cache(false);\r\n            reqQuery.entity.request.push(\"session\", \"sessionType\", \"chatConfig\", \"promptConfig\", \"objectId\");\r\n            let reqResult = await page.search(reqQuery);\r\n\r\n            if (reqResult && reqResult.results && reqResult.results.length > 0) {\r\n                // Use existing chat request\r\n                chatSession = reqResult.results[0];\r\n            } else {\r\n                // Create new chat request\r\n                let chatReq = {\r\n                    schema: \"olio.llm.chatRequest\",\r\n                    name: requestName,\r\n                    chatConfig: { objectId: chatCfg.objectId },\r\n                    promptConfig: { objectId: promptCfg.objectId },\r\n                    uid: page.uid()\r\n                };\r\n\r\n                chatSession = await m.request({\r\n                    method: 'POST',\r\n                    url: g_application_path + \"/rest/chat/new\",\r\n                    withCredentials: true,\r\n                    body: chatReq\r\n                });\r\n            }\r\n\r\n            if (chatSession) {\r\n                // Get chat history\r\n                let historyReq = {\r\n                    schema: chatSession[am7model.jsonModelKey],\r\n                    objectId: chatSession.objectId,\r\n                    uid: page.uid()\r\n                };\r\n                let history = await m.request({\r\n                    method: 'POST',\r\n                    url: g_application_path + \"/rest/chat/history\",\r\n                    withCredentials: true,\r\n                    body: historyReq\r\n                });\r\n                chatMessages = history?.messages || [];\r\n            }\r\n\r\n            m.redraw();\r\n        } catch (e) {\r\n            console.error(\"Failed to setup chat:\", e);\r\n            page.toast(\"error\", \"Failed to setup chat\");\r\n            chatDialogOpen = false;\r\n        }\r\n    }\r\n\r\n    function closeChatDialog() {\r\n        chatDialogOpen = false;\r\n        chatSession = null;\r\n        chatMessages = [];\r\n        chatActor = null;\r\n        chatTarget = null;\r\n        m.redraw();\r\n    }\r\n\r\n    async function sendChatMessage(message) {\r\n        if (!chatSession || chatPending) {\r\n            return;\r\n        }\r\n\r\n        chatPending = true;\r\n        // Only add user message to display if there's actual content\r\n        if (message.trim()) {\r\n            chatMessages.push({ role: \"user\", content: message });\r\n        }\r\n        m.redraw();\r\n\r\n        try {\r\n            let chatReq = {\r\n                schema: chatSession[am7model.jsonModelKey],\r\n                objectId: chatSession.objectId,\r\n                uid: page.uid(),\r\n                message: message\r\n            };\r\n\r\n            let response = await m.request({\r\n                method: 'POST',\r\n                url: g_application_path + \"/rest/chat/text\",\r\n                withCredentials: true,\r\n                body: chatReq\r\n            });\r\n\r\n            if (response && response.messages) {\r\n                chatMessages = response.messages;\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Chat error:\", e);\r\n            page.toast(\"error\", \"Chat request failed\");\r\n        }\r\n\r\n        chatPending = false;\r\n        m.redraw();\r\n    }\r\n\r\n    // Chat Panel Component - inline in center column (not a modal)\r\n    function ChatPanel() {\r\n        let inputMessage = \"\";\r\n        let autoStartTimeout = null;\r\n        let userStartedTyping = false;\r\n        let lastMessageCount = -1;\r\n\r\n        function scrollToLastMessage() {\r\n            let container = document.getElementById(\"chatMessagesContainer\");\r\n            if (!container) return;\r\n            let msgs = container.querySelectorAll(\":scope > div\");\r\n            if (msgs.length > 0 && lastMessageCount !== msgs.length) {\r\n                lastMessageCount = msgs.length;\r\n                msgs[msgs.length - 1].scrollIntoView({ behavior: \"smooth\" });\r\n            }\r\n        }\r\n\r\n        function clearAutoStartTimeout() {\r\n            if (autoStartTimeout) {\r\n                clearTimeout(autoStartTimeout);\r\n                autoStartTimeout = null;\r\n            }\r\n        }\r\n\r\n        function setupAutoStartTimeout() {\r\n            // Only set timeout if no chat history and user hasn't started typing\r\n\r\n            if (chatMessages.length === 0 && !userStartedTyping && !chatPending) {\r\n                // Random timeout between 1-15 seconds\r\n                let delay = Math.floor(Math.random() * 14000) + 1000;\r\n                page.toast(\"info\", \"chat in \" + delay, delay);\r\n                autoStartTimeout = setTimeout(function() {\r\n                    if (!userStartedTyping && chatMessages.length === 0 && !chatPending) {\r\n                        // Submit empty string to let assistant start\r\n                        sendChatMessage(\"\");\r\n                    }\r\n                }, delay);\r\n            }\r\n        }\r\n\r\n        return {\r\n            oninit: function() {\r\n                userStartedTyping = false;\r\n                setupAutoStartTimeout();\r\n            },\r\n            onremove: function() {\r\n                clearAutoStartTimeout();\r\n            },\r\n            onupdate: function() {\r\n                scrollToLastMessage();\r\n            },\r\n            view: function() {\r\n                let actorUrl = getPortraitUrl(chatActor, \"96x96\");\r\n                let targetUrl = getPortraitUrl(chatTarget, \"96x96\");\r\n\r\n                return m(\"div\", {class: \"flex flex-col h-full bg-white dark:bg-gray-800\"}, [\r\n                    // Header with character portraits - clickable to select character\r\n                    m(\"div\", {class: \"cg-chat-header\"}, [\r\n                        m(\"div\", {class: \"flex items-center space-x-3\"}, [\r\n                            // Actor (user's character) - clickable\r\n                            m(\"div\", {\r\n                                class: \"cg-chat-character-btn -ml-2\",\r\n                                onclick: function() {\r\n                                    if (chatActor) {\r\n                                        selectCard(chatActor);\r\n                                    }\r\n                                },\r\n                                title: \"View \" + (chatActor?.name || \"actor\")\r\n                            }, [\r\n                                actorUrl ?\r\n                                    m(\"img\", {src: actorUrl, class: \"w-8 h-8 rounded-full border-2 border-white\"}) :\r\n                                    m(\"span\", {class: \"material-symbols-outlined text-xl\"}, \"person\"),\r\n                                m(\"span\", {class: \"text-sm font-medium\"}, chatActor?.name?.split(\" \")[0] || \"Actor\")\r\n                            ]),\r\n                            m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"swap_horiz\"),\r\n                            // Target (system's character) - clickable\r\n                            m(\"div\", {\r\n                                class: \"cg-chat-character-btn\",\r\n                                onclick: function() {\r\n                                    if (chatTarget) {\r\n                                        selectCard(chatTarget);\r\n                                    }\r\n                                },\r\n                                title: \"View \" + (chatTarget?.name || \"target\")\r\n                            }, [\r\n                                targetUrl ?\r\n                                    m(\"img\", {src: targetUrl, class: \"w-8 h-8 rounded-full border-2 border-white\"}) :\r\n                                    m(\"span\", {class: \"material-symbols-outlined text-xl\"}, \"person\"),\r\n                                m(\"span\", {class: \"text-sm font-medium\"}, chatTarget?.name?.split(\" \")[0] || \"Target\")\r\n                            ])\r\n                        ]),\r\n                        m(\"button\", {\r\n                            class: \"p-1 rounded hover:bg-purple-500\",\r\n                            onclick: closeChatDialog,\r\n                            title: \"Close chat\"\r\n                        }, m(\"span\", {class: \"material-symbols-outlined\"}, \"close\"))\r\n                    ]),\r\n\r\n                    // Messages area\r\n                    m(\"div\", {id: \"chatMessagesContainer\", class: \"cg-chat-messages\"}, [\r\n                        chatMessages.length === 0 ?\r\n                            m(\"div\", {class: \"text-center text-gray-500 dark:text-gray-400 py-8\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined text-4xl block mb-2\"}, \"forum\"),\r\n                                m(\"div\", {}, \"Start a conversation...\")\r\n                            ]) :\r\n                            chatMessages.map(function(msg, idx) {\r\n                                let isUser = msg.role === \"user\";\r\n                                let isAssistant = msg.role === \"assistant\";\r\n                                if (!isUser && !isAssistant) return \"\"; // Skip system messages\r\n\r\n                                return m(\"div\", {\r\n                                    class: \"flex \" + (isUser ? \"justify-end\" : \"justify-start\"),\r\n                                    key: idx\r\n                                }, [\r\n                                    m(\"div\", {\r\n                                        class: \"max-w-[85%] px-3 py-2 rounded-lg text-sm \" +\r\n                                            (isUser ?\r\n                                                \"bg-purple-600 text-white rounded-br-none\" :\r\n                                                \"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-bl-none\")\r\n                                    }, [\r\n                                        m(\"div\", {class: \"text-xs opacity-70 mb-0.5\"},\r\n                                            isUser ? (chatActor?.name?.split(\" \")[0] || \"You\") : (chatTarget?.name?.split(\" \")[0] || \"AI\")),\r\n                                        m(\"div\", {class: \"whitespace-pre-wrap\"}, msg.content)\r\n                                    ])\r\n                                ]);\r\n                            })\r\n                    ]),\r\n\r\n                    // Pending indicator\r\n                    chatPending ? m(\"div\", {class: \"cg-chat-pending\"}, [\r\n                        m(\"div\", {class: \"flex items-center space-x-2 text-gray-500 dark:text-gray-400 text-sm\"}, [\r\n                            m(\"div\", {class: \"animate-pulse\"}, \"...\"),\r\n                            m(\"span\", {}, chatTarget?.name?.split(\" \")[0] + \" is typing...\")\r\n                        ])\r\n                    ]) : \"\",\r\n\r\n                    // Input area - pb-14 ensures visibility above bottom navigation bar\r\n                    m(\"div\", {class: \"cg-chat-input-area\"}, [\r\n                        m(\"div\", {class: \"flex space-x-2\"}, [\r\n                            m(\"input\", {\r\n                                type: \"text\",\r\n                                class: \"cg-chat-input text-sm focus:ring-2 focus:ring-purple-500\",\r\n                                placeholder: \"Type a message...\",\r\n                                value: inputMessage,\r\n                                disabled: chatPending,\r\n                                oninput: function(e) {\r\n                                    inputMessage = e.target.value;\r\n                                    // Cancel auto-start timeout when user starts typing\r\n                                    if (!userStartedTyping && inputMessage.length > 0) {\r\n                                        userStartedTyping = true;\r\n                                        clearAutoStartTimeout();\r\n                                    }\r\n                                },\r\n                                onkeydown: function(e) {\r\n                                    if (e.key === \"Enter\" && !e.shiftKey && inputMessage.trim()) {\r\n                                        sendChatMessage(inputMessage);\r\n                                        inputMessage = \"\";\r\n                                    }\r\n                                }\r\n                            }),\r\n                            m(\"button\", {\r\n                                class: \"cg-chat-send-btn\",\r\n                                disabled: chatPending || !inputMessage.trim(),\r\n                                onclick: function() {\r\n                                    if (inputMessage.trim()) {\r\n                                        sendChatMessage(inputMessage);\r\n                                        inputMessage = \"\";\r\n                                    }\r\n                                }\r\n                            }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"send\"))\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Keep ChatDialog for backwards compatibility but it now returns empty (ChatPanel is used inline)\r\n    function ChatDialog() {\r\n        return {\r\n            view: function() {\r\n                return \"\"; // Chat is now inline in the center panel\r\n            }\r\n        };\r\n    }\r\n\r\n    // ==========================================\r\n    // Save Game Functions\r\n    // ==========================================\r\n\r\n    function getGameState() {\r\n        // Capture current game state for saving\r\n        return {\r\n            version: 2,\r\n            timestamp: new Date().toISOString(),\r\n            // Character cards - store objectIds for reference\r\n            deck: deck.map(c => c.objectId),\r\n            userHand: userHand.map(c => c.objectId),\r\n            gameHand: gameHand.map(c => c.objectId),\r\n            discard: discard.map(c => c.objectId),\r\n            // Action cards - store full action data since they're local\r\n            actionDeck: actionDeck.map(a => ({type: a.type, id: a.id})),\r\n            playedActions: playedActions.map(a => ({type: a.type, id: a.id})),\r\n            actionDiscard: actionDiscard.map(a => ({type: a.type, id: a.id})),\r\n            // Item cards - store objectIds\r\n            itemDeck: itemDeck.map(i => i.objectId),\r\n            itemHand: itemHand.map(i => i.objectId),\r\n            itemDiscard: itemDiscard.map(i => i.objectId),\r\n            // Apparel cards - store objectIds\r\n            apparelDeck: apparelDeck.map(a => a.objectId),\r\n            apparelHand: apparelHand.map(a => a.objectId),\r\n            apparelDiscard: apparelDiscard.map(a => a.objectId),\r\n            // Selected state\r\n            selectedCardId: selectedCard ? selectedCard.objectId : null,\r\n            previewIndex: previewIndex,\r\n            actionPreviewIndex: actionPreviewIndex,\r\n            itemPreviewIndex: itemPreviewIndex,\r\n            apparelPreviewIndex: apparelPreviewIndex,\r\n            activePile: activePile\r\n        };\r\n    }\r\n\r\n    async function loadGameState(state) {\r\n        if (!state || (state.version !== 1 && state.version !== 2)) {\r\n            page.toast(\"error\", \"Invalid save game format\");\r\n            return false;\r\n        }\r\n\r\n        try {\r\n            // Load all data first\r\n            await loadCharacters();\r\n            await loadItems();\r\n            await loadApparel();\r\n\r\n            // Helper to find character by objectId\r\n            function findChar(objectId) {\r\n                return deck.find(c => c.objectId === objectId) ||\r\n                       userHand.find(c => c.objectId === objectId) ||\r\n                       gameHand.find(c => c.objectId === objectId) ||\r\n                       discard.find(c => c.objectId === objectId);\r\n            }\r\n\r\n            // Rebuild character piles from saved objectIds\r\n            let allChars = [...deck, ...userHand, ...gameHand, ...discard];\r\n            deck = [];\r\n            userHand = [];\r\n            gameHand = [];\r\n            discard = [];\r\n\r\n            // Restore deck\r\n            state.deck.forEach(id => {\r\n                let char = allChars.find(c => c.objectId === id);\r\n                if (char) deck.push(char);\r\n            });\r\n\r\n            // Restore hands\r\n            state.userHand.forEach(id => {\r\n                let char = allChars.find(c => c.objectId === id);\r\n                if (char) userHand.push(char);\r\n            });\r\n            state.gameHand.forEach(id => {\r\n                let char = allChars.find(c => c.objectId === id);\r\n                if (char) gameHand.push(char);\r\n            });\r\n\r\n            // Restore discard\r\n            state.discard.forEach(id => {\r\n                let char = allChars.find(c => c.objectId === id);\r\n                if (char) discard.push(char);\r\n            });\r\n\r\n            // Helper to rebuild action card from saved data\r\n            function rebuildAction(saved) {\r\n                let template = ACTION_CARD_TYPES.find(a => a.type === saved.type);\r\n                if (template) {\r\n                    return {...template, id: saved.id};\r\n                }\r\n                return null;\r\n            }\r\n\r\n            // Restore action piles\r\n            actionDeck = state.actionDeck.map(rebuildAction).filter(a => a);\r\n            playedActions = state.playedActions.map(rebuildAction).filter(a => a);\r\n            actionDiscard = state.actionDiscard.map(rebuildAction).filter(a => a);\r\n\r\n            // Restore item piles (version 2+)\r\n            if (state.version >= 2 && state.itemDeck) {\r\n                let allItems = [...itemDeck, ...itemHand, ...itemDiscard];\r\n                itemDeck = [];\r\n                itemHand = [];\r\n                itemDiscard = [];\r\n\r\n                state.itemDeck.forEach(id => {\r\n                    let item = allItems.find(i => i.objectId === id);\r\n                    if (item) itemDeck.push(item);\r\n                });\r\n                state.itemHand.forEach(id => {\r\n                    let item = allItems.find(i => i.objectId === id);\r\n                    if (item) itemHand.push(item);\r\n                });\r\n                state.itemDiscard.forEach(id => {\r\n                    let item = allItems.find(i => i.objectId === id);\r\n                    if (item) itemDiscard.push(item);\r\n                });\r\n            }\r\n\r\n            // Restore apparel piles (version 2+)\r\n            if (state.version >= 2 && state.apparelDeck) {\r\n                let allApparel = [...apparelDeck, ...apparelHand, ...apparelDiscard];\r\n                apparelDeck = [];\r\n                apparelHand = [];\r\n                apparelDiscard = [];\r\n\r\n                state.apparelDeck.forEach(id => {\r\n                    let app = allApparel.find(a => a.objectId === id);\r\n                    if (app) apparelDeck.push(app);\r\n                });\r\n                state.apparelHand.forEach(id => {\r\n                    let app = allApparel.find(a => a.objectId === id);\r\n                    if (app) apparelHand.push(app);\r\n                });\r\n                state.apparelDiscard.forEach(id => {\r\n                    let app = allApparel.find(a => a.objectId === id);\r\n                    if (app) apparelDiscard.push(app);\r\n                });\r\n            }\r\n\r\n            // Restore selection state\r\n            previewIndex = state.previewIndex || 0;\r\n            actionPreviewIndex = state.actionPreviewIndex || 0;\r\n            itemPreviewIndex = state.itemPreviewIndex || 0;\r\n            apparelPreviewIndex = state.apparelPreviewIndex || 0;\r\n            activePile = state.activePile || 'character';\r\n            updateActionPreview();\r\n\r\n            if (state.selectedCardId) {\r\n                let char = findChar(state.selectedCardId);\r\n                if (char) {\r\n                    // Load full character data including statistics\r\n                    selectedCard = await loadFullCharacter(char);\r\n                } else {\r\n                    selectedCard = null;\r\n                }\r\n            } else {\r\n                selectedCard = null;\r\n            }\r\n\r\n            // Update preview\r\n            previewCard = deck.length > 0 ? deck[previewIndex] : null;\r\n\r\n            page.toast(\"success\", \"Game loaded\");\r\n            m.redraw();\r\n            return true;\r\n        } catch (e) {\r\n            console.error(\"Failed to load game state:\", e);\r\n            page.toast(\"error\", \"Failed to load game\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    async function loadSavedGames() {\r\n        try {\r\n            let saveDir = await page.makePath(\"auth.group\", \"data\", \"~/Saved Games\");\r\n            let saves = await am7client.list(\"data.data\", saveDir.objectId, null, 0, 0);\r\n            savedGames = saves || [];\r\n            m.redraw();\r\n        } catch (e) {\r\n            console.error(\"Failed to load saved games:\", e);\r\n            savedGames = [];\r\n        }\r\n    }\r\n\r\n    async function saveGame(name) {\r\n        if (!name || !name.trim()) {\r\n            page.toast(\"warn\", \"Please enter a save name\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            let saveDir = await page.makePath(\"auth.group\", \"data\", \"~/Saved Games\");\r\n            let state = getGameState();\r\n            let stateJson = JSON.stringify(state);\r\n\r\n            // Check if save with this name exists\r\n            let existing = savedGames.find(s => s.name === name.trim());\r\n\r\n            if (existing) {\r\n                // Update existing save\r\n                existing.dataBytesStore = btoa(stateJson);\r\n                await page.patchObject({\r\n                    schema: \"data.data\",\r\n                    id: existing.id,\r\n                    dataBytesStore: existing.dataBytesStore\r\n                });\r\n                currentSave = existing;\r\n                page.toast(\"success\", \"Game saved: \" + name);\r\n            } else {\r\n                // Create new save\r\n                let saveInst = am7model.newInstance(\"data.data\");\r\n                saveInst.api.groupId(saveDir.id);\r\n                saveInst.api.groupPath(saveDir.path);\r\n                saveInst.api.name(name.trim());\r\n                saveInst.api.contentType(\"application/json\");\r\n                saveInst.entity.dataBytesStore = btoa(stateJson);\r\n\r\n                let saved = await page.createObject(saveInst.entity);\r\n                if (saved) {\r\n                    currentSave = saved;\r\n                    page.toast(\"success\", \"Game saved: \" + name);\r\n                    await loadSavedGames();\r\n                } else {\r\n                    page.toast(\"error\", \"Failed to create save\");\r\n                }\r\n            }\r\n\r\n            saveDialogOpen = false;\r\n            m.redraw();\r\n        } catch (e) {\r\n            console.error(\"Failed to save game:\", e);\r\n            page.toast(\"error\", \"Failed to save game\");\r\n        }\r\n    }\r\n\r\n    async function loadGame(save) {\r\n        if (!save) return;\r\n\r\n        try {\r\n            // Get full save data\r\n            let fullSave = await am7client.getFull(\"data.data\", save.objectId);\r\n            if (!fullSave || !fullSave.dataBytesStore) {\r\n                page.toast(\"error\", \"Save data not found\");\r\n                return;\r\n            }\r\n\r\n            let stateJson = atob(fullSave.dataBytesStore);\r\n            let state = JSON.parse(stateJson);\r\n\r\n            let success = await loadGameState(state);\r\n            if (success) {\r\n                currentSave = save;\r\n                saveDialogOpen = false;\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Failed to load game:\", e);\r\n            page.toast(\"error\", \"Failed to load game\");\r\n        }\r\n    }\r\n\r\n    async function deleteGame(save) {\r\n        if (!save) return;\r\n\r\n        try {\r\n            await page.deleteObject(\"data.data\", save.objectId);\r\n            page.toast(\"success\", \"Deleted: \" + save.name);\r\n\r\n            if (currentSave && currentSave.objectId === save.objectId) {\r\n                currentSave = null;\r\n            }\r\n\r\n            await loadSavedGames();\r\n        } catch (e) {\r\n            console.error(\"Failed to delete save:\", e);\r\n            page.toast(\"error\", \"Failed to delete save\");\r\n        }\r\n    }\r\n\r\n    async function newGame() {\r\n        // Reset all game state\r\n        currentSave = null;\r\n        deck = [];\r\n        userHand = [];\r\n        gameHand = [];\r\n        discard = [];\r\n        selectedCard = null;\r\n        previewCard = null;\r\n        previewIndex = 0;\r\n\r\n        // Reset action state\r\n        playedActions = [];\r\n        actionDiscard = [];\r\n        selectedAction = null;\r\n        pendingInteraction = null;\r\n\r\n        // Reset item state\r\n        itemDeck = [];\r\n        itemHand = [];\r\n        itemDiscard = [];\r\n        itemPreviewIndex = 0;\r\n\r\n        // Reset apparel state\r\n        apparelDeck = [];\r\n        apparelHand = [];\r\n        apparelDiscard = [];\r\n        apparelPreviewIndex = 0;\r\n\r\n        // Reload all decks\r\n        await loadCharacters();\r\n        await loadItems();\r\n        await loadApparel();\r\n        initActionDeck();\r\n\r\n        // Deal initial cards\r\n        await newDeal();\r\n\r\n        saveDialogOpen = false;\r\n        page.toast(\"info\", \"New game started with initial deal\");\r\n        m.redraw();\r\n    }\r\n\r\n    // Create an interaction object from an action card\r\n    function createInteractionFromAction(action) {\r\n        return {\r\n            id: action.id + '_' + Date.now() + '_' + Math.random().toString(36).substring(2, 11),\r\n            type: action.type,\r\n            label: action.label,\r\n            icon: action.icon,\r\n            description: action.description,\r\n            cardId: action.id,\r\n            timestamp: Date.now(),\r\n            isDefault: action.isDefault || false  // Track if this is an auto-played default action\r\n        };\r\n    }\r\n\r\n    // Auto-play a Talk card to both trays (special rule: Talk is always available)\r\n    function autoPlayTalkCards() {\r\n        // Find and play a Talk card for user\r\n        let userTalkIdx = actionDeck.findIndex(a => a.type === 'TALK');\r\n        if (userTalkIdx > -1) {\r\n            let talkCard = actionDeck.splice(userTalkIdx, 1)[0];\r\n            talkCard.isDefault = true;  // Mark as default/permanent\r\n            let interaction = createInteractionFromAction(talkCard);\r\n            playedActions.push(interaction);\r\n        }\r\n\r\n        // Find and play a Talk card for system\r\n        let sysTalkIdx = actionDeck.findIndex(a => a.type === 'TALK');\r\n        if (sysTalkIdx > -1) {\r\n            let talkCard = actionDeck.splice(sysTalkIdx, 1)[0];\r\n            talkCard.isDefault = true;\r\n            let interaction = createInteractionFromAction(talkCard);\r\n            systemPlayedActions.push(interaction);\r\n        }\r\n    }\r\n\r\n    async function newDeal() {\r\n        // New deal for BOTH user and game:\r\n        // Each gets: 1 character, 1 auto-played Talk, 3 random actions\r\n        // Items and apparel come from the character's store\r\n        page.toast(\"info\", \"Dealing hands...\");\r\n\r\n        // Shuffle all decks first\r\n        deck = shuffleArray(deck);\r\n        actionDeck = shuffleArray(actionDeck);\r\n        itemDeck = shuffleArray(itemDeck);\r\n        apparelDeck = shuffleArray(apparelDeck);\r\n\r\n        // SPECIAL RULE: Auto-play Talk cards to both trays first\r\n        autoPlayTalkCards();\r\n\r\n        // Deal 1 character to user hand and load their store items/apparel\r\n        let userChar = null;\r\n        if (deck.length > 0 && userHand.length < USER_HAND_LIMIT) {\r\n            userChar = deck.splice(0, 1)[0];\r\n            // Load full character to get store reference\r\n            userChar = await loadFullCharacter(userChar);\r\n            userHand.push(userChar);\r\n            await selectCard(userChar);\r\n\r\n            // Load character's store items and apparel\r\n            let userStore = await loadCharacterStore(userChar);\r\n            if (userStore.items.length > 0) {\r\n                itemHand.push(...userStore.items);\r\n            }\r\n            if (userStore.apparel.length > 0) {\r\n                apparelHand.push(...userStore.apparel);\r\n            }\r\n        }\r\n\r\n        // Deal 1 character to game hand and load their store items/apparel\r\n        let gameChar = null;\r\n        if (deck.length > 0 && gameHand.length < GAME_HAND_LIMIT) {\r\n            gameChar = deck.splice(0, 1)[0];\r\n            // Load full character to get store reference\r\n            gameChar = await loadFullCharacter(gameChar);\r\n            gameHand.push(gameChar);\r\n\r\n            // Load character's store items and apparel\r\n            let gameStore = await loadCharacterStore(gameChar);\r\n            if (gameStore.items.length > 0) {\r\n                systemItems.push(...gameStore.items);\r\n            }\r\n            if (gameStore.apparel.length > 0) {\r\n                systemApparel.push(...gameStore.apparel);\r\n            }\r\n        }\r\n\r\n        // Deal 3 random action cards to user's hand (excluding Talk since it's auto-played)\r\n        for (let i = 0; i < 3 && actionDeck.length > 0; i++) {\r\n            let randIdx = Math.floor(Math.random() * actionDeck.length);\r\n            let action = actionDeck.splice(randIdx, 1)[0];\r\n            actionHand.push(action);\r\n        }\r\n\r\n        // System only gets Talk auto-played to tray, no cards in hand\r\n\r\n        // Update preview indices\r\n        previewIndex = 0;\r\n        previewCard = deck.length > 0 ? deck[0] : null;\r\n        actionPreviewIndex = 0;\r\n        updateActionPreview();\r\n        itemPreviewIndex = 0;\r\n        apparelPreviewIndex = 0;\r\n\r\n        m.redraw();\r\n    }\r\n\r\n    async function openSaveDialog(mode) {\r\n        saveDialogMode = mode || 'list';\r\n        await loadSavedGames();\r\n        // Default name: current save name if exists, otherwise \"Save #(count+1)\"\r\n        if (currentSave) {\r\n            newSaveName = currentSave.name;\r\n        } else {\r\n            newSaveName = \"Save #\" + (savedGames.length + 1);\r\n        }\r\n        saveDialogOpen = true;\r\n        m.redraw();\r\n    }\r\n\r\n    function closeSaveDialog() {\r\n        saveDialogOpen = false;\r\n        m.redraw();\r\n    }\r\n\r\n    // Save Game Dialog Component\r\n    function SaveGameDialog() {\r\n        return {\r\n            view: function() {\r\n                if (!saveDialogOpen) return \"\";\r\n\r\n                return m(\"div\", {\r\n                    class: \"cg-modal-overlay\",\r\n                    onclick: function(e) { if (e.target === e.currentTarget) closeSaveDialog(); }\r\n                }, [\r\n                    m(\"div\", {\r\n                        class: \"cg-modal-content\",\r\n                        style: \"height: 400px;\",\r\n                        onclick: function(e) { e.stopPropagation(); }\r\n                    }, [\r\n                        // Header\r\n                        m(\"div\", {class: \"cg-modal-header\"}, [\r\n                            m(\"div\", {class: \"flex items-center space-x-2\"}, [\r\n                                m(\"span\", {class: \"material-symbols-outlined\"}, \"save\"),\r\n                                m(\"span\", {class: \"font-medium\"},\r\n                                    saveDialogMode === 'save' ? \"Save Game\" :\r\n                                    saveDialogMode === 'new' ? \"New Game\" : \"Load Game\")\r\n                            ]),\r\n                            m(\"button\", {\r\n                                class: \"p-1 rounded hover:bg-blue-500\",\r\n                                onclick: closeSaveDialog\r\n                            }, m(\"span\", {class: \"material-symbols-outlined\"}, \"close\"))\r\n                        ]),\r\n\r\n                        // Mode buttons (fixed, not scrollable)\r\n                        m(\"div\", {class: \"flex-shrink-0 flex space-x-2 p-4 pb-2\"}, [\r\n                            m(\"button\", {\r\n                                class: \"flex-1 px-3 py-2 rounded text-sm \" +\r\n                                    (saveDialogMode === 'list' ? \"bg-blue-600 text-white\" : \"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200\"),\r\n                                onclick: function() { saveDialogMode = 'list'; }\r\n                            }, \"Load\"),\r\n                            m(\"button\", {\r\n                                class: \"flex-1 px-3 py-2 rounded text-sm \" +\r\n                                    (saveDialogMode === 'save' ? \"bg-blue-600 text-white\" : \"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200\"),\r\n                                onclick: function() { saveDialogMode = 'save'; }\r\n                            }, \"Save\"),\r\n                            m(\"button\", {\r\n                                class: \"flex-1 px-3 py-2 rounded text-sm \" +\r\n                                    (saveDialogMode === 'new' ? \"bg-blue-600 text-white\" : \"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200\"),\r\n                                onclick: function() { saveDialogMode = 'new'; }\r\n                            }, \"New\")\r\n                        ]),\r\n\r\n                        // Content area (scrollable)\r\n                        m(\"div\", {class: \"flex-1 overflow-y-auto px-4 pb-4\"}, [\r\n                            // Save mode - input for save name\r\n                            saveDialogMode === 'save' ? [\r\n                                m(\"div\", {class: \"mb-4\"}, [\r\n                                    m(\"label\", {class: \"cg-input-label\"}, \"Save Name\"),\r\n                                    m(\"input\", {\r\n                                        type: \"text\",\r\n                                        class: \"cg-input-field\",\r\n                                        placeholder: \"Enter save name...\",\r\n                                        value: newSaveName,\r\n                                        oninput: function(e) { newSaveName = e.target.value; }\r\n                                    })\r\n                                ]),\r\n                                m(\"button\", {\r\n                                    class: \"cg-btn-submit-green\",\r\n                                    disabled: !newSaveName.trim(),\r\n                                    onclick: function() { saveGame(newSaveName); }\r\n                                }, \"Save Game\")\r\n                            ] : \"\",\r\n\r\n                            // New game mode - confirmation\r\n                            saveDialogMode === 'new' ? [\r\n                                m(\"div\", {class: \"text-center py-4\"}, [\r\n                                    m(\"span\", {class: \"material-symbols-outlined text-4xl text-yellow-500 mb-2\"}, \"warning\"),\r\n                                    m(\"p\", {class: \"text-gray-700 dark:text-gray-300 mb-4\"}, \"Start a new game? Current progress will be lost unless saved.\"),\r\n                                    m(\"button\", {\r\n                                        class: \"cg-btn-submit-red\",\r\n                                        onclick: newGame\r\n                                    }, \"Start New Game\")\r\n                                ])\r\n                            ] : \"\",\r\n\r\n                            // List mode - show saved games (this is the scrollable part)\r\n                            saveDialogMode === 'list' ? [\r\n                                savedGames.length === 0 ?\r\n                                    m(\"div\", {class: \"text-center py-8 text-gray-500 dark:text-gray-400\"}, [\r\n                                        m(\"span\", {class: \"material-symbols-outlined text-4xl mb-2\"}, \"folder_open\"),\r\n                                        m(\"p\", {}, \"No saved games found\")\r\n                                    ]) :\r\n                                    m(\"div\", {class: \"space-y-2\"}, savedGames.map(function(save) {\r\n                                        let isCurrent = currentSave && currentSave.objectId === save.objectId;\r\n                                        return m(\"div\", {\r\n                                            class: \"cg-save-list-item \" +\r\n                                                (isCurrent ? \"cg-save-list-item-active\" : \"cg-save-list-item-inactive\")\r\n                                        }, [\r\n                                            m(\"div\", {class: \"flex-1\"}, [\r\n                                                m(\"div\", {class: \"font-medium text-gray-800 dark:text-gray-200\"}, save.name),\r\n                                                m(\"div\", {class: \"cg-nav-label\"},\r\n                                                    save.modifiedDate ? new Date(save.modifiedDate).toLocaleString() : \"\")\r\n                                            ]),\r\n                                            m(\"div\", {class: \"flex space-x-1\"}, [\r\n                                                m(\"button\", {\r\n                                                    class: \"cg-save-btn-load\",\r\n                                                    onclick: function() { loadGame(save); },\r\n                                                    title: \"Load\"\r\n                                                }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"play_arrow\")),\r\n                                                m(\"button\", {\r\n                                                    class: \"cg-save-btn-delete\",\r\n                                                    onclick: function() { deleteGame(save); },\r\n                                                    title: \"Delete\"\r\n                                                }, m(\"span\", {class: \"material-symbols-outlined text-sm\"}, \"delete\"))\r\n                                            ])\r\n                                        ]);\r\n                                    }))\r\n                            ] : \"\"\r\n                        ]),\r\n\r\n                        // Footer with current save info\r\n                        currentSave ? m(\"div\", {class: \"cg-modal-footer\"}, [\r\n                            m(\"span\", {class: \"cg-nav-label\"}, \"Current: \" + currentSave.name)\r\n                        ]) : \"\"\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // ==========================================\r\n    // Main View\r\n    // ==========================================\r\n\r\n    function getOuterView() {\r\n        return m(\"div\", {class: \"content-outer\"}, [\r\n            fullMode ? \"\" : m(page.components.navigation),\r\n            m(\"div\", {class: \"content-main\"}, [\r\n                mainPanel()\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function mainPanel() {\r\n        // On small screens: vertical scroll layout\r\n        // On medium+ screens: horizontal layout with fixed panels\r\n        return m(\"div\", {class: \"cg-main-panel\"}, [\r\n            m(\"div\", {class: \"cg-main-panel-inner\"}, [\r\n                // Left panel - Draw Piles (horizontal row on mobile, vertical column on desktop)\r\n                m(\"div\", {class: \"cg-left-panel\"}, [\r\n                    m(ConsolidatedDecks)\r\n                ]),\r\n\r\n                // Center panel - Either hands or action view (chat, etc.)\r\n                chatDialogOpen ?\r\n                    // Chat view replaces the hands\r\n                    m(\"div\", {class: \"cg-center-panel\"}, [\r\n                        m(ChatPanel)\r\n                    ]) :\r\n                    // Default: Both hands stacked (actions integrated into hand headers)\r\n                    m(\"div\", {class: \"cg-center-panel\"}, [\r\n                        // User's hand (top) - 50%\r\n                        m(\"div\", {class: \"flex-1 min-h-32 md:min-h-0 overflow-hidden\"}, [\r\n                            m(UserHandPile)\r\n                        ]),\r\n                        // System's hand (bottom) - 50%\r\n                        m(\"div\", {class: \"flex-1 min-h-32 md:min-h-0 overflow-hidden\"}, [\r\n                            m(GameHandPile)\r\n                        ])\r\n                    ]),\r\n\r\n                // Right panel - Selected Card View\r\n                m(\"div\", {class: \"cg-right-panel\"}, [\r\n                    m(SelectedCardView)\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function toggleTag(tag) {\r\n        let idx = activeTags.indexOf(tag);\r\n        if (idx >= 0) {\r\n            activeTags.splice(idx, 1);\r\n        } else {\r\n            activeTags.push(tag);\r\n        }\r\n        // Reload characters with new filter\r\n        loadCharacters();\r\n    }\r\n\r\n    function getFooter() {\r\n        let nudeActive = activeTags.indexOf(\"nude\") >= 0;\r\n        return [\r\n            // Save/Load game button\r\n            m(\"button\", {\r\n                class: \"flyout-button\",\r\n                onclick: function() { openSaveDialog('list'); }\r\n            }, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, \"folder_open\"),\r\n                \"Game\"\r\n            ]),\r\n            // Quick save (if current save exists)\r\n            currentSave ? m(\"button\", {\r\n                class: \"flyout-button\",\r\n                onclick: function() { saveGame(currentSave.name); }\r\n            }, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, \"save\"),\r\n                \"Save\"\r\n            ]) : \"\",\r\n            // Tag filter - Nude toggle\r\n            m(\"button\", {\r\n                class: \"flyout-button\" + (nudeActive ? \" bg-pink-600 hover:bg-pink-500 text-white\" : \"\"),\r\n                onclick: function() { toggleTag(\"nude\"); },\r\n                title: nudeActive ? \"Nude filter active - click to disable\" : \"Filter by nude tag\"\r\n            }, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, nudeActive ? \"visibility\" : \"visibility_off\"),\r\n                \"Nude\"\r\n            ]),\r\n            // New Deal button\r\n            m(\"button\", {\r\n                class: \"flyout-button\",\r\n                onclick: newDeal\r\n            }, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, \"playing_cards\"),\r\n                \"Deal\"\r\n            ]),\r\n            m(\"button\", {\r\n                class: \"flyout-button\",\r\n                onclick: toggleFullMode\r\n            }, [\r\n                m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, fullMode ? \"close_fullscreen\" : \"fullscreen\"),\r\n                fullMode ? \"Exit\" : \"Full\"\r\n            ])\r\n        ];\r\n    }\r\n\r\n    // ==========================================\r\n    // Component Export\r\n    // ==========================================\r\n\r\n    let cardGame = {\r\n        oninit: async function() {\r\n            await loadCharacters();\r\n            await loadItems();\r\n            await loadApparel();\r\n            initActionDeck();\r\n            // Do initial deal\r\n            await newDeal();\r\n        },\r\n        view: function() {\r\n            return [\r\n                getOuterView(),\r\n                page.components.dialog.loadDialog(),\r\n                page.loadToast(),\r\n                // Chat dialog\r\n                m(ChatDialog),\r\n                // Save game dialog\r\n                m(SaveGameDialog),\r\n                // Footer toolbar\r\n                m(\"div\", {class: \"cg-footer-fixed\"},\r\n                    getFooter()\r\n                )\r\n            ];\r\n        }\r\n    };\r\n\r\n    page.views.cardGame = cardGame;\r\n}());\r\n\n\n;/* === client/components/advGrid.js === */\n(function(){\r\n    const advgrid = {};\r\n    let icon = \"videogame_asset\";\r\n    let label = \"Adventure Grid\";\r\n    let status = \"\";\r\n    let infoLabel = \"Info\";\r\n    let infoStatus = \"\";\r\n    let builderMode = false;\r\n    let modeClear = false;\r\n    let modeRoom = false;\r\n    let modeCorridor = false;\r\n    let changed = false;\r\n    let modeSpawn = 0;\r\n\r\n    let groups;\r\n\r\n    let communityData = {\r\n        communityName: 'AdvGrid - LC',\r\n        projectName: 'AdvGrid - P1',\r\n\r\n        countryData: [\"IR\"],\r\n        locationSize: 3,\r\n        locationSeed: 250,\r\n        epochs: 25,\r\n        lifecycle: null,\r\n        project: null\r\n    };\r\n\r\n    let data;\r\n\r\n    function newGameData(){\r\n        let dat = {\r\n            info: {},\r\n            gridWidth: 30,\r\n            gridHeight: 30,\r\n            cubeWidth: 20,\r\n            cubeHeight: 20,\r\n            /// gridWidth, cubeWidth (note: No space after comma!)\r\n            /// this is hard coded to be picked up by the processor\r\n            gridColCls: \"grid-cols-[repeat(30,20px)]\",\r\n            grid: [],\r\n            level: 1,\r\n            score: 0,\r\n            initialLocation: 'A New World',// - ' + (new Date().getTime()),\r\n            initialEvent: 'A New Start',// - ' + (new Date().getTime()),\r\n            event: null,\r\n            location: null,\r\n            player: null,\r\n            cellLocations:null,\r\n            mapgen : {\r\n                maxRooms: 5,\r\n                minRoomSize: 5,\r\n                maxRoomSize: 15\r\n            }\r\n        };\r\n        //dat.gridColCls = \"grid-cols-[repeat(\" + dat.gridWidth + \",\" + dat.cubeWidth + \"px)]\";\r\n        return dat;\r\n    }\r\n\r\n    function updateChanged(){\r\n        changed = true;\r\n    }\r\n    function toggleBuilder(){\r\n        builderMode = !builderMode;\r\n    }\r\n    function toggleModeClear(){\r\n        modeClear = !modeClear;\r\n        modeRoom = false;\r\n        modeCorridor = false;\r\n        modeSpawn = 0;\r\n    }\r\n\r\n    function toggleModeRoom(){\r\n        modeClear = false;\r\n        modeRoom = !modeRoom;\r\n        modeCorridor = false;\r\n        modeSpawn = 0;\r\n    }\r\n\r\n    function toggleModeCorridor(){\r\n        modeClear = false;\r\n        modeRoom = false;\r\n        modeSpawn = 0;\r\n        modeCorridor = !modeCorridor;\r\n    }\r\n\r\n    function toggleSpawn(i){\r\n        \r\n        if(modeSpawn == i) modeSpawn = 0;\r\n        else modeSpawn = i;\r\n        modeClear = false;\r\n        modeRoom = false;\r\n        modeCorridor = false;\r\n    }\r\n\r\n\r\n    function buildCell(x, y){\r\n        let g = data.grid;\r\n        if(g[x] && g[x][y]){\r\n            let cell = g[x][y];\r\n            let type = cell.type;\r\n            if(modeClear) type = 0;\r\n            else if(modeRoom) type = 1;\r\n            else if(modeCorridor) type = 2;\r\n            else if(modeSpawn == 1) type = 3;\r\n            else if (modeSpawn == -1) type = 4;\r\n            else if (modeSpawn == 2) type = 5;\r\n            else if (modeSpawn == 3) type = 6;\r\n            cell.type = type;\r\n            updateChanged();\r\n        }\r\n        else{\r\n            console.warn(\"No cell at \" + x + \", \" + y);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    /// TODO:   Location needs Long/Lat values\r\n    ///         Resource needs more variant type support\r\n    ///         Expose API to generate a single fake person or fake event\r\n\r\n    /// Build a region based on the grid dimensions\r\n    ///\r\n    function constructRegion(name){\r\n\r\n    }\r\n\r\n    async function getGroups(){\r\n        let aP = [];\r\n//        if(!data) return Promise.resolve();\r\n        groups = {};\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"location\")).then((g)=>{ groups.location = g;}));\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"event\")).then((g)=>{ groups.event = g;}));\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"trait\")).then((g)=>{ groups.trait = g;}));\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"data\")).then((g)=>{ groups.data = g;}));\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"person\")).then((g)=>{ groups.person = g;}));\r\n        aP.push(page.findObject(\"GROUP\", \"DATA\", am6community.getPathForType(\"tag\")).then((g)=>{ groups.tag = g;}));\r\n        return Promise.all(aP);\r\n    }\r\n   \r\n\r\n    function generateMap(){\r\n        generateRooms();\r\n    }\r\n    function placeRoom(w, h){\r\n        let g = data.grid;\r\n        let pos = findSpaceLocation(w, h);\r\n         if(pos){\r\n\r\n            console.log(\"Place room at \" + pos.left + \", \" + pos.top);\r\n            for(let i = pos.left; i < pos.left + w; i++){\r\n                for(let b = pos.top; b < pos.top + h; b++){\r\n                    g[i][b].type = 1;\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            console.warn(\"Failed to place room: \" + pos);\r\n        }\r\n\r\n    }\r\n    function randomVal(min, max){\r\n        return Math.floor( (Math.random() * (max - min)) + min)\r\n    }\r\n\r\n    function findSpaceLocation(w, h){\r\n        let g = data.grid;\r\n        let pos;\r\n        let iters = 0;\r\n        let maxiters = 100;\r\n        while(!pos){\r\n            iters++;\r\n            if(iters > maxiters){\r\n                console.log(\"Exceeded location attempts\");\r\n                break;\r\n            }\r\n            let t = randomVal(0, data.gridHeight);\r\n            let l = randomVal(0, data.gridWidth);\r\n            //console.log(\"Test: \" + t + \", \" + l);\r\n            /// Keep placement 1+ inside the margins to allow for any other border\r\n            if(l == 0) l = 1;\r\n            if(t == 0) t = 1;\r\n            if(l + w >= data.gridWidth) l = data.gridWidth - w - 2;\r\n            if(t + h >= data.gridHeight) t = data.gridHeight - h - 2;\r\n            let collision = false;\r\n            for(let x = l - 1; x < l + w + 1; x++){\r\n                for(let y = t - 1; y < t + h + 1; y++){\r\n                    //console.log(\"Scan: \" + x + \", \" + y);\r\n                    if(!g[x] || !g[x][y]){\r\n                        console.error(\"Cell error at \" + x + \", \" + y);\r\n                        collision = true;\r\n                        break;\r\n                    }\r\n                    let cell = g[x][y];\r\n                    if(cell.type){\r\n                        collision = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if(collision) break;\r\n            }\r\n            if(!collision){\r\n                pos = {left: l, top: t};\r\n                break;\r\n            }\r\n            else{\r\n                console.warn(\"Collision detected\");\r\n            }\r\n        }\r\n        return pos;\r\n    }\r\n\r\n    function generateRooms(){\r\n        let mg = data.mapgen;\r\n        let placedRooms = 0;\r\n        for(let i = 0; i < mg.maxRooms; i++){\r\n            let rw = randomVal(mg.minRoomSize, mg.maxRoomSize);\r\n            let rh = randomVal(mg.minRoomSize, mg.maxRoomSize);\r\n            placeRoom(rw, rh);\r\n        }\r\n    }\r\n\r\n    function newMapCell(x, y){\r\n        return {\r\n            dropped: 0,\r\n            active: false,\r\n            occupied: false,\r\n            color: \"white\",\r\n            x: x,\r\n            y: y,\r\n            type: 0\r\n        };\r\n    }\r\n\r\n    function statusCallback(s){\r\n        status = \" - \" + s;\r\n        m.redraw();\r\n    }\r\n    async function initLocation(){\r\n        if(!data) return false;\r\n        let outB = false;\r\n        let l = await page.openObjectByName('LOCATION', groups.location.objectId, data.initialLocation);\r\n        if(!l){\r\n            status = \" - Create a location\";\r\n            builderMode = true;\r\n            console.log(status);\r\n            m.redraw();\r\n        }\r\n        else{\r\n            data.location = l;\r\n            let cl = await page.listObjectsInParent('LOCATION', l.objectId, 0, l.childLocations.length);\r\n            data.childLocations = cl;\r\n            restoreMap();\r\n            outB = await initEvent();\r\n        }\r\n        return outB;\r\n    }\r\n    function restoreMap(){\r\n        if(!data || !data.childLocations) return;\r\n        data.childLocations.forEach((l)=>{\r\n            let y = l.longitude;\r\n            let x = l.latitude;\r\n\r\n            if(typeof x == 'number' || typeof y == 'number'){\r\n                let cell = data.grid[x][y];\r\n                let ct = 0;\r\n                if(l.attributes) ct = AM6Client.getAttributeValue(l, \"cellType\");\r\n                let cellType = 0;\r\n                if(ct) cellType = parseInt(ct);\r\n                cell.type = cellType;\r\n                cell.location = l;\r\n            }\r\n        });\r\n        m.redraw();\r\n    }\r\n    async function configureEvent(){\r\n        if(!data.event || !communityData.project){\r\n            console.log(\"No event or data project defined\");\r\n            return;\r\n        }\r\n        let outB = false;\r\n        if(!data.event.location){\r\n//            console.log(\"Obtain inception event ...\");\r\n            let pev = await page.findObject('GROUP', 'DATA', communityData.project.groupPath + \"/Events\");\r\n            console.log(\"Configuring event location ...\");\r\n            let pevC = await page.countObjects('EVENT', pev.objectId);\r\n            let lastE = await page.listObjects('EVENT', pev.objectId, pevC - 1, 1);\r\n            console.log(pev.objectId + \" / \" + pevC + \" / \" + lastE.length);\r\n            let randE = randomVal(1, pevC - 2);\r\n            let oE;\r\n            (await page.listObjects('EVENT', pev.objectId, randE, 3)).forEach((e)=>{\r\n                if(!oE && e.name.match(/epoch/gi)){\r\n                    oE = e;\r\n                }\r\n            });\r\n            if(oE){\r\n                let loc = await page.openObject('LOCATION', oE.location.objectId);\r\n                let cloc = loc.childLocations[randomVal(0,loc.childLocations.length)];\r\n                if(cloc){\r\n                    let clocd = await page.openObject('LOCATION', cloc.objectId);\r\n                    data.event.location = clocd;\r\n                    /// Push the start date to the last event\r\n                    ///\r\n                    data.event.startDate = lastE[0].startDate;\r\n                    data.event.endDate = lastE[0].endDate;\r\n                    console.log(\"Update event\");\r\n                    console.log(data.event);\r\n                    await page.updateObject(data.event);\r\n                    console.log(\"Post update\");\r\n                    console.log(data.event);\r\n                    outB = true;\r\n                    console.log(\"Enjoy \" + AM6Client.getAttributeValue(clocd, \"name\",clocd.name));\r\n                }\r\n                else{\r\n                    console.warn(\"No child!\");\r\n                }\r\n            }\r\n            else{\r\n                console.error(\"No epoch found!\");\r\n            }\r\n            //console.log(aE);\r\n\r\n        }\r\n        else{\r\n            if(!data.event.location.attributesPopulated) data.event.location = await page.openObject('LOCATION', data.event.location.objectId);\r\n            console.log(\"Working with \" + AM6Client.getAttributeValue(data.event.location, \"name\",data.event.location.name));\r\n            outB = true;\r\n        }\r\n        return outB;\r\n    }\r\n    async function initEvent(){\r\n        if(!data || !groups || !groups.event) return false;\r\n        let outB = false;\r\n        let e = await page.openObjectByName('EVENT', groups.event.objectId, data.initialEvent);\r\n        if(!e){\r\n            console.log(\"Create initial event\");\r\n            let initLoc = getCell(-1, -1, 5);\r\n            if(initLoc && initLoc.location){\r\n                console.log(\"Continue ...\");\r\n                let initEvt = am6model.newPrimitive(\"event\", true, am6community.getPathForType(\"event\"));\r\n                initEvt.name = data.initialEvent;\r\n                //initEvt.location = initLoc.location;\r\n                initEvt.eventType = 'INCEPT';\r\n                let b = await page.updateObject(initEvt);\r\n                if(b){\r\n                    console.log(\"Configure event ... \" + groups.event.objectId + \" / \" + data.initialEvent);\r\n                    let e2 = await page.openObjectByName('EVENT', groups.event.objectId, data.initialEvent);\r\n                    if(!e2.startDate) console.warn(\"Error retrieving event start date\");\r\n                    data.event = e2;\r\n                    outB = await configureEvent();\r\n                }\r\n                else{\r\n                    console.error(\"Failed to update event\");\r\n                    return false;\r\n                }\r\n\r\n            }\r\n            else{\r\n                console.error(\"Spawn location not found\");\r\n                return false;\r\n            }\r\n        }\r\n        else{\r\n            console.log(\"Load event ... \" + groups.event.objectId + \" / \" + data.initialEvent);\r\n            data.event = e;\r\n            outB = await configureEvent();\r\n        }\r\n        return true;\r\n\r\n    }\r\n    async function randomPerson(count){\r\n        let pev = await page.findObject('GROUP', 'DATA', communityData.project.groupPath + \"/Persons\");\r\n        let pevC = await page.countObjects('PERSON', pev.objectId);\r\n        let pR = randomVal(1, pevC - count);\r\n        let aR = await page.listObjects('PERSON', pev.objectId, pR, count);\r\n        return aR;\r\n    }\r\n\r\n    async function randomPersons(count){\r\n        let aP = [];\r\n        for(let i = 0; i < count; i++){\r\n            let per = await randomPerson(1);\r\n            aP.push(per[0]);\r\n        }\r\n        return aP;\r\n    }\r\n\r\n    async function newPlayerPerson(){\r\n        let pers = await randomPerson(1);\r\n        let per = pers[0];\r\n        //data.event.actors = [per];\r\n        return per;\r\n    }\r\n    async function initPopulation(){\r\n        //let bc = 0;\r\n        if(!data || !data.event) return;\r\n        if(!data.event.actors.length){\r\n            let per = await newPlayerPerson();\r\n            data.info.per = per;\r\n            data.info.pers = await randomPersons(10);\r\n            solicitInfo(\"Setup\");\r\n            //console.log(\"Selecting player: \" + per.name);\r\n            //bc++;\r\n        }\r\n        else{\r\n            //infoStatus = \" - \" + data.event.actors[0].name;\r\n            data.player = await page.openObjectByName('PERSON', groups.person.objectId, data.event.actors[0].name);\r\n            if(!data.player){\r\n                console.log(\"Cloning base person\");\r\n                let clone = await page.openObject('PERSON', data.event.actors[0].objectId);\r\n                delete clone.id;\r\n                delete clone.objectId;\r\n                delete clone.contactInformation;\r\n                clone.groupPath = am6community.getPathForType(\"person\");\r\n                await page.updateObject(clone);\r\n                data.player = await page.openObjectByName('PERSON', groups.person.objectId, data.event.actors[0].name);\r\n            }\r\n            console.log(\"Working with player: \");\r\n            console.log(data.player);\r\n            solicitInfo(\"Setup2\");\r\n        }\r\n    }\r\n\r\n    function chooseInfo(o){\r\n        if(!data) return;\r\n        data.info.selected = o;\r\n    }\r\n    async function confirmInfo(){\r\n        if(!data || !data.info.selected) return;\r\n        if(data.info.step == \"setup\"){\r\n            data.event.actors = [data.info.selected];\r\n            await page.updateObject(data.event);\r\n            //solicitInfo(\"Setup2\");\r\n            await initPopulation();\r\n        }\r\n    }\r\n    async function refreshInfo(){\r\n        if(!data) return;\r\n        if(data.info.step == 'setup'){\r\n            console.log(\"Refresh pop\");\r\n            await initPopulation();\r\n        }\r\n        else{\r\n            console.log(\"Unknown step: \" + data.info.step);\r\n        }\r\n\r\n    }\r\n\r\n    function solicitInfo(x){\r\n        if(!data) return;\r\n        data.info.step = x.toLowerCase();\r\n        infoStatus = \" - \" + x;\r\n        m.redraw();\r\n    }\r\n\r\n    async function init(){\r\n    \r\n        //generateMap();\r\n        console.log(\"Create empty grid\");\r\n        createNewGrid();\r\n        if(!groups){\r\n            await getGroups();\r\n            if(data){\r\n                let p = await am6community.getCreateConfiguredCommunityProject(communityData.communityName, communityData.projectName, communityData.countryData, communityData.locationSize, communityData.locationSeed, communityData.epochs, statusCallback);\r\n                communityData.project = p;\r\n                await initLocation();\r\n                console.log(\"Init pop\");\r\n                await initPopulation();\r\n            }\r\n        }\r\n    }\r\n\r\n    function getCell(x, y, type){\r\n        if(!data || !data.grid) return;\r\n        let outCell;\r\n        for(let i = 0; i < data.gridWidth; i++){\r\n            if(typeof x == 'number' && x >= 0 && x != i) continue; \r\n            for(let b = 0; b < data.gridHeight; b++){\r\n                let cell = data.grid[i][b];\r\n                if(typeof y == 'number' && y >= 0 && y != b) continue;\r\n                if(typeof type == 'number' && cell.type == type){\r\n                    outCell = cell;\r\n                }\r\n            }\r\n            if(outCell) break;\r\n        }\r\n        return outCell;\r\n    }\r\n\r\n    function createNewGrid(){\r\n        console.log(\"Initialize grid\");\r\n\r\n        data = newGameData();\r\n\r\n        let dgrid = data.grid;\r\n\r\n        for(let i = 0; i < data.gridWidth; i++){\r\n            if(!dgrid[i]) dgrid[i] = [];\r\n            for(let b = 0; b < data.gridHeight; b++){\r\n                dgrid[i][b] = newMapCell(i, b);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function refreshGrid(){\r\n        if(!data) return m(\"div\",\"[ ... ]\");\r\n        let gridView = [];\r\n        let dgrid = data.grid;\r\n        let w = data.cubeWidth;\r\n        let h = data.cubeHeight;\r\n\r\n        let gridStyle = \"width: \" + (data.gridWidth * w) + \"px;\";\r\n\r\n        let colorPrep = [\r\n            \"bg-blue-500\",\r\n            \"bg-red-500\",\r\n            \"bg-green-500\",\r\n            \"bg-brown-500\",\r\n            \"bg-gray-500\",\r\n            \"bg-orange-500\",\r\n            \"bg-yellow-500\",\r\n            \"bg-purple-500\",\r\n            \"bg-teal-500\",\r\n            \"bg-white\",\r\n            \"bg-black\",\r\n            \"border-white\",\r\n            \"border-black\"\r\n        ];\r\n\r\n        let defCubeColor = \"white\";\r\n\r\n        let cubeTrans = \"transition-all duration-300\";\r\n        let cubeClsC = cubeTrans;\r\n        let cubeStyleS = \"width:\" + w + \"px;\"\r\n        + \"height: \" + h + \"px;\";\r\n\r\n        for(let b = 0; b < data.gridHeight; b++){\r\n            for(let i = 0; i < data.gridWidth; i++){\r\n                let cell = dgrid[i][b];\r\n                let cellTypeColor = defCubeColor;\r\n                if(cell.type > 0) cellTypeColor = getCellTypeStyle(cell.type);\r\n                /*\r\n                if(cell.type == 1) cellTypeColor = \"black\";\r\n                else if (cell.type == 2) cellTypeColor = \"orange\";\r\n                */\r\n                let cubeCls = cubeClsC + \" \" + cubeStyle(cell.active, cell.active ? cell.color : cellTypeColor);\r\n                let handler;\r\n                if(builderMode){\r\n                    handler = function(){\r\n                        buildCell(i, b);\r\n                    };\r\n                }\r\n                let n = m(\"div\", {class: cubeCls, style: cubeStyleS, onclick: handler});\r\n                gridView.push(n);\r\n            }\r\n        }\r\n        // console.log(gridStyle);\r\n        return [m(\"div\", {class: \"game-grid-auto \" + data.gridColCls, style: gridStyle}, gridView)];\r\n    }\r\n    let cellColorMap = [\r\n        \"white\",\r\n        \"black\",\r\n        \"gray\",\r\n        \"teal\",\r\n        \"red\",\r\n        \"green\",\r\n        \"purple\"\r\n    ];\r\n\r\n    function getCellTypeStyle(i){\r\n        return cellColorMap[i] || \"yellow\";\r\n    }\r\n    function cubeStyle(b, g){\r\n        let color = g + ((g.match(/^(white|black)$/) ? \"\" : \"-500\")); \r\n        return (b ? \"border border-gray-900 shadow-lg\" : \"border border-\" + color) \r\n        + \" bg-\" + color\r\n    ;\r\n    }\r\n\r\n    let oneYearMs = 31536000000;\r\n    function getAge(per){\r\n        if(!data) return 0;\r\n        let d1 = per.birthDate;\r\n        let d2 = data.event.endDate;\r\n        let ms = d2.getTime() - d1.getTime();\r\n        /// Because the randomly chosen event may be before the randomly chosen person was born, then the age may be negative\r\n        /// Just take the absolute value here\r\n        return Math.abs(Math.round(ms / oneYearMs));\r\n    }\r\n\r\n    function modelInfo(){\r\n        if(!data) return \"\";\r\n        let ino = data.info;\r\n\r\n        if(ino.step === 'setup'){\r\n            let aR = [];\r\n            if(ino.per){\r\n                aR.push(m(\"li\",m(\"div\", {onclick: function(){ chooseInfo(ino.per);}, class: 'result-item' + (ino.selected && ino.selected.objectId == ino.per.objectId ? \" result-item-active\" : \"\")},  ino.per.name + \" (\" + ino.per.gender + \") (\" + getAge(ino.per) + \" years) (\" + AM6Client.getAttributeValue(ino.per, \"alignment\") + \") (\" + AM6Client.getAttributeValue(ino.per, \"trade\") + \")\")));\r\n            }\r\n            if(ino.pers) ino.pers.forEach((p)=>{\r\n                aR.push(m(\"li\",m(\"div\", {onclick: function(){ chooseInfo(p);}, class: 'result-item'  + (ino.selected && ino.selected.objectId == p.objectId ? \" result-item-active\" : \"\")}, p.name + \" (\" + p.gender + \")\" + (AM6Client.getAttributeValue(p, \"deceased\") === 'true' ? \" (dead)\" : \"\") + \" (\" + getAge(p) + \" years) (\" + AM6Client.getAttributeValue(p, \"alignment\") + \") (\" + AM6Client.getAttributeValue(p, \"trade\") + \")\")));\r\n            });\r\n            return m(\"ul\", {\"class\" : \"list-results-overflow\"}, aR);\r\n        }\r\n        return \"\";\r\n    }\r\n    function modelGame(){\r\n        return refreshGrid();\r\n    }\r\n\r\n    function getScoreCard(){\r\n        return m(\"div\",{class: \"result-nav-outer\"},[\r\n            m(\"div\",{class: \"result-nav-inner\"},[\r\n                //page.iconButton(\"button mr-4\", \"start\", \"\", start),\r\n                page.iconButton(\"button mr-4\", \"refresh\", \"\", refreshInfo),\r\n                //m(\"div\",{class: \"count-label mr-4\"},\"Level \" + (data ? data.level : 1)),\r\n                //m(\"div\",{class: \"count-label mr-4\"},\"Score \" + (data ? data.score : 0)),\r\n                page.iconButton(\"button\", \"check\", \"\", confirmInfo)\r\n            ])\r\n        ]);\r\n    }\r\n\r\n\r\n    function modelPanel(){\r\n        return [m(\"div\",{class: \"results-overflow grid grid-cols-2 gap-4\"},\r\n                    m(\"div\",{class: \"panel-card\"},\r\n                        m(\"p\", {\"class\" : \"card-title\"}, [\r\n                            m(\"span\", {class : \"material-icons material-icons-cm mr-2\"}, icon),\r\n                            label + status\r\n                        ]),\r\n                        m(\"div\", {\"class\": \"card-contents\"}, modelGame())\r\n                    ),\r\n                    m(\"div\",{class: \"panel-card\"},\r\n                    m(\"p\", {\"class\" : \"card-title\"}, [\r\n                        m(\"span\", {class : \"material-icons material-icons-cm mr-2\"}, icon),\r\n                        infoLabel + infoStatus\r\n                    ]),\r\n                    m(\"div\", {\"class\": \"card-contents\"}, modelInfo())\r\n                )\r\n\r\n            ),\r\n            m(\"div\",{class: \"result-nav-outer\"},[\r\n                m(\"div\",{class: \"result-nav-inner\"},[\r\n                    m(\"div\",{class: \"result-nav tab-container\"},[\r\n                        page.iconButton(\"button\", \"west\", \"\", moveWest),\r\n                        page.iconButton(\"button\", \"north\", \"\", moveNorth),\r\n                        page.iconButton(\"button\", \"south\", \"\", moveSouth),\r\n                        page.iconButton(\"button\", \"east\", \"\", moveEast),\r\n                        page.iconButton(\"button\", \"hourglass_empty\", \"\", wait)\r\n                    ])\r\n                ])\r\n            ]),\r\n        ];\r\n    }\r\n    function wait(){\r\n\r\n    }\r\n    function moveEast(){\r\n\r\n    }\r\n    function moveWest(){\r\n\r\n    }\r\n    function moveNorth(){\r\n\r\n    }\r\n    function moveSouth(){\r\n\r\n    }\r\n\r\n    function start(){\r\n\r\n    }\r\n    function stop(){\r\n\r\n    }\r\n\r\n    function endGame(){\r\n        let udef;\r\n        groups = udef;\r\n        data = udef;\r\n    }\r\n\r\n    function keyControl(e){\r\n\r\n    }\r\n\r\n    function shuffle(){\r\n        createNewGrid();\r\n        generateMap();\r\n        //m.redraw();\r\n    }\r\n\r\n    async function saveGame(){\r\n        console.log(\"Save!\");\r\n        if(builderMode){\r\n            return saveGrid();\r\n        }\r\n        else{\r\n            console.warn(\"Implement save...\");\r\n        }\r\n    }\r\n    async function saveGrid(){\r\n        let l1 = data.location;\r\n        let name = document.querySelector(\"[rid=gridName]\").value;\r\n        if(name){\r\n            if(!l1 || l1.name !== name) l1 = am6model.newPrimitive(\"location\", true, am6community.getBasePath(\"location\"));\r\n            l1.name = name;\r\n\r\n            console.log(\"Attempt to update\");\r\n            let b = await page.updateObject(l1);\r\n            console.log(\"Attempt to retrieve\");\r\n            let l2 = await page.openObjectByName(\"LOCATION\", groups.location.objectId, name);\r\n            if(l2){\r\n                /// Build up the grid and do a bulk load:\r\n\r\n                let aLocs = [];\r\n                for(let y = 0; y < data.gridHeight; y++){\r\n                    for(let i = 0; i < data.gridWidth; i++){\r\n                        let cell = data.grid[i][y];\r\n                        let l3 = cell.location || am6model.newPrimitive(\"location\", true, am6community.getBasePath(\"location\"));\r\n                        l3.name = \"Cell x\" + i + \" y\" + y;\r\n                        if(cell.location && (l3.longitude != y || l3.latitude != i)){\r\n                            console.warn(\"Cell miss-match: \" + l3.latitude + \" == \" + i + \" / \" + l3.longitude + \" == \" + y);\r\n                        }\r\n                        l3.longitude = y;\r\n                        l3.latitude = i;\r\n                        l3.attributes = [AM6Client.newAttribute(\"cellType\", cell.type)];\r\n                        l3.geographyType = \"ENVIRONMENTAL\";\r\n                        l3.parentId = l2.id;\r\n                        aLocs.push(l3);\r\n                    }\r\n                }\r\n                console.log(\"Attempting to bulk update \" + aLocs.length + \" items\");\r\n                AM6Client.updateBulk(\"LOCATION\", aLocs, function(s, v){\r\n                    if(v && typeof v.json != \"undefined\") v = v.json;\r\n                    /// Clear the context object properly load the children\r\n                    ///\r\n                    page.clearContextObject(l2.objectId);\r\n                    window.dbgEntity = aLocs;\r\n                    console.log(\"Done: \" + v);\r\n                    changed = false;\r\n                    initLocation();\r\n                    //m.redraw();\r\n                });\r\n\r\n            }\r\n            else{\r\n                console.error(\"Failed to retrieve \" + name);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    function getCommands(){\r\n        if(!am6community.getCommunityMode){\r\n            return [\r\n                page.iconButton(\"button\", \"group\", \"\", function(){ page.components.breadCrumb.toggleCommunity(); })\r\n            ];\r\n        }\r\n        let bldCommands = [\r\n            page.iconButton(\"button\" + (builderMode ? \" active\" : \"\"), (builderMode ? \"draw\" : \"edit_off\"), \"\", function(){ toggleBuilder(); }),\r\n        ];\r\n        if(builderMode) bldCommands = bldCommands.concat([\r\n            page.iconButton(\"button\",\"shuffle\", \"\", function(){ shuffle(); }),\r\n            page.iconButton(\"button\" + (modeClear ? \" active\" : \"\"),\"backspace\", \"\", function(){ toggleModeClear(); }),\r\n            page.iconButton(\"button\" + (modeRoom ? \" active\" : \"\"),\"meeting_room\", \"\", function(){ toggleModeRoom(); }),\r\n            page.iconButton(\"button\" + (modeCorridor ? \" active\" : \"\"),\"edit_road\", \"\", function(){ toggleModeCorridor(); }),\r\n            page.iconButton(\"button\" + (modeSpawn == 1 ? \" active\" : \"\"),\"thumb_up_off_alt\", \"\", function(){ toggleSpawn(1); }),\r\n            page.iconButton(\"button\" + (modeSpawn == -1 ? \" active\" : \"\"),\"thumb_down_off_alt\", \"\", function(){ toggleSpawn(-1); }),\r\n            page.iconButton(\"button\" + (modeSpawn == 2 ? \" active\" : \"\"), \"my_location\", \"\", function(){ toggleSpawn(2); }),\r\n            page.iconButton(\"button\" + (modeSpawn == 3 ? \" active\" : \"\"), \"place\", \"\", function(){ toggleSpawn(3); })\r\n\r\n        ]);\r\n        bldCommands.push(m(\"input\", {type: \"text\", class : \"ml-4 text-field\", rid : 'gridName', value: (data ? data.initialLocation : \"\")}));\r\n        return bldCommands;\r\n    }\r\n\r\n    advgrid.component = {\r\n        data : function(){ return data },\r\n        isChanged : function(){ return changed; },\r\n        saveGame : saveGame,\r\n        commands : getCommands,\r\n        keyHandler : keyControl,\r\n        scoreCard : getScoreCard,\r\n\r\n        oninit : function(x){\r\n            init();\r\n        },\r\n        oncreate : function (x) {\r\n\r\n        },\r\n        onremove : function(x){\r\n            endGame();\r\n        },\r\n\r\n        view: function () {\r\n            return modelPanel();\r\n         }\r\n    };\r\n\r\n    page.components.advgrid = advgrid.component;\r\n}());\r\n\n\n;/* === client/components/tetris.js === */\n/// Demo game component - based on a 20+ year old 5K JavaScript submission I made\r\n///\r\n(function(){\r\n    const tetris = {};\r\n    let icon = \"videogame_asset\";\r\n    let label = \"Tetris\";\r\n    let preview = true;\r\n\r\n    function newGameData(){\r\n        let dat = {\r\n            cube_width:25,\r\n            cube_height:25,\r\n            grid_width:10,\r\n            grid_height:20,\r\n            grid:[],\r\n            cubes:[],\r\n            cube_types:[\r\n                /* square */\r\n                \"10112021101120211011202110112021\",\r\n                /* line */\r\n                \"20212223011121312021222301112131\",\r\n        \r\n                /* right_elbow */\r\n                \"10201112011121221011120200011121\",\r\n                /* left_elbow */\r\n                \"10202122112130312021223211122131\",\r\n                /* intersect */\r\n                \"11202131312021221121223111202122\",\r\n                /* right_twist */\r\n                \"10200111101121221020011110112122\",\r\n                /* left_twist */\r\n                \"00101121100111020010112110011102\"\r\n            ],\r\n            cube_colors:[\"red\",\"green\",\"blue\"],\r\n            next_cube_color:\"blue\",\r\n        \r\n            /* piece matrix size */\r\n            piece_width:4,\r\n            piece_height:4,\r\n        \r\n            /* default starting position */\r\n            piece_left:4,\r\n            piece_top:0,\r\n        \r\n            /* flag whether an active game piece is in play */\r\n            piece_is_active:0,\r\n            current_clock_value: 1000,\r\n            next_level_requirement:10,\r\n            next_level:0,\r\n            lines:0,\r\n            point_modifier:1,\r\n            init_game:0,\r\n            level:1,\r\n            score: 0,\r\n            levels:[1000,900,800,700,600,500,400,300,200,100,50,10,1]\r\n        };\r\n\r\n        /* mark the top-most piece */\r\n        dat.mark_top = dat.grid_height;\r\n\r\n        return dat;\r\n    }\r\n\r\n    let data;\r\n    \r\n    function init(){\r\n    \r\n        console.log(\"Initialize grid\");\r\n\r\n        data = newGameData();\r\n\r\n        data.cube_types.forEach((c, i)=>{\r\n            let n = [];\r\n            for(let b = 0; b < data.piece_width; b++){\r\n                n[b] = [];\r\n                for(let k = 0; k < data.piece_height; k++){\r\n                    n[b][k] = [];\r\n                    /// rotation\r\n                    for(let j = 0; j < 4; j++){\r\n                        n[b][k][j] = 0;\r\n                    }\r\n                }\r\n            }\r\n\r\n            let mesh = c;\r\n            let r = -1;\r\n            for(let k = 0; k < mesh.length; k += 2){\r\n                if(k % 8 == 0) r++;\r\n                let j = mesh.substring(k, k + 2).split(\"\");\r\n                n[j[0]][j[1]][r] = 1;\r\n            }\r\n            \r\n            data.cubes[i] = n;\r\n\r\n        });\r\n\r\n        data.next_cube_index = parseInt(Math.random() * data.cube_types.length);\r\n        data.next_cube_color = data.cube_colors[parseInt(Math.random() * data.cube_colors.length)];\r\n    }\r\n\r\n    function refreshGrid(){\r\n        if(!data) return m(\"div\",\"init ...\");\r\n        let gridView = [];\r\n        let dgrid = data.grid;\r\n        let w = data.cube_width;\r\n        let h = data.cube_height;\r\n\r\n        let gridStyle = \"width: \" + (data.grid_width * w) + \"px\";\r\n        let previewStyle = \"width: \" + (data.piece_width * w) + \"px\";\r\n\r\n        let colorPrep = [\r\n            \"bg-blue-500\",\r\n            \"bg-red-500\",\r\n            \"bg-green-500\",\r\n        ];\r\n\r\n        let defCubeColor = \"white\";\r\n\r\n        let cubeTrans = \"rounded-sm transition-all duration-300\"\r\n        let cubeClsC = cubeTrans;\r\n        let cubeStyleS = \"width:\" + w + \"px;\"\r\n        + \"height: \" + h + \"px;\";\r\n\r\n        for(let b = 0; b < data.grid_height; b++){\r\n            for(let i = 0; i < data.grid_width; i++){\r\n                if(!dgrid[i]) dgrid[i] = [];\r\n                if(!dgrid[i][b]) dgrid[i][b] = {dropped: 0};\r\n                let cubeCls = cubeClsC + \" \" + cubeStyle(dgrid[i][b].active, dgrid[i][b].active ? dgrid[i][b].color : defCubeColor);\r\n                let n = m(\"div\", {class: cubeCls, style: cubeStyleS});\r\n                gridView.push(n);\r\n            }\r\n        }\r\n        let prev = \"\";\r\n        if(preview){\r\n            let prevGrid = [];\r\n            let prevColor = data.next_cube_color;\r\n            for(let b = 0; b < data.piece_height; b++){\r\n                for(let i = 0; i < data.piece_width; i++){\r\n                    let p = data.cubes[data.next_cube_index][i][b][0];\r\n                    let cubeCls = cubeClsC + \" \" + cubeStyle((p ? true : false), (p ? prevColor : defCubeColor));\r\n                    let n = m(\"div\", {class: cubeCls, style: cubeStyleS});\r\n                    prevGrid.push(n);\r\n                }\r\n            }\r\n            prev = m(\"div\", {class: \"game-grid-preview-44\", style: previewStyle}, prevGrid);\r\n        }\r\n        return [m(\"div\", {class: \"game-grid-1020\", style: gridStyle}, gridView), prev];\r\n    }\r\n    \r\n    function cubeStyle(b, g){\r\n        return (b ? \"border border-gray-900 shadow-lg\" : \"border border-white\") \r\n        + \" bg-\" + g + (g.match(/^(white|black)$/) ? \"\" : \"-500\")\r\n    ;\r\n    }\r\n\r\n    function evaluateGrid(){\r\n        var s = arguments[0], h = 0,  p;\r\n        data.piece_on_left_edge = 0;\r\n        data.piece_on_right_edge = 0;\r\n        for(let a = data.current_piece_left; a < (data.current_piece_left + data.piece_width); a++){\r\n            if(typeof data.grid[a] == 'object'){\r\n                for(let b = data.current_piece_top; b < (data.current_piece_top + data.piece_height); b++){\r\n                    if(typeof data.grid[a][b] == 'object'){\r\n                        let dg = data.grid[a][b];\r\n                        p = data.cubes[data.active_cube_index][a - data.current_piece_left][b - data.current_piece_top][data.piece_rotation];\r\n                        if(p){\r\n                            if(dg.dropped)\r\n                                h=1;\r\n                            \r\n                            if(!a)\r\n                                data.piece_on_left_edge=1;\r\n                            \r\n                            if(b == (data.grid_height - 1))\r\n                                data.piece_is_dropped = 1;\r\n                            \r\n                            if(a == (data.grid_width-1))\r\n                                data.piece_on_right_edge=1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            else{\r\n                let c1 = 0;\r\n                if(data.current_piece_left < 0){\r\n                    c1 = Math.abs(data.current_piece_left) - 1;\r\n                }\r\n                else {\r\n                    c1= Math.abs(data.current_piece_left - data.grid_width);\r\n                }\r\n                for(let b = 0; b < data.piece_height; b++){\r\n                    if(data.cubes[data.active_cube_index][c1][b][data.piece_rotation]){\r\n                        h = 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(!h){\r\n            for(let a = (data.current_piece_left - 1); a < (data.current_piece_left + data.piece_width + 1); a++){\r\n                if(typeof data.grid[a] == 'object'){\r\n                    for(let b = (data.current_piece_top - 1); b < (data.current_piece_top + data.piece_height + 1); b++){\r\n                        if(typeof data.grid[a][b] =='object'){\r\n                            let dg = data.grid[a][b];\r\n                            p = 0;\r\n                            if(typeof data.cubes[data.active_cube_index][a - data.current_piece_left] == 'object'){\r\n                                if(typeof data.cubes[data.active_cube_index][a - data.current_piece_left][b - data.current_piece_top] == 'object'){\r\n                                    p = data.cubes[data.active_cube_index][a - data.current_piece_left][b - data.current_piece_top][data.piece_rotation];\r\n                                }\r\n                            }\r\n                            if(p){\r\n                                dg.color = data.active_cube_color;\r\n                                dg.active = true;\r\n                            }\r\n                            else{\r\n                                if(!dg.dropped){\r\n                                    dg.active = false;\r\n                                    dg.color = \"white\";\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        let r = 0;\r\n        if(h){\r\n            if(s == 1)\r\n                data.current_piece_top--;\r\n            \r\n            if(s == 3)\r\n                data.current_piece_left--;\r\n            \r\n            if(s == 2)\r\n                data.current_piece_left++;\r\n            \r\n            r = 1;\r\n        }\r\n    \r\n        /* Prevent further left moves. */\r\n        if(s == 2 && data.piece_on_left_edge)\r\n            r = 1;\r\n        \r\n        /* Prevent further down moves. */\r\n        if(s == 1 && data.piece_is_dropped)\r\n            r = 1;\r\n        \r\n        /* Prevent further right moves; */\r\n        if(s == 3 && data.piece_on_right_edge)\r\n            r = 1;\r\n        \r\n        /* Return false if there were no hits, return true if there were hits. */\r\n        return r;\r\n    }\r\n\r\n    function addPiece(){\r\n        if(!data.init_game)\r\n            data.init_game = 1;\r\n        \r\n        clock();\r\n        \r\n        data.piece_rotation = 0;\r\n        data.active_cube_index = data.next_cube_index;\r\n        data.next_cube_index = parseInt(Math.random() * data.cube_types.length);\r\n        data.active_cube_color = data.next_cube_color;\r\n        while( data.next_cube_color == data.active_cube_color && data.cube_colors.length > 1)\r\n            data.next_cube_color = data.cube_colors[parseInt(Math.random() * data.cube_colors.length)];\r\n        \r\n        data.piece_is_active = 1;\r\n        data.piece_on_left_edge = 0;\r\n        data.piece_on_right_edge = 0;\r\n        data.piece_is_dropped = 0;\t\r\n        data.current_piece_top = data.piece_top;\r\n        data.current_piece_left = data.piece_left;\r\n    \r\n        if(evaluateGrid()){\r\n            alert(\"game over\");\r\n            endGame();\r\n        }\r\n        else{\r\n            console.log(\"Redraw for add\");\r\n            m.redraw();\r\n            clock(1);\r\n        }\r\n    \r\n    }\r\n\r\n    function endGame(){\r\n        clock();\r\n        clearAllNodes();\r\n    }\r\n    \r\n    function clock(z){\r\n        if(z)\r\n            data.timer = setInterval(down, data.current_clock_value);\r\n        else\r\n            if(typeof data.timer == 'number')\r\n                clearInterval(data.timer);\r\n    }\r\n    \r\n    function checkClearLine(){\r\n        var a=[],b,c=0,d,i,e,s;\r\n    \r\n        let lineCount = 0;\r\n\r\n        for(b=data.mark_top-data.piece_height;b<data.grid_height;b++){\r\n            if(b>-1){\r\n                d=1;\r\n                for(i=0;i<data.grid_width;i++){\r\n                    e=data.grid[i][b];\r\n                    if(!e.dropped)\r\n                        d=0;\r\n                    \r\n                }\r\n                if(d){\r\n                    c=1;\r\n                    clock();\r\n                    a[a.length]=b;\r\n                }\r\n            }\r\n            else\r\n                b=-1;\r\n        }\r\n\r\n        if(c){\r\n            for(i=0;i<a.length;i++){\r\n                for(b=0;b<data.grid_width;b++){\r\n                    e = data.grid[b][a[i]];\r\n                    e.dropped = 0;\r\n                    e.color = \"white\";\r\n                    e.active = false;\r\n                }\r\n        \r\n                if(data.mark_top<data.grid_height)\r\n                    data.mark_top++;\r\n        \r\n                e = a[i]-1;\r\n                if(e>0){\r\n                    for(b=e;b>-1;b--){\r\n                        for(d=0;d<data.grid_width;d++){\r\n                            c = data.grid[d][b];\r\n                            if(c.dropped && b<data.grid_height){\r\n                            \r\n                                c.dropped = 0;\r\n                                c.active = false;\r\n                                s = c.color;\r\n                                c.color = \"white\";\r\n                                c = data.grid[d][b+1];\r\n                                c.dropped = 1;\r\n                                c.active = true;\r\n                                c.color = s;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                lineCount++;\r\n                //data.lines++;\r\n                data.next_level++;\r\n                if(a.length > 3)\r\n                    data.point_modifier += .5;\r\n        \r\n            }\r\n        \r\n        \r\n            if(data.next_level >= data.next_level_requirement){\r\n                data.next_level=0;\r\n                if(data.level<data.levels.length-1) data.level++;\r\n        \r\n                data.current_clock_value = data.levels[data.level];\r\n\r\n                clock();\r\n                clock(1);\r\n        \r\n            }\r\n        }\r\n        if(lineCount > 0){\r\n            data.lines += lineCount;\r\n            data.score += parseInt(data.point_modifier * lineCount);\r\n            console.log(data.point_modifier + \" / \" + lineCount);\r\n        }\r\n    }\r\n    \r\n    function tryStart(){\r\n        if(!data.piece_is_active)\r\n            addPiece();\r\n        \r\n    }\r\n    \r\n    function rotatePiece(i){\r\n        /* Checking the drop status is redundant since the piece vectors should be flagged in the grid. */\r\n        if(!data.piece_is_dropped && data.piece_is_active){\r\n            var o = data.piece_rotation;\r\n            data.piece_rotation += i;\r\n            if(data.piece_rotation > 3)\r\n                data.piece_rotation = 0;\r\n            \r\n            if(data.piece_rotation < 0)\r\n                data.piece_rotation= 3;\r\n            \r\n            if(evaluateGrid())\r\n                data.piece_rotation = o;\r\n            \r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function down(){\r\n        var a,b,c,p;\r\n        if(!data.piece_is_dropped && data.piece_is_active){\r\n            data.current_piece_top++;\r\n            if(evaluateGrid(1)){\r\n                data.piece_is_active = 0;\r\n                for(a = data.current_piece_left; a < data.current_piece_left + data.piece_width; a++)\r\n                    if(typeof data.grid[a]== 'object')\r\n                        for(b = data.current_piece_top; b < data.current_piece_top + data.piece_height;b++)\r\n                            if(typeof data.grid[a][b]=='object'){\r\n                                c=data.grid[a][b];\r\n                                p=data.cubes[data.active_cube_index][a - data.current_piece_left][b - data.current_piece_top][data.piece_rotation];\r\n                                if(p && !c.dropped){\r\n                                    c.dropped=1;\r\n                                    if(b < data.mark_top)\r\n                                        data.mark_top = b;\r\n                                    \r\n                                }\r\n                            }\r\n\r\n                checkClearLine();\r\n                clock();\r\n                setTimeout(addPiece,1000);\r\n            }\r\n            else if(arguments[0] == 1){\r\n                data.point_modifier += 0.5;\r\n                setTimeout(function(){ down(1);}, 1);\r\n            }\r\n            else{\r\n                data.point_modifier += 0.1;\r\n            }\r\n            m.redraw();\r\n        }\r\n        else{\r\n            console.log(\"piece dropped or isn't active\");\r\n        }\r\n        \r\n    }\r\n    function move(z){\r\n        var p= ( z > 0 ? 'piece_on_right_edge' : 'piece_on_left_edge');\r\n        if(!data[p] && data.piece_is_active){\r\n            data.current_piece_left+=z;\r\n            if(!evaluateGrid( ( z > 0 ? 3 : 2) )){\r\n                data[p] = 0;\r\n            }\r\n            m.redraw();\r\n            \r\n        }\r\n    }\r\n\r\n    function clearAllNodes(){\r\n        var c,a,b;\r\n    \r\n        data.level=1;\r\n        data.score = 0;\r\n        data.init_game=0;\r\n        data.piece_is_active=0;\r\n        data.lines=0;\r\n        data.current_clock_value = 1000;\r\n    \r\n        clock();\r\n        \r\n        for(a = 0;a < data.grid_width; a++)\r\n            for(b = 0; b < data.grid_height; b++){\r\n                c = data.grid[a][b];\r\n                c.dropped = 0;\r\n                c.active = false;\r\n            }\r\n    }\r\n    \r\n\r\n    function keyControl(e){\r\n    \r\n        var i = e.keyCode;\r\n        /* Move a piece left */\r\n        if(i==37 || i==52 || i==100)\r\n            move(-1);\r\n    \r\n        /* Move a piece right */\r\n        if(i==39 || i==54 || i==102)\r\n            move(1);\r\n    \r\n        /* Drop a piece */\r\n        if(i == 38) down(1);\r\n        if(i==40 || i==50 || i==98)\r\n            down();\r\n\r\n        /* Rotate left */\r\n        if(i==44 || i==55 || i==188 || i==101)\r\n            rotatePiece(-1);\r\n    \r\n        /* Rotate right */\r\n        if(i==46 || i==57 || i==190)\r\n            rotatePiece(1);\r\n    \r\n        /* Reset */\r\n        if(i==82 || i==114)\r\n            clearAllNodes();\r\n    \r\n        /* Start */\r\n        if(i==83 || i==115)\r\n            tryStart();\r\n    \r\n    }\r\n\r\n    function moveLeft(){\r\n        move(-1);\r\n    }\r\n    function moveRight(){\r\n        move(1);\r\n    }\r\n\r\n    function rotateLeft(){\r\n        rotatePiece(-1);\r\n    }\r\n    function rotateRight(){\r\n        rotatePiece(1);\r\n    }\r\n    function drop(){\r\n        down();\r\n    }\r\n    function start(){\r\n        tryStart();\r\n    }\r\n    function stop(){\r\n        endGame();\r\n    }\r\n    function modelPanel(){\r\n        return [m(\"div\",{class: \"results-overflow\"},\r\n                    m(\"div\",{class: \"panel-card\"},\r\n                        m(\"p\", {\"class\" : \"card-title\"}, [\r\n                            m(\"span\", {class : \"material-icons material-icons-cm mr-2\"}, icon),\r\n                            label\r\n                        ]),\r\n                        m(\"div\", {\"class\": \"card-contents\"}, modelGame())\r\n                    )\r\n            ),\r\n            m(\"div\",{class: \"result-nav-outer\"},[\r\n                m(\"div\",{class: \"result-nav-inner\"},[\r\n                    m(\"div\",{class: \"result-nav tab-container\"},[\r\n                        page.iconButton(\"button\", \"undo\", \"\", rotateLeft),\r\n                        page.iconButton(\"button\", \"west\", \"\", moveLeft),\r\n                        page.iconButton(\"button\", \"south\", \"\", drop),\r\n                        page.iconButton(\"button\", \"east\", \"\", moveRight),\r\n                        page.iconButton(\"button\", \"redo\", \"\", rotateRight)\r\n                    ])\r\n                ])\r\n            ]),\r\n        ];\r\n    }\r\n\r\n    function modelGame(){\r\n        return refreshGrid();\r\n    }\r\n\r\n    function getScoreCard(){\r\n        return m(\"div\",{class: \"result-nav-outer\"},[\r\n            m(\"div\",{class: \"result-nav-inner\"},[\r\n                page.iconButton(\"button mr-4\", \"start\", \"\", start),\r\n                m(\"div\",{class: \"count-label mr-4\"},\"Level \" + (data ? data.level : 1)),\r\n                m(\"div\",{class: \"count-label mr-4\"},\"Score \" + (data ? data.score : 0)),\r\n                page.iconButton(\"button\", \"stop\", \"\", stop)\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    tetris.component = {\r\n        keyHandler : keyControl,\r\n        scoreCard : getScoreCard,\r\n\r\n        oninit : function(x){\r\n            init();\r\n        },\r\n        oncreate : function (x) {\r\n\r\n        },\r\n        onremove : function(x){\r\n            endGame();\r\n        },\r\n\r\n        view: function () {\r\n            return modelPanel();\r\n         }\r\n    };\r\n\r\n    page.components.tetris = tetris.component;\r\n}());\r\n\n\n;/* === client/components/wordGame.js === */\n// Main Game Component\r\n\r\n// Word Game\r\n(function () {\r\n    let entity = {};\r\n    let fullMode = false;\r\n    let gridPath = \"/Olio/Universes/My Grid Universe/Worlds/My Grid World\";\r\n\r\n    // Array of common \"glue\" words for poetry.\r\n    const commonWords = [\r\n        'a', 'an', 'the', 'this', 'that', 'these', 'those', 'my', 'your', 'its', 'our', 'their', 'some', 'any', 'every', 'each', 'no',\r\n        'of', 'in', 'on', 'for', 'to', 'from', 'with', 'by', 'at', 'as', 'like', 'into', 'unto', 'over', 'under', 'above', 'below', 'beneath', 'beside', 'between', 'beyond', 'through', 'against', 'without', 'within', 'before', 'after', 'since', 'until',\r\n        'I', 'me', 'you', 'he', 'him', 'she', 'her', 'it', 'we', 'us', 'they', 'them', 'who', 'what', 'where', 'when', 'why', 'how',\r\n        'and', 'but', 'or', 'nor', 'so', 'yet', 'for', 'if', 'then', 'than', 'while', 'because', 'though',\r\n        'is', 'am', 'are', 'was', 'were', 'be', 'being', 'been', 'has', 'have', 'had', 'do', 'does', 'did', 'will', 'would', 'shall', 'should', 'can', 'could', 'may', 'might', 'must'\r\n    ];\r\n\r\n    // Function to shuffle and pick a new set of common words.\r\n    function randomizeCommonWords() {\r\n        const shuffled = commonWords.sort(() => 0.5 - Math.random());\r\n        data.activeCommonWords = shuffled.slice(0, 10); // Pick 10 random words\r\n    }\r\n\r\n    // --- UTILITY FUNCTIONS ---\r\n\r\n    function getWordColorClass(word) {\r\n        if (!word) return '';\r\n        let classes = '';\r\n\r\n        if (word.isLocked) {\r\n            classes += word.owner === 1 ? 'shadow-[0_0_8px_#60a5fa] ' : 'shadow-[0_0_8px_#4ade80] ';\r\n        }\r\n\r\n        if (word.isCustom) return classes + 'bg-gray-200 text-gray-800';\r\n\r\n        if (word.isCommon) {\r\n            if (word.player === 1) return classes + 'bg-blue-200 text-blue-800';\r\n            if (word.player === 2) return classes + 'bg-green-200 text-green-800';\r\n            return classes + 'bg-white text-black border border-gray-400';\r\n        }\r\n\r\n        switch (word.type) {\r\n            case 'n': return classes + 'bg-red-200 text-red-800';         // Noun\r\n            case 'v': return classes + 'bg-yellow-200 text-yellow-800';  // Verb\r\n            case 's': return classes + 'bg-purple-200 text-purple-800';    // Adjective\r\n            case 'a': return classes + 'bg-purple-200 text-purple-800';    // Adjective (alternate code)\r\n            case 'r': return classes + 'bg-indigo-200 text-indigo-800';   // Adverb\r\n            default:\r\n                if (word.player === 1) return classes + 'bg-blue-200 text-blue-800';\r\n                if (word.player === 2) return classes + 'bg-green-200 text-green-800';\r\n                return classes + 'bg-gray-300 text-gray-900';\r\n        }\r\n    }\r\n\r\n    function calculateTurnScore() {\r\n        if (data.timeLeft > 24) return 5;\r\n        if (data.timeLeft > 18) return 4;\r\n        if (data.timeLeft > 12) return 3;\r\n        if (data.timeLeft > 6) return 2;\r\n        return 1;\r\n    }\r\n\r\n\r\n    // --- GAME LOGIC AND STATE MANAGEMENT ---\r\n\r\n    function getInitialData() {\r\n        return {\r\n             endGameInfo: null,\r\n            isProcessingEndOfRound: false,\r\n            isGameStarted: false,\r\n            turn: 1, // 1 or 2\r\n            turnPoints: 5,\r\n            currentRound: 1,\r\n            actionsThisRound: 0,\r\n            commonWordUsedThisTurn: false,\r\n            timerId: null,\r\n            timeLeft: 30,\r\n            isPaused: false,\r\n            player1: {\r\n                name: \"Player 1\",\r\n                score: 0,\r\n                customWord: '',\r\n                customWordTimeout: null,\r\n            },\r\n            player2: {\r\n                name: \"Player 2\",\r\n                score: 0,\r\n                customWord: '',\r\n                customWordTimeout: null,\r\n                autopilot: false,\r\n            },\r\n            board: Array(8).fill(null).map(() => Array(10).fill(null)),\r\n            activeCommonWords: [],\r\n            left: [],\r\n            right: [],\r\n            foundCombinations: []\r\n        };\r\n    }\r\n\r\n    let data = getInitialData();\r\n    let coherenceScoreThreshold = 0.6;\r\n    let analyzing = false;\r\n    async function analyzeAndLockPhrases() {\r\n        if (analyzing) return;\r\n        scanForCombinations();\r\n        const phrasesToAnalyze = data.foundCombinations\r\n            .filter(combo => !combo.isLocked)\r\n            .map(combo => combo.phrase);\r\n\r\n        if (phrasesToAnalyze.length === 0) return;\r\n        analyzing = true;\r\n        try {\r\n            let resp = await m.request({\r\n                method: 'POST',\r\n                url: g_application_path + '/rest/word/analyze',\r\n                withCredentials: true,\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: { phrases: phrasesToAnalyze }\r\n            });\r\n\r\n            if (resp && resp.scores) {\r\n                resp.scores.forEach(scoredPhrase => {\r\n                    if (scoredPhrase.score >= coherenceScoreThreshold) {\r\n                        const comboToLock = data.foundCombinations.find(c => c.phrase === scoredPhrase.phrase);\r\n                        if (comboToLock) {\r\n                            // Determine ownership\r\n                            const p1Words = comboToLock.words.filter(w => w.player === 1).length;\r\n                            const p2Words = comboToLock.words.filter(w => w.player === 2).length;\r\n                            const owner = p1Words > p2Words ? 1 : (p2Words > p1Words ? 2 : data.turn);\r\n\r\n                            // Mark words on board as locked\r\n                            const phraseId = Date.now() + Math.random();\r\n                            comboToLock.words.forEach(wordInfo => {\r\n                                const boardWord = data.board[wordInfo.row][wordInfo.col];\r\n                                if (boardWord && boardWord.name === wordInfo.word) {\r\n                                    boardWord.isLocked = true;\r\n                                    boardWord.phraseId = phraseId;\r\n                                    boardWord.owner = owner;\r\n                                }\r\n                            });\r\n                            page.toast(\"success\", `Phrase \"${scoredPhrase.phrase}\" locked by Player ${owner}!`);\r\n                        }\r\n                    }\r\n                    else {\r\n                        console.log(`Phrase \"${scoredPhrase.phrase}\" not coherent enough to lock (score: ${scoredPhrase.score}).`);\r\n                    }\r\n                    analyzing = false;\r\n                });\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Error analyzing phrases:\", e);\r\n            page.toast(\"error\", \"Could not analyze phrases.\");\r\n            analyzing = false;\r\n        }\r\n    }\r\n\r\n\r\n    function scanForCombinations() {\r\n        const combinations = [];\r\n        data.board.forEach((row, rIdx) => {\r\n            let currentCombination = [];\r\n            row.forEach((cell, cIdx) => {\r\n                if (cell) {\r\n                    currentCombination.push({\r\n                        word: cell.name,\r\n                        player: cell.player,\r\n                        row: rIdx,\r\n                        col: cIdx,\r\n                        isLocked: !!cell.isLocked // Pass lock status\r\n                    });\r\n                } else {\r\n                    if (currentCombination.length >= 2) {\r\n                        combinations.push({\r\n                            phrase: currentCombination.map(c => c.word).join(' '),\r\n                            row: rIdx,\r\n                            words: currentCombination,\r\n                            isLocked: currentCombination.every(c => c.isLocked)\r\n                        });\r\n                    }\r\n                    currentCombination = [];\r\n                }\r\n            });\r\n            if (currentCombination.length >= 2) {\r\n                combinations.push({\r\n                    phrase: currentCombination.map(c => c.word).join(' '),\r\n                    row: rIdx,\r\n                    words: currentCombination,\r\n                    isLocked: currentCombination.every(c => c.isLocked)\r\n                });\r\n            }\r\n        });\r\n        data.foundCombinations = combinations;\r\n    }\r\n\r\nasync function handleEndOfRound() {\r\n        // --- STEP 1: Set processing state to show the overlay ---\r\n        data.isProcessingEndOfRound = true;\r\n        page.toast(\"info\", `Round ${data.currentRound} has ended! Calculating scores...`);\r\n        clearInterval(data.timerId);\r\n        data.isPaused = true;\r\n        m.redraw();\r\n\r\n        scanForCombinations();\r\n        const combinationsThisRound = [...data.foundCombinations];\r\n        \r\n        // Award initial points for all formed phrases\r\n        combinationsThisRound.forEach(combo => {\r\n            const p1Words = combo.words.filter(w => w.player === 1).length;\r\n            const p2Words = combo.words.filter(w => w.player === 2).length;\r\n            let owner = p1Words > p2Words ? 1 : (p2Words > p1Words ? 2 : 0);\r\n\r\n            if (owner !== 0) {\r\n                combo.owner = owner;\r\n                if (owner === 1) data.player1.score += 5; else data.player2.score += 5;\r\n                page.toast(\"success\", `Player ${owner} gets 5 points for forming \"${combo.phrase}\"`);\r\n            }\r\n        });\r\n\r\n        // --- STEP 2: Process all phrases serially using a for...of loop ---\r\n        const survivingPhrases = [];\r\n        const combosToEvaluate = combinationsThisRound.filter(c => c.owner);\r\n\r\n        // This for...of loop will pause and wait for each chat call\r\n        for (const combo of combosToEvaluate) {\r\n            try {\r\n                const response = await am7chat.chat(gameChat, combo.phrase);\r\n                const lastMessage = response?.messages?.[response.messages.length - 1]?.content;\r\n                \r\n                if (lastMessage && lastMessage.toLowerCase().trim() !== 'incoherent') {\r\n                    // Phrase is coherent, award bonus and mark for survival\r\n                    page.toast(\"success\", `Phrase \"${combo.phrase}\" is coherent! Player ${combo.owner} gets 10 bonus points!`);\r\n                    if (combo.owner === 1) data.player1.score += 10; else data.player2.score += 10;\r\n                    survivingPhrases.push(combo);\r\n                } else {\r\n                    // Phrase is incoherent\r\n                    page.toast(\"info\", `Phrase \"${combo.phrase}\" was incoherent and is removed.`);\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Error evaluating phrase:\", combo.phrase, e);\r\n                page.toast(\"error\", `Could not evaluate phrase: \"${combo.phrase}\"`);\r\n            }\r\n        }\r\n        \r\n        // --- STEP 3: Rebuild the board ---\r\n        const newBoard = Array(8).fill(null).map(() => Array(10).fill(null));\r\n        let nextAvailableRow = 0;\r\n        if( survivingPhrases.length === 0) {\r\n            page.toast(\"info\", \"No coherent phrases survived this round. Going to next round.\");\r\n        }\r\n        survivingPhrases.forEach(combo => {\r\n            if (nextAvailableRow < data.board.length) {\r\n                combo.words.forEach(wordInfo => {\r\n                    const originalWord = data.board[wordInfo.row][wordInfo.col];\r\n                    if (originalWord) newBoard[nextAvailableRow][wordInfo.col] = originalWord;\r\n                });\r\n                nextAvailableRow++;\r\n            }\r\n        });\r\n        data.board = newBoard;\r\n\r\n        // --- STEP 4: CHECK FOR END GAME CONDITION ---\r\n        // Condition: The number of surviving phrases equals the total number of rows.\r\n        if (survivingPhrases.length > 0 && survivingPhrases.length >= data.board.length) {\r\n            const finalPhraseStrings = survivingPhrases.map(p => p.phrase);\r\n            triggerEndGame(finalPhraseStrings); // Trigger the end game routine\r\n            return; // Stop the normal round progression\r\n        }\r\n\r\n        // --- STEP 5: Reset for the next round (if not game over) ---\r\n        data.currentRound++;\r\n        data.actionsThisRound = 0;\r\n        data.isPaused = false;\r\n        data.isProcessingEndOfRound = false; // Hide the overlay\r\n        page.toast(\"success\", `Starting Round ${data.currentRound}!`);\r\n        \r\n        switchTurn();\r\n        m.redraw();\r\n    }\r\n\r\n     async function triggerEndGame(finalPhrases) {\r\n        page.toast(\"success\", \"Game Over! All rows are coherent phrases!\");\r\n        \r\n        // 1. Determine the winner\r\n        let winner = \"It's a tie!\";\r\n        if (data.player1.score > data.player2.score) winner = \"Player 1 Wins!\";\r\n        if (data.player2.score > data.player1.score) winner = \"Player 2 Wins!\";\r\n\r\n        // 2. Stub out the final LLM call (as requested)\r\n        const finalPrompt = `Create a poem and brief analysis from the following coherent phrases:\\n\\n${finalPhrases.join(\"\\n\")}.`;\r\n        let finalMessage = \"### Final Summary\\n\\nThe AI summary could not be generated at this time.\";\r\n        try {\r\n            const response = await am7chat.chat(endGameChat, finalPrompt);\r\n            const content = response?.messages?.[response.messages.length - 1]?.content;\r\n            if (content) finalMessage = content;\r\n        } catch (e) {\r\n            console.error(\"Failed to get final game summary:\", e);\r\n        }\r\n\r\n        // 3. Set the state to show the popup\r\n        data.endGameInfo = {\r\n            winner: winner,\r\n            finalMessage: finalMessage\r\n        };\r\n        data.isProcessingEndOfRound = false; // Turn off the \"calculating\" screen\r\n        m.redraw();\r\n    }\r\n\r\n    //let chatName = \"WordBattle.chat\";\r\n    let chatName = \"A1 Mini\";\r\n    async function prepareChatConfig() {\r\n        return am7chat.makeChat(chatName, \"herm-local\", \"http://localhost:11434\", \"ollama\");\r\n    }\r\n\r\n    let endPromptName = \"WordBattleEndRound.prompt\";\r\n    async function prepareEndPrompt() {\r\n\r\n        return am7chat.makePrompt(endPromptName, [\r\n            \"You are the controller for a word battle game. You receive phrases you have identified as coherent.\",\r\n            \"Your job is to format these phrases into a poem.  You are allowed to make changes to each phrase by changing word order, tense, count, or adding pronoun, preposition, or conjunction.\",\r\n            \"The resulting poem may use any or no rhyme and meter.\",\r\n            \"Following the poem, you will include an analysis of the poem. For the analysis, you will adopt the persona of a very pompous literary critic who extolls the brilliance, profoundness, and genius of the poem while downplaying any negative qualities.\",\r\n            \"USE *markdown* TO FORMAT YOUR RESPONSE.\"\r\n        ]);\r\n    }\r\n\r\n\r\n    let promptName = \"WordBattlePhraseCoherence.prompt\";\r\n    async function preparePrompt() {\r\n\r\n        return am7chat.makePrompt(promptName, [\r\n            \"You are the controller for a word battle game. Random words will be assembled into phrases. Possible coherent phrases will be sent to you to be evaluated.\",\r\n            \"Your job is to evaluate these phrases and respond in one of three ways:\",\r\n            \"1. If the phrase is incoherent, respond with 'incoherent'.\",\r\n            \"2. If the phrase is coherent as-is, respond with the phrase itself.\",\r\n            \"3. If the phrase can be improved by changing word order, tense, count, etc, or by adding a pronoun, preposition, or conjunction, then respond with the improved phrase.\",\r\n            \"Example: 'Holbein fatally choke vicariously' -> 'Holbein fatally choked vicariously'\",\r\n            \"Example: 'aphyllous blood count' -> 'incoherent'\",\r\n            \"Example: 'blessed whistle' -> 'blessed whistle'\",\r\n            \"Example: 'like blessed whistle knock' -> 'knocked like a blessed whistle'\"\r\n        ]);\r\n    }\r\n\r\n    let chatRequestName = \"WordBattle Chat\";\r\n    let endChatRequestName = \"WordBattle End Chat\";\r\n\r\n    let endPromptCfg = null;\r\n    let promptCfg = null;\r\n    let chatCfg = null;\r\n    let gameChat = null;\r\n    let endGameChat = null;\r\n    async function startGame() {\r\n        promptCfg = await preparePrompt();\r\n        if (!promptCfg) {\r\n            page.toast(\"Error\", \"Could not start game without prompt config\");\r\n            return;\r\n        }\r\n        endPromptCfg = await prepareEndPrompt();\r\n        if (!promptCfg) {\r\n            page.toast(\"Error\", \"Could not start game without end prompt config\");\r\n            return;\r\n        }\r\n\r\n        chatCfg = await prepareChatConfig();\r\n        if (!chatCfg) {\r\n            page.toast(\"Error\", \"Could not start game without chat config\");\r\n            return;\r\n        }\r\n        gameChat = await am7chat.getChatRequest(chatRequestName, chatCfg, promptCfg);\r\n        if (!gameChat) {\r\n            page.toast(\"Error\", \"Could not start game without chat request\");\r\n            return;\r\n        }\r\n\r\n        endGameChat = await am7chat.getChatRequest(endChatRequestName, chatCfg, endPromptCfg);\r\n        if (!endGameChat) {\r\n            page.toast(\"Error\", \"Could not start game without end chat request\");\r\n            return;\r\n        }\r\n\r\n\r\n        await prepareWords();\r\n        data.isGameStarted = true;\r\n\r\n        startTimer();\r\n    }\r\n\r\n    function resetGame() {\r\n        clearInterval(data.timerId);\r\n        page.toast(\"info\", \"Game has been reset.\");\r\n        data = getInitialData();\r\n        setup();\r\n    }\r\n\r\n    function togglePause() {\r\n        if (!data.isGameStarted) return;\r\n        data.isPaused = !data.isPaused;\r\n        page.toast(\"info\", `Timer ${data.isPaused ? 'paused' : 'resumed'}.`);\r\n        m.redraw();\r\n    }\r\n\r\n    function exportBoardState() {\r\n        scanForCombinations(); // Ensure combinations are up-to-date\r\n        const exportedData = {\r\n            gameState: {\r\n                currentRound: data.currentRound,\r\n                actionsRemainingInRound: 20 - data.actionsThisRound,\r\n                scores: {\r\n                    player1: data.player1.score,\r\n                    player2: data.player2.score,\r\n                },\r\n            },\r\n            playerHands: {\r\n                player1: data.left.map(w => ({ name: w.name, type: w.type || (w.isCustom ? 'custom' : 'unknown') })),\r\n                player2: data.right.map(w => ({ name: w.name, type: w.type || (w.isCustom ? 'custom' : 'unknown') })),\r\n            },\r\n            board: [],\r\n            wordCombinations: data.foundCombinations\r\n        };\r\n\r\n        data.board.forEach((row, rIdx) => {\r\n            row.forEach((cell, cIdx) => {\r\n                if (cell) {\r\n                    exportedData.board.push({\r\n                        row: rIdx,\r\n                        col: cIdx,\r\n                        word: cell.name,\r\n                        type: cell.type || (cell.isCommon ? 'common' : 'custom'),\r\n                        player: cell.player,\r\n                        isLocked: !!cell.isLocked,\r\n                        owner: cell.owner || null\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        const jsonString = JSON.stringify(exportedData, null, 2);\r\n        //console.log(\"Exported Board State:\", jsonString);\r\n        console.log(exportedData);\r\n\r\n        try {\r\n            const textArea = document.createElement(\"textarea\");\r\n            textArea.value = jsonString;\r\n            textArea.style.position = \"fixed\";\r\n            textArea.style.left = \"-9999px\";\r\n            document.body.appendChild(textArea);\r\n            textArea.focus();\r\n            textArea.select();\r\n            document.execCommand('copy');\r\n            document.body.removeChild(textArea);\r\n            page.toast(\"success\", \"Board state copied to clipboard!\");\r\n        } catch (err) {\r\n            page.toast(\"error\", \"Could not copy. See browser console for data.\");\r\n            console.error(\"Clipboard write failed:\", err);\r\n        }\r\n    }\r\n\r\n\r\n    function startTimer() {\r\n        clearInterval(data.timerId);\r\n        data.timeLeft = 30;\r\n        data.timerId = setInterval(() => {\r\n            if (data.isPaused) return;\r\n\r\n            data.timeLeft--;\r\n            if (data.timeLeft <= 0) {\r\n                page.toast(\"info\", `Player ${data.turn} ran out of time!`);\r\n                if (data.turn === 1) data.player1.score--;\r\n                else data.player2.score--;\r\n                switchTurn();\r\n            }\r\n            m.redraw();\r\n        }, 1000);\r\n    }\r\n\r\n    function switchTurn() {\r\n        data.turn = data.turn === 1 ? 2 : 1;\r\n        data.turnPoints = 5;\r\n        data.commonWordUsedThisTurn = false;\r\n        startTimer();\r\n\r\n        if (data.turn === 2 && data.player2.autopilot) {\r\n            setTimeout(runAutopilot, 1500);\r\n        }\r\n    }\r\n\r\n    function spendTurnPoints(points) {\r\n        data.turnPoints -= points;\r\n        if (data.turnPoints <= 0) {\r\n            data.actionsThisRound++;\r\n            if (data.actionsThisRound >= 20) {\r\n                // Trigger the new end-of-round logic\r\n                handleEndOfRound(); \r\n            } else {\r\n                // Continue to the next turn normally\r\n                setTimeout(switchTurn, 200);\r\n            }\r\n        }\r\n    }\r\n\r\n    function handleRefreshWords(playerNum) {\r\n        let player = playerNum === 1 ? data.player1 : data.player2;\r\n        let words = playerNum === 1 ? data.left : data.right;\r\n\r\n        if (words.length > 5) player.score--;\r\n        if (words.length >= 6) player.score -= 5;\r\n        page.toast(\"info\", `Player ${playerNum} refreshed their word list.`);\r\n        prepareWords(playerNum);\r\n    }\r\n\r\n    function handleCustomWord(playerNum, value) {\r\n        let player = playerNum === 1 ? data.player1 : data.player2;\r\n        player.customWord = value;\r\n\r\n        clearTimeout(player.customWordTimeout);\r\n        player.customWordTimeout = setTimeout(() => {\r\n            addCustomWord(playerNum);\r\n        }, 5000);\r\n    }\r\n\r\n    function addCustomWord(playerNum) {\r\n        let player = playerNum === 1 ? data.player1 : data.player2;\r\n        const wordName = player.customWord.trim();\r\n        if (wordName) {\r\n            const isDuplicate = data.left.some(w => w.name.toLowerCase() === wordName.toLowerCase()) ||\r\n                data.right.some(w => w.name.toLowerCase() === wordName.toLowerCase());\r\n\r\n            if (isDuplicate) {\r\n                page.toast(\"error\", \"Cannot add a duplicate word.\");\r\n                player.customWord = '';\r\n                return;\r\n            }\r\n\r\n            const newWord = { name: wordName, isCustom: true, definition: \"A custom word.\" };\r\n            if (playerNum === 1) data.left.unshift(newWord);\r\n            else data.right.unshift(newWord);\r\n            page.toast(\"info\", `Player ${playerNum} added the custom word '${wordName}'.`);\r\n            player.customWord = '';\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n    function runAutopilot() {\r\n        if (data.turn !== 2 || !data.player2.autopilot) return;\r\n\r\n        const choice = Math.random();\r\n\r\n        let emptyCells = [];\r\n        data.board.forEach((row, rIdx) => row.forEach((cell, cIdx) => { if (!cell) emptyCells.push({ r: rIdx, c: cIdx }); }));\r\n\r\n        if (choice < 0.7 && data.right.length > 0 && emptyCells.length > 0) {\r\n            const wordToPlace = data.right[Math.floor(Math.random() * data.right.length)];\r\n            const wordIndex = data.right.indexOf(wordToPlace);\r\n            const targetCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];\r\n\r\n            const wordWithPlayer = { ...wordToPlace, player: 2 };\r\n            data.board[targetCell.r][targetCell.c] = wordWithPlayer;\r\n            data.right.splice(wordIndex, 1);\r\n\r\n            const points = calculateTurnScore();\r\n            data.player2.score += points;\r\n            page.toast(\"info\", `Autopilot placed '${wordWithPlayer.name}' for ${points} points.`);\r\n            analyzeAndLockPhrases();\r\n            spendTurnPoints(5);\r\n            if (data.right.length < 5) prepareWords(2, true);\r\n        }\r\n        else if (choice < 0.9 && !data.commonWordUsedThisTurn && emptyCells.length > 0) {\r\n            const wordToPlace = data.activeCommonWords[Math.floor(Math.random() * data.activeCommonWords.length)];\r\n            const targetCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];\r\n\r\n            const wordWithPlayer = { name: wordToPlace, isCommon: true, player: 2 };\r\n            data.board[targetCell.r][targetCell.c] = wordWithPlayer;\r\n            data.commonWordUsedThisTurn = true;\r\n            page.toast(\"info\", `Autopilot placed common word '${wordWithPlayer.name}'.`);\r\n            analyzeAndLockPhrases();\r\n            setTimeout(switchTurn, 200);\r\n        }\r\n        else {\r\n            page.toast(\"info\", \"Autopilot passed its turn.\");\r\n            switchTurn();\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    async function shiftWords(direction) {\r\n        // Unlock all words before shifting\r\n        data.board.forEach(row => row.forEach(cell => {\r\n            if (cell) {\r\n                cell.isLocked = false;\r\n                cell.phraseId = null;\r\n                cell.owner = null;\r\n            }\r\n        }));\r\n\r\n        const rows = data.board.length;\r\n        const cols = data.board[0].length;\r\n        const newBoard = Array(rows).fill(null).map(() => Array(cols).fill(null));\r\n\r\n        // **BUG FIX START**: Capture coordinates when gathering words.\r\n        const allWords = [];\r\n        data.board.forEach((row, rIdx) => row.forEach((cell, cIdx) => {\r\n            if (cell) allWords.push({ ...cell, row: rIdx, col: cIdx });\r\n        }));\r\n        // **BUG FIX END**\r\n\r\n        if (direction === 'up') {\r\n            for (let c = 0; c < cols; c++) {\r\n                const colWords = allWords.filter(w => w.col === c).sort((a, b) => a.row - b.row);\r\n                colWords.forEach((word, r) => newBoard[r][c] = word);\r\n            }\r\n        } else if (direction === 'down') {\r\n            for (let c = 0; c < cols; c++) {\r\n                const colWords = allWords.filter(w => w.col === c).sort((a, b) => b.row - a.row);\r\n                colWords.forEach((word, i) => newBoard[rows - 1 - i][c] = word);\r\n            }\r\n        } else if (direction === 'left') {\r\n            for (let r = 0; r < rows; r++) {\r\n                const rowWords = allWords.filter(w => w.row === r).sort((a, b) => a.col - b.col);\r\n                rowWords.forEach((word, c) => newBoard[r][c] = word);\r\n            }\r\n        } else if (direction === 'right') {\r\n            for (let r = 0; r < rows; r++) {\r\n                const rowWords = allWords.filter(w => w.row === r).sort((a, b) => b.col - a.col);\r\n                rowWords.forEach((word, i) => newBoard[r][cols - 1 - i] = word);\r\n            }\r\n        }\r\n\r\n        data.board = newBoard;\r\n        page.toast(\"info\", `Player ${data.turn} shifted the board ${direction}.`);\r\n        await analyzeAndLockPhrases();\r\n        spendTurnPoints(5);\r\n        m.redraw();\r\n    }\r\n\r\n\r\n    // --- DRAG AND DROP HANDLERS ---\r\n\r\n    function findEmptyAdjacent(row, col) {\r\n        const directions = [[0, 1], [0, -1], [1, 0], [-1, 0], [1, 1], [1, -1], [-1, 1], [-1, -1]];\r\n        for (const [dr, dc] of directions) {\r\n            const newRow = row + dr, newCol = col + dc;\r\n            if (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 10 && !data.board[newRow][newCol]) {\r\n                return { r: newRow, c: newCol };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function handleGridDragStart(e, word, rowIndex, colIndex) {\r\n        e.stopPropagation();\r\n        e.dataTransfer.effectAllowed = 'move'; // Firefox compatibility\r\n        const payload = { word: word, source: 'board', rowIndex: rowIndex, colIndex: colIndex };\r\n        e.dataTransfer.setData(\"text/plain\", JSON.stringify(payload));\r\n    }\r\n\r\n    function handleDrop(e, targetRowIndex, targetColIndex) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const payload = JSON.parse(e.dataTransfer.getData(\"text/plain\"));\r\n\r\n        const targetCell = data.board[targetRowIndex][targetColIndex];\r\n        const emptySpot = findEmptyAdjacent(targetRowIndex, targetColIndex);\r\n\r\n        if (targetCell && targetCell.isLocked && emptySpot) {\r\n            page.toast(\"error\", \"Cannot bump a locked phrase.\");\r\n            return;\r\n        }\r\n\r\n        if (payload.source === 'common' && data.commonWordUsedThisTurn) return;\r\n        if ((payload.source === 'left' && data.turn !== 1) || (payload.source === 'right' && data.turn !== 2)) return;\r\n        if (payload.source === 'board' && payload.word.player !== data.turn) return;\r\n\r\n        const wordWithPlayer = { ...payload.word, player: data.turn };\r\n\r\n        if (targetCell) {\r\n            const bumpedWord = targetCell;\r\n            if (emptySpot) {\r\n                data.board[emptySpot.r][emptySpot.c] = bumpedWord;\r\n                page.toast(\"info\", `Player ${bumpedWord.player}'s word '${bumpedWord.name}' was bumped.`);\r\n            } else { // Destruction logic\r\n                if (bumpedWord.isLocked) {\r\n                    data.board.forEach(row => row.forEach(cell => {\r\n                        if (cell && cell.phraseId === bumpedWord.phraseId) {\r\n                            cell.isLocked = false;\r\n                            cell.phraseId = null;\r\n                            cell.owner = null;\r\n                        }\r\n                    }));\r\n                    page.toast(\"info\", `A locked phrase owned by Player ${bumpedWord.owner} was broken!`);\r\n                }\r\n                if (!bumpedWord.isCommon && !bumpedWord.isCustom) {\r\n                    if (bumpedWord.player === 1) data.player1.score -= 5;\r\n                    else data.player2.score -= 5;\r\n                    page.toast(\"info\", `Player ${bumpedWord.player}'s word '${bumpedWord.name}' was destroyed! (-5 points)`);\r\n                } else {\r\n                    page.toast(\"info\", `Player ${bumpedWord.player}'s word '${bumpedWord.name}' was destroyed!`);\r\n                }\r\n            }\r\n        }\r\n\r\n        data.board[targetRowIndex][targetColIndex] = wordWithPlayer;\r\n\r\n        if (payload.source !== 'board') page.toast(\"info\", `Player ${data.turn} placed the word '${wordWithPlayer.name}'.`);\r\n\r\n        if (payload.source === 'left') {\r\n            data.left.splice(payload.index, 1);\r\n            if (data.left.length < 5) prepareWords(1, true);\r\n        } else if (payload.source === 'right') {\r\n            data.right.splice(payload.index, 1);\r\n            if (data.right.length < 5) prepareWords(2, true);\r\n        } else if (payload.source === 'board') {\r\n            data.board[payload.rowIndex][payload.colIndex] = null;\r\n        } else if (payload.source === 'common') {\r\n            data.commonWordUsedThisTurn = true;\r\n        }\r\n\r\n        if (payload.source !== 'common' && payload.source !== 'board') {\r\n            const points = calculateTurnScore();\r\n            if (data.turn === 1) data.player1.score += points;\r\n            else data.player2.score += points;\r\n            page.toast(\"success\", `Player ${data.turn} scored ${points} points!`);\r\n            spendTurnPoints(5);\r\n        }\r\n\r\n        analyzeAndLockPhrases();\r\n        randomizeCommonWords();\r\n        m.redraw();\r\n    }\r\n\r\n    function handleTrashDrop(e) {\r\n        e.preventDefault();\r\n        const payload = JSON.parse(e.dataTransfer.getData(\"text/plain\"));\r\n\r\n        if (payload.source === 'board' && payload.word.player === data.turn) {\r\n            const wordToTrash = payload.word;\r\n            if (wordToTrash.isLocked) {\r\n                // If a locked word is trashed, unlock the entire phrase\r\n                data.board.forEach(row => row.forEach(cell => {\r\n                    if (cell && cell.phraseId === wordToTrash.phraseId) {\r\n                        cell.isLocked = false;\r\n                        cell.phraseId = null;\r\n                        cell.owner = null;\r\n                    }\r\n                }));\r\n                page.toast(\"info\", \"A locked phrase was broken!\");\r\n            }\r\n\r\n            if (!wordToTrash.isCommon && !wordToTrash.isCustom) {\r\n                if (data.turn === 1) data.player1.score -= 5;\r\n                else data.player2.score -= 5;\r\n            }\r\n            page.toast(\"info\", `Player ${data.turn} trashed the word '${wordToTrash.name}'.`);\r\n            data.board[payload.rowIndex][payload.colIndex] = null;\r\n            analyzeAndLockPhrases();\r\n            spendTurnPoints(5);\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n\r\n    // --- VIEW COMPONENTS ---\r\n\r\n    function modelPanel() {\r\n        if (!data.isGameStarted) {\r\n            return m(\"div\", { class: \"flex-grow flex items-center justify-center bg-gray-100 dark:bg-black\" }, [\r\n                m(\"div\", { class: \"text-center\" }, [\r\n                    m(\"h1\", { class: \"text-4xl font-bold mb-4 dark:text-white\" }, \"Word Battle\"),\r\n                    m(\"button\", { class: \"menu-button text-2xl p-4\", onclick: startGame }, \"Start Game\")\r\n                ])\r\n            ]);\r\n        }\r\n\r\n        return m(\"div\", { class: \"relative flex-grow overflow-hidden flex bg-white border border-gray-200 dark:bg-black dark:border-gray-700 dark:text-gray-200\" }, [\r\n            data.isProcessingEndOfRound ? m(\"div\", { class: \"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50\" }, [\r\n                m(\"div\", { class: \"text-white text-2xl font-bold animate-pulse\" }, \"Calculating End of Round Scores...\")\r\n            ]) : null,\r\n            data.endGameInfo ? m(\"div\", { class: \"absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4\" },\r\n                m(\"div\", { class: \"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-2xl w-full text-center\" }, [\r\n                    m(\"h1\", { class: \"text-4xl font-bold text-blue-500 mb-2\" }, \"Game Over!\"),\r\n                    m(\"h2\", { class: \"text-3xl font-semibold mb-4 dark:text-white\" }, data.endGameInfo.winner),\r\n                    m(\"div\", { class: \"prose dark:prose-invert text-left p-4 my-4 border rounded-md max-h-60 overflow-y-auto\" },\r\n                        // This will render the markdown from the AI\r\n                        m.trust(marked.parse(data.endGameInfo.finalMessage))\r\n                    ),\r\n                    m(\"button\", { \r\n                        class: \"menu-button text-xl p-3 mt-4\", \r\n                        onclick: resetGame \r\n                    }, \"Play Again\")\r\n                ])\r\n            ) : null,\r\n            m(\"div\", { class: \"flex flex-col w-full overflow-hidden p-0\" }, [\r\n                m(\"div\", { class: \"flex-1 overflow-hidden\" }, [\r\n                    m(\"div\", { class: \"max-h-full h-full flex\" }, [\r\n                        // Player 1 Panel\r\n                        m(\"div\", { class: `flex flex-col w-1/4 p-4 overflow-y-auto mx-auto ${data.turn === 1 ? 'bg-blue-100 dark:bg-blue-900' : ''}` }, [\r\n                            m(\"div\", { class: \"flex justify-between items-center\" }, [\r\n                                m(\"h3\", { class: \"text-lg font-bold\" }, \"Player 1\"),\r\n                                m(\"div\", { class: \"font-bold text-xl p-2 bg-gray-200 dark:bg-gray-700 rounded\" }, data.player1.score)\r\n                            ]),\r\n                            m(\"input\", {\r\n                                class: \"w-full p-1 my-2 border rounded\",\r\n                                placeholder: \"Add custom word...\",\r\n                                value: data.player1.customWord,\r\n                                oninput: (e) => handleCustomWord(1, e.target.value),\r\n                                onblur: () => addCustomWord(1),\r\n                                disabled: data.turn !== 1\r\n                            }),\r\n                            m(\"button\", { class: \"menu-button\", onclick: () => handleRefreshWords(1), disabled: data.turn !== 1 }, [m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"refresh\"), \"Refresh Words\"]),\r\n                            leftWords()\r\n                        ]),\r\n\r\n                        // Center Game Board Panel\r\n                        m(\"div\", { class: \"flex flex-col w-3/5 p-2 overflow-auto mx-auto\" }, [\r\n                            m(\"h2\", { class: \"text-center text-2xl font-bold\" }, \"Word Battle\"),\r\n                            m(\"div\", { class: \"text-center font-semibold text-lg\" }, `Round: ${data.currentRound} | Actions Left: ${20 - data.actionsThisRound}`),\r\n                            m(\"div\", { class: \"text-center font-semibold text-lg\" }, `Turn: Player ${data.turn} | Time: ${data.timeLeft}s | Turn Actions: ${data.turnPoints}`),\r\n                            m(\"div\", { class: \"menu-buttons-spaced my-2 justify-center\" },\r\n                                data.activeCommonWords.map(word =>\r\n                                    m(\"button\", {\r\n                                        draggable: !data.commonWordUsedThisTurn,\r\n                                        class: `menu-button ${getWordColorClass({ isCommon: true })} ${data.commonWordUsedThisTurn ? 'opacity-50 cursor-not-allowed' : ''}`,\r\n                                        ondragstart: (e) => {\r\n                                            if (data.commonWordUsedThisTurn) {\r\n                                                e.preventDefault();\r\n                                                return;\r\n                                            }\r\n                                            e.dataTransfer.effectAllowed = 'move'; // Firefox compatibility\r\n                                            const payload = { word: { name: word, isCommon: true }, source: 'common' };\r\n                                            e.dataTransfer.setData(\"text/plain\", JSON.stringify(payload));\r\n                                        }\r\n                                    }, word)\r\n                                )\r\n                            ),\r\n                            m(\"table\", { class: \"w-full border-collapse mt-2 table-fixed\" }, [\r\n                                m(\"tbody\",\r\n                                    data.board.map((row, rowIndex) =>\r\n                                        m(\"tr\", { key: rowIndex },\r\n                                            row.map((slot, colIndex) =>\r\n                                                m(\"td\", {\r\n                                                    class: \"border border-gray-500 h-12 p-1\",\r\n                                                    ondragover: (e) => e.preventDefault(),\r\n                                                    ondrop: (e) => handleDrop(e, rowIndex, colIndex)\r\n                                                },\r\n                                                    slot ? m(\"div\", {\r\n                                                        class: `p-1 rounded text-center text-sm cursor-move ${getWordColorClass(slot)}`,\r\n                                                        draggable: slot.player === data.turn && !slot.isLocked,\r\n                                                        title: slot.definition,\r\n                                                        ondragstart: (e) => handleGridDragStart(e, slot, rowIndex, colIndex)\r\n                                                    }, slot.name)\r\n                                                        : m(\"div\", { class: \"w-full h-full\" })\r\n                                                )\r\n                                            )\r\n                                        )\r\n                                    )\r\n                                )\r\n                            ]),\r\n                            m(\"div\", { class: \"flex justify-center items-center mt-2\" }, [\r\n                                m(\"button\", { class: \"menu-button\", onclick: resetGame }, m(\"span\", { class: \"material-symbols-outlined\" }, \"restart_alt\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: togglePause }, m(\"span\", { class: \"material-symbols-outlined\" }, data.isPaused ? \"play_arrow\" : \"pause\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: exportBoardState }, m(\"span\", { class: \"material-symbols-outlined\" }, \"download\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: () => shiftWords('up'), disabled: data.turnPoints < 5 }, m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_upward\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: () => shiftWords('down'), disabled: data.turnPoints < 5 }, m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_downward\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: () => shiftWords('left'), disabled: data.turnPoints < 5 }, m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_back\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: () => shiftWords('right'), disabled: data.turnPoints < 5 }, m(\"span\", { class: \"material-symbols-outlined\" }, \"arrow_forward\")),\r\n                                m(\"button\", { class: \"menu-button\", onclick: () => { page.toast(\"info\", `Player ${data.turn} passed their turn.`); switchTurn(); } }, \"Pass\"),\r\n                                m(\"button\", {\r\n                                    class: \"flyout-button text-center ml-2\",\r\n                                    ondragover: (e) => e.preventDefault(),\r\n                                    ondrop: handleTrashDrop\r\n                                }, [m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"delete\"), \"Trash\"])\r\n                            ])\r\n                        ]),\r\n\r\n                        // Player 2 Panel\r\n                        m(\"div\", { class: `flex flex-col w-1/4 p-4 overflow-y-auto mx-auto ${data.turn === 2 ? 'bg-green-100 dark:bg-green-900' : ''}` }, [\r\n                            m(\"div\", { class: \"flex justify-between items-center\" }, [\r\n                                m(\"h3\", { class: \"text-lg font-bold\" }, \"Player 2\"),\r\n                                m(\"div\", { class: \"font-bold text-xl p-2 bg-gray-200 dark:bg-gray-700 rounded\" }, data.player2.score)\r\n                            ]),\r\n                            m(\"input\", {\r\n                                class: \"w-full p-1 my-2 border rounded\",\r\n                                placeholder: \"Add custom word...\",\r\n                                value: data.player2.customWord,\r\n                                oninput: (e) => handleCustomWord(2, e.target.value),\r\n                                onblur: () => addCustomWord(2),\r\n                                disabled: data.turn !== 2\r\n                            }),\r\n                            m(\"button\", { class: \"menu-button\", onclick: () => handleRefreshWords(2), disabled: data.turn !== 2 }, [m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"refresh\"), \"Refresh Words\"]),\r\n                            m(\"label\", { class: \"flex items-center my-2\" }, [\r\n                                m(\"input\", {\r\n                                    type: \"checkbox\",\r\n                                    checked: data.player2.autopilot,\r\n                                    onchange: (e) => { data.player2.autopilot = e.target.checked; if (data.turn === 2 && data.player2.autopilot) runAutopilot(); }\r\n                                }),\r\n                                m(\"span\", { class: \"ml-2\" }, \"Autopilot\")\r\n                            ]),\r\n                            rightWords()\r\n                        ])\r\n                    ])\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    function leftWords() {\r\n        return data.left.map((word, index) => m(\"button\", {\r\n            draggable: data.turn === 1,\r\n            class: `flyout-button ${getWordColorClass(word)}`,\r\n            title: word.definition,\r\n            ondragstart: (e) => {\r\n                e.dataTransfer.effectAllowed = 'move'; // Firefox compatibility\r\n                const payload = { word: word, source: 'left', index: index };\r\n                e.dataTransfer.setData(\"text/plain\", JSON.stringify(payload));\r\n            }\r\n        }, word.name));\r\n    }\r\n\r\n    function rightWords() {\r\n        return data.right.map((word, index) => m(\"button\", {\r\n            draggable: data.turn === 2,\r\n            class: `flyout-button ${getWordColorClass(word)}`,\r\n            title: word.definition,\r\n            ondragstart: (e) => {\r\n                e.dataTransfer.effectAllowed = 'move'; // Firefox compatibility\r\n                const payload = { word: word, source: 'right', index: index };\r\n                e.dataTransfer.setData(\"text/plain\", JSON.stringify(payload));\r\n            }\r\n        }, word.name));\r\n    }\r\n\r\n    // --- DATA FETCHING AND SETUP ---\r\n\r\n    async function prepareWords(playerNum = null, isAutoRefresh = false) {\r\n        console.log(\"Preparing words by type...\");\r\n        let grp = await page.findObject(\"auth.group\", \"data\", \"/Library/Dictionary\");\r\n\r\n        let wordTargetCount = 8;\r\n        let wordCount = wordTargetCount;\r\n        if (playerNum) {\r\n            const currentWords = playerNum === 1 ? data.left : data.right;\r\n            wordCount = Math.max(0, wordTargetCount - currentWords.length);\r\n        }\r\n        if (wordCount <= 0 && isAutoRefresh) return;\r\n        if (wordCount <= 0 && !isAutoRefresh) wordCount = wordTargetCount;\r\n\r\n        const wordsPerType = Math.ceil(wordCount / 4);\r\n        const wordTypes = { 'v': 'verbs', 'n': 'nouns', 's': 'adjectives', 'r': 'adverbs' };\r\n        let wordDict = { nouns: [], verbs: [], adjectives: [], adverbs: [] };\r\n\r\n        for (const typeCode in wordTypes) {\r\n            let q = am7client.newQuery(\"data.wordNet\");\r\n            q.field(\"groupId\", grp.id);\r\n            q.field(\"type\", typeCode);\r\n            q.cache(false);\r\n            q.range(0, 30); // Fetch a larger pool to pick from\r\n            q.entity.request = [\"name\", \"groupId\", \"organizationId\", \"type\", \"definition\"];\r\n            q.entity.sortField = \"random()\";\r\n            let l = await page.search(q);\r\n            if (l && l.results) {\r\n                wordDict[wordTypes[typeCode]] = l.results;\r\n            }\r\n        }\r\n\r\n        const allExistingNames = new Set([...data.left.map(w => w.name.toLowerCase()), ...data.right.map(w => w.name.toLowerCase())]);\r\n\r\n        function getNewPlayerWords() {\r\n            let newWords = [];\r\n            for (const typeName in wordDict) {\r\n                const availableWords = wordDict[typeName].filter(w => !allExistingNames.has(w.name.toLowerCase()));\r\n                const picked = availableWords.slice(0, wordsPerType);\r\n                newWords.push(...picked);\r\n                picked.forEach(w => allExistingNames.add(w.name.toLowerCase()));\r\n            }\r\n            return newWords.sort(() => 0.5 - Math.random());\r\n        }\r\n\r\n        const assignWords = (playerList) => {\r\n            const newWords = getNewPlayerWords();\r\n            if (isAutoRefresh || playerNum) {\r\n                return playerList.concat(newWords);\r\n            } else {\r\n                return newWords;\r\n            }\r\n        };\r\n\r\n        if (playerNum === 1) {\r\n            data.left = assignWords(data.left);\r\n        } else if (playerNum === 2) {\r\n            data.right = assignWords(data.right);\r\n        } else {\r\n            data.left = assignWords([]);\r\n            data.right = assignWords([]);\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    function setup() {\r\n        console.log(\"Setup\");\r\n        randomizeCommonWords();\r\n        // Words will be prepared when the game is started\r\n    }\r\n\r\n    async function testEndGame() {\r\n        console.log(\"--- Running testEndGame ---\");\r\n\r\n        // 1. Set up initial game state for the test\r\n        data.player1.score = 100;\r\n        data.player2.score = 50;\r\n\r\n        // 2. Set up local dependencies required by triggerEndGame\r\n        endPromptCfg = await prepareEndPrompt();\r\n        chatCfg = await prepareChatConfig();\r\n        endGameChat = await am7chat.getChatRequest(endChatRequestName, chatCfg, endPromptCfg);\r\n\r\n        // 3. Invoke triggerEndGame with an array of 5 phrases\r\n        const testPhrases = [\"the quick brown fox\", \"jumps over the lazy dog\", \"a stitch in time\", \"saves nine\", \"an apple a day\"];\r\n        await triggerEndGame(testPhrases);\r\n\r\n        console.log(\"--- testEndGame Finished ---\");\r\n        console.log(\"Final data.endGameInfo:\", data.endGameInfo);\r\n    }\r\n\r\n    let wordGame = {\r\n        scoreCard: () => \"\",\r\n        oninit: function () {\r\n            setup();\r\n        },\r\n        onremove: function () {\r\n            if (data) {\r\n                data.isPaused = true;\r\n            }\r\n            if(gameChat){\r\n                am7chat.deleteChat(gameChat, true);\r\n            }\r\n            if(endGameChat){\r\n                am7chat.deleteChat(endGameChat, true);\r\n            }\r\n            clearInterval(data.timerId); // Cleanup timer on component removal\r\n        },\r\n        view: function () {\r\n            return modelPanel();\r\n        },\r\n        testEndGame: testEndGame // Exposing the test function\r\n    };\r\n    page.components.wordGame = wordGame;\r\n}());\r\n\n\n;/* === client/components/breadcrumb.js === */\n(function () {\r\n    \r\n    let crumbButtons;\r\n    let showBreadcrumb = false;\r\n\r\n    function modelBreadCrumb() {\r\n        let oL = document.querySelector(\"#listBreadcrumb\");\r\n        let sPath = page.user.homeDirectory.path;\r\n        let model = page.context();\r\n\r\n        let objectId = m.route.param(\"objectId\");\r\n\r\n        let modType;\r\n        let type = m.route.param(\"type\") || \"data.data\";\r\n        if (type) {\r\n            modType = am7model.getModel(type);\r\n            type = modType.type || type;\r\n        }\r\n\r\n        let objType = type;\r\n        if (m.route.get().match(/\\/(list|new)\\//gi)) {\r\n            objType = \"auth.group\";\r\n        }\r\n\r\n        if (modType && am7model.isGroup(modType) && objectId != null && objectId != \"null\" && objectId != undefined && objectId != \"undefined\") {\r\n            let typeUdef = typeof model.contextObjects[objectId] == \"undefined\";\r\n            if (typeUdef || model.contextObjects[objectId] == null) {\r\n                model.contextObjects[objectId] = null;\r\n                am7client.get(objType, objectId, function (v) {\r\n                    if(v && v != null){\r\n                        model.contextObjects[objectId] = v;\r\n                        m.redraw();\r\n                    }\r\n                    else{\r\n                        console.error(\"Failed to retrieve group\", objType, objectId);\r\n                    }\r\n                });\r\n            }\r\n            else if (!typeUdef && model.contextObjects[objectId] != null) {\r\n                sPath = model.contextObjects[objectId][(objType.match(/^auth\\.group/gi) ? \"path\" : \"groupPath\")];\r\n            }\r\n        }\r\n\r\n        let crumbs = [];\r\n        crumbButtons = [];\r\n        if (!sPath || !sPath.length) {\r\n            console.warn(\"Unexpected path: \" + sPath);\r\n            return crumbs;\r\n        }\r\n        let aSp = sPath.split(\"/\").slice(1);\r\n        let bBack = [];\r\n\r\n\r\n        aSp.forEach((p) => {\r\n            bBack.push(\"/\" + p);\r\n\r\n            let bJoi = bBack.join(\"\");\r\n            let id = bJoi.replace(/\\//g, \"zZz\").replace(/\\s/g, \"yYy\");\r\n            let bid = id + \"Button\";\r\n            let handler;\r\n            let menuCls = \"context-menu-container-slim\";\r\n            let btnCls = \"multi-button\";\r\n            let disabled = false;\r\n            if ((bJoi.match(/^\\/home$/gi) || bJoi.match(/^\\/$/)) && !page.context().roles.admin) {\r\n                menuCls += \" context-menu-container-disabled\";\r\n                btnCls = \"multi-button-disabled\";\r\n                disabled = true;\r\n            }\r\n            else {\r\n                handler = function () { page.navigateToPath(type, modType, bJoi).then((id) => { page.listByType(type, id); }); }\r\n            }\r\n\r\n\r\n            if (!disabled) crumbButtons.push({ id: id, bid: bid, path: bJoi, items: [] });\r\n            crumbs.push(m(\"li\", \"/\"));\r\n            crumbs.push(m(\"li\", [\r\n                m(\"div\", { class: menuCls }, [\r\n                    m(\"button\" + (disabled ? \"[disabled = 'true']\" : \"\"), { onclick: handler, class: \"rounded-l \" + btnCls }, p),\r\n                    (!disabled ? m(\"button\", { id: bid, class: \"rounded-r \" + btnCls }, m(\"span\", { class: \"material-symbols-outlined material-icons-cm\" }, \"expand_more\")) : \"\"),\r\n                    (!disabled ? m(\"div\", { id: id, class: \"transition transition-0 context-menu-48\" }, [\r\n                        page.navigable.contextMenuButton(id, \"Loading\", \"folder_off\"),\r\n                    ]) : \"\")\r\n                ])\r\n\r\n            ]));\r\n\r\n        });\r\n        return crumbs;\r\n    }\r\n\r\n\r\n\r\n    function buildBreadCrumb() {\r\n        if(!showBreadcrumb) return \"\";\r\n        let type = m.route.param(\"type\") || \"data.data\";\r\n        let modType = am7model.getModel(type);\r\n\r\n        return m(\"nav\", { class: \"breadcrumb-bar\" }, [\r\n            m(\"div\", { class: \"breadcrumb-container\" }, [\r\n                m(\"nav\", { class: \"breadcrumb\" }, [\r\n                    m(\"ol\", { id: \"listBreadcrumb\", class: \"breadcrumb-list\" }, [\r\n                        m(\"li\", m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, modType.icon)),\r\n                        modelBreadCrumb()\r\n                    ])\r\n                ])\r\n            ])\r\n        ]);\r\n\r\n    }\r\n\r\n    function contextMenuItemHandler(query, object) {\r\n        let aP = query.items.filter((i) => {\r\n            if (object.path == i.path) return true;\r\n        });\r\n\r\n        let type = 'data';\r\n        let modType = am7view.typeByPath(object.name) || \"data.data\";\r\n        if (modType) type = modType;\r\n        if (aP.length) {\r\n            page.listByType(type, aP[0].objectId);\r\n        }\r\n    }\r\n\r\n    function configureContextMenus() {\r\n        if(!showBreadcrumb){\r\n            return;\r\n        }\r\n\r\n        crumbButtons.forEach((v) => {\r\n            page.navigable.addContextMenu(\"#\" + v.id, \"#\" + v.bid, {\r\n                menu: v.id,\r\n                action: \"list\",\r\n                type: \"auth.group\",\r\n                subType: \"data\",\r\n                objectId: 0,\r\n                path: v.path,\r\n                handler: contextMenuItemHandler,\r\n                icon: \"folder\"\r\n            });\r\n        });\r\n    }\r\n    function cleanupContextMenus() {\r\n        if(crumbButtons){\r\n            crumbButtons.forEach((v) => page.navigable.removeContextMenu(\"#\" + v.id));\r\n        }\r\n    }\r\n    function setupDisplayState() {\r\n        configureContextMenus();\r\n    }\r\n    let breadCrumb = {\r\n        toggleBreadcrumb: function(){\r\n            showBreadcrumb = !showBreadcrumb;\r\n            m.redraw();\r\n        },\r\n        oninit: function (x) {\r\n\r\n        },\r\n        onupdate: function () {\r\n            cleanupContextMenus();\r\n            setupDisplayState();\r\n        },\r\n        oncreate: function (x) {\r\n            setupDisplayState();\r\n\r\n        },\r\n        onremove: function (x) {\r\n            cleanupContextMenus();\r\n        },\r\n\r\n        view: function () {\r\n            return m(\"div\", { avoid: \"1\", class: \"\" },\r\n                buildBreadCrumb()\r\n            );\r\n        }\r\n    };\r\n\r\n    page.components.breadCrumb = breadCrumb;\r\n}());\r\n\n\n;/* === client/components/asideMenu.js === */\n(function () {\r\n    const asideMenu = {};\r\n    let vnode;\r\n    let app;\r\n\r\n    function button(sLabel, sIco, icoId, cls, fHandler, fHold) {\r\n        let fWrapper = function (e) {\r\n            if (!fHold) page.navigable.drawer();\r\n            if (fHandler) fHandler(e);\r\n        };\r\n        let btnCls = \"flyout-button\";\r\n        if (cls) {\r\n            btnCls += \" \" + cls;\r\n        }\r\n        return m(\"button\", { onclick: fWrapper, class: btnCls }, (sIco ? m(\"span\", { id: icoId, class: \"mr-2 material-symbols-outlined\" }, sIco) : \"\"), (sLabel || \"\"));\r\n    }\r\n\r\n    function clicky() {\r\n        console.log(\"Clicky!\");\r\n    }\r\n    function expandCategory(key) {\r\n        expanded = key;\r\n    }\r\n    let expanded;\r\n    function getCategories() {\r\n        let cats = [];\r\n        let model = am7model;\r\n        model.categories.forEach(cat => {\r\n            let k = cat.name;\r\n            if (!expanded) {\r\n                expanded = k;\r\n            }\r\n            cats.push(button(cat.label, cat.icon, undefined, undefined, function (e) { expandCategory(k); }, true));\r\n            if (expanded == k) {\r\n                let order = cat.order;\r\n                if (!order) {\r\n                    order = [];\r\n                    Object.keys(model.types).forEach((l) => { if (types[l].category == key) order.push(key); });\r\n                }\r\n                order.forEach((l) => {\r\n                    let item = am7model.getModel(l);\r\n                    if (cat.prototype && cat.prototype[l]) item = cat.prototype[l];\r\n                    if (item == null) console.error(\"Null item for \" + l);\r\n                    else {\r\n                        cats.push(button(item.label || l, item.icon, undefined, \"ml-4\", function (e) { page.components.panel.clickPanelItem(item, l); }));\r\n                    }\r\n\r\n                });\r\n            }\r\n            /// add in sub cat buttons\r\n        });\r\n        return cats;\r\n    }\r\n\r\n    asideMenu.component = {\r\n        oninit: function (x) {\r\n\r\n        },\r\n        oncreate: function (x) {\r\n            //app = page.space(entityName, x, {});\r\n        },\r\n        onremove: function (x) {\r\n            if (app) app.destroy();\r\n        },\r\n\r\n        view: function () {\r\n            vnode = m(\"aside\", {\r\n                class: \"transition transition-0\"\r\n            }, [\r\n                m(\"span\", { class: \"flyout-banner\" }, [\r\n                    m(\"img\", { src: \"/media/logo_128.png\", class: \"object-scale-down h-24 w-24\" })\r\n                ]),\r\n                m(\"div\", {class: \"flyout-body\"}, [\r\n                    button(\"Home\", \"home\"),\r\n                    //getCategories(),\r\n                ]),\r\n                m(\"div\", { class: \"flyout-gutter\" }, [\r\n                    button(\"Dark Mode\", \"dark_mode\", null, undefined, async function(){ let de = document.documentElement; let cls = de.className; if(cls != \"dark\") de.className = \"dark\"; else de.className = \"light\";}),\r\n                    button(\"Breadcrumb Bar\", \"footprint\", null, undefined, async function(){ page.components.breadCrumb.toggleBreadcrumb();}),\r\n                    button(\"Clear Cache\", \"cached\", null, undefined, async function(){ await am7client.clearCache();}),\r\n                    button(\"Cleanup\", \"cached\", null, undefined, async function(){ await page.cleanup();})\r\n                ])\r\n            ]);\r\n            return vnode;\r\n        }\r\n    };\r\n\r\n    page.components.asideMenu = asideMenu.component;\r\n}());\r\n\n\n;/* === client/components/topMenu.js === */\n\r\n(function () {\r\n    const topMenu = {};\r\n    let vnode;\r\n    let app;\r\n    let profileDimensions = \"48x48\";\r\n    let dnd = page.components.dnd;\r\n    let showFavButton = true;\r\n    let trayExpanded = false;\r\n    let shutOnEmpty = true;\r\n\r\n    function button(sLabel, sIco, sCls, fHandler, sAltIco) {\r\n        let props = {};\r\n        if (typeof fHandler == \"function\") {\r\n            props = { onclick: fHandler };\r\n        }\r\n        else if (typeof fHandler == \"object\") {\r\n            props = fHandler;\r\n        }\r\n        props.class = \"menu-button\" + (sCls ? \" \" + sCls : \"\");\r\n        return m(\"button\", props, (sIco ? m(\"span\", { class: (sLabel ? \"mr-2 \" : \"\") + \"material-symbols-outlined\" + (sAltIco ? \" \" + sAltIco : \"\") }, sIco) : \"\"), (sLabel || \"\"));\r\n    }\r\n    function profileContextButton() {\r\n        let xProf = am7client.getAttributeValue(page.user, \"v1-profile-path\", 0);\r\n        let img;\r\n        if (xProf) img = m(\"img\", { class: \"h-8 w-8 rounded-full\", src: g_application_path + \"/thumbnail/\" + xProf + \"/\" + profileDimensions });\r\n        else img = m(\"span\", { class: \"material-symbols-outlined\" }, \"account_circle\");\r\n        return m(\"button\", { id: \"profileContextMenuButton\", class: \"context-menu-button px-2 py-1 space-x-4\" }, [img]);\r\n\r\n    }\r\n\r\n    let activeShuffle;\r\n    let favGroup;\r\n    function doPickShuffle(object, filter) {\r\n\r\n        let bBlend = object[am7model.jsonModelKey].match(/^(auth\\.group|auth\\.role|data\\.tag|olio\\.event)$/gi);\r\n        if (!filter || (filter && bBlend) || !activeShuffle) {\r\n            activeShuffle = object;\r\n        }\r\n    }\r\n\r\n    async function loadFavGroup() {\r\n        if (favGroup) return favGroup;\r\n        let grp = await page.favorites();\r\n        favGroup = grp;\r\n        if (!activeShuffle) {\r\n            activeShuffle = grp;\r\n            dnd.workingSet.push(grp);\r\n        }\r\n        //m.redraw();\r\n    }\r\n    function shuffleTray() {\r\n\r\n        let buttons = dnd.workingSet.map((o) => {\r\n            if (activeShuffle && activeShuffle.objectId == o.objectId) {\r\n                let modType = am7model.getModel(o[am7model.jsonModelKey]);\r\n                let icon = \"device_unknown\";\r\n                if (modType.icon) {\r\n                    icon = modType.icon;\r\n                }\r\n                return button(o.name, icon, \"truncate\");\r\n            }\r\n            return \"\";\r\n        });\r\n        let workingBtns = [];\r\n        let bid = \"shuffleButton\";\r\n        let mid = bid + \"-menu\";\r\n        let blendable = false;\r\n        let blendy = false;\r\n        let blendCls = \"\";\r\n        dnd.workingSet.forEach((o) => {\r\n            if ((activeShuffle && activeShuffle.objectId == o.objectId) || o[am7model.jsonModelKey].match(/^(auth\\.group|auth\\.role|data\\.tag|olio\\.event)$/gi)) {\r\n                blendable = true;\r\n            }\r\n            else {\r\n                blendy = true;\r\n            }\r\n            let modType = am7model.getModel(o[am7model.jsonModelKey]);\r\n            let icon = \"device_unknown\";\r\n            if (modType.icon) {\r\n                icon = modType.icon;\r\n            }\r\n            workingBtns.push(page.navigable.contextMenuButton(mid, o.name, icon, function () { doPickShuffle(o); }));\r\n        });\r\n        if (blendable && blendy) {\r\n            blendCls = \"material-symbols-outlined-orange active-orange\";\r\n            if (dnd.workingSet.length > 2) blendCls += \" filled\";\r\n        }\r\n\r\n        let favButton = \"\";\r\n        let blendButton = \"\";\r\n        let backButton = \"\";\r\n        let expanded = (trayExpanded || dnd.workingSet.length > 0);\r\n        if (expanded) {\r\n            if (showFavButton) {\r\n                favButton = button(0, \"favorite\", \"\", async function () {\r\n                    await loadFavGroup();\r\n                    if (dnd.workingSet.filter(f => f.objectId == favGroup.objectId).length == 0) {\r\n                        dnd.workingSet.push(favGroup);\r\n                    }\r\n                    activeShuffle = favGroup;\r\n                    m.redraw();\r\n                });\r\n            }\r\n            backButton = button(0, \"backspace\", \"\", function () {\r\n                dnd.workingSet.length = 0;\r\n                activeShuffle = undefined;\r\n                if (shutOnEmpty) expanded = false;\r\n            });\r\n        }\r\n\r\n        blendButton = button(0, \"blender\", \"\", async function () {\r\n            if (dnd.workingSet.length == 0) {\r\n                trayExpanded = !trayExpanded;\r\n            }\r\n            else {\r\n                await dnd.doBlend((activeShuffle ? activeShuffle.objectId : undefined));\r\n                m.redraw();\r\n            }\r\n        }, blendCls);\r\n\r\n\r\n        buttons.push(favButton, backButton, blendButton);\r\n\r\n        let menuCls = \"menu\";\r\n        let trayCls = \"place-content-end menu-buttons ml-4\";\r\n        if (expanded) {\r\n            trayCls += \" w-96 bg-orange-100 border rounded-lg border-orange-600\";\r\n        }\r\n        else {\r\n            menuCls = \"hidden\";\r\n        }\r\n\r\n        let tray = m(\"div[draggable]\", {\r\n            class: trayCls,\r\n            ondragover: function (e) {\r\n                e.preventDefault();\r\n            },\r\n            ondrop: function (e) {\r\n                //activeShuffle = dnd.dragTarget;\r\n                doPickShuffle(dnd.dragTarget, true);\r\n                dnd.doDrop(e, \"set\");\r\n            }\r\n        }, [\r\n            buttons,\r\n            button(0, \"menu\", menuCls, { id: bid }),\r\n            m(\"div\", { class: \"context-menu-container\" }, [\r\n                m(\"div\", { class: \"transition transition-0 context-menu-96\", id: mid }, [\r\n                    workingBtns\r\n                ])\r\n            ])\r\n        ]);\r\n        page.navigable.pendContextMenu(\"#\" + mid, \"#\" + bid, null, \"context-menu-96\");\r\n        return tray;\r\n    }\r\n   \r\n\r\n    topMenu.component = {\r\n        menuButton: button,\r\n        activeShuffle: function(o){\r\n            activeShuffle = o;\r\n        },\r\n        oninit: function (x) {\r\n            page.navigable.setupPendingContextMenus();\r\n        },\r\n        oncreate: function (x) {\r\n            page.navigable.addContextMenu(\"#profileContextMenu\", \"#profileContextMenuButton\");\r\n        },\r\n        onupdate: function () {\r\n            page.navigable.setupPendingContextMenus();\r\n        },\r\n        onremove: function (x) {\r\n            if (app) app.destroy();\r\n        },\r\n\r\n        view: function (x) {\r\n            let lastNot;\r\n            let not = page.context().notifications;\r\n            let notiActive = (not && not.length && not[not.length - 1].newMessageCount > 0);\r\n            let mr = m.route.get();\r\n            vnode = m(\"div\", {\r\n                class: \"menu-bar\"\r\n            }, [\r\n                m(\"div\", { class: \"menu-bar-flex\" }, [\r\n                    m(\"div\", { class: \"flex-center\" }, [\r\n                        m(\"div\", { class: \"flex-shrink-0\" }, [\r\n                            m(\"img\", { class: \"h-8\", src: \"/media/logo_128_alt.png\" })\r\n                        ]),\r\n                        m(\"div\", { class: \"menu-buttons-spaced\" }, [\r\n                            button(null, \"dashboard\", (mr.match(/^\\/main/gi) ? \"active\" : \"\"), page.home),\r\n                            button(0, \"explore\", (mr.match(/^\\/nav/gi) ? \"active\" : \"\"), page.nav),\r\n                            button(0, \"chat\", (mr.match(/^\\/chat/gi) ? \"active\" : \"\"), page.chat),\r\n                            button(0, \"notifications\", (notiActive ? \"active-red\" : (mr.match(/^\\/list\\/message/gi) ? \"active\" : \"\")), page.messages)\r\n                        ])\r\n                    ]),\r\n                    (x.attrs.customTray ? x.attrs.customTray() : \"\"),\r\n                    shuffleTray(),\r\n                    m(\"div\", { class: \"flex-center2\" }, [\r\n                        m(page.components.emoji.component),\r\n                        m(\"div\", { class: \"context-menu-container\" }, [\r\n                            profileContextButton(),\r\n                            m(\"div\", { id: \"profileContextMenu\", class: \"transition transition-0 context-menu-48\" }, [\r\n                                page.navigable.contextMenuButton(\".context-menu-48\", \"Your Profile\", \"account_circle\", page.profile),\r\n                                page.navigable.contextMenuButton(\".context-menu-48\", \"Your Settings\", \"settings\"),\r\n                                page.navigable.contextMenuButton(\".context-menu-48\", \"Sign Out\", \"lock\", page.logout)\r\n                            ])\r\n                        ])\r\n                    ])\r\n                ])\r\n            ]);\r\n            return vnode;\r\n        }\r\n    };\r\n\r\n\r\n    page.components.topMenu = topMenu.component;\r\n}());\r\n\n\n;/* === client/components/panel.js === */\n(function () {\r\n    const panel = {};\r\n\r\n    function modelPanel() {\r\n        let panels = [];\r\n        am7model.categories.forEach((cat) => {\r\n            let k = cat.name;\r\n            panels.push(\r\n                m(\"div\", { class: \"panel-card\" },\r\n                    m(\"p\", { \"class\": \"card-title\" }, [\r\n                        (cat.icon ? m(\"span\", { class: \"material-symbols-outlined material-icons-cm mr-2\" }, cat.icon) : \"\"),\r\n                        (cat.label || k)\r\n                    ]),\r\n                    m(\"div\", { \"class\": \"card-contents\" }, modelPanelContents(k))\r\n                )\r\n            );\r\n        });\r\n\r\n        return panels;\r\n\r\n    }\r\n\r\n    async function clickPanelItem(item, type) {\r\n        let path = am7view.pathForType(type);\r\n        if (item.prototype) {\r\n            type = item.type;\r\n            path = page.user.homeDirectory.path + \"/\" + item.group;\r\n        }\r\n        let base = item;\r\n        let baseType = type;\r\n        if (item.limit && item.limit.length) {\r\n            baseType = item.limit[0];\r\n            base = am7model.getModel(baseType);\r\n        }\r\n        let listPathBase = \"/list/\" + baseType;\r\n        if (am7model.isGroup(base) || base == 'auth.group') {\r\n            /// find the requested path, and make it if it doesn't exist\r\n            ///\r\n            am7client.make(\"auth.group\", \"data\", path, function (v) {\r\n                if (v != null) {\r\n                    m.route.set(listPathBase + \"/\" + v.objectId);\r\n                }\r\n                else console.error(\"Error: Unable to load path \" + path);\r\n            });\r\n        }\r\n        else if (am7model.inherits(base, \"common.parent\") && type.match(/^(auth\\.role|auth\\.permission)$/gi)) {\r\n            am7client.user(type, \"user\", function (v) {\r\n                uwm.getDefaultParentForType(type, v).then((parObj) => {\r\n                    if (parObj != null) {\r\n                        m.route.set(listPathBase + \"/\" + parObj.objectId);\r\n                    }\r\n                    else console.error(\"Handle parent: \" + listPathBase);\r\n                });\r\n            });\r\n        }\r\n        else if (type.match(/^message$/)) {\r\n            let dir = await page.makePath(\"auth.group\", \"data\", \"~/.messages\");\r\n            if (dir != null) {\r\n                m.route.set(listPathBase + \"/\" + dir.objectId);\r\n            }\r\n            else {\r\n                console.error(\"Failed to find .messages\");\r\n            }\r\n        }\r\n        else {\r\n            console.warn(\"Handle non-group/non-parent or type \" + type + \" / \" + listPathBase, base);\r\n            m.route.set(listPathBase);\r\n        }\r\n    }\r\n    function getProtoCat(cat, name) {\r\n        if (cat && cat.prototypes) {\r\n            let ap = cat.prototypes.filter(c => c.name == name);\r\n            if (ap.length) return ap[0];\r\n        }\r\n    }\r\n    function modelPanelContents(key) {\r\n        let cat = am7model.categories.find(o => o.name == key);\r\n        if (!cat) {\r\n            console.error(\"Failed to find: \" + key);\r\n            return;\r\n        }\r\n        let order = cat.order;\r\n        if (!order) {\r\n            order = [];\r\n            am7models.models.forEach((m) => {\r\n                if (m.categories && m.categories.includes(key)) {\r\n                    order.push(m.name);\r\n                }\r\n            });\r\n        }\r\n        let items = [];\r\n\r\n        order.forEach((l) => {\r\n            let item = getProtoCat(cat, l) || am7model.getModel(l);\r\n            if (item == null) {\r\n                // console.error(\"Null item for \" + l);\r\n            }\r\n            else {\r\n                items.push(\r\n                    m(\"div\", { class: \"card-item\" },\r\n                        m(\"button\", { onclick: function () { clickPanelItem(item, l); } }, [\r\n                            (item.icon ? m(\"span\", { class: \"material-symbols-outlined material-icons-cm mr-2\" }, item.icon) : \"\"),\r\n                            (item.label || l)\r\n                        ])\r\n                    )\r\n                );\r\n            }\r\n\r\n        });\r\n        return items;\r\n    }\r\n    panel.component = {\r\n        clickPanelItem,\r\n        oninit: function (x) {\r\n\r\n        },\r\n        oncreate: function (x) {\r\n\r\n        },\r\n        onremove: function (x) {\r\n\r\n        },\r\n\r\n        view: function () {\r\n            return m(\"div\", {\r\n                class: \"panel-container\"\r\n            },\r\n                m(\"div\", { class: \"panel-grid\" },\r\n                    modelPanel()\r\n                )\r\n            );\r\n        }\r\n    };\r\n\r\n    page.components.panel = panel.component;\r\n}());\r\n\n\n;/* === client/components/objectViewDef.js === */\n(function() {\r\n    /// Object View Model Definitions\r\n    /// These define the structure for different object view types\r\n\r\n    am7model.models.push({\r\n        name: \"view.objectDisplay\",\r\n        icon: \"visibility\",\r\n        label: \"Object Display\",\r\n        fields: [\r\n            {\r\n                name: \"objectId\",\r\n                type: \"string\",\r\n                label: \"Object ID\"\r\n            },\r\n            {\r\n                name: \"active\",\r\n                type: \"boolean\",\r\n                label: \"Active\",\r\n                default: false\r\n            },\r\n            {\r\n                name: \"maxMode\",\r\n                type: \"boolean\",\r\n                label: \"Maximize\",\r\n                default: false\r\n            },\r\n            {\r\n                name: \"viewType\",\r\n                type: \"string\",\r\n                label: \"View Type\",\r\n                virtual: true,\r\n                ephemeral: true\r\n            }\r\n        ]\r\n    });\r\n\r\n    /// Form definitions for object viewers\r\n    /// Note: These forms include a dummy 'field' property to bypass model field lookup\r\n    /// when used in the legacy view/object.js dialog rendering system\r\n    am7model.forms.portraitView = {\r\n        label: \"Portrait Viewer\",\r\n        icon: \"account_circle\",\r\n        viewType: \"portrait\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"portrait\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.imageView = {\r\n        label: \"Image Viewer\",\r\n        icon: \"image\",\r\n        viewType: \"image\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"image\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.videoView = {\r\n        label: \"Video Viewer\",\r\n        icon: \"videocam\",\r\n        viewType: \"video\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"video\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.audioView = {\r\n        label: \"Audio Player\",\r\n        icon: \"audiotrack\",\r\n        viewType: \"audio\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"audio\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.textView = {\r\n        label: \"Text Viewer\",\r\n        icon: \"article\",\r\n        viewType: \"text\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"text\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.pdfView = {\r\n        label: \"PDF Viewer\",\r\n        icon: \"picture_as_pdf\",\r\n        viewType: \"pdf\",\r\n        fields: {\r\n            objectId: {\r\n                layout: \"full\",\r\n                format: \"pdf\",\r\n                field: {name: \"objectId\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.noteView = {\r\n        label: \"Note Viewer\",\r\n        icon: \"note\",\r\n        viewType: \"note\",\r\n        fields: {\r\n            text: {\r\n                layout: \"full\",\r\n                format: \"markdown\",\r\n                field: {name: \"text\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n    am7model.forms.messageView = {\r\n        label: \"Message Viewer\",\r\n        icon: \"message\",\r\n        viewType: \"message\",\r\n        fields: {\r\n            data: {\r\n                layout: \"full\",\r\n                format: \"messageContent\",\r\n                field: {name: \"data\", type: \"string\"}\r\n            }\r\n        }\r\n    };\r\n\r\n}());\r\n\n\n;/* === client/components/objectViewRenderers.js === */\n(function() {\r\n    /// Custom field renderers for object views\r\n    /// These extend am7view to handle special formats\r\n\r\n    /// Portrait format renderer (for profile.portrait)\r\n    function renderPortraitField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        // Get maxMode and active from attrs if available, otherwise from inst.api\r\n        let maxMode = (attrs && attrs.maxMode !== undefined) ? attrs.maxMode : (inst.api.maxMode ? inst.api.maxMode() : false);\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        // Check for portrait\r\n        if (!object.profile || !object.profile.portrait || !object.profile.portrait.contentType) {\r\n            return m(\"span\", \"No portrait available\");\r\n        }\r\n\r\n        let pp = object.profile.portrait;\r\n        let path = g_application_path + \"/media/\" +\r\n                   am7client.dotPath(am7client.currentOrganization) +\r\n                   \"/data.data\" + pp.groupPath + \"/\" + pp.name;\r\n        let imgClass = \"carousel-item-img\" + (maxMode ? \" carousel-item-img-max\" : \"\");\r\n\r\n        return m(\"img\", {\r\n            class: imgClass,\r\n            src: path,\r\n            alt: object.name || \"Portrait\"\r\n        });\r\n    }\r\n\r\n    /// Image format renderer\r\n    function renderImageField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        // Get maxMode and active from attrs if available, otherwise from inst.api\r\n        let maxMode = (attrs && attrs.maxMode !== undefined) ? attrs.maxMode : (inst.api.maxMode ? inst.api.maxMode() : false);\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        let path = buildMediaPath(object);\r\n        let imgClass = \"carousel-item-img\" + (maxMode ? \" carousel-item-img-max\" : \"\");\r\n\r\n        return m(\"img\", {\r\n            class: imgClass,\r\n            src: path,\r\n            alt: object.name || \"Image\"\r\n        });\r\n    }\r\n\r\n    /// Video format renderer\r\n    function renderVideoField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        // Get maxMode and active from attrs if available, otherwise from inst.api\r\n        let maxMode = (attrs && attrs.maxMode !== undefined) ? attrs.maxMode : (inst.api.maxMode ? inst.api.maxMode() : false);\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        let path = buildMediaPath(object);\r\n        let mt = object.contentType;\r\n        let vidClass = \"carousel-item-img\" + (maxMode ? \" carousel-item-img-max\" : \"\");\r\n\r\n        return m(\"video\", {\r\n            class: vidClass,\r\n            preload: \"auto\",\r\n            controls: \"controls\",\r\n            autoplay: \"autoplay\"\r\n        }, [\r\n            m(\"source\", { src: path, type: mt })\r\n        ]);\r\n    }\r\n\r\n    /// Audio format renderer\r\n    function renderAudioField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        // Get maxMode and active from attrs if available, otherwise from inst.api\r\n        let maxMode = (attrs && attrs.maxMode !== undefined) ? attrs.maxMode : (inst.api.maxMode ? inst.api.maxMode() : false);\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        let path = buildMediaPath(object);\r\n        let mt = object.contentType;\r\n\r\n        if (mt.match(/mpeg3$/)) mt = \"audio/mpeg\";\r\n\r\n        let audClass = \"carousel-item-img\" + (maxMode ? \" carousel-item-img-max\" : \"\");\r\n\r\n        return m(\"audio\", {\r\n            class: audClass,\r\n            preload: \"auto\",\r\n            controls: \"controls\",\r\n            autoplay: \"autoplay\"\r\n        }, [\r\n            m(\"source\", { src: path, type: mt })\r\n        ]);\r\n    }\r\n\r\n    /// Text content renderer\r\n    function renderTextField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        let ctx = page.context();\r\n        let objectId = object.objectId;\r\n\r\n        // Clear invalid cache\r\n        if (ctx.contextObjects[objectId] && ctx.contextObjects[objectId].detailsOnly) {\r\n            console.warn(\"Data is cached as detailsOnly. This shouldn't have happened.\");\r\n            delete ctx.contextObjects[objectId];\r\n        }\r\n\r\n        // Load full object if needed\r\n        if (!ctx.contextObjects[objectId]) {\r\n            let model = inst.model.name;\r\n            let q = am7view.viewQuery(am7model.newInstance(model));\r\n            q.field(\"objectId\", objectId);\r\n\r\n            page.search(q).then(qr => {\r\n                ctx.contextObjects[objectId] = (qr && qr.results.length ? qr.results[0] : null);\r\n                ctx.tags[objectId] = [];\r\n                m.redraw();\r\n            });\r\n\r\n            return m(\"div\", { class: \"carousel-article-outer\" },\r\n                m(\"div\", { class: \"carousel-article carousel-article-margin\" },\r\n                    \"Loading...\"\r\n                )\r\n            );\r\n        }\r\n\r\n        // Render loaded content\r\n        let dat = ctx.contextObjects[objectId];\r\n        let cnt = bbConverter.mInto(Base64.decode(dat.dataBytesStore));\r\n\r\n        return m(\"div\", { class: \"carousel-article-outer\" },\r\n            m(\"div\", { class: \"carousel-article carousel-article-margin\" }, cnt)\r\n        );\r\n    }\r\n\r\n    /// PDF viewer renderer\r\n    function renderPDFField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        let ctx = page.context();\r\n        let objectId = object.objectId;\r\n\r\n        // Clear invalid cache\r\n        if (ctx.contextObjects[objectId] && ctx.contextObjects[objectId].detailsOnly) {\r\n            console.warn(\"Data is cached as detailsOnly. This shouldn't have happened.\");\r\n            delete ctx.contextObjects[objectId];\r\n        }\r\n\r\n        // Load full object if needed\r\n        if (!ctx.contextObjects[objectId]) {\r\n            let model = inst.model.name;\r\n            let q = am7view.viewQuery(am7model.newInstance(model));\r\n            q.field(\"objectId\", objectId);\r\n\r\n            page.search(q).then(qr => {\r\n                ctx.contextObjects[objectId] = (qr && qr.results.length ? qr.results[0] : null);\r\n                ctx.tags[objectId] = [];\r\n\r\n                if (ctx.contextObjects[objectId]) {\r\n                    page.components.pdf.viewer(am7model.prepareInstance(ctx.contextObjects[objectId]));\r\n                }\r\n                m.redraw();\r\n            });\r\n\r\n            return m(\"div\", { class: \"carousel-article-outer\" },\r\n                m(\"div\", { class: \"carousel-article carousel-article-margin\" },\r\n                    \"Loading PDF...\"\r\n                )\r\n            );\r\n        }\r\n\r\n        // Render PDF viewer\r\n        let cnt = \"\";\r\n        if (page.components.pdf.viewer(objectId)) {\r\n            cnt = page.components.pdf.viewer(objectId).container();\r\n        } else {\r\n            cnt = m(\"div\", \"No PDF Viewer ...\");\r\n        }\r\n\r\n        return m(\"div\", { class: \"carousel-article-outer\" },\r\n            m(\"div\", { class: \"carousel-article carousel-article-margin\" }, cnt)\r\n        );\r\n    }\r\n\r\n    /// Markdown/Note renderer\r\n    function renderMarkdownField(inst, fieldName, attrs) {\r\n        let value = inst.api[fieldName]();\r\n\r\n        return m(\"div\", { class: \"carousel-article-outer\" },\r\n            m(\"div\", { class: \"carousel-article carousel-article-margin\" },\r\n                value\r\n            )\r\n        );\r\n    }\r\n\r\n    /// Message content renderer\r\n    function renderMessageContentField(inst, fieldName, attrs) {\r\n        let object = inst.entity;\r\n        let active = (attrs && attrs.active !== undefined) ? attrs.active : (inst.api.active ? inst.api.active() : true);\r\n\r\n        if (!active) return m(\"span\", \"\");\r\n\r\n        // Auto-acknowledge message on view\r\n        if (object.spoolStatus === 'SPOOLED' || object.spoolStatus === 'TRANSMITTED') {\r\n            object.spoolStatus = \"ACKNOWLEGED_RECEIPT\";\r\n            page.patchObject(object);\r\n        }\r\n\r\n        let content = Base64.decode(object.data || \"\");\r\n\r\n        return m(\"div\", { class: \"carousel-article-outer\" },\r\n            m(\"div\", { class: \"carousel-article carousel-article-margin\" }, [\r\n                m(\"div\", content)\r\n            ])\r\n        );\r\n    }\r\n\r\n    /// Helper to build media path\r\n    function buildMediaPath(object) {\r\n        return g_application_path + \"/media/\" +\r\n               am7client.dotPath(am7client.currentOrganization) +\r\n               \"/data.data\" + object.groupPath + \"/\" + object.name;\r\n    }\r\n\r\n    /// Register custom format renderers with am7view\r\n    /// These can be used by setting format: \"image\", format: \"video\", etc. in form definitions\r\n\r\n    if (!am7view.customRenderers) {\r\n        am7view.customRenderers = {};\r\n    }\r\n\r\n    am7view.customRenderers.portrait = renderPortraitField;\r\n    am7view.customRenderers.image = renderImageField;\r\n    am7view.customRenderers.video = renderVideoField;\r\n    am7view.customRenderers.audio = renderAudioField;\r\n    am7view.customRenderers.text = renderTextField;\r\n    am7view.customRenderers.pdf = renderPDFField;\r\n    am7view.customRenderers.markdown = renderMarkdownField;\r\n    am7view.customRenderers.messageContent = renderMessageContentField;\r\n\r\n    /// Export for external use\r\n    window.objectViewRenderers = {\r\n        portrait: renderPortraitField,\r\n        image: renderImageField,\r\n        video: renderVideoField,\r\n        audio: renderAudioField,\r\n        text: renderTextField,\r\n        pdf: renderPDFField,\r\n        markdown: renderMarkdownField,\r\n        messageContent: renderMessageContentField,\r\n        buildMediaPath: buildMediaPath\r\n    };\r\n\r\n}());\r\n\n\n;/* === client/components/object_v2.js === */\n(function () {\r\n    let object = {};\r\n\r\n    /// ========================================\r\n    /// INNER VIEW - Uses am7view pattern\r\n    /// ========================================\r\n\r\n    function renderInnerObjectView(attrs) {\r\n        let obj = attrs.object;\r\n        let model = attrs[am7model.jsonModelKey] || obj[am7model.jsonModelKey] || attrs.model;\r\n\r\n        if (!obj || !model) {\r\n            console.warn(\"Invalid object\", obj);\r\n            return \"\";\r\n        }\r\n\r\n        // Ensure attrs has the model in the correct format for am7view\r\n        let attrsWithModel = Object.assign({}, attrs);\r\n        attrsWithModel[am7model.jsonModelKey] = model;\r\n\r\n        // Prepare view instance using am7view\r\n        let inst = am7view.prepareObjectView(obj, attrsWithModel);\r\n\r\n        if (!inst) {\r\n            return m(\"div\", \"Unable to render object: \" + (obj.name || obj.objectId));\r\n        }\r\n\r\n        // Get carousel classes\r\n        let cls = 'carousel-item';\r\n        if (attrs.active) cls += ' carousel-item-abs';\r\n        cls += ' carousel-item-' + (attrs.active ? '100' : '0');\r\n\r\n        // Render using the custom renderer\r\n        let format = inst.entity.viewType;\r\n        let renderer = am7view.customRenderers[format];\r\n\r\n        if (!renderer) {\r\n            return m(\"div\", { class: cls },\r\n                m(\"div\", \"No renderer available for: \" + format)\r\n            );\r\n        }\r\n\r\n        // Pass attrs to renderer so it can access dynamic values like maxMode\r\n        let content = renderer(inst, \"objectId\", attrs);\r\n\r\n        return m(\"div\", { class: cls }, content);\r\n    }\r\n\r\n    /// ========================================\r\n    /// OUTER VIEW - Carousel controls\r\n    /// ========================================\r\n\r\n    function renderObjectView(attrs) {\r\n        return m(\"div\", { class: \"content-outer\" }, [\r\n            (fullMode ? \"\" : m(page.components.navigation)),\r\n            m(\"div\", { class: \"content-main\" }, [\r\n                m(\"div\", { class: \"carousel\" }, [\r\n                    m(\"div\", { class: \"carousel-inner\" }, [\r\n                        renderInnerObjectView(attrs),\r\n                        renderCarouselControls()\r\n                    ])\r\n                ])\r\n            ])\r\n        ]);\r\n    }\r\n\r\n    /// Render carousel control buttons\r\n    function renderCarouselControls() {\r\n        return [\r\n            m(\"span\", {\r\n                onclick: toggleCarouselFull,\r\n                class: \"carousel-full\"\r\n            }, [\r\n                m(\"span\", { class: \"material-icons\" },\r\n                    (fullMode ? \"close_fullscreen\" : \"open_in_new\"))\r\n            ]),\r\n            m(\"span\", {\r\n                onclick: toggleCarouselMax,\r\n                class: \"carousel-max\"\r\n            }, [\r\n                m(\"span\", { class: \"material-icons\" },\r\n                    (maxMode ? \"photo_size_select_small\" : \"aspect_ratio\"))\r\n            ]),\r\n            m(\"span\", {\r\n                onclick: toggleInfo,\r\n                class: \"carousel-info\"\r\n            }, [\r\n                m(\"span\", {\r\n                    class: \"material-icons\" + (info ? \"\" : \"-outlined\")\r\n                }, (info ? \"info\" : \"info\"))\r\n            ]),\r\n            m(\"span\", {\r\n                onclick: function () {\r\n                    editItem(pr[pages.currentItem]);\r\n                },\r\n                class: \"carousel-edit\"\r\n            }, [\r\n                m(\"span\", { class: \"material-icons\" }, \"edit\")\r\n            ]),\r\n            m(\"span\", {\r\n                onclick: toggleCarousel,\r\n                class: \"carousel-exit\"\r\n            }, [\r\n                m(\"span\", { class: \"material-icons\" }, \"close\")\r\n            ])\r\n        ];\r\n    }\r\n\r\n    /// ========================================\r\n    /// COMPONENT DEFINITION\r\n    /// ========================================\r\n\r\n    object.component = {\r\n        oncreate: function (vnode) {\r\n            // Initialization if needed\r\n        },\r\n        view: function (vnode) {\r\n            if (vnode.attrs.inner) {\r\n                return renderInnerObjectView(vnode.attrs);\r\n            } else {\r\n                return renderObjectView(vnode.attrs);\r\n            }\r\n        }\r\n    };\r\n\r\n    page.components.object = object.component;\r\n\r\n}());\r\n\n\n;/* === client/components/form.js === */\n(function () {\r\n    /* WARNING: This is not yet fully ported over from the previous version*/\r\n    let form = {};\r\n    let entity = {};\r\n    let entityName = \"sig\";\r\n    let changed = false;\r\n    let app;\r\n    let view;\r\n\r\n    function updateChange(evt) {\r\n        changed = true;\r\n    }\r\n\r\n    function renderFormView(attrs) {\r\n        return m(\"div\", { class: \"content-outer\" }, [(fullMode ? \"\" : m(page.components.navigation)),\r\n        m(\"div\", { class: \"content-main\" }, [\r\n            m(\"div\", { class: \"carousel\" }, [\r\n                m(\"div\", { class: \"carousel-inner\" }, [\r\n                    renderInnerFormView(attrs),\r\n                    m(\"span\", { onclick: toggleCarouselFull, class: \"carousel-full\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, (fullMode ? \"close_fullscreen\" : \"open_in_new\"))]),\r\n                    m(\"span\", { onclick: toggleCarouselMax, class: \"carousel-max\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, (maxMode ? \"photo_size_select_small\" : \"aspect_ratio\"))]),\r\n                    m(\"span\", { onclick: toggleInfo, class: \"carousel-info\" }, [m(\"span\", { class: \"material-symbols\" + (info ? \"\" : \"-outlined\") }, (info ? \"info\" : \"info\"))]),\r\n                    m(\"span\", { onclick: function () { editItem(pr[pages.currentItem]); }, class: \"carousel-edit\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"edit\")]),\r\n                    m(\"span\", { onclick: toggleCarousel, class: \"carousel-exit\" }, [m(\"span\", { class: \"material-symbols-outlined\" }, \"close\")])\r\n                ])\r\n            ])\r\n        ])\r\n        ]);\r\n    }\r\n    function renderInnerFormView(attrs) {\r\n\r\n        let cls = 'carousel-item';\r\n        let object = attrs.object;\r\n        let active = attrs.active;\r\n\r\n        let ctx = page.context();\r\n\r\n        if (active) cls += ' carousel-item-abs';\r\n        let maxMode = attrs.maxMode;\r\n        if (!object || !object[am7model.jsonModelKey]) {\r\n            console.warn(\"Invalid object\");\r\n            return \"\";\r\n        }\r\n\r\n        let type = am7model.getModel(object[am7model.jsonModelKey]);\r\n        let objView = \"\";\r\n\r\n        if (ctx.contextObjects[object.objectId] && !ctx.contextObjects[object.objectId].populated) {\r\n            logger.warn(\"Form is cached unpopulated.  This shouldn't have happened.\");\r\n            delete ctx.contextObjects[object.objectId];\r\n        }\r\n        if (!ctx.contextObjects[object.objectId]) {\r\n            return [];\r\n        }\r\n        else {\r\n            let objDat = ctx.contextObjects[object.objectId];\r\n            objView = m(\"div\", { class: \"carousel-article-outer\" }, m(\"div\", { class: \"carousel-article carousel-article-margin\" }, [\r\n                active ? renderForm(objDat) : \"\"\r\n            ]));\r\n        }\r\n\r\n        let useCls = cls + \" carousel-item-\" + (active ? \"100\" : \"0\");\r\n        return m(\"div\", { class: useCls }, objView);\r\n    }\r\n\r\n    function getRowCount(object) {\r\n        return (object.elements.length && object.elements[0].elementValues.length ? getMaxElementValue(object, object.elements[0].elementValues) : 1);\r\n    }\r\n    function addFormRow(object) {\r\n        let row = entity.rowCount;\r\n        object.elements.forEach((e, i) => {\r\n            let val = new org.cote.objects.formElementValueType();\r\n            val.formId = object.id;\r\n            val.textValue = \"\";\r\n            e.elementValues.push(val);\r\n            setEntityBinding(object, e, row, i);\r\n        });\r\n        console.log(\"Add row \" + entity.rowCount);\r\n        entity.rowCount++;\r\n    }\r\n\r\n    function removeFormRow(object, index) {\r\n        form = page.form(app);\r\n        object.elements.forEach((e, i) => {\r\n            let name = \"fe-\" + e.elementName + \"-\" + index;\r\n            delete entity[name];\r\n            form.removeElement(form.getElementByName(name));\r\n        });\r\n    }\r\n\r\n    let patterns = [];\r\n    function getPatternType(rule) {\r\n        var s = \"\";\r\n        switch (rule.validationType) {\r\n            case \"BOOLEAN\":\r\n                s = \"bool\";\r\n                break;\r\n            case \"REPLACEMENT\":\r\n                s = \"replace\";\r\n                break;\r\n            case \"NONE\":\r\n                s = \"none\";\r\n                break;\r\n        }\r\n        return s;\r\n    }\r\n\r\n    let invalid = [];\r\n    function validateForm(object) {\r\n\r\n        invalid = [];\r\n        var oF = getAppForm();\r\n        let formVal = Hemi.data.form.service.validateForm(oF.i, 0);\r\n\r\n        let row = 0;\r\n        if (!formVal) {\r\n            object.template.elements.forEach((e) => {\r\n                let name = \"fe-\" + e.elementName + \"-\" + row;\r\n                let el = document.querySelector(\"[name=\" + name + \"]\");\r\n                let pid = el.getAttribute(\"pattern-id\");\r\n                if (pid) {\r\n                    let vres = Hemi.data.validator.service.validateField(el, pid);\r\n                    if (!vres) {\r\n                        invalid.push({ name, label: e.name, pattern: pid });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return !invalid.length;\r\n    }\r\n\r\n    function getAppForm() {\r\n        return Hemi.data.form.service.getFormByName(app.getTemplateSpace().space_id);\r\n    }\r\n    function isSupportedBinaryType(type) {\r\n        var out_bool = false;\r\n        switch (type) {\r\n            case \"resource\":\r\n            case \"schedule\":\r\n            case \"estimate\":\r\n            case \"time\":\r\n            case \"note\":\r\n            case \"data\":\r\n            case \"form\":\r\n            case \"task\":\r\n            case \"tickt\":\r\n            case \"model\":\r\n            case \"artifact\":\r\n            case \"stage\":\r\n            case \"case\":\r\n            case \"work\":\r\n            case \"goal\":\r\n            case \"budget\":\r\n            case \"cost\":\r\n                out_bool = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return out_bool;\r\n    }\r\n    let entityMap = [];\r\n    async function saveForm(object) {\r\n        let xtr = entity;\r\n        window.dbgEntityMap = entityMap;\r\n        window.dbgObject = object;\r\n        window.dbgEntity = entity;\r\n        if (!validateForm(object)) {\r\n            m.redraw();\r\n            return;\r\n        }\r\n        let row = 0;\r\n        for (let ri = 0; ri < entity.rowCount; ri++) {\r\n            let testEl = object.elements[0];\r\n            if (!testEl) {\r\n                console.warn(\"No element exists\");\r\n                continue;\r\n            }\r\n            let testName = \"fe-\" + testEl.elementName + \"-\" + ri;\r\n            if (typeof entity[testName] === \"undefined\") {\r\n                console.log(\"Skip\", testName, entity[testName]);\r\n                continue;\r\n            }\r\n            else {\r\n                console.log(\"Continue at \" + ri, testName, entity[testName]);\r\n            }\r\n            object.elements.forEach((e, i) => {\r\n                if (row == 0) e.elementValues = [];\r\n                let ename = \"fe-\" + e.elementName + \"-\" + ri;\r\n\r\n                let val = new org.cote.objects.formElementValueType();\r\n                val.name = ename;\r\n                val.isBinary = isSupportedBinaryType(e.elementType);\r\n\r\n\r\n                if (entityMap[e.elementName]) {\r\n                    if (val.isBinary) val.binaryId = parseInt(entityMap[ename]);\r\n                    else val.textValue = entityMap[ename];\r\n                }\r\n                else {\r\n                    val.textValue = entity[ename];\r\n                }\r\n                console.log(\"Assign value: \" + ename + \" == \" + val.textValue + \" at row \" + row, val);\r\n                e.elementValues[row] = val;\r\n            });\r\n            row++;\r\n        }\r\n\r\n        let updated = await page.patchObject(object);\r\n        am7client.clearCache(\"FORM\", true);\r\n        if (object.objectId) {\r\n            page.clearContextObject(object.objectId);\r\n        }\r\n        if (updated) {\r\n            console.log(\"Saved the form\");\r\n            changed = false;\r\n            if (view && view.closeView) {\r\n                view.closeView();\r\n            }\r\n            else {\r\n                console.log(\"Note: There is a caching issue with the form refreshing after an update where the values aren't correctly populated\");\r\n                m.redraw();\r\n            }\r\n        }\r\n        else {\r\n            console.log(\"Error updating form\");\r\n        }\r\n    }\r\n\r\n    function modelRule(rule) {\r\n        return new Promise((res, rej) => {\r\n            if (!rule) rej(\"Invalid rule\");\r\n            let rid = rule.urn;\r\n            if (Hemi.data.validator.service.getPattern(rid)) {\r\n                res();\r\n            }\r\n            (rule.populated ? Promise.resolve(rule) : new Promise((res2, rej2) => {\r\n                am7client.get(\"VALIDATIONRULE\", rule.objectId, function (v) {\r\n                    res2(v);\r\n                });\r\n            })).then((rule2) => {\r\n                var oDV = Hemi.data.validator.definitions.service;\r\n                var aInc;\r\n                let aP = [];\r\n                rule.rules.forEach((r) => {\r\n                    if (!aInc) aInc = [];\r\n                    let oP = (r.populated ? Promise.resolve(r) : new Promise((res3, rej3) => {\r\n                        am7client.get(\"VALIDATIONRULE\", r.objectId, function (s2, v2) {\r\n                            if (v2 && v2.json) v2 = v2.json;\r\n                            res3(v2);\r\n                        });\r\n                    }));\r\n                    aP.push(oP);\r\n                    oP.then((crule) => {\r\n                        aInc.push(crule.urn);\r\n                        aP.push(modelRule(crule));\r\n                    });\r\n                });\r\n                patterns.push(rid);\r\n                oDV.addNewPattern(\r\n                    rid,\r\n                    getPatternType(rule),\r\n                    (rule.validationType == \"BOOLEAN\" ? (rule.comparison ? \"true\" : \"false\") : 0),\r\n                    rule.expression,\r\n                    (rule.validationType == \"REPLACEMENT\" ? rule.replacementValue : 0),\r\n                    rule.allowNull, rule.errorMessage, aInc\r\n                );\r\n                Promise.all(aP).then(() => {\r\n                    res();\r\n                });\r\n            });\r\n        });\r\n    }\r\n    function modelElement(object, element, row) {\r\n        let el = [];\r\n        row = row || 0;\r\n        let name = \"fe-\" + element.elementName + \"-\" + row;\r\n        let component = \"\";\r\n        let type;\r\n        let patternId;\r\n        if (element.validationRule) {\r\n            modelRule(element.validationRule);\r\n            patternId = element.validationRule.urn;\r\n        }\r\n\r\n        let fHandler = function (e) {\r\n            updateChange(e);\r\n        };\r\n\r\n        let err = invalid.filter((i) => i.name === name);\r\n        let errCls = \"\";\r\n        if (err.length) {\r\n            errCls = \" field-error\";\r\n        }\r\n        let cls = \"text-field-full\" + errCls;\r\n        switch (element.elementType) {\r\n            case \"SELECT\":\r\n            case \"MULTIPLE_SELECT\":\r\n                cls = \"select-field-full\" + errCls;\r\n                el.push(m(\"select\", { onchange: fHandler, class: cls, name: name }, element.elementValues.map((v) => {\r\n                    return m(\"option\", { value: v.textValue }, v.name);\r\n                })));\r\n\r\n                break;\r\n            case \"BOOLEAN\":\r\n                cls = \"check-field\" + errCls;\r\n                el.push(m(\"input\", { onchange: updateChange, name: name, type: \"checkbox\", class: cls, \"pattern-id\": patternId }));\r\n                break;\r\n            case \"DATE\":\r\n                component = \"calendar\";\r\n                type = \"datetime-local\";\r\n            case \"STRING\":\r\n                if (!type) type = \"text\";\r\n                el.push(m(\"input\", { onchange: updateChange, name, type: type, component, class: cls, \"pattern-id\": patternId }));\r\n                break;\r\n            default:\r\n                console.warn(\"Unhandled: \" + element.elementType);\r\n                break;\r\n        }\r\n        return el;\r\n    }\r\n    function modelElementContainer(object, element, layout) {\r\n        let className = \"field-grid-item-\" + (layout || \"full\")\r\n        let labelClass = \"field-label\";\r\n        if (object.template.isGrid) {\r\n            console.warn(\"Not applicable to a grid layout\");\r\n            return \"\";\r\n        }\r\n        else {\r\n            return m(\"div\", { class: className }, [\r\n                m(\"label\", { class: labelClass, for: element.elementName }, element.elementLabel || element.name),\r\n                modelElement(object, element)\r\n            ]);\r\n        }\r\n    }\r\n    function renderForm(object) {\r\n        let formView = [];\r\n        let els = (object.isTemplate ? object : object.template).elements;\r\n        let grid = (object.isTemplate ? object : object.template).isGrid;\r\n        let altCls = '';\r\n        if (changed) altCls = ' warn';\r\n        formView.push(m(\"h3\", object.name));\r\n        formView.push(m(\"div\", { class: \"result-nav-outer\" }, [\r\n            m(\"div\", { class: \"result-nav-inner\" }, [\r\n                m(\"div\", { class: \"result-nav tab-container\" }, [\r\n                    page.iconButton(\"button\" + altCls, \"save\", \"\", function () { saveForm(object); }),\r\n                    (grid ? page.iconButton(\"button\", \"add\", \"\", function () { addFormRow(object); }) : \"\"),\r\n                ])\r\n            ])\r\n        ]));\r\n        if (object.isTemplate) {\r\n            formView.push(m(\"h2\", \"Form Template View Not Currently Supported\"));\r\n        }\r\n        else if (object.template.isGrid) {\r\n            let rowE = [];\r\n            let rows = getRowCount(object);\r\n            let skipDel = false;\r\n            if (entity && entity.rowCount) {\r\n                rows = entity.rowCount;\r\n                skipDel = true;\r\n            }\r\n            for (let i = 0; i < rows; i++) {\r\n\r\n                let skipRow = false;\r\n                let cells = els.map((e, i2) => {\r\n                    let cell;\r\n                    if (skipRow || (skipDel && typeof entity[\"fe-\" + e.elementName + \"-\" + i] === \"undefined\")) {\r\n                        cell = \"\";\r\n                        skipRow = true;\r\n                    }\r\n                    else {\r\n                        cell = modelElement(object, e, i);\r\n                    }\r\n                    return m(\"td\", cell);\r\n                });\r\n                cells.push(m(\"td\", (skipRow ? \"\" : page.iconButton(\"button ml-4\", \"delete_outline\", \"\", function () { removeFormRow(object, i) }))));\r\n                rowE.push(\r\n                    m(\"tr\", cells)\r\n                );\r\n            }\r\n            formView.push(m(\"table\", { class: \"table-field\" }, [\r\n                m(\"tr\", els.map((a) => {\r\n                    return m(\"th\", a.elementLabel)\r\n                }), m(\"th\", \"\")),\r\n                rowE\r\n            ]));\r\n        }\r\n        else {\r\n            els.forEach((e, i) => {\r\n                formView.push(modelElementContainer(object, e, \"two-thirds\"));\r\n            });\r\n        }\r\n        return formView;\r\n    }\r\n    function init(vnode) {\r\n        let attrs = vnode.attrs;\r\n        let object = attrs.object;\r\n        let active = attrs.active;\r\n        let ctx = page.context();\r\n        if (!ctx.contextObjects[object.objectId]) {\r\n            page.openObject(object[am7model.jsonModelKey], object.objectId).then((a) => {\r\n                m.redraw();\r\n            });\r\n        }\r\n        else {\r\n            setApp(vnode, ctx.contextObjects[object.objectId]);\r\n        }\r\n    }\r\n    function setApp(vnode, object) {\r\n        if (vnode.dom) {\r\n            if (!app) {\r\n                entity = { uid: Hemi.guid() };\r\n                setEntity(object);\r\n                window.dbgApp = app;\r\n                window.dbgEntity = entity;\r\n                window.dbgObject = object;\r\n            }\r\n            else {\r\n                let rows = vnode.dom.querySelectorAll(\"tr\");\r\n                let bind = false;\r\n                rows.forEach((row) => {\r\n                    if (row.firstChild && row.firstChild.getAttribute(\"hemi-id\") == null) {\r\n                        bind = true;\r\n                        page.extendSpace(app, row);\r\n                    }\r\n                });\r\n                /// Due to how space parsing works, there is a promise buried inside that doesn't lead to an arbitrary notification for the app component to pick up when binding to dynamically added inputs\r\n                /// Therefore, wait a moment and then bind\r\n                if (bind) {\r\n                    setTimeout(function () {\r\n                        page.bindEntity(app, entity);\r\n                    }, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function getMaxElementValue(form, vals) {\r\n        return Math.max(vals.length - getDefaultOffset(form, vals), 1);\r\n    }\r\n    function getDefaultOffset(form, vals) {\r\n        let i = 0, v = 0;\r\n        for (; i < vals.length; i++) {\r\n            if (vals[i].formId != form.id) v++;\r\n        }\r\n        return v;\r\n    }\r\n    function setEntityBinding(object, element, row, index) {\r\n        let ename = \"fe-\" + element.elementName + \"-\" + row;\r\n        let e2 = Object.assign({}, object.elements[index]);\r\n\r\n        /// Filter off the defaults\r\n        let ev = (e2 ? e2.elementValues : []).filter((e3) => {\r\n            return e3.formId == object.id;\r\n        });\r\n        let evv = ev.length > row ? ev[row] : undefined;\r\n        switch (element.elementType) {\r\n            case \"BOOLEAN\":\r\n                entity[ename] = evv ? evv.textValue === \"true\" : false;\r\n                break;\r\n            case \"DATE\":\r\n                entity[ename] = evv && evv.textValue && evv.textValue.length > 0 ? new Date(evv.textValue) : new Date();\r\n                break;\r\n\r\n            default:\r\n                entity[ename] = evv ? evv.textValue : \"\";\r\n        }\r\n    }\r\n\r\n    function setEntity(object) {\r\n        if (!object) {\r\n            console.error(\"Form is null\");\r\n            return;\r\n        }\r\n        else if (object.isTemplate) {\r\n            console.log(\"Skip template\");\r\n            return;\r\n        }\r\n        else if (object.template == null) {\r\n            console.error(\"Form template is null\");\r\n            return;\r\n        }\r\n        let rows = getRowCount(object);\r\n        entity.rowCount = rows;\r\n        for (let i = 0; i < rows; i++) {\r\n            object.template.elements.forEach((e, i2) => {\r\n                setEntityBinding(object, e, i, i2);\r\n            });\r\n        }\r\n    }\r\n\r\n    form.component = {\r\n        oncreate: function (vnode) {\r\n            init(vnode);\r\n            if (vnode.attrs && vnode.attrs.view) view = vnode.attrs.view;\r\n        },\r\n        onupdate: function (vnode) {\r\n            init(vnode);\r\n        },\r\n        onremove: function (vnode) {\r\n            if (app) app.destroy();\r\n            app = undefined;\r\n        },\r\n        view: function (vnode) {\r\n            if (vnode.attrs.inner) return renderInnerFormView(vnode.attrs);\r\n            else return renderFormView(vnode.attrs);\r\n        }\r\n    };\r\n\r\n    page.components.form = form.component;\r\n\r\n}());\r\n\n\n;/* === client/components/navigation.js === */\n(function () {\r\n    const navigation = {};\r\n\r\n    function navigable() {\r\n        let nav = {\r\n            drawerOpen: false,\r\n            contextMenus: [],\r\n            pendingMenus: [],\r\n            cleanupMenus: [],\r\n            init: function () {\r\n                document.addEventListener(\"keydown\", e => {\r\n                    if (e.keyCode == 27) {\r\n                        page.components.dialog.endDialog();\r\n                        this.drawer(1);\r\n                        this.menu(null, true);\r\n                    }\r\n                });\r\n\r\n            },\r\n            addDrawerClickEvent: function (eventPath) {\r\n                document.querySelector(eventPath).onclick = function () {\r\n                    nav.drawer();\r\n                };\r\n            },\r\n            removeContextMenu: function (menuPath) {\r\n                let len = this.contextMenus.length;\r\n                this.contextMenus = this.contextMenus.filter(function (o) { return o.menuPath != menuPath; });\r\n            },\r\n            contextMenuButton: function (sMenuId, sLabel, sIco, fHandler) {\r\n                let id = sMenuId;\r\n                if (!sMenuId.match(/^\\./)) id = \"#\" + sMenuId;\r\n                return m(\"button\", {\r\n                    class: \"context-menu-item\", onclick:\r\n                        function () {\r\n\r\n                            page.navigable.menu(id);\r\n                            if (fHandler) fHandler();\r\n                        }\r\n                }, [(sLabel || \"\"), (sIco ? m(\"span\", { class: \"material-symbols-outlined material-symbols-outlined-cm ml-2\" }, sIco) : \"\")]);\r\n            },\r\n            cleanupContextMenus: function () {\r\n                navg.cleanupMenus.forEach((m) => {\r\n                    navg.removeContextMenu(m);\r\n                });\r\n                navg.cleanupMenus = [];\r\n            },\r\n            setupPendingContextMenus: function () {\r\n                navg.pendingMenus.forEach((o) => {\r\n                    navg.addContextMenu(o.menu, o.button, o.query, o.class);\r\n                    navg.cleanupMenus.push(o.menu);\r\n                });\r\n                navg.pendingMenus = [];\r\n            },\r\n            pendContextMenu: function (menuPath, buttonPath, vQuery, altClass) {\r\n                navg.pendingMenus.push({ menu: menuPath, button: buttonPath, class: altClass, query: vQuery });\r\n            },\r\n            addContextMenu: function (menuPath, buttonPath, vQuery, sAltCls) {\r\n                let oE = document.querySelector(buttonPath);\r\n                if (oE == null) {\r\n                    console.warn(buttonPath + \" does not exist\");\r\n                    return;\r\n                }\r\n                let ctx = {\r\n                    menuOpen: false,\r\n                    buttonPath: buttonPath,\r\n                    menuPath: menuPath,\r\n                    class: sAltCls,\r\n                    query: vQuery\r\n                };\r\n                this.contextMenus.push(ctx);\r\n\r\n                oE.onclick = function () {\r\n                    (!vQuery ? Promise.resolve() : nav.populateContextMenu(vQuery)).then(() => {\r\n                        nav.menu(menuPath);\r\n                    });\r\n                };\r\n            },\r\n            menu: function (path, bF, bN) {\r\n                this.contextMenus.forEach((m) => {\r\n                    m.menuOpen = (\r\n                        (!path || m.menuPath === path)\r\n                        && !bF && !m.menuOpen) || false;\r\n                });\r\n                if (!bN) this.flash();\r\n            },\r\n            drawer: function (bF) {\r\n                this.drawerOpen = (!bF && !this.drawerOpen) || false;\r\n                if (this.drawerOpen) this.menu(0, true);\r\n                this.flash();\r\n            },\r\n            glass: function () {\r\n                let cls = \"screen-glass screen-glass-slide screen-glass-open\";\r\n                document.querySelector(\"div.screen-glass\").className = cls;\r\n            },\r\n            flash: function () {\r\n                let cls = \"screen-glass screen-glass-slide screen-glass-\" + (this.drawerOpen ? 'open' : 'close');\r\n                document.querySelector(\"div.screen-glass\").className = cls;\r\n                document.querySelector(\"aside.transition\").className = \"transition transition-\" + (this.drawerOpen ? 'full' : '0');\r\n                this.contextMenus.forEach((m) => {\r\n                    let cls = m.class || \"context-menu-48\";\r\n                    let mnu = document.querySelector(m.menuPath);\r\n                    if (mnu == null) {\r\n                        console.debug(\"Null menu for path: \" + m.menuPath);\r\n                    }\r\n                    else mnu.className = cls + \" transition transition-\" + (m.menuOpen ? 'full' : '0');\r\n                });\r\n            },\r\n            populateContextMenu: function (vQuery) {\r\n\r\n                /// There isn't an attribute to control visibility (vs. read permission), and the long-standing default has been to preface groups to be hidden with a period\r\n                ///\r\n                let ignoreList = /^\\./;\r\n\r\n                return (vQuery.loaded ? Promise.resolve() : new Promise((res, rej) => {\r\n                    vQuery.loaded = true;\r\n                    (vQuery.objectId ? Promise.resolve(vQuery.objectId) : new Promise((res2, rej2) => {\r\n                        am7client.find(vQuery.type, vQuery.subType, vQuery.path, function (v) {\r\n                            if (!v) {\r\n                                vQuery.denied = true;\r\n                                res2();\r\n                            }\r\n                            else res2(v.objectId);\r\n                        })\r\n                    }))\r\n                        .then((gid) => {\r\n                            vQuery.objectId = gid;\r\n                            if (vQuery.items) res();\r\n                            else {\r\n                                am7client.list(vQuery.type, gid, null, 0, 0, function (r) {\r\n                                    let oMenu = document.querySelector(\"#\" + vQuery.menu);\r\n                                    oMenu.innerHTML = \"\";\r\n                                    vQuery.items = r;\r\n                                    r.forEach((g) => {\r\n                                        if (!g.name.match(ignoreList)) {\r\n                                            let btn = document.createElement(\"button\");\r\n                                            btn.setAttribute(\"class\", \"context-menu-item\");\r\n                                            btn.appendChild(document.createTextNode(g.name));\r\n                                            if (vQuery.icon) {\r\n                                                let ico = document.createElement(\"span\");\r\n                                                ico.setAttribute(\"class\", \"material-symbols-outlined material-icons-cm ml-2\");\r\n                                                ico.appendChild(document.createTextNode(vQuery.icon));\r\n                                                btn.appendChild(ico);\r\n                                            }\r\n                                            oMenu.appendChild(btn);\r\n                                            btn.onclick = function () {\r\n                                                nav.menu(\"#\" + vQuery.menu);\r\n                                                if (vQuery.handler) vQuery.handler(vQuery, g);\r\n                                            };\r\n                                        }\r\n                                    });\r\n                                    res();\r\n                                });\r\n                            }\r\n                        });\r\n                }));\r\n            }\r\n        };\r\n\r\n        nav.init();\r\n\r\n        return nav;\r\n    }\r\n\r\n\r\n    function asideToggle() {\r\n        return m(\"div\", { class: \"menuToggle\" }, [m(\"button\", { class: \"mr-2\" }, m(\"span\", { class: \"material-symbols-outlined material-icons-48\" }, \"menu\"))]);\r\n    }\r\n    function asideGlass() {\r\n        return m(\"div\", { class: \"screen-glass screen-glass-slide screen-glass-close\" }, [m(\"div\", { class: \"screen-glass-gray\" })]);\r\n    }\r\n    let navg;\r\n\r\n    navigation.view = {\r\n        onupdate: function (x) {\r\n\r\n        },\r\n        oninit: function (x) {\r\n            if (!page.authenticated()) return;\r\n        },\r\n        oncreate: function (x) {\r\n            if (!page.authenticated()) return;\r\n            navg.addDrawerClickEvent(\"div.screen-glass-slide\");\r\n            navg.addDrawerClickEvent(\"div.menuToggle button\");\r\n        },\r\n        onremove: function (x) {\r\n\r\n        },\r\n\r\n        view: function (vnode) {\r\n            if (!page.authenticated()) return;\r\n            let crumb = \"\";\r\n            if (!vnode.attrs.hideBreadcrumb) {\r\n                crumb = m(page.components.breadCrumb);\r\n            }\r\n            return [\r\n                m(\"nav\", { class: \"pageNav\" }, [\r\n                    asideToggle(),\r\n                    m(page.components.topMenu, { customTray: vnode.attrs.customTray }),\r\n                    asideGlass(),\r\n                    , m(page.components.asideMenu)\r\n                ]),\r\n                crumb\r\n            ];\r\n\r\n\r\n        }\r\n    };\r\n    navg = navigable();\r\n    page.navigable = navg;\r\n    page.components.navigation = navigation.view;\r\n}());\r\n\n\n;/* === client/components/pagination.js === */\n(function () {\r\n\r\n  function newPaginationControl() {\r\n    let requesting = false;\r\n    let embeddedMode = false;\r\n\r\n    let entity = {\r\n      listFilter: \"\",\r\n      sort: \"name\",\r\n      order: \"ascending\"\r\n    };\r\n\r\n    function newPagination(containerType) {\r\n      return {\r\n        navigateByParent: false,\r\n        listSystem: false,\r\n        startRecord: 0,\r\n        recordCount: 10,\r\n        displayCount: 0,\r\n        totalCount: 0,\r\n        counted: false,\r\n        currentPage: -1,\r\n        currentItem: 0,\r\n        pageCount: 0,\r\n        pageResults: [],\r\n        pageState: {},\r\n        resultType: null,\r\n        filter: null,\r\n        containerType: (containerType || \"auth.group\"),\r\n        containerSubType: null,\r\n        containerId: null,\r\n        container: null,\r\n        sort: entity.sort,\r\n        order: entity.order,\r\n        id: page.uid()\r\n      };\r\n    }\r\n    let pages = newPagination();\r\n\r\n    async function getSearchQuery() {\r\n\r\n      let q = am7client.newQuery(pages.resultType);\r\n      q.entity.request = getRequestFields(pages.resultType);\r\n      if(pages.filter != null){\r\n        let qf = q.field(\"name\", pages.filter);\r\n        qf.comparator = \"like\";\r\n      }\r\n\r\n      if(!am7model.hasField(pages.resultType, \"name\") && entity.sort == \"name\"){\r\n        entity.sort = \"id\";\r\n        pages.sort = \"id\";\r\n      }\r\n\r\n      q.range(pages.startRecord, pages.recordCount);\r\n      q.sort(pages.sort);\r\n      q.order(pages.order);\r\n      q.field(\"organizationId\", page.user.organizationId);\r\n\r\n      if(am7model.hasField(pages.resultType, \"tags\")){ \r\n        q.entity.request.push(\"tags\");\r\n      }\r\n\r\n      if(!pages.containerId){\r\n        am7client.search(q, handleList);\r\n      }\r\n      else{\r\n        let gq = am7view.viewQuery(am7model.newInstance(pages.containerType));\r\n        gq.field(\"objectId\", pages.containerId  );\r\n        let g = await page.search(gq);\r\n        let id = 0;\r\n        if(g && g.results){\r\n          id = g.results[0].id;\r\n        }\r\n        /// auth.group is a special case where it is a parent/child hierarchy, so the parentId is used\r\n        /// some models like data.note can be hierarchical by group and parent\r\n        if(pages.resultType){\r\n          if(am7model.isGroup(pages.resultType) && am7model.hasField(pages.resultType, \"groupId\")){\r\n            q.field(\"groupId\", id);\r\n          }\r\n          else if(am7model.isParent(pages.resultType)){\r\n            q.field(\"parentId\", id);\r\n          }\r\n        }\r\n      }\r\n\r\n      return q;\r\n    }\r\n\r\n    function handleCount(v) {\r\n      pages.pageResults = [];\r\n      pages.counted = true;\r\n      pages.totalCount = v || 0;\r\n\r\n      requesting = false;\r\n      m.redraw();\r\n    }\r\n    function handleList(v) {\r\n      if(v && v[am7model.jsonModelKey] == \"io.queryResult\"){\r\n        v = v.results;\r\n      }\r\n      pages.pageResults[pages.currentPage] = v;\r\n      am7model.updateListModel(v);\r\n      requesting = false;\r\n      m.redraw();\r\n    }\r\n\r\n    function listRouter(url, iPage) {\r\n      if (embeddedMode) {\r\n        updatePage(iPage);\r\n      }\r\n      else {\r\n        m.route.set(url);\r\n      }\r\n    }\r\n    function navNext(bRedrawOnly) {\r\n      if (pages.currentPage < pages.pageCount) {\r\n        if (bRedrawOnly || embeddedMode) {\r\n          updatePage(pages.currentPage + 1);\r\n        }\r\n        else listRouter(getPageUrl(pages.currentPage + 1), pages.currentPage + 1);\r\n      }\r\n    }\r\n    function navPrev(bRedrawOnly) {\r\n      if (pages.currentPage > 1) {\r\n        if (bRedrawOnly || embeddedMode) {\r\n          updatePage(pages.currentPage - 1);\r\n        }\r\n        else listRouter(getPageUrl(pages.currentPage - 1), pages.currentPage - 1);\r\n      }\r\n    }\r\n\r\n    function updatePage(iPage) {\r\n      if (requesting) return;\r\n      if (iPage <= 0 || iPage > pages.pageCount) {\r\n        // console.debug(\"Invalid page: \" + iPage + \" / \" + pages.pageCount);\r\n        return;\r\n      }\r\n\r\n      pages.currentPage = iPage;\r\n      pages.startRecord = (iPage - 1) * pages.recordCount;\r\n      pages.currentItem = -1;\r\n      if (pages.pageResults[iPage]) {\r\n        m.redraw();\r\n      }\r\n\r\n      else {\r\n        /// filter is used for count and list through the search API, which allows for scoping to the current group and recurse through child group structures\r\n        ///\r\n        requesting = true;\r\n\r\n        if (pages.containerSubType != null && pages.containerSubType.match(/^(user|account|person|bucket)$/gi)) {\r\n          am7client.members(pages.containerType, pages.containerId, pages.resultType, pages.startRecord, pages.recordCount, function (v) {\r\n            handleList(v);\r\n          });\r\n        }\r\n        else if (pages.listSystem && pages.resultType.match(/^(policy\\.policy|auth\\.role|auth\\.permission)$/gi)) {\r\n          let ttype =  pages.resultType.substring(pages.resultType.lastIndexOf(\".\") + 1,  pages.resultType.length);\r\n\r\n          let uType = ttype.substring(0, 1).toUpperCase() + ttype.slice(1);\r\n          let fType = uType + \"s\";\r\n          if (uType.match(/y$/)) fType = uType.slice(0, uType.length - 1) + \"ies\";\r\n          let v;\r\n          if((v = page.application[\"system\" + fType])){\r\n            let i = parseInt(pages.startRecord);\r\n            let c = parseInt(pages.recordCount);\r\n            let modList = v.slice(i, i + c);\r\n            handleList(modList);\r\n          }\r\n\r\n        }\r\n        else if (pages.resultType.match(/^request$/)) {\r\n          console.warn(\"REFACTOR LIST REQUESTS\");\r\n          // am7client.listRequests(\"USER\", page.user.objectId, pages.startRecord, pages.recordCount, handleList);\r\n        }\r\n        else {\r\n          getSearchQuery().then((q) => {\r\n            am7client.search(q, handleList);\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    function getRequestFields(type) {\r\n      let flds = am7model.queryFields(type);\r\n      window.am7decorator.map().forEach(m => {\r\n        if(!m.match(/^_/) && !flds.includes(m) && am7model.hasField(type, m)){\r\n          flds.push(m);\r\n        }\r\n      });\r\n      return flds;\r\n\r\n    }\r\n\r\n    function stopPaginating() {\r\n      pagination.paginating = false;\r\n      pages = newPagination();\r\n    }\r\n\r\n    function updateList(type, containerId, navigateByParent, filter, startRecord, recordCount, bSystem) {\r\n      if (requesting) return;\r\n      pagination.paginating = true;\r\n\r\n      entity.listFilter = filter || \"\";\r\n      let sortChange = (entity.sort != pages.sort || entity.order != pages.order);\r\n\r\n      if (\r\n        sortChange\r\n        ||\r\n        ((pages.filter == null && entity.listFilter.length) || (pages.filter != null && pages.filter != entity.listFilter))\r\n        ||\r\n        (pages.containerId != null && pages.containerId != containerId)\r\n        ||\r\n        (!isNaN(recordCount) && recordCount > 0 && pages.recordCount != recordCount)\r\n      ) {\r\n        /// TODO: Need to clean all of this up - the pagination state object needs a better relationship with the entity containing the filter and any search/query configuration\r\n        /// A lot of this is due to the original API being driven by listing by type and membership, and it's morphed into the query/search format which is more flexible (albeit still somewhat limited by type)\r\n        ///\r\n        let sort = pages.sort;\r\n        let order = pages.order;\r\n        pages = newPagination();\r\n        entity.sort = sort;\r\n        entity.order = order;\r\n        pages.sort = sort;\r\n        pages.order = order;\r\n        pages.recordCount = (!isNaN(recordCount) && recordCount > 0 ? recordCount : pages.recordCount);\r\n        pages.filter = (entity.listFilter.length ? entity.listFilter : null);\r\n\r\n      }\r\n      pages.navigateByParent = navigateByParent;\r\n      pages.listSystem = bSystem;\r\n      if (type.match(/^(system\\.user|auth\\.permission|auth\\.role|auth\\.request|auth\\.control)$/gi) || navigateByParent) pages.containerType = type;\r\n      pages.resultType = type;\r\n      pages.containerId = containerId;\r\n\r\n      /// Need to get the container to understand the subType, such as GROUP/DATA vs GROUP/BUCKET\r\n      if (containerId && pages.container == null) {\r\n        requesting = true;\r\n        page.openObject(pages.containerType, pages.containerId).then(v => {\r\n          pages.container = v;\r\n          requesting = false;\r\n          if (v != null) {\r\n            // console.log(\"Redraw to load container object\");\r\n            pages.container = v;\r\n            if (pages.containerType.match(/^auth\\.group$/gi)) {\r\n              pages.containerSubType = pages.container.type;\r\n            }\r\n            m.redraw();\r\n          }\r\n          else {\r\n            console.error(\"Error loading container: \" + pages.containerType + \" / \" + pages.containerId);\r\n          }\r\n        });\r\n      }\r\n      else if (!pages.counted) {\r\n        requesting = true;\r\n        if (pages.containerSubType != null && pages.containerSubType.match(/^(system\\.user|identity\\.account|identity\\.person|bucket)$/gi)) {\r\n          am7client.countMembers(pages.containerType, pages.containerId, type, handleCount);\r\n        }\r\n        else if (bSystem && type.match(/^(policy\\.policy|auth\\.role|auth\\.permission)$/gi)) {\r\n          let ttype = type.substring(type.lastIndexOf(\".\") + 1, type.length);\r\n          let uType = ttype.substring(0, 1).toUpperCase() + ttype.slice(1);\r\n          let fType = uType + \"s\";\r\n          if (uType.match(/y$/)) fType = uType.slice(0, uType.length - 1) + \"ies\";\r\n          if(page.application[\"system\" + fType]){\r\n            handleCount(page.application[\"system\" + fType].length);\r\n          }\r\n        }\r\n        else if (type.match(/^request$/gi)) {\r\n          console.warn(\"REFACTOR COUNT REQUESTS\");\r\n          /*\r\n          am7client.countRequests(\"USER\", page.user.objectId, function (v) {\r\n            handleCount(v);\r\n          });\r\n          */\r\n        }\r\n        else {\r\n\r\n          //let req = getSearchQuery();\r\n          //am7client.searchCount(req, handleCount);\r\n          /// Set record count to 0 because searchCount operates differently than the regular count, counting authorized identifiers outside of a view versus counting rows\r\n          ///\r\n          getSearchQuery().then((req) => {\r\n            req.recordCount = 0;\r\n            page.count(req).then((v) => {\r\n              handleCount(v);\r\n            });\r\n          });\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n        if (pages.totalCount > 0) pages.pageCount = Math.ceil(pages.totalCount / pages.recordCount);\r\n        if (isNaN(startRecord)) startRecord = 0;\r\n        if (isNaN(recordCount)) recordCount = pages.recordCount;\r\n        pages.startRecord = startRecord;\r\n        pages.recordCount = recordCount;\r\n\r\n        let usePage = 0;\r\n        if (recordCount > 0) {\r\n          usePage = 1;\r\n          if (startRecord > 1) usePage = Math.ceil(startRecord / pages.recordCount) + 1;\r\n          if (usePage != pages.currentPage) {\r\n            updatePage(usePage);\r\n          }\r\n        }\r\n\r\n      }\r\n    }\r\n    function doFilter(sFilt, bRedrawOnly) {\r\n      let url = page.getRawUrl() + \"?startRecord=0\";\r\n      pages = newPagination();\r\n      entity.listFilter = sFilt || \"\";\r\n      console.log(\"Filter: \", entity);\r\n      if (entity.listFilter != null && entity.listFilter.length) {\r\n        url += \"&filter=\" + encodeURI(entity.listFilter);\r\n        pages.filter = entity.listFilter;\r\n      }\r\n      if(bRedrawOnly){\r\n        m.redraw();\r\n      }\r\n      else{\r\n        listRouter(url);\r\n      }\r\n    }\r\n\r\n    function getPageUrl(iPage, iCount) {\r\n      if (isNaN(iPage)) iPage = pages.currentPage;\r\n      if (isNaN(iCount)) iCount = pages.recordCount;\r\n      let url = page.getRawUrl();\r\n      let filter = \"\";\r\n      if (pages.filter != null) filter = \"&filter=\" + encodeURI(pages.filter);\r\n      url += \"?startRecord=\" + ((iPage - 1) * iCount) + filter + \"&recordCount=\" + iCount;\r\n      let stem = page.uriStem();\r\n\r\n      return url + (stem.length ? \"&\" + stem : \"\");\r\n    }\r\n    function paginationControlBar() {\r\n      return m(\"div\", { class: \"result-nav-outer\" }, [\r\n        m(\"div\", { class: \"result-nav-inner\" }, [\r\n          m(\"div\", { class: \"count-label\" }, \"Showing \" + pages.currentPage + \" of \" + pages.pageCount + \" (\" + pages.totalCount + \")\"),\r\n          m(\"nav\", { class: \"result-nav\" }, [\r\n            pageButtons()\r\n          ])\r\n        ])\r\n      ]);\r\n    }\r\n    function pageButtons(bRedrawOnly) {\r\n\r\n      let pageButtons = [];\r\n\r\n      pageButtons.push(paginationButton(\"previous button\", \"keyboard_double_arrow_left\", \"\", function () { listRouter(getPageUrl(1), 1); }));\r\n      pageButtons.push(paginationButton(\"button\", \"chevron_left\", \"\", function () { navPrev(); }));\r\n\r\n      let bMore = (pages.pageCount > 7)\r\n      let left = pages.currentPage - 3;\r\n\r\n      if (left < 1) left = 1;\r\n\r\n      let right = pages.currentPage + 3;\r\n      if (right < 7) right = 7;\r\n      right = Math.min(pages.pageCount, right);\r\n\r\n      if (pages.currentPage > 3 && (right - left) < 7) {\r\n        left = Math.max(right - 6, 1);\r\n      }\r\n      let maxI = Math.max(right, 7);\r\n      for (let i = left; i <= maxI; i++) {\r\n        let style = \"page\";\r\n        let fHandler;\r\n        if (i > pages.pageCount) {\r\n          pageButtons.push(paginationButton(\"page\", null, \"\"));\r\n          continue;\r\n        }\r\n        if (pages.currentPage == i) style = \"page-current\";\r\n        else fHandler = function () {\r\n          listRouter(getPageUrl(i), i);\r\n        };\r\n        pageButtons.push(paginationButton(style, null, i, fHandler));\r\n\r\n      };\r\n      pageButtons.push(paginationButton(\"button\", \"chevron_right\", \"\", function () { navNext(); }));\r\n      pageButtons.push(paginationButton(\"next button\", \"keyboard_double_arrow_right\", \"\", function () { listRouter(getPageUrl(pages.pageCount), pages.pageCount); }));\r\n      return pageButtons;\r\n    }\r\n\r\n    function getPageState(o) {\r\n      if (!pages.pageState[o.objectId]) {\r\n        pages.pageState[o.objectId] = { checked: false };\r\n      }\r\n      return pages.pageState[o.objectId];\r\n    }\r\n\r\n    function paginationButton(sClass, sIco, sLabel, fHandler) {\r\n      return page.iconButton(sClass, sIco, sLabel, fHandler);\r\n    }\r\n\r\n    let pagination = {\r\n      requesting: requesting,\r\n      entity: entity,\r\n      paginating: false,\r\n      new: function () {\r\n        pages = newPagination();\r\n        return pages;\r\n      },\r\n      pages: function () { return pages; },\r\n      pageBarView: paginationControlBar,\r\n      update: updateList,\r\n      searchQuery: getSearchQuery,\r\n      handleCount: handleCount,\r\n      handleList: handleList,\r\n      next: navNext,\r\n      prev: navPrev,\r\n      filter: doFilter,\r\n      //changePage: updatePage,\r\n      url: getPageUrl,\r\n      pageButtons: pageButtons,\r\n      state: getPageState,\r\n      button: paginationButton,\r\n      stop: stopPaginating,\r\n      setEmbeddedMode: function(bEmbed) { embeddedMode = bEmbed; }\r\n\r\n    };\r\n    return pagination;\r\n  }\r\n  page.pagination = newPaginationControl;\r\n}())\n\n;/* === client/components/designer.js === */\n(function () {\r\n    const designer = {};\r\n    let designStyle = 'edit';\r\n    let designHtml = \"\";\r\n    let caller;\r\n    let init = false;\r\n    let toggled = false;\r\n    let pickData = false;\r\n    let pickDataObject = null;\r\n    let codeMirror;\r\n\r\n    function handlePickData(dat) {\r\n        if (dat && dat.length) {\r\n            pickDataObject = dat[0];\r\n            pickData = true;\r\n        }\r\n        caller.endPicker();\r\n    }\r\n\r\n    function insertObjectAtCaret(obj) {\r\n        let frame = document.querySelector(\"[rid=designFrame]\");\r\n        let doc = (frame.contentWindow || frame.contentDocument);\r\n        doc.document.body.focus();\r\n\r\n        var oA = doc.document.createElement(\"a\");\r\n\r\n\r\n        let oI;\r\n        var sOrg = am7client.dotPath(am7client.currentOrganization);\r\n        var sThumbUrl = g_application_path + \"/thumbnail/\" + sOrg + \"/data.data\" + obj.groupPath + \"/\" + obj.name + \"/250x250\";\r\n        var sUrl = g_application_path + \"/media/\" + sOrg + \"/data.data\" + obj.groupPath + \"/\" + obj.name;\r\n        var sIco = 0;\r\n        if (!obj.contentType.match(/^image/)) {\r\n            oI = doc.document.createElement(\"span\");\r\n            oI.setAttribute(\"class\", \"material-symbols-outlined material-icons-48\");\r\n            oI.appendChild(document.createTextNode(\"widgets\"));\r\n        }\r\n        else {\r\n            oI = doc.document.createElement(\"img\");\r\n            oI.setAttribute(\"src\", sThumbUrl);\r\n            oI.setAttribute(\"title\", obj.name);\r\n        }\r\n        oA.appendChild(oI);\r\n        oA.setAttribute(\"href\", sUrl);\r\n        oA.setAttribute(\"target\", \"blank\");\r\n        oA.setAttribute(\"title\", obj.name);\r\n        insertNodeAtCaret(oA);\r\n    }\r\n    function insertNodeAtCaret(oNode) {\r\n        var sel, range;\r\n        let frame = document.querySelector(\"[rid=designFrame]\");\r\n        let doc = (frame.contentWindow || frame.contentDocument);\r\n        if (doc.getSelection) {\r\n            sel = doc.getSelection();\r\n            if (sel.getRangeAt && sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                range.deleteContents();\r\n                range.insertNode(oNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    function pickImage() {\r\n        if (pickData) {\r\n            pickData = false;\r\n            insertObjectAtCaret(pickDataObject);\r\n            pickDataObject = null;\r\n        }\r\n        else caller.preparePicker(caller.getInstance(), 'data.data', handlePickData, \"~/Gallery\");\r\n    }\r\n  \r\n    function defAct(e, action) {\r\n        //console.log(\"Default action: \" + e.srcElement);\r\n        let frame = document.querySelector(\"[rid=designFrame]\");\r\n        let doc = (frame.contentWindow || frame.contentDocument);\r\n        let opt;\r\n        doc.document.body.focus();\r\n        switch (action) {\r\n            case \"Indent\":\r\n            case \"Outdent\":\r\n            case \"InsertHorizontalRule\":\r\n            case \"InsertOrderedList\":\r\n            case \"InsertUnorderedList\":\r\n            case \"JustifyLeft\":\r\n            case \"JustifyCenter\":\r\n            case \"JustifyRight\":\r\n            case \"Underline\":\r\n            case 'Bold':\r\n            case 'Italic':\r\n                console.log(\"Command: '\" + action + \"'\");\r\n                doc.document.execCommand(action, false, opt);\r\n                break;\r\n            default:\r\n                console.log(\"Don't know what to do\");\r\n                break;\r\n        }\r\n        doc.focus();\r\n    }\r\n\r\n    function transitionHandler() {\r\n        init = false;\r\n        let entity = caller.getEntity();\r\n        if (!entity || entity[am7model.jsonModelKey] != 'data.data') {\r\n            console.log(\"Ignoring non data or invalid entity\");\r\n            return;\r\n        }\r\n        let source;\r\n        if (designStyle == 'code') {\r\n            source = codeMirror.getValue();\r\n        }\r\n        else {\r\n            source = refreshDesignSources();\r\n        }\r\n\r\n        caller.getInstance().api.dataBytesStore(source);\r\n        if (caller.getInstance().api.compressionType) {\r\n            caller.getInstance().api.compressionType(\"none\");\r\n        }\r\n        designHtml = \"\";\r\n\r\n    }\r\n    function alignSource() {\r\n        toggled = false;\r\n        if (!init) {\r\n            setupDesigner();\r\n        }\r\n        else {\r\n            switch (designStyle) {\r\n                case 'source':\r\n                    let txt = document.querySelector(\"[rid=designText]\");\r\n                    if (txt) {\r\n                        txt.value = designHtml;\r\n                    }\r\n                    break;\r\n                case 'edit':\r\n                case 'preview':\r\n                    let frame = document.querySelector(\"[rid=designFrame]\");\r\n                    if (frame) {\r\n                        let content = designDocumentHeader + bbConverter.import(designHtml) + designDocumentFooter;\r\n                        writeFrame(frame, content);\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    function toggleStyle(sStyle) {\r\n        designHtml = refreshDesignSources();\r\n        designStyle = sStyle;\r\n        toggled = true;\r\n        m.redraw();\r\n    }\r\n\r\n    let formatOptions = ['BLOCK', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'BlockQuote', 'P'];\r\n    let fontOptions = ['FONT', 'Arial', 'Times', 'Verdana', 'Courier'];\r\n    let fontSizeOptions = ['SIZE', 'Size 1', 'Size 2', 'Size 3', 'Size 4', 'Size 5', 'Size 6', 'Size 7'];\r\n    let fontColorOptions = ['COLOR', 'Black', 'Grey', 'White', 'Yellow', 'Green', 'Blue', 'Violet'];\r\n    let fillColorOptions = ['FILL', 'Black', 'Grey', 'White', 'Yellow', 'Green', 'Blue', 'Violet'];\r\n\r\n    let designDocumentHeader = `<html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"utf-8\">\r\n            <title>forms</title>\r\n            <link rel=\"icon\" href=\"/media/logo_48.png\" />  \r\n            <link href = \"/dist/basiTail.css\" rel = \"stylesheet\" />\r\n            <link href=\"/node_modules/material-icons/iconfont/material-icons.css\" rel=\"stylesheet\" />\r\n            <link rel=\"stylesheet\" href=\"/styles/pageStyle.css\" />\r\n        </head>\r\n        <body class = 'carousel-article'>\r\n    `;\r\n    let designDocumentDefContent = `<h1>Title</h1>\r\n    <h2>Sub Title</h2>\r\n    <div>[ body ]</div>\r\n    `;\r\n\r\n    let designDocumentFooter = `</body></html>`;\r\n\r\n    function setupDesigner() {\r\n        if (init) return;\r\n        let entity = caller.getEntity();\r\n        if (!entity) {\r\n            return;\r\n        }\r\n        if (!entity[am7model.jsonModelKey] || entity[am7model.jsonModelKey] != 'data.data') {\r\n            console.warn(\"Unexpected model: \" + entity[am7model.jsonModelKey]);\r\n            return;\r\n        }\r\n        if (designStyle != 'edit' && designStyle != 'code') {\r\n            console.warn(\"Setup should only be invoked for edit or code mode\");\r\n            return;\r\n        }\r\n\r\n        let bytes = caller.getInstance().api.dataBytesStore();\r\n        if (designStyle == 'code') {\r\n            let tarea = document.querySelector(\"[rid=designText]\");\r\n            if (!tarea) {\r\n                return;\r\n            }\r\n            tarea.value = bytes;\r\n            let cfg = {\r\n                lineNumbers: true,\r\n                mode: \"javascript\",\r\n                indentUnit: 4,\r\n                extraKeys: {\r\n                    Tab: function (cm) {\r\n                        cm.replaceSelection(\"    \", \"end\");\r\n                    }\r\n                },\r\n                autoFocus: false,\r\n                gutters: [\"CodeMirror-lint-markers\"],\r\n                lint: {\r\n                    globals: [\"m\"],\r\n                    onUpdateLinting: function (annotations) {\r\n                        m.redraw();\r\n                    }\r\n                }\r\n            };\r\n            codeMirror = CodeMirror.fromTextArea(tarea, cfg);\r\n            codeMirror.setSize(\"100%\", \"100%\");\r\n            window.dbgCode = codeMirror;\r\n        }\r\n        else {\r\n            let frame = document.querySelector(\"[rid=designFrame]\");\r\n            if (!frame) {\r\n                return;\r\n            }\r\n            if (bytes.length) {\r\n                console.log(\"Write byte store\");\r\n                writeFrame(frame, designDocumentHeader + bbConverter.import(bytes) + designDocumentFooter);\r\n            }\r\n            else {\r\n                writeFrame(frame, designDocumentHeader + designDocumentDefContent + designDocumentFooter);\r\n            }\r\n        }\r\n        init = true;\r\n    }\r\n\r\n    function writeFrame(frame, content) {\r\n\r\n        //console.log(\"Write: \" + content);\r\n        let docType = '<!doctype html>';\r\n        let doc = (frame.contentWindow || frame.contentDocument);\r\n        try {\r\n            if (!doc || !doc.document) {\r\n                console.error(\"WriteContent: Unable to find document; \" + this.writeFrame.caller);\r\n                return;\r\n            }\r\n            var d = doc.document;\r\n            d.open();\r\n            d.write(docType + content);\r\n            d.close();\r\n            enableDesigner(d);\r\n        }\r\n        catch (e) {\r\n            console.error(\"Unexpected UI Error: \" + (e.message ? e.message : e.description));\r\n        }\r\n    }\r\n    function enableDesigner(doc) {\r\n        try {\r\n            if (doc) {\r\n                doc.designMode = (designStyle == 'edit' ? \"on\" : \"off\");\r\n                console.log(\"Design mode: \" + doc.designMode);\r\n                doc.documentElement.focus();\r\n            }\r\n            else {\r\n                console.error(\"Could not find designer document to enabled\");\r\n            }\r\n        }\r\n        catch (e) {\r\n            console.error(\"Error enabling designer: \" + (e.message ? e.message : e.description));\r\n        }\r\n    }\r\n\r\n    function refreshDesignSources() {\r\n        let sSource;\r\n        switch (designStyle) {\r\n            case 'edit':\r\n                let frame = document.querySelector(\"[rid=designFrame]\");\r\n                if (frame) {\r\n                    var doc = (frame.contentWindow || frame.contentDocument);\r\n                    if (!doc || !doc.document) return null;\r\n                    sSource = bbConverter.convertNodes(doc.document.body.childNodes);\r\n                }\r\n                break;\r\n            case 'source':\r\n                let txt = document.querySelector(\"[rid=designText]\");\r\n                if (txt) sSource = txt.value;\r\n                break;\r\n        }\r\n        if (!sSource) sSource = designHtml;\r\n        else designHtml = sSource;\r\n        return sSource;\r\n    }\r\n\r\n    function getDesignField() {\r\n        let field = \"\";\r\n        let cls = 'full-block' + (page.components.picker.inPickMode() ? \" hidden\" : \"\");\r\n        switch (designStyle) {\r\n            case 'edit':\r\n            case 'preview':\r\n                /// src : '/blank.html'\r\n                field = m(\"iframe\", { src: 'about:blank', rid: 'designFrame', class: cls });\r\n                break;\r\n            case 'code':\r\n            case 'source':\r\n                field = m(\"textarea\", { rid: 'designText', class: cls });\r\n                break;\r\n        }\r\n        return field;\r\n    }\r\n\r\n    function getDesigner(attrs) {\r\n        if (attrs && attrs.entity) {\r\n            let mt = attrs.entity.contentType;\r\n            if (mt) {\r\n                if (mt.match(/^text\\//)) {\r\n                    if (designStyle == 'code') designStyle = 'edit';\r\n                    return getRichTextDesigner();\r\n                }\r\n                if (mt.match(/(css|javascript)$/)) {\r\n                    designStyle = 'code';\r\n                    return getCodeDesigner();\r\n                }\r\n            }\r\n        }\r\n        return \"\";\r\n    }\r\n    function getCodeDesigner() {\r\n        return [\r\n            m(\"div\", { class: \"results-overflow\" }, getDesignField())\r\n        ];\r\n    }\r\n    function getRichTextDesigner() {\r\n        return [\r\n            m(\"div\", { class: \"result-nav-outer\" + (page.components.picker.inPickMode() ? \" hidden\" : \"\") }, [\r\n                m(\"div\", { class: \"result-nav-inner\" }, [\r\n                    m(\"div\", { class: \"result-nav\" }, [\r\n                        page.iconButton(\"button\" + (designStyle == 'source' ? ' active' : ''), \"code\", \"\", function () { toggleStyle('source'); }),\r\n                        page.iconButton(\"button\" + (designStyle == 'edit' ? ' active' : ''), \"design_services\", \"\", function () { toggleStyle('edit'); }),\r\n                        page.iconButton(\"button\" + (designStyle == 'preview' ? ' active' : ''), \"preview\", \"\", function () { toggleStyle('preview'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_italic\", \"\", function (e) { defAct(e, 'Italic'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_bold\", \"\", function (e) { defAct(e, 'Bold'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_underlined\", \"\", function (e) { defAct(e, 'Underline'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_align_left\", \"\", function (e) { defAct(e, 'JustifyLeft'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_align_center\", \"\", function (e) { defAct(e, 'JustifyCenter'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_align_justify\", \"\", function (e) { defAct(e, 'JustifyFull'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_align_right\", \"\", function (e) { defAct(e, 'JustifyRight'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_list_bulleted\", \"\", function (e) { defAct(e, 'InsertOrderedList'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_list_numbered\", \"\", function (e) { defAct(e, 'InsertUnorderedList'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_indent_increase\", \"\", function (e) { defAct(e, 'Indent'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"format_indent_decrease\", \"\", function (e) { defAct(e, 'Outdent'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"horizontal_rule\", \"\", function (e) { defAct(e, 'InsertHorizontalRule'); }),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : (pickData ? ' focus' : '')), (pickData ? \"content_paste_go\" : \"image\"), \"\", pickImage),\r\n                        page.iconButton(\"button\" + (designStyle != 'edit' ? ' inactive' : ''), \"link\", \"\", defAct)\r\n                    ]),\r\n                    (designStyle != 'edit' ? '' : m(\"div\", { class: \"result-nav\" }, [\r\n                        m(\"select\", { class: \"nav-select reactive-arrow\" }, formatOptions.map((o) => m(\"option\", o))),\r\n                        m(\"select\", { class: \"nav-select reactive-arrow\" }, fontOptions.map((o) => m(\"option\", o))),\r\n                        m(\"select\", { class: \"nav-select reactive-arrow\" }, fontSizeOptions.map((o) => m(\"option\", o))),\r\n                        m(\"select\", { class: \"nav-select reactive-arrow\" }, fontColorOptions.map((o) => m(\"option\", o))),\r\n                        m(\"select\", { class: \"nav-select reactive-arrow\" }, fillColorOptions.map((o) => m(\"option\", o)))\r\n                    ]))\r\n                ])\r\n            ]),\r\n            m(\"div\", { class: \"results-overflow\" }, getDesignField())\r\n        ];\r\n    }\r\n\r\n    designer.component = {\r\n\r\n        oninit: function (x) {\r\n            if (x.attrs.caller) {\r\n                caller = x.attrs.caller;\r\n                caller.transitionHandler = transitionHandler;\r\n            }\r\n        },\r\n        oncreate: function (x) {\r\n            alignSource();\r\n        },\r\n        onupdate: function (x) {\r\n            if (!init) setupDesigner();\r\n            else if (toggled) alignSource();\r\n        },\r\n        onremove: function (x) {\r\n            init = false;\r\n            caller = null;\r\n            toggled = false;\r\n            pickData = false;\r\n            pickDataObject = null;\r\n        },\r\n\r\n        view: function (v) {\r\n            return (v.attrs.visible ? getDesigner(v.attrs) : \"\");\r\n        }\r\n    };\r\n\r\n    page.components.designer = designer.component;\r\n}());\r\n\n\n;/* === client/components/tree.js === */\n(function () {\r\n\r\n    function newTreeComponent() {\r\n\r\n        let treeMatrix = {};\r\n        let autoExpand = false;\r\n        let selectedNode;\r\n        let origin;\r\n        let originRole;\r\n        let originPermission;\r\n        let list;\r\n        let pendingRefresh = false;\r\n        let dnd;\r\n        let olioMode = true;\r\n        let checkOlio = false;\r\n        let olio;\r\n\r\n        function inlineType(type, fConfirm, fCancel) {\r\n            treeMatrix[selectedNode].expanded = true;\r\n            let entity = am7model.newPrimitive(type);\r\n            if (type == \"auth.group\") {\r\n                entity.path = treeMatrix[selectedNode].path;\r\n            }\r\n            if (type == \"auth.role\" || type == \"auth.permission\") {\r\n                entity.path = treeMatrix[selectedNode].path + \"/\" + treeMatrix[selectedNode].name;\r\n            }\r\n\r\n            let dlg = {\r\n                label: \"New \" + type,\r\n                entityType: type,\r\n                size: 50,\r\n                data: { entity },\r\n                confirm: async function (data) {\r\n                    if (fConfirm) await fConfirm(data);\r\n                    page.components.dialog.endDialog();\r\n                },\r\n                cancel: async function (data) {\r\n                    if (fCancel) await fCancel(data);\r\n                    page.components.dialog.endDialog();\r\n                }\r\n            };\r\n            page.components.dialog.setDialog(dlg);\r\n        }\r\n        async function inlineAdd(data) {\r\n            let mtx = treeMatrix[selectedNode];\r\n            let newGrp = data.entity;\r\n            if (mtx.type == \"auth.group\") {\r\n                newGrp.type = data.entity.type;\r\n            }\r\n\r\n            if (mtx.type == \"auth.role\" || mtx.type == \"auth.permission\" || mtx.type == \"auth.group\") {\r\n                newGrp.path = treeMatrix[selectedNode].path + \"/\" + treeMatrix[selectedNode].name;\r\n            }\r\n\r\n            if (mtx.type.match(/^(auth\\.role|auth\\.permission)$/)) {\r\n                newGrp.type = data.entity.type;\r\n            }\r\n            newGrp.parentId = mtx.nodeId;\r\n            newGrp.name = data.entity.name;\r\n            await page.createObject(newGrp);\r\n            resetNode(selectedNode);\r\n            am7client.clearCache(newGrp[am7model.jsonModelKey], true);\r\n            m.redraw();\r\n        }\r\n\r\n        function addNew() {\r\n            let mtx = treeMatrix[selectedNode];\r\n            inlineType(mtx.listChildType, inlineAdd, async function (data) {\r\n                //inlineType(mtx.type.toLowerCase(), inlineAdd, async function(data){\r\n                console.log(\"Cancel\");\r\n            });\r\n        }\r\n\r\n        function scrollToLast(){\r\n            let sel = document.getElementById(\"selectedNode\");\r\n            if(sel != null){\r\n              //sel.scrollIntoView();\r\n            }\r\n  \r\n          }\r\n\r\n        function deleteNode() {\r\n            if (!selectedNode || selectedNode == origin.objectId) return;\r\n            let node = treeMatrix[selectedNode];\r\n            let pid;\r\n            Object.keys(treeMatrix).forEach((t) => {\r\n                let tmx = treeMatrix[t];\r\n                if (!pid && t != selectedNode && tmx.nodeId == node.parentId) {\r\n                    pid = tmx.id;\r\n                }\r\n            });\r\n            console.log(\"PID\", pid);\r\n            page.components.dialog.confirm(\"Delete \" + node.type + \" \" + node.name + \"?\", async function () {\r\n                await page.deleteObject(node.type, node.id);\r\n                am7client.clearCache(node.type, true);\r\n                delete treeMatrix[selectedNode];\r\n                if (pid) {\r\n                    selectedNode = pid;\r\n                    resetNode(pid);\r\n                    am7client.clearCache(\"auth.group\", true);\r\n                    m.redraw();\r\n                }\r\n            });\r\n        }\r\n        function refreshTree() {\r\n            Object.keys(treeMatrix).forEach((i) => {\r\n                resetNode(i, true);\r\n            });\r\n            am7client.clearCache(\"auth.group\", true);\r\n            m.redraw();\r\n        }\r\n        function getTreeView() {\r\n            let tree = [];\r\n\r\n            let buttons = [];\r\n            buttons.push(page.iconButton(\"button\", \"add\", \"\", addNew));\r\n            buttons.push(page.iconButton(\"button\", \"refresh\", \"\", refreshTree));\r\n            buttons.push(page.iconButton(\"button\" + (selectedNode && selectedNode != origin.objectId ? \"\" : \" inactive\"), \"delete_outline\", \"\", deleteNode));\r\n            let buttonBar = m(\"div\", { class: \"result-nav-outer\" }, [\r\n                m(\"div\", { class: \"result-nav-inner\" }, [\r\n                    m(\"div\", { class: \"result-nav tab-container\" },\r\n                        buttons\r\n                    ),\r\n                    m(\"nav\", { class: \"result-nav\" }, [\r\n                        //page.pagination().pageButtons()\r\n                    ])\r\n                ])\r\n            ]);\r\n\r\n            if (origin) {\r\n                if (!selectedNode) selectedNode = origin.objectId;\r\n                tree.push(getTreeViewNode(origin));\r\n                if (olioMode) {\r\n                    if (!olio && !checkOlio) {\r\n                        checkOlio = true;\r\n                        page.findObject(\"auth.group\", \"DATA\", \"/Olio/Universes\").then((g) => {\r\n                            if (!g) {\r\n                                return;\r\n                            }\r\n                            let q = am7view.viewQuery(am7model.newInstance(\"auth.group\"));\r\n                            q.field(\"objectId\", g.objectId);\r\n                            page.search(q).then((g2) => {\r\n\r\n                                if (g2 && g2.results) {\r\n                                    olio = g2.results[0];\r\n                                    m.redraw();\r\n                                }\r\n                            })\r\n                        });\r\n                    }\r\n                    else if (olio) {\r\n                        tree.push(getTreeViewNode(olio));\r\n                    }\r\n                }\r\n                else {\r\n                    console.log(\"Not olio mode\");\r\n                }\r\n            }\r\n\r\n            return m(\"div\", { class: \"list-results-container\" }, [\r\n                m(\"div\", { class: \"list-results\" }, [\r\n                    buttonBar,\r\n                    m(\"div\", { class: \"results-overflow\" }, tree)\r\n                ])\r\n            ]);\r\n        }\r\n\r\n        function getMatrix(node) {\r\n            let bGroup = (node[am7model.jsonModelKey] === \"auth.group\");\r\n            let nodeName = node.name;\r\n            if (!treeMatrix[node.objectId]) {\r\n                let fList = \"list\";\r\n                let fListType = \"data.data\";\r\n                let ico = \"folder\";\r\n                let builtIn = false;\r\n\r\n                /// Auto-Type, Lock from dragging out\r\n                let pathType;\r\n                if (bGroup) {\r\n                    if (node.type && node.type.match(/^(account|person)$/gi)) {\r\n                        /// fListType = node.type;\r\n                        fListType = \"identity.\" + node.type;\r\n                        let modType = am7model.getModel(fListType.toLowerCase());\r\n                        ico = modType.icon;\r\n                    }\r\n                    else if (node.type && node.type.match(/^(bucket)$/gi)) {\r\n                        ico = \"collections_bookmark\";\r\n                        if (node.name.match(/^favorite/i)) {\r\n                            ico = \"favorite\";\r\n                        }\r\n                    }\r\n                    else {\r\n                        let path = node.path;\r\n                        let idx = node.path.indexOf(origin.path);\r\n                        if (idx == 0) {\r\n                            path = path.slice(idx + origin.path.length + 1);\r\n                        }\r\n\r\n                        // console.log(path, am7view.typeByPath(path));\r\n                        let pathType;\r\n                        if (path.indexOf(\"/\") > -1) {\r\n                            let np = node.path;\r\n                            np = np.replace(/\\/Gallery$/, \"/Gallery\");\r\n                            pathType = am7view.typeByPath(np) || \"data.data\";\r\n                        }\r\n                        else{\r\n                            pathType = am7view.typeByPath(path) || \"data.data\";\r\n                        }\r\n                        if (pathType) {\r\n                            fListType = pathType;\r\n                            let modType = am7model.getModel(pathType);\r\n                            if (modType) {\r\n                                if (modType.icon) {\r\n                                    ico = modType.icon;\r\n                                }\r\n                                if (modType.limit && modType.limit.length) {\r\n                                    fListType = modType.limit[0];\r\n                                }\r\n                                else if (modType.type) {\r\n                                    fListType = modType.type;\r\n                                }\r\n                            }\r\n                            //builtIn = true;\r\n                        }\r\n                        else\r\n                        if (node.path == page.user.homeDirectory.path) {\r\n                            ico = \"gite\";\r\n                        }\r\n                        \r\n                    }\r\n                }\r\n                else if (node[am7model.jsonModelKey].match(/^(auth\\.role|auth\\.permission)$/gi)) {\r\n                    let modType = am7model.getModel(node[am7model.jsonModelKey].toLowerCase());\r\n                    if (modType && modType.icon) {\r\n                        ico = modType.icon;\r\n                    }\r\n                    fListType = node[am7model.jsonModelKey];\r\n                    //fList = \"listInParent\";\r\n                    fList = \"list\";\r\n                    if (node.objectId == originPermission.objectId || node.objectId == originRole.objectId) {\r\n                        nodeName = (node[am7model.jsonModelKey] == \"auth.role\" ? \"Roles\" : \"Permissions\");\r\n                        builtIn = true;\r\n                    }\r\n\r\n                }\r\n                treeMatrix[node.objectId] = {\r\n                    id: node.objectId,\r\n                    name: nodeName,\r\n                    type: node[am7model.jsonModelKey],\r\n                    objectType: node.type,\r\n                    path: node.path,\r\n                    groupId: node.groupId,\r\n                    parentId: node.parentId,\r\n                    expanded: false,\r\n                    origin: (node.objectId === origin.objectId),\r\n                    baseIco: ico,\r\n                    builtIn,\r\n                    ico,\r\n                    listEntityType: fListType,\r\n                    listChildType: node[am7model.jsonModelKey],\r\n                    flist: fList,\r\n                    nodeId: node.id\r\n                };\r\n            }\r\n\r\n            let mtx = treeMatrix[node.objectId];\r\n\r\n            if (bGroup && !mtx.origin) {\r\n                mtx.ico = (mtx.expanded && mtx.children && mtx.children.length ? \"folder_open\" : mtx.baseIco);\r\n            }\r\n\r\n            return mtx;\r\n        }\r\n\r\n        function expandNode(node) {\r\n            let mtx = treeMatrix[node.objectId];\r\n            mtx.expanded = !mtx.expanded;\r\n            m.redraw();\r\n        }\r\n        function selectNode(node) {\r\n            if (autoExpand) {\r\n                expandNode(node);\r\n            }\r\n            selectedNode = node.objectId;\r\n            if (list) {\r\n                list.pagination().new();\r\n            }\r\n            m.route.set(\"/nav\");\r\n        }\r\n\r\n        function getNestedTreeView(node) {\r\n            return m(\"div\", { class: \"hier-item-nest\" }, getTreeViewNode(node));\r\n        }\r\n\r\n        function getTreeViewNode(node) {\r\n\r\n            if (!node) return \"\";\r\n\r\n            /// Depending on how it's queried, the model property will be pruned from complex objects since the schema definition includes the model type, so that the same\r\n            /// The downside is, if looking at a child node without the parent model reference, you don't know what the child type is supposed to be\r\n            ///\r\n            if (!node[am7model.jsonModelKey]) {\r\n                //console.warn(\"push model to group: \" + node.name);\r\n                node[am7model.jsonModelKey] = 'auth.group';\r\n            }\r\n            if (!node[am7model.jsonModelKey].match(/^(auth\\.role|auth\\.permission|auth\\.group)$/gi)) {\r\n                console.warn(\"Only roles, groups, and permissions are supported for hierarchical navigation\");\r\n                return \"\";\r\n            }\r\n            let bExpand = false;\r\n            let mtx = getMatrix(node);\r\n            if (mtx.origin || mtx.expanded) bExpand = true;\r\n\r\n            let label = mtx.name;\r\n            let nest = [];\r\n            if (bExpand) {\r\n                if (!mtx.children) {\r\n                    if (!pendingRefresh) {\r\n                        pendingRefresh = true;\r\n                        // console.log(mtx.flist, mtx.listChildType, mtx.id, mtx);\r\n                        am7client[mtx.flist](mtx.listChildType, mtx.id, null, 0, 1000, function (v) {\r\n                            if(!v || v == null){\r\n                                pendingRefresh = false;\r\n                                m.redraw();\r\n                                return;\r\n                            }\r\n                            am7model.updateListModel(v);\r\n                            mtx.children = v.filter((o) => { return !o.name.match(/^\\./); });\r\n                            if (node.objectId == origin.objectId) {\r\n                                page.parentType(\"auth.role\").then((rb) => {\r\n                                    page.parentType(\"auth.permission\").then((pb) => {\r\n                                        mtx.children.push(rb);\r\n                                        mtx.children.push(pb);\r\n                                        originRole = rb;\r\n                                        originPermission = pb;\r\n\r\n                                        mtx.children = mtx.children.sort(function (aa, bb) {\r\n                                            let n1 = aa.name;\r\n                                            if (aa.objectId == rb.objectId) n1 = \"Roles\";\r\n                                            else if (aa.objectId == pb.objectId) n1 = \"Permissions\";\r\n                                            let n2 = bb.name;\r\n                                            if (bb.objectId == rb.objectId) n2 = \"Roles\";\r\n                                            else if (bb.objectId == pb.objectId) n2 = \"Permissions\";\r\n                                            return (\r\n                                                n1 < n2\r\n                                                    ? -1\r\n                                                    : 1\r\n                                            );\r\n                                        });\r\n                                        pendingRefresh = false;\r\n                                        m.redraw();\r\n                                    });\r\n                                });\r\n                            }\r\n                            else {\r\n                                pendingRefresh = false;\r\n                                m.redraw();\r\n                            }\r\n\r\n\r\n                        });\r\n                    }\r\n                }\r\n                else {\r\n                    mtx.children.forEach((c) => {\r\n                        nest.push(getNestedTreeView(c));\r\n                    });\r\n                }\r\n            }\r\n            let altCls = \"\";\r\n            let altActive = \"\";\r\n            if ((node.objectType && node.objectType.match(/^(bucket|account|person)$/gi)) || (originPermission && node.objectId == originPermission.objectId) || (originRole && node.objectId == originRole.objectId)) {\r\n                altCls = \" material-symbols-outlined-orange\";\r\n                altActive = \"-orange\";\r\n\r\n            }\r\n            let icoCls = \"flare hier-item-element material-icons-24 material-symbols-outlined\" + altCls;\r\n            let selId;\r\n            if (node.objectId == selectedNode) {\r\n                icoCls += \" filled active\" + altActive;\r\n                selId = \"selectedNode\";\r\n            }\r\n\r\n            let fHandler = function () {\r\n                selectNode(node);\r\n            }\r\n            let attr = \"\";\r\n            if (!mtx.builtIn) {\r\n                attr = \"[draggable]\";\r\n            }\r\n            let itemProps = {\r\n                class: \"hier-item\",\r\n                ondblclick: function () { expandNode(node); },\r\n                onclick: fHandler,\r\n\r\n            };\r\n\r\n            let dcls = dnd.doDragDecorate(node);\r\n            if (dcls) itemProps.class += \" \" + dcls;\r\n\r\n            itemProps.ondragover = function (e) { dnd.doDragOver(e, node); };\r\n            itemProps.ondragend = function (e) { dnd.doDragEnd(e, node); };\r\n            itemProps.ondragstart = function (e) { dnd.doDragStart(e, node); };\r\n            itemProps.ondrop = function (e) { dnd.doDrop(e, node); };\r\n\r\n            return m(\"div\", { id: selId, class: \"hier-item-container\" }, [\r\n                m(\"div\" + attr, itemProps, [\r\n                    m(\"span\", { class: icoCls }, mtx.ico),\r\n                    m(\"span\", { class: \"hier-item-element\" }, label)\r\n                ]),\r\n                nest\r\n            ])\r\n        }\r\n\r\n        function resetNode(objectId, skipList) {\r\n            if (treeMatrix[objectId]) {\r\n                let mtx = treeMatrix[objectId];\r\n                delete mtx.children;\r\n                /*\r\n                if(mtx.parentId){\r\n                    let pid;\r\n                    Object.keys(treeMatrix).forEach((t)=>{\r\n                        if(!pid && t.objectId != objectId && t.nodeId == mtx.parentId){\r\n                            pid = t.id;\r\n                        }\r\n                    });\r\n                    if(pid) resetNode(pid, skipList);\r\n                }\r\n                */\r\n                if (!skipList) list.pagination().new();\r\n            }\r\n        }\r\n\r\n        let tree = {\r\n            resetNode,\r\n            selectedNode: function () {\r\n                if (!selectedNode) return;\r\n                return treeMatrix[selectedNode];\r\n            },\r\n            oninit: function (vnode) {\r\n                dnd = page.components.dnd;\r\n                list = vnode.attrs.list;\r\n                origin = vnode.attrs.origin || page.user.homeDirectory;\r\n            },\r\n            oncreate: function (x) {\r\n\r\n            },\r\n            onremove: function (x) {\r\n\r\n            },\r\n            onupdate: function(x){\r\n                scrollToLast();\r\n            },\r\n\r\n            view: function () {\r\n                return getTreeView()\r\n            }\r\n        };\r\n        return tree;\r\n    }\r\n    page.components.tree = newTreeComponent;\r\n}());\r\n\n\n;/* === client/components/picker.js === */\n(function () {\r\n\r\n    let pickerMode = {\r\n        enabled: false,\r\n        containerId: undefined,\r\n        pickPath: undefined\r\n    };\r\n    let childPickerMode;\r\n    let requesting = false;\r\n\r\n    function fieldPicker(inst, field, useName, altEntity, altPath, pickerHandler){\r\n        let entity = inst?.entity;\r\n        let useEntity = altEntity || entity;\r\n        if(!useEntity || !field.pickerProperty){\r\n            console.log(\"Invalid entity or field property\",useEntity,field);\r\n            return;\r\n        }\r\n        let mat;\r\n        let type = (entity[am7model.jsonModelKey] ? entity[am7model.jsonModelKey] : undefined);\r\n        let setType = false;\r\n        /// Special handling for embedding pickers in disconnected tables\r\n        ///\r\n        if(\r\n            field.pickerProperty.foreign\r\n            &&\r\n            useName\r\n            &&\r\n            (mat = useName.match(/(\\-\\d+)$/)) != null\r\n            &&\r\n            field.pickerType\r\n            &&\r\n            field.pickerType.match(/^\\./)\r\n        ){\r\n            console.log(field.pickerType.slice(1) + mat[1]);\r\n            let el = document.querySelector(\"[name='\" + field.pickerType.slice(1) + mat[1] + \"']\");\r\n            type = el.value.toLowerCase();\r\n            setType = true;\r\n        }\r\n        else{\r\n            if(field.pickerType && field.pickerType !== 'self') type = field.pickerType;\r\n            if(type.match(/^\\./)){\r\n                type = useEntity[type.slice(1)].toLowerCase();\r\n            }\r\n        }\r\n        if(!type.match(/^unknown$/gi)){\r\n            preparePicker(inst, type, function(data){\r\n                if(data && data.length){\r\n                    if(useEntity == inst.entity){\r\n                        \r\n                        if(field.pickerProperty.selected === '{object}'){\r\n                            // inst.api[field.pickerProperty.entity](data[0]);\r\n\r\n                            if(field.pickerProperty.entity.match(/\\./)){\r\n                                let pv = field.pickerProperty.entity.split(\".\");\r\n                                if(pinst[pv[0]]){\r\n                                    inst[pv[0]].api(data[0]);\r\n                                    pinst[pv[0]].api[pv[1]](data[0]);\r\n                                }\r\n                                else{\r\n                                    console.warn(\"didn't find \" + pv[0]);\r\n                                }\r\n                                //inst.dapi(field.pickerProperty.entity, data[0]);\r\n                                \r\n                            }\r\n                            else{\r\n                                console.log(\"Update pick\");\r\n                                inst.api[field.pickerProperty.entity](data[0]);\r\n                            }\r\n                        }\r\n                        else{\r\n                            console.log(\"Update\", field.pickerProperty.entity);\r\n                            //inst.api[field.pickerProperty.entity](data[0][field.pickerProperty.selected]);\r\n                            inst.api[field.pickerProperty.entity](data[0][field.pickerProperty.selected]);\r\n                        }\r\n                        cancelPicker(true);\r\n                        if(setType){\r\n                            inst.api[field.pickerType.slice(1)](type);\r\n                        }\r\n\r\n                    }\r\n                    else{\r\n                        if(field.pickerProperty.selected === '{object}') useEntity[field.pickerProperty.entity] = data[0];\r\n                        else useEntity[field.pickerProperty.entity] = data[0][field.pickerProperty.selected];\r\n                        cancelPicker(true);\r\n                        if(setType){\r\n                            useEntity[field.pickerType.slice(1)] = type;\r\n                        }\r\n                    }\r\n\r\n                    updateChange();\r\n                    if(pickerHandler){\r\n                        pickerHandler(objectPage, inst, field, useName, data[0]);\r\n                    }\r\n                    /// Clear the server cache because the parent may have a cached copy of the child\r\n                    ///\r\n                    if(!useEntity[am7model.jsonModelKey] || useEntity[am7model.jsonModelKey].match(/message/i)) m.redraw();\r\n                    else{\r\n                        am7client.clearCache(useEntity[am7model.jsonModelKey], false, function(){\r\n                            m.redraw();\r\n                        });\r\n                    }\r\n                }\r\n            }, altPath || field.pickerProperty.path);\r\n        }\r\n    }\r\n\r\n    function preparePicker(inst, type, handler, altPath){\r\n        requesting = true;\r\n        return new Promise((res, rej)=>{\r\n\r\n            let model = am7model.getModel(type);\r\n            if(!model){\r\n                console.error(\"Invalid model for '\" + type + \"'\");\r\n                rej();\r\n            }\r\n            // pickerMode.tabIndex = tabIndex;\r\n            pickerMode.type = type;\r\n            pickerMode.handler = handler;\r\n            if(am7model.isGroup(model) || am7model.isParent(model)) pickerMode.pickPath = altPath || am7view.path(type);\r\n            if(am7model.isGroup(model)){\r\n                console.warn(\"PICK PATH\", pickerMode.pickPath);\r\n                am7client.make(\"auth.group\",\"data\", pickerMode.pickPath, function(v){\r\n                    pickerMode.containerId = v.objectId;\r\n                    requesting = false;\r\n                    enablePicker();\r\n                    res();\r\n                });\r\n            }\r\n            else if(type.match(/^(auth\\.role|auth\\.permission)$/)){\r\n                am7client.user(type, \"user\", function(v){\r\n                    uwm.getDefaultParentForType(type, v).then((parObj) =>{\r\n                        pickerMode.containerId = parObj.objectId;\r\n                        requesting = false;\r\n                        enablePicker();\r\n                        res();\r\n                    });\r\n                });\r\n\r\n            }\r\n            else if(type.match(/^user$/)){\r\n                enablePicker();\r\n                res();\r\n            }\r\n            else{\r\n                console.warn(\"Handle pick \" + type);\r\n            }\r\n        });\r\n    }\r\n    function enablePicker(bNoRefresh, objectPage, caller){\r\n        pickerMode.enabled = true;\r\n        if(caller){\r\n            childPickerMode = objectPage;\r\n        }\r\n        if(!bNoRefresh){\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n    function cancelPicker(bNoRefresh){\r\n        if(childPickerMode){\r\n            childPickerMode.cancelPicker(bNoRefresh);\r\n            childPickerMode = undefined;\r\n        }\r\n        pickerMode.enabled = false;\r\n        if(!bNoRefresh){\r\n            m.redraw();\r\n        }\r\n    }\r\n\r\n    const picker = {\r\n        cancelPicker,\r\n        enablePicker,\r\n        validateFormat: function(inst, field, format, useName){\r\n            if(format === \"picker\" && field.pickerProperty && field.pickerProperty.requiredAttributes){\r\n                let req = field.pickerProperty;\r\n                if(!am7view.showField(inst, req, useName)){\r\n                    format = \"text\";\r\n                }\r\n            }\r\n            return format;\r\n        },\r\n        inPickMode : function(){\r\n            return (pickerMode.enabled || childPickerMode);\r\n        },\r\n        fieldPicker\r\n\r\n    };\r\n  \r\n\r\n    page.components.picker = picker;\r\n}());\r\n\n\n;/* === client/components/formFieldRenderers.js === */\n(function() {\r\n    /// Form Field Renderers for Object Edit Views\r\n    /// These handle input fields in the object editor (view/object.js)\r\n    ///\r\n    /// Each renderer receives a context object with:\r\n    ///   - inst: the prepared instance with API methods\r\n    ///   - entity: the current entity being edited\r\n    ///   - field: the model field definition\r\n    ///   - fieldView: the form field configuration\r\n    ///   - name: the field name\r\n    ///   - useName: the actual input name (may differ for arrays)\r\n    ///   - defVal: the default/current value\r\n    ///   - fieldClass: CSS classes to apply\r\n    ///   - disabled: whether the field is disabled\r\n    ///   - fHandler: the change handler function\r\n    ///   - show: whether the field should be visible\r\n\r\n    let renderers = {};\r\n\r\n    /// ========================================\r\n    /// SIMPLE RENDERERS - No dependencies\r\n    /// ========================================\r\n\r\n    /// Blank placeholder field\r\n    renderers.blank = function(ctx) {\r\n        return [m(\"span\", {class: \"blank\"})];\r\n    };\r\n\r\n    /// Read-only print display\r\n    renderers.print = function(ctx) {\r\n        let val = ctx.defVal;\r\n        if (!val && ctx.entity) val = ctx.entity[ctx.useName];\r\n        return [m(\"span\", {class: ctx.fieldClass + \" inline-block text-field-full text-content\"}, val)];\r\n    };\r\n\r\n    /// Read-only print with alert styling\r\n    renderers[\"print-alert\"] = function(ctx) {\r\n        let val = ctx.defVal;\r\n        if (!val && ctx.entity) val = ctx.entity[ctx.useName];\r\n        return [m(\"span\", {class: \"text-content-alert\"}, val)];\r\n    };\r\n\r\n    /// Checkbox field\r\n    renderers.checkbox = function(ctx) {\r\n        let inputAttrs = {\r\n            type: \"checkbox\",\r\n            class: ctx.fieldClass + \" check-field\",\r\n            name: ctx.useName,\r\n            checked: ctx.defVal,\r\n            oninput: ctx.fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n        return [m(\"input\", inputAttrs)];\r\n    };\r\n\r\n    /// Color picker field\r\n    renderers.color = function(ctx) {\r\n        let inputAttrs = {\r\n            type: \"color\",\r\n            class: ctx.fieldClass + \" color-field\",\r\n            name: ctx.useName,\r\n            value: ctx.defVal,\r\n            oninput: ctx.fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n        return [m(\"input\", inputAttrs)];\r\n    };\r\n\r\n    /// ========================================\r\n    /// SELECT AND DROPDOWN RENDERERS\r\n    /// ========================================\r\n\r\n    /// Select dropdown field\r\n    /// Uses am7view.defaultValuesForField to get enum/list values\r\n    renderers.select = function(ctx) {\r\n        let vals = am7view.defaultValuesForField(ctx.field);\r\n        let selectAttrs = {\r\n            class: ctx.fieldClass + \" select-field-full\",\r\n            name: ctx.useName,\r\n            oninput: ctx.fHandler\r\n        };\r\n\r\n        let options = vals.map(function(v) {\r\n            let selected = false;\r\n            if (ctx.defVal && (ctx.defVal === v || (typeof ctx.defVal == \"string\" && ctx.defVal.toLowerCase() === v.toLowerCase()))) {\r\n                selected = true;\r\n            }\r\n            let optAttrs = {value: v.toLowerCase()};\r\n            if (selected) optAttrs.selected = \"true\";\r\n            return m(\"option\", optAttrs, v);\r\n        });\r\n\r\n        return [m(\"select\", selectAttrs, options)];\r\n    };\r\n\r\n    /// ========================================\r\n    /// RANGE SLIDER RENDERER\r\n    /// ========================================\r\n\r\n    /// Range slider field with min/max display\r\n    renderers.range = function(ctx) {\r\n        let min = 0;\r\n        let max = 100;\r\n\r\n        if (typeof ctx.field.minValue == \"number\" && typeof ctx.field.maxValue == \"number\") {\r\n            if (ctx.field.type == \"double\" && ctx.field.maxValue >= 1) {\r\n                max = ctx.field.maxValue * 100;\r\n                if (min != 0) {\r\n                    min = ctx.field.minValue * 100;\r\n                }\r\n            } else {\r\n                min = ctx.field.minValue;\r\n                max = ctx.field.maxValue;\r\n            }\r\n        }\r\n\r\n        let inputAttrs = {\r\n            type: \"range\",\r\n            class: ctx.fieldClass + \" range-field-full\",\r\n            name: ctx.useName,\r\n            value: ctx.defVal,\r\n            min: min,\r\n            max: max,\r\n            oninput: ctx.fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n\r\n        return [m(\"div\", {class: \"relative mb-5\"}, [\r\n            m(\"label\", {class: \"sr-only\"}, \"Range\"),\r\n            m(\"input\", inputAttrs),\r\n            m(\"span\", {class: \"text-sm text-gray-500 absolute start-0 -bottom-6\"}, min),\r\n            m(\"span\", {class: \"text-sm text-gray-500 absolute start-1/2 -translate-x-1/2 -bottom-6\"}, ctx.defVal),\r\n            m(\"span\", {class: \"text-sm text-gray-500 absolute end-0 -bottom-6\"}, max)\r\n        ])];\r\n    };\r\n\r\n    /// ========================================\r\n    /// PROGRESS BAR RENDERER\r\n    /// ========================================\r\n\r\n    /// Progress bar field\r\n    renderers.progress = function(ctx) {\r\n        let progressAttrs = {\r\n            class: ctx.fieldClass + \" progress-field-full\",\r\n            name: ctx.useName,\r\n            value: ctx.defVal,\r\n            max: ctx.field.maxValue || 100,\r\n            min: ctx.field.minValue || 0\r\n        };\r\n        if (ctx.disabled) {\r\n            progressAttrs.disabled = true;\r\n        }\r\n        return [m(\"progress\", progressAttrs)];\r\n    };\r\n\r\n    /// ========================================\r\n    /// BUTTON RENDERER\r\n    /// ========================================\r\n\r\n    /// Button field with optional icon\r\n    renderers.button = function(ctx) {\r\n        let buttonHandler = function() {\r\n            if (ctx.field.command) {\r\n                ctx.field.command(ctx.objectPage, ctx.inst, ctx.name);\r\n            }\r\n        };\r\n\r\n        let buttonContent = [];\r\n        if (ctx.fieldView.icon) {\r\n            buttonContent.push(m(\"span\", {class: \"material-symbols-outlined material-icons-24\"}, ctx.fieldView.icon));\r\n        }\r\n        if (ctx.field.label) {\r\n            buttonContent.push(ctx.field.label);\r\n        }\r\n\r\n        let buttonAttrs = {\r\n            class: ctx.fieldClass + \" button-field-full\",\r\n            onclick: buttonHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            buttonAttrs.disabled = true;\r\n        }\r\n\r\n        return [m(\"button\", buttonAttrs, buttonContent)];\r\n    };\r\n\r\n    /// ========================================\r\n    /// TEXT INPUT RENDERERS\r\n    /// ========================================\r\n\r\n    /// Helper to create audio recording button for text fields\r\n    function createAudioRecordButton(ctx) {\r\n        if (typeof page === \"undefined\" || !page.components || !page.components.audio) {\r\n            return \"\";\r\n        }\r\n        return page.components.audio.recordField(function(text) {\r\n            if (text !== null) {\r\n                ctx.inst.api[ctx.name](text);\r\n            } else {\r\n                return ctx.inst.api[ctx.name]() || \"\";\r\n            }\r\n        });\r\n    }\r\n\r\n    /// Helper to apply drag-and-drop props to a field\r\n    function applyDragAndDrop(ctx, props) {\r\n        if (ctx.entity && !ctx.entity.objectId && ctx.fieldView.dragAndDrop) {\r\n            props.class += \" border-dotted\";\r\n            if (typeof page !== \"undefined\" && page.components && page.components.dnd) {\r\n                let dnd = page.components.dnd.dropProps(ctx.inst);\r\n                Object.assign(props, dnd);\r\n            }\r\n            props.placeholder = \"{ Type Text or Drop File Here }\";\r\n        }\r\n        return props;\r\n    }\r\n\r\n    /// Text input field with audio recording support\r\n    renderers.text = function(ctx) {\r\n        let inputAttrs = {\r\n            type: \"text\",\r\n            class: ctx.fieldClass + \" text-field-full pr-8\",\r\n            name: ctx.useName,\r\n            value: ctx.defVal,\r\n            oninput: ctx.fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n\r\n        inputAttrs = applyDragAndDrop(ctx, inputAttrs);\r\n\r\n        return [m(\"div\", {class: \"relative w-full\"},\r\n            m(\"input\", inputAttrs),\r\n            m(\"div\", {class: \"absolute inset-y-0 right-0 flex items-center\"},\r\n                createAudioRecordButton(ctx)\r\n            )\r\n        )];\r\n    };\r\n\r\n    /// Datetime-local field (shares most logic with text)\r\n    renderers[\"datetime-local\"] = function(ctx) {\r\n        let inputAttrs = {\r\n            type: \"datetime-local\",\r\n            class: ctx.fieldClass + \" text-field-full pr-8\",\r\n            name: ctx.useName,\r\n            value: ctx.defVal,\r\n            oninput: ctx.fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n\r\n        return [m(\"div\", {class: \"relative w-full\"},\r\n            m(\"input\", inputAttrs),\r\n            m(\"div\", {class: \"absolute inset-y-0 right-0 flex items-center\"},\r\n                createAudioRecordButton(ctx)\r\n            )\r\n        )];\r\n    };\r\n\r\n    /// Textarea field with audio recording support\r\n    renderers.textarea = function(ctx) {\r\n        let textareaAttrs = {\r\n            class: ctx.fieldClass + \" textarea-field-full w-full pr-8\",\r\n            name: ctx.useName,\r\n            onchange: ctx.fHandler\r\n        };\r\n\r\n        textareaAttrs = applyDragAndDrop(ctx, textareaAttrs);\r\n\r\n        return [m(\"div\", {class: \"relative w-full\"},\r\n            m(\"textarea\", textareaAttrs, ctx.defVal),\r\n            m(\"div\", {class: \"absolute top-2 right-0 flex items-start\"},\r\n                createAudioRecordButton(ctx)\r\n            )\r\n        )];\r\n    };\r\n\r\n    /// Textlist is an alias for textarea\r\n    renderers.textlist = renderers.textarea;\r\n\r\n    /// ========================================\r\n    /// MEDIA RENDERERS (image, audio, pdf)\r\n    /// ========================================\r\n\r\n    /// Helper to build media path\r\n    function buildMediaPath(entity) {\r\n        return g_application_path + \"/media/\" +\r\n               am7client.dotPath(am7client.currentOrganization) +\r\n               \"/data.data\" + entity.groupPath + \"/\" + entity.name;\r\n    }\r\n\r\n    /// Helper to build thumbnail path\r\n    function buildThumbnailPath(entity, size) {\r\n        size = size || \"96x96\";\r\n        return g_application_path + \"/thumbnail/\" +\r\n               am7client.dotPath(am7client.currentOrganization) +\r\n               \"/data.data\" + entity.groupPath + \"/\" + entity.name + \"/\" + size;\r\n    }\r\n\r\n    /// Image field renderer\r\n    /// Handles multiple entity types: imageView, data.data, profile portraits\r\n    renderers.image = function(ctx) {\r\n        let useEntity = ctx.useEntity || ctx.entity;\r\n        let fieldClass = ctx.fieldClass + \" image-field\";\r\n        let dataUrl;\r\n        let clickHandler;\r\n\r\n        if (!useEntity) {\r\n            return [m(\"span\", \"No image data\")];\r\n        }\r\n\r\n        let modelKey = useEntity[am7model.jsonModelKey];\r\n\r\n        /// imageView type - show thumbnail\r\n        if (modelKey && modelKey.match(/^imageView$/gi)) {\r\n            let ui = useEntity.image;\r\n            if (ui) {\r\n                fieldClass = \"carousel-item-img\";\r\n                dataUrl = buildThumbnailPath(ui, \"512x512\");\r\n            }\r\n        }\r\n        /// data.data type - show base64 or stream\r\n        else if (modelKey && modelKey.match(/^data\\.data$/gi)) {\r\n            if (useEntity.stream) {\r\n                if (ctx.streamSeg) {\r\n                    dataUrl = \"data:\" + useEntity.contentType + \";base64,\" + ctx.streamSeg.stream;\r\n                } else if (ctx.loadStream) {\r\n                    /// Caller must provide loadStream callback to fetch stream data\r\n                    ctx.loadStream(useEntity.stream);\r\n                    return [m(\"span\", \"Loading...\")];\r\n                }\r\n            } else {\r\n                dataUrl = \"data:\" + useEntity.contentType + \";base64,\" + useEntity.dataBytesStore;\r\n            }\r\n        }\r\n        /// Profile portrait\r\n        else if (useEntity.profile && useEntity.profile.portrait && useEntity.profile.portrait.contentType) {\r\n            let pp = useEntity.profile.portrait;\r\n            let charInst = ctx.inst;\r\n            clickHandler = function() {\r\n                if (typeof page !== \"undefined\") {\r\n                    // Open gallery with character instance to allow profile selection\r\n                    page.imageGallery([], charInst);\r\n                }\r\n            };\r\n            dataUrl = buildThumbnailPath(pp, \"96x96\");\r\n        }\r\n        /// Direct portrait\r\n        else if (useEntity.portrait && useEntity.portrait.contentType) {\r\n            let pp = useEntity.portrait;\r\n            clickHandler = function() {\r\n                if (typeof page !== \"undefined\") page.imageView(pp);\r\n            };\r\n            dataUrl = buildThumbnailPath(pp, \"96x96\");\r\n        }\r\n\r\n        if (!dataUrl) {\r\n            return [m(\"span\", \"No image source\")];\r\n        }\r\n\r\n        return [m(\"img\", {\r\n            class: fieldClass,\r\n            name: ctx.useName,\r\n            onclick: clickHandler,\r\n            src: dataUrl\r\n        })];\r\n    };\r\n\r\n    /// Gallery field renderer for multiple images with navigation\r\n    renderers.gallery = function(ctx) {\r\n        let useEntity = ctx.useEntity || ctx.entity;\r\n        let fieldClass = ctx.fieldClass + \" gallery-field\";\r\n\r\n        // Images can come from ctx.defVal (field value) or useEntity.images\r\n        let images = ctx.defVal || (useEntity && useEntity.images);\r\n        if (!images || !images.length) {\r\n            return [m(\"span\", \"No images\")];\r\n        }\r\n\r\n        // Get character instance if available (for set-as-profile)\r\n        let charInst = useEntity && useEntity.characterInstance;\r\n\r\n        // Store currentIndex on the entity for state persistence\r\n        if(useEntity && typeof useEntity.currentIndex === 'undefined'){\r\n            useEntity.currentIndex = 0;\r\n        }\r\n        let currentIndex = useEntity ? (useEntity.currentIndex || 0) : 0;\r\n\r\n        // Social sharing tags list\r\n        let sharingTags = (typeof window !== \"undefined\" && window.am7sharingTags)\r\n            ? window.am7sharingTags.tags\r\n            : [\"inappropriate\", \"intimate\", \"sexy\", \"private\", \"casual\", \"public\", \"professional\"];\r\n\r\n        function navigate(delta) {\r\n            if(useEntity){\r\n                useEntity.currentIndex = (currentIndex + delta + images.length) % images.length;\r\n            }\r\n            m.redraw();\r\n        }\r\n\r\n        async function deleteImage() {\r\n            if(typeof page === \"undefined\") return;\r\n            let img = images[currentIndex];\r\n            if(!img || !img.objectId) return;\r\n\r\n            if(!confirm(\"Delete this image?\")) return;\r\n\r\n            await page.deleteObject(\"data.data\", img.objectId);\r\n            images.splice(currentIndex, 1);\r\n            if(currentIndex >= images.length && images.length > 0){\r\n                if(useEntity){\r\n                    useEntity.currentIndex = images.length - 1;\r\n                }\r\n                currentIndex = images.length - 1;\r\n            }\r\n            page.toast(\"success\", \"Image deleted\");\r\n            m.redraw();\r\n        }\r\n\r\n        async function setAsProfile() {\r\n            if(typeof page === \"undefined\" || !charInst) return;\r\n            let img = images[currentIndex];\r\n            if(!img || !img.id) return;\r\n\r\n            // Update the character's profile portrait\r\n            charInst.entity.profile.portrait = img;\r\n            let od = {id: charInst.entity.profile.id, portrait: {id: img.id}};\r\n            od[am7model.jsonModelKey] = \"identity.profile\";\r\n            await page.patchObject(od);\r\n\r\n            page.toast(\"success\", \"Profile image updated\");\r\n            m.redraw();\r\n        }\r\n\r\n        async function toggleTag(tagName) {\r\n            if(typeof page === \"undefined\" || typeof window === \"undefined\" || !window.am7sharingTags) return;\r\n            let img = images[currentIndex];\r\n            if(!img || !img.objectId) return;\r\n\r\n            // Check if tag is currently applied\r\n            let imgTags = img.tags || [];\r\n            let hasTag = imgTags.some(t => t.name === tagName);\r\n\r\n            // Toggle the tag\r\n            let success = await window.am7sharingTags.toggle(img, tagName, !hasTag);\r\n            if(success){\r\n                // Update local tags array\r\n                if(hasTag){\r\n                    img.tags = imgTags.filter(t => t.name !== tagName);\r\n                } else {\r\n                    let tag = await window.am7sharingTags.getOrCreate(tagName, \"data.data\");\r\n                    if(tag){\r\n                        if(!img.tags) img.tags = [];\r\n                        img.tags.push(tag);\r\n                    }\r\n                }\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        async function applyImageTags() {\r\n            if(typeof page === \"undefined\") return;\r\n            let img = images[currentIndex];\r\n            if(!img || !img.objectId) return;\r\n\r\n            page.toast(\"info\", \"Applying image tags...\");\r\n            try {\r\n                let tags = await page.applyImageTags(img.objectId);\r\n                if(tags && Array.isArray(tags) && tags.length){\r\n                    page.toast(\"success\", \"Applied \" + tags.length + \" tags\");\r\n                }\r\n                else if(tags){\r\n                    page.toast(\"success\", \"Tags applied\");\r\n                }\r\n                else {\r\n                    page.toast(\"warn\", \"No tags were applied\");\r\n                }\r\n            }\r\n            catch(e){\r\n                console.error(e);\r\n                page.toast(\"error\", \"Failed to apply tags\");\r\n            }\r\n        }\r\n\r\n        function openImageInNewTab() {\r\n            let img = images[currentIndex];\r\n            if(!img || !img.objectId) return;\r\n            let uri = \"#/view/data.data/\" + img.objectId;\r\n            window.open(uri, \"_blank\");\r\n        }\r\n\r\n        let currentImage = images[currentIndex];\r\n        let dataUrl = buildThumbnailPath(currentImage, \"512x512\");\r\n\r\n        // Get current image's tags (filter to only sharing tags)\r\n        let currentTags = (currentImage.tags || [])\r\n            .filter(t => sharingTags.includes(t.name))\r\n            .map(t => t.name);\r\n\r\n        // Build navigation buttons\r\n        let navButtons = [\r\n            page.iconButton(\"button\", \"arrow_back\", \"\", function() { navigate(-1); }, images.length <= 1),\r\n            m(\"span\", { class: \"button\" }, (currentIndex + 1) + \" / \" + images.length),\r\n            page.iconButton(\"button mr-4\", \"arrow_forward\", \"\", function() { navigate(1); }, images.length <= 1),\r\n            page.iconButton(\"button\", \"delete\", \"\", deleteImage),\r\n            page.iconButton(\"button\", \"sell\", \"\", applyImageTags),\r\n            page.iconButton(\"button\", \"open_in_new\", \"\", openImageInNewTab)\r\n        ];\r\n\r\n        // Only show set-as-profile button if we have a character instance\r\n        if(charInst){\r\n            navButtons.push(page.iconButton(\"button\", \"account_circle\", \"\", setAsProfile));\r\n        }\r\n\r\n        // Build sharing tags vertical list\r\n        let tagsList = sharingTags.map(function(tagName){\r\n            let isActive = currentTags.includes(tagName);\r\n            return m(\"button\", {\r\n                class: \"gallery-tag-btn\" + (isActive ? \" active\" : \"\"),\r\n                onclick: function(){ toggleTag(tagName); }\r\n            }, tagName);\r\n        });\r\n\r\n        return [\r\n            m(\"div\", { class: \"gallery-container gallery-with-tags\" }, [\r\n                m(\"div\", { class: \"result-nav-outer\" }, [\r\n                    m(\"div\", { class: \"result-nav-inner\" }, [\r\n                        m(\"div\", { class: \"result-nav tab-container\" }, navButtons)\r\n                    ])\r\n                ]),\r\n                m(\"div\", { class: \"gallery-content\" }, [\r\n                    m(\"img\", {\r\n                        class: \"carousel-item-img\",\r\n                        src: dataUrl,\r\n                        onclick: function() {\r\n                            if (typeof page !== \"undefined\") page.imageView(currentImage);\r\n                        }\r\n                    }),\r\n                    m(\"div\", { class: \"gallery-tags-panel\" }, tagsList)\r\n                ])\r\n            ])\r\n        ];\r\n    };\r\n\r\n    /// Audio player field renderer\r\n    renderers.audio = function(ctx) {\r\n        let val = ctx.defVal;\r\n        if (!val || typeof val !== 'object') {\r\n            return [m(\"span\", \"No audio data\")];\r\n        }\r\n\r\n        let apath = g_application_path + \"/media/\" +\r\n                    am7client.dotPath(am7client.currentOrganization) +\r\n                    \"/data.data\" + val.groupPath + \"/\" + val.name;\r\n        let amt = val.contentType;\r\n        if (amt.match(/mpeg3$/)) amt = \"audio/mpeg\";\r\n\r\n        return [m(\"audio\", {\r\n            class: \"\",\r\n            id: ctx.useName,\r\n            preload: \"auto\",\r\n            controls: \"controls\",\r\n            autoplay: \"autoplay\"\r\n        }, m(\"source\", {src: apath, type: amt}))];\r\n    };\r\n\r\n    /// PDF viewer field renderer\r\n    renderers.pdf = function(ctx) {\r\n        if (ctx.pdfViewer) {\r\n            return [ctx.pdfViewer.container()];\r\n        }\r\n        return [m(\"span\", \"Missing PDF viewer\")];\r\n    };\r\n\r\n    /// ========================================\r\n    /// OBJECT-LINK RENDERER\r\n    /// ========================================\r\n\r\n    /// Object link field - shows link to REST endpoint and JSON viewer\r\n    renderers[\"object-link\"] = function(ctx) {\r\n        let useEntity = ctx.useEntity || ctx.entity;\r\n        let uri = \"about:blank\";\r\n        let label = \"\";\r\n\r\n        if (useEntity && useEntity.objectId) {\r\n            let modelKey = useEntity[am7model.jsonModelKey];\r\n            if (modelKey && modelKey.match(/^data\\.data$/gi)) {\r\n                uri = g_application_path + \"/media/\" +\r\n                      am7client.dotPath(am7client.currentOrganization) + \"/\" +\r\n                      modelKey + useEntity.groupPath + \"/\" + useEntity.name;\r\n            } else {\r\n                uri = g_application_path + \"/rest/model/\" + modelKey + \"/\" + useEntity.objectId;\r\n            }\r\n            label = useEntity.name;\r\n        }\r\n\r\n        let printHandler = function() {\r\n            if (ctx.printJSONToWindow) {\r\n                ctx.printJSONToWindow();\r\n            }\r\n        };\r\n\r\n        return [\r\n            m(\"a\", {target: \"new\", href: uri, class: \"text-blue-600\"}, [\r\n                m(\"span\", {class: \"material-icons-outlined mr-2\"}, \"link\"),\r\n                label\r\n            ]),\r\n            m(\"span\", {onclick: printHandler, class: \"cursor-pointer material-symbols-outlined ml-2\"}, \"file_json\")\r\n        ];\r\n    };\r\n\r\n    /// ========================================\r\n    /// PICKER RENDERER\r\n    /// ========================================\r\n\r\n    /// Picker field - text input with context menu for object selection\r\n    /// Context must provide:\r\n    ///   - doFieldPicker(field, useName, useEntity): function to open picker\r\n    ///   - doFieldOpen(field): function to navigate to selected object\r\n    ///   - doFieldClear(field): function to clear selection\r\n    ///   - updateChange(evt, field): function to handle manual changes\r\n    renderers.picker = function(ctx) {\r\n        let useEntity = ctx.useEntity || ctx.entity;\r\n        let field = ctx.field;\r\n        let fieldClass = ctx.fieldClass + \" text-field-full\";\r\n        let defVal = ctx.defVal;\r\n        let fHandler = ctx.fHandler;\r\n\r\n        /// Check if this should be a picker or just text input\r\n        let valPick = false;\r\n        if (typeof page !== \"undefined\" && page.components && page.components.picker) {\r\n            valPick = (page.components.picker.validateFormat(ctx.inst, field, \"picker\", ctx.useName) === \"picker\");\r\n        }\r\n\r\n        /// Resolve picker value to display name\r\n        if (valPick && useEntity && field.pickerProperty) {\r\n            let findVal = useEntity[field.pickerProperty.entity];\r\n            let pageCtx = (typeof page !== \"undefined\") ? page.context() : null;\r\n\r\n            if (findVal) {\r\n                if (typeof findVal === 'object') {\r\n                    defVal = findVal.name;\r\n                } else if (pageCtx && !pageCtx.contextObjects[findVal]) {\r\n                    /// Need to load the referenced object\r\n                    let type = field.pickerType;\r\n                    if (!type || type === 'self') type = useEntity[am7model.jsonModelKey];\r\n                    if (type.match(/^\\./)) {\r\n                        type = useEntity[field.pickerType.slice(1)];\r\n                    }\r\n                    if (typeof page !== \"undefined\") {\r\n                        page.openObject(type, findVal).then(function() {\r\n                            m.redraw();\r\n                        });\r\n                    }\r\n                } else if (pageCtx) {\r\n                    defVal = pageCtx.contextObjects[findVal].name;\r\n                }\r\n            }\r\n        } else if (useEntity && field.pickerProperty) {\r\n            defVal = useEntity[field.pickerProperty.entity];\r\n        }\r\n\r\n        let pickerName = ctx.useName + '-picker';\r\n        let mid = pickerName + \"-menu\";\r\n\r\n        if (valPick) {\r\n            fieldClass += \" menu-icon\";\r\n        } else {\r\n            /// Not a picker, just handle as text with change tracking\r\n            fHandler = function(e) {\r\n                if (ctx.updateChange) {\r\n                    ctx.updateChange(e, field);\r\n                }\r\n            };\r\n        }\r\n\r\n        let view = [];\r\n\r\n        /// Input field\r\n        let inputAttrs = {\r\n            type: \"text\",\r\n            class: fieldClass,\r\n            name: ctx.useName,\r\n            id: pickerName,\r\n            value: defVal,\r\n            autocomplete: \"off\",\r\n            avoid: 1,\r\n            onchange: fHandler\r\n        };\r\n        if (ctx.disabled) {\r\n            inputAttrs.disabled = true;\r\n        }\r\n        view.push(m(\"input\", inputAttrs));\r\n\r\n        /// Context menu for picker mode\r\n        if (valPick && typeof page !== \"undefined\" && page.navigable) {\r\n            view.push(\r\n                m(\"div\", {class: \"context-menu-container\"}, [\r\n                    m(\"div\", {class: \"transition transition-0 context-menu\", id: mid}, [\r\n                        page.navigable.contextMenuButton(pickerName, \"Find\", \"search\", function() {\r\n                            if (ctx.doFieldPicker) ctx.doFieldPicker(field, ctx.useName, useEntity);\r\n                        }),\r\n                        page.navigable.contextMenuButton(pickerName, \"View\", \"file_open\", function() {\r\n                            if (ctx.doFieldOpen) ctx.doFieldOpen(field);\r\n                        }),\r\n                        page.navigable.contextMenuButton(pickerName, \"Clear\", \"backspace\", function() {\r\n                            if (ctx.doFieldClear) ctx.doFieldClear(field);\r\n                        }),\r\n                        page.navigable.contextMenuButton(pickerName, \"Cancel\", \"cancel\")\r\n                    ])\r\n                ])\r\n            );\r\n\r\n            /// Register context menu (this needs to be done after render)\r\n            page.navigable.pendContextMenu(\"#\" + mid, \"#\" + pickerName, null, \"context-menu-96\");\r\n        }\r\n\r\n        return view;\r\n    };\r\n\r\n    /// ========================================\r\n    /// TABLE RENDERER\r\n    /// ========================================\r\n\r\n    /// Table field renderer - displays array data in a table format\r\n    /// This is a complex renderer that requires significant context:\r\n    ///   - valuesState: object tracking row selection/edit state\r\n    ///   - foreignData: object for storing foreign relationship data\r\n    ///   - getFormCommandView: function to render table commands\r\n    ///   - modelField: function to render individual fields (for edit mode)\r\n    ///\r\n    /// Due to the complexity and tight coupling with object page state,\r\n    /// this renderer delegates to the provided callback functions\r\n    renderers.table = function(ctx) {\r\n        /// Delegate to the table renderer function if provided\r\n        if (ctx.getValuesForTableField) {\r\n            return ctx.getValuesForTableField(\r\n                ctx.useName,\r\n                ctx.fieldView,\r\n                ctx.field,\r\n                ctx.fieldClass + \" table-field\",\r\n                !ctx.show\r\n            );\r\n        }\r\n\r\n        /// Fallback: simple table rendering without edit support\r\n        let field = ctx.field;\r\n        let entity = ctx.entity;\r\n        let fieldView = ctx.fieldView;\r\n\r\n        if (!entity || !field.baseModel || !fieldView.form) {\r\n            return [m(\"span\", \"Invalid table configuration\")];\r\n        }\r\n\r\n        let tableType = field.baseModel;\r\n        if (tableType === \"$self\") {\r\n            tableType = entity[am7model.jsonModelKey];\r\n        }\r\n\r\n        let tableForm = fieldView.form;\r\n        let rows = [];\r\n\r\n        /// Build header row\r\n        let headers = Object.keys(tableForm.fields).map(function(k) {\r\n            let tableFieldView = tableForm.fields[k];\r\n            let tableField = am7model.getModelField(tableType, k);\r\n            return m(\"th\", tableFieldView?.label || tableField?.label || k);\r\n        });\r\n        rows.push(m(\"tr\", headers));\r\n\r\n        /// Get values\r\n        let vals;\r\n        if (ctx.inst && ctx.inst.api[ctx.name]) {\r\n            vals = ctx.inst.api[ctx.name]();\r\n        } else if (entity[ctx.name]) {\r\n            vals = entity[ctx.name];\r\n        }\r\n\r\n        /// Build data rows\r\n        if (vals && Array.isArray(vals)) {\r\n            vals.forEach(function(v, i) {\r\n                let cells = Object.keys(tableForm.fields).map(function(k) {\r\n                    let val = v[k];\r\n                    if (val === undefined || val === null) val = \"\";\r\n                    return m(\"td\", \"\" + val);\r\n                });\r\n                rows.push(m(\"tr\", {class: \"row-field\"}, cells));\r\n            });\r\n        }\r\n\r\n        return [m(\"table\", {class: ctx.fieldClass + \" table-field\"}, rows)];\r\n    };\r\n\r\n    /// ========================================\r\n    /// FORM RENDERER (nested form)\r\n    /// ========================================\r\n\r\n    /// Form field renderer - delegates to a callback for nested form rendering\r\n    /// Context must provide:\r\n    ///   - getValuesForFormField: function to render nested form content\r\n    renderers.form = function(ctx) {\r\n        if (ctx.getValuesForFormField) {\r\n            return ctx.getValuesForFormField(\r\n                ctx.useName,\r\n                ctx.fieldView,\r\n                ctx.field,\r\n                \"table-field\",\r\n                !ctx.show\r\n            );\r\n        }\r\n\r\n        /// Fallback\r\n        return [m(\"span\", \"Nested form rendering requires getValuesForFormField callback\")];\r\n    };\r\n\r\n    /// ========================================\r\n    /// REGISTRY AND EXPORT\r\n    /// ========================================\r\n\r\n    /// Check if a renderer exists for a format\r\n    function hasRenderer(format) {\r\n        return renderers.hasOwnProperty(format);\r\n    }\r\n\r\n    /// Get a renderer by format name\r\n    function getRenderer(format) {\r\n        return renderers[format];\r\n    }\r\n\r\n    /// Render a field using the appropriate renderer\r\n    function render(format, ctx) {\r\n        if (!hasRenderer(format)) {\r\n            console.warn(\"No form field renderer for format: \" + format);\r\n            return null;\r\n        }\r\n        return renderers[format](ctx);\r\n    }\r\n\r\n    /// Register a new renderer\r\n    function register(format, fn) {\r\n        renderers[format] = fn;\r\n    }\r\n\r\n    /// Export\r\n    let formFieldRenderers = {\r\n        render: render,\r\n        has: hasRenderer,\r\n        get: getRenderer,\r\n        register: register\r\n    };\r\n\r\n    /// Register with page.components\r\n    if (typeof page !== \"undefined\" && page.components) {\r\n        page.components.formFieldRenderers = formFieldRenderers;\r\n    }\r\n\r\n}());\r\n\n\n;/* === client/components/membership.js === */\n(function() {\r\n    /// Membership Component\r\n    /// Handles object relationships: members, entities, children, and participations\r\n    ///\r\n    /// This component provides functions for managing object memberships that can be\r\n    /// used by objectPage or other components. Each function receives a context object\r\n    /// with the necessary state and callbacks.\r\n\r\n    /// ========================================\r\n    /// MEMBER OPERATIONS\r\n    /// Uses am7client.member() for membership relationships\r\n    /// ========================================\r\n\r\n    /// Pick members from picker and add them to the entity\r\n    /// ctx: { entity, field, foreignData, cancelPicker, updateChange, fieldName }\r\n    function pickMember(ctx, members) {\r\n        let aP = [];\r\n        let entity = ctx.entity;\r\n        let field = ctx.field;\r\n        let fieldName = ctx.fieldName || field.name;\r\n\r\n        console.log(\"pickMember\", fieldName, field, members);\r\n\r\n        if (am7model.hasIdentity(entity)) {\r\n            members.forEach(function(t) {\r\n                aP.push(new Promise(function(res, rej) {\r\n                    /// Differentiate which is the container\r\n                    /// For tags, the tag participates in the entity, not vice versa\r\n                    let e2 = entity;\r\n                    let a2 = t;\r\n                    if (\"data.tag\" === field.baseModel) {\r\n                        e2 = t;\r\n                        a2 = entity;\r\n                    }\r\n\r\n                    /// For tags and virtual fields, don't pass field name\r\n                    let fn = (field.baseModel !== \"data.tag\" && !field.virtual) ? field.name : null;\r\n                    console.log(\"member call:\", e2[am7model.jsonModelKey], e2.objectId, fn, a2[am7model.jsonModelKey], a2.objectId, true);\r\n                    am7client.member(\r\n                        e2[am7model.jsonModelKey], e2.objectId,\r\n                        fn,\r\n                        a2[am7model.jsonModelKey], a2.objectId,\r\n                        true,\r\n                        function(v) {\r\n                            console.log(\"Member result: \" + v);\r\n                            res(v);\r\n                        }\r\n                    );\r\n                }));\r\n            });\r\n        } else {\r\n            console.warn(\"Entity has no identity, cannot add member\");\r\n        }\r\n\r\n        if (!aP.length) {\r\n            console.warn(\"Nothing picked!\");\r\n        }\r\n\r\n        return Promise.all(aP).then(function() {\r\n            /// Clear foreign data for the field to force refresh\r\n            if (ctx.foreignData && fieldName) {\r\n                delete ctx.foreignData[fieldName];\r\n            }\r\n            if (ctx.cancelPicker) ctx.cancelPicker();\r\n        });\r\n    }\r\n\r\n    /// Add member via picker\r\n    /// ctx: { entity, inst, field, preparePicker }\r\n    /// Returns Promise\r\n    function addMember(ctx, name, tableType, tableForm, props) {\r\n        let type = tableType;\r\n        let field = ctx.field;\r\n\r\n        console.log(\"addMember\", name, tableType, props);\r\n\r\n        if (type === \"$flex\") {\r\n            if (field.foreignType && ctx.inst) {\r\n                type = ctx.inst.api[field.foreignType]();\r\n            } else {\r\n                console.warn(\"Cannot reference a flex field without a foreign type\");\r\n                return Promise.resolve(null);\r\n            }\r\n        }\r\n\r\n        if (props.typeAttribute && ctx.entity) {\r\n            type = am7view.typeToModel(ctx.entity[props.typeAttribute]);\r\n        }\r\n\r\n        if (props.picker && ctx.preparePicker) {\r\n            /// Add fieldName to context for pickMember to use\r\n            let pickCtx = Object.assign({}, ctx, { fieldName: name });\r\n            return ctx.preparePicker(type, function(members) {\r\n                pickMember(pickCtx, members);\r\n            });\r\n        }\r\n\r\n        return Promise.resolve(null);\r\n    }\r\n\r\n    /// Delete selected members\r\n    /// ctx: { entity, field, valuesState, foreignData }\r\n    function deleteMember(ctx, name, field, tableType, tableForm) {\r\n        let aP = [];\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n        let foreignData = ctx.foreignData || {};\r\n\r\n        console.log(\"deleteMember\", name, field, valuesState);\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            if (state.selected) {\r\n                console.log(\"Processing selected state:\", k, state);\r\n                if (foreignData[state.attribute]) {\r\n                    let obj = foreignData[state.attribute][state.index];\r\n                    console.log(\"Delete from foreignData:\", obj);\r\n                    /// For virtual/ephemeral fields, don't pass field name to member()\r\n                    let fn = (field.virtual || field.ephemeral) ? null : name;\r\n                    console.log(\"Delete member call (foreignData):\", entity[am7model.jsonModelKey], entity.objectId, fn, obj[am7model.jsonModelKey], obj.objectId, false);\r\n                    aP.push(new Promise(function(res, rej) {\r\n                        am7client.member(\r\n                            entity[am7model.jsonModelKey], entity.objectId,\r\n                            fn,\r\n                            obj[am7model.jsonModelKey], obj.objectId,\r\n                            false,\r\n                            function(v) {\r\n                                console.log(\"Deleted member result:\", v);\r\n                                if (entity[name]) {\r\n                                    entity[name] = entity[name].filter(function(m) {\r\n                                        return m.objectId !== obj.objectId;\r\n                                    });\r\n                                }\r\n                                res(v);\r\n                            }\r\n                        );\r\n                    }));\r\n                } else {\r\n                    let vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n                    let per = vProp[name][state.index];\r\n                    console.log(\"Delete from vProp:\", per);\r\n\r\n                    if (am7model.hasIdentity(entity)) {\r\n                        /// For tags and virtual fields, don't pass field name\r\n                        let fn = (field.baseModel !== \"data.tag\" && !field.virtual) ? field.name : null;\r\n                        let obj = entity;\r\n                        let act = per;\r\n                        /// For tags, reverse the relationship\r\n                        if (per[am7model.jsonModelKey] === \"data.tag\") {\r\n                            obj = per;\r\n                            act = entity;\r\n                        }\r\n                        console.log(\"Delete member call:\", obj[am7model.jsonModelKey], obj.objectId, fn, act[am7model.jsonModelKey], act.objectId, false);\r\n                        aP.push(am7client.member(\r\n                            obj[am7model.jsonModelKey], obj.objectId,\r\n                            fn,\r\n                            act[am7model.jsonModelKey], act.objectId,\r\n                            false\r\n                        ));\r\n                    }\r\n                    vProp[name] = vProp[name].filter(function(o) {\r\n                        return o.objectId !== per.objectId;\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        if (!aP.length) {\r\n            console.warn(\"No members selected for deletion\");\r\n        }\r\n\r\n        return Promise.all(aP).then(function() {\r\n            if (ctx.foreignData) delete ctx.foreignData[name];\r\n            m.redraw();\r\n        });\r\n    }\r\n\r\n    /// Get members of an object (object is the container)\r\n    /// ctx: { entity }\r\n    function objectMembers(ctx, name, field) {\r\n        return new Promise(function(res, rej) {\r\n            let entity = ctx.entity;\r\n            let ftype = field ? (field.typeAttribute || field.foreignType) : null;\r\n\r\n            if (!entity || !entity.objectId || !field || !ftype) {\r\n                res([]);\r\n                return;\r\n            }\r\n\r\n            let type = am7view.typeToModel(entity[ftype]);\r\n            am7client.members(\r\n                entity[am7model.jsonModelKey], entity.objectId,\r\n                type, 0, 100,\r\n                function(v) {\r\n                    am7model.updateListModel(v);\r\n                    res(v);\r\n                }\r\n            );\r\n        });\r\n    }\r\n\r\n    /// Get participations where object is a participant\r\n    /// ctx: { entity }\r\n    function memberObjects(ctx, name, field) {\r\n        return new Promise(function(res, rej) {\r\n            let entity = ctx.entity;\r\n\r\n            if (!entity || !entity.objectId) {\r\n                res([]);\r\n                return;\r\n            }\r\n            if (!field || !field.participantType) {\r\n                res([]);\r\n                return;\r\n            }\r\n\r\n            let ftype = field.factoryType;\r\n            let paftype = field.participationFactoryType;\r\n            if (!ftype) ftype = paftype;\r\n            let pftype = field.participantFactoryType;\r\n            let ptype = field.participantType;\r\n\r\n            /// Resolve dynamic type references\r\n            if (paftype && paftype.match(/^\\./)) paftype = entity[paftype.slice(1)];\r\n            if (ftype && ftype.match(/^\\./)) ftype = entity[ftype.slice(1)];\r\n            if (pftype && pftype.match(/^\\./)) pftype = entity[pftype.slice(1)];\r\n            if (ptype && ptype.match(/^\\./)) ptype = entity[ptype.slice(1)];\r\n\r\n            let search = new org.cote.objects.participationSearchRequest();\r\n            search.startRecord = 0;\r\n            search.recordCount = 100;\r\n            search.participantList = [entity.objectId];\r\n            search.participantFactoryType = pftype;\r\n            search.participationFactoryType = paftype;\r\n            search.participantType = ptype;\r\n\r\n            am7client.listParticipations(ftype, search, function(v) {\r\n                am7model.updateListModel(v);\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n\r\n    /// ========================================\r\n    /// ENTITY OPERATIONS\r\n    /// Direct entity list manipulation with optional member() calls\r\n    /// ========================================\r\n\r\n    /// Pick entities and add them to a field\r\n    /// ctx: { entity, field, caller, objectPage, inst, parentProperty, cancelPicker }\r\n    function pickEntity(ctx, name, data) {\r\n        let entity = ctx.entity;\r\n        let field = ctx.field;\r\n        let vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n\r\n        if (!vProp[name] && field.type === \"list\") {\r\n            vProp[name] = [];\r\n        }\r\n        vProp[name] = page.removeDuplicates(vProp[name].concat(data), \"objectId\");\r\n\r\n        if (ctx.caller) {\r\n            ctx.caller.callback('update', ctx.objectPage, ctx.inst, name, ctx.parentProperty);\r\n        } else {\r\n            /// For existing entities, add memberships immediately\r\n            if (am7model.hasIdentity(entity)) {\r\n                let aP = [];\r\n                data.forEach(function(v) {\r\n                    aP.push(am7client.member(\r\n                        entity[am7model.jsonModelKey], entity.objectId,\r\n                        name,\r\n                        v[am7model.jsonModelKey], v.objectId,\r\n                        true\r\n                    ));\r\n                });\r\n                Promise.all(aP);\r\n            }\r\n        }\r\n\r\n        if (ctx.cancelPicker) ctx.cancelPicker();\r\n    }\r\n\r\n    /// Add entity via picker\r\n    /// ctx: { preparePicker, field }\r\n    function addEntity(ctx, name, tableType, tableForm, props) {\r\n        if (props.picker && ctx.preparePicker) {\r\n            return ctx.preparePicker(tableType, function(data) {\r\n                pickEntity(ctx, name, data);\r\n            });\r\n        }\r\n        return Promise.resolve(null);\r\n    }\r\n\r\n    /// Open selected entity in a new view\r\n    /// ctx: { entity, field, valuesState, foreignData }\r\n    function openEntity(ctx, name, field, tableType, tableForm, props) {\r\n        let ent;\r\n        let valuesState = ctx.valuesState || {};\r\n        let foreignData = ctx.foreignData || {};\r\n        let entity = ctx.entity;\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            let vProp;\r\n            if (field.foreign && foreignData[name]) {\r\n                vProp = foreignData;\r\n            } else {\r\n                vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n            }\r\n\r\n            if (!ent && state.selected && vProp[name]) {\r\n                ent = vProp[name][state.index];\r\n            }\r\n        });\r\n\r\n        if (ent) {\r\n            let uri = \"/view/\" + ent[am7model.jsonModelKey] + \"/\" + ent.objectId;\r\n            m.route.set(uri, {key: ent.objectId});\r\n        } else {\r\n            console.log(\"Didn't find entity to open\");\r\n        }\r\n    }\r\n\r\n    /// Delete selected entities\r\n    /// ctx: { entity, field, valuesState, updateChange }\r\n    function deleteEntity(ctx, name, field, tableType, tableForm, props) {\r\n        let aP = [];\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            let vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n\r\n            if (state.selected && vProp[name]) {\r\n                let per = vProp[name][state.index];\r\n\r\n                if (am7model.hasIdentity(entity)) {\r\n                    aP.push(am7client.member(\r\n                        entity[am7model.jsonModelKey], entity.objectId,\r\n                        name,\r\n                        per[am7model.jsonModelKey], per.objectId,\r\n                        false\r\n                    ));\r\n                } else {\r\n                    console.warn(\"Cannot delete entity without identity: \" + entity[am7model.jsonModelKey]);\r\n                }\r\n                vProp[name] = vProp[name].filter(function(o) {\r\n                    return o.objectId !== per.objectId;\r\n                });\r\n            }\r\n        });\r\n\r\n        return Promise.all(aP).then(function() {\r\n            if (ctx.updateChange) ctx.updateChange();\r\n            m.redraw();\r\n        });\r\n    }\r\n\r\n    /// ========================================\r\n    /// CHILD/PARENT OPERATIONS\r\n    /// Uses parentId for hierarchical relationships\r\n    /// ========================================\r\n\r\n    /// Reparent children to a new parent\r\n    function reparent(parent, children) {\r\n        let aP = [];\r\n        children.forEach(function(c) {\r\n            aP.push(new Promise(function(res, rej) {\r\n                if (c[am7model.jsonModelKey].match(/^auth\\.group$/gi) && !parent) {\r\n                    rej(\"Unable to reparent a group to nothing\");\r\n                } else {\r\n                    c.parentId = parent ? parent.id : 0;\r\n                    am7client.patch(c[am7model.jsonModelKey], c, function(v) {\r\n                        if (v) res();\r\n                        else rej();\r\n                    });\r\n                }\r\n            }));\r\n        });\r\n        return Promise.all(aP);\r\n    }\r\n\r\n    /// Pick children and add them to parent\r\n    /// ctx: { entity, field, cancelPicker }\r\n    function pickChild(ctx, name, data) {\r\n        let entity = ctx.entity;\r\n        let field = ctx.field;\r\n\r\n        reparent(entity, data).then(function() {\r\n            let vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n            vProp[name] = page.removeDuplicates(vProp[name].concat(data), \"objectId\");\r\n\r\n            if (ctx.cancelPicker) ctx.cancelPicker(true);\r\n\r\n            /// Don't update because the new lineage is already persisted\r\n            am7client.clearCache(entity[am7model.jsonModelKey], false, function(s, v) {\r\n                m.redraw();\r\n            });\r\n        });\r\n    }\r\n\r\n    /// Add child via picker\r\n    /// ctx: { preparePicker, field }\r\n    function addChild(ctx, name, tableType, tableForm, props) {\r\n        if (props.picker && ctx.preparePicker) {\r\n            return ctx.preparePicker(tableType, function(data) {\r\n                pickChild(ctx, name, data);\r\n            });\r\n        }\r\n        return Promise.resolve(null);\r\n    }\r\n\r\n    /// Delete selected children (removes parent relationship)\r\n    /// ctx: { entity, field, valuesState }\r\n    function deleteChild(ctx, name, field, tableType, tableForm, props) {\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n        let aC = [];\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            let vProp = (field.parentProperty ? entity[field.parentProperty] : entity);\r\n\r\n            if (state.selected && vProp[name]) {\r\n                let obj = vProp[name][state.index];\r\n                aC.push(obj);\r\n                /// Update UI immediately\r\n                vProp[name] = vProp[name].filter(function(o) {\r\n                    return o.objectId !== obj.objectId;\r\n                });\r\n            }\r\n        });\r\n\r\n        return reparent(null, aC).then(function() {\r\n            am7client.clearCache(entity[am7model.jsonModelKey], false, function(s, v) {\r\n                m.redraw();\r\n            });\r\n        });\r\n    }\r\n\r\n    /// ========================================\r\n    /// SPECIAL OPERATIONS\r\n    /// ========================================\r\n\r\n    /// Get controls for an object\r\n    /// ctx: { entity }\r\n    function objectControls(ctx, name, field) {\r\n        return new Promise(function(res, rej) {\r\n            let entity = ctx.entity;\r\n            if (!entity || !entity.objectId) {\r\n                res([]);\r\n                return;\r\n            }\r\n            page.controls(entity[am7model.jsonModelKey], entity.objectId).then(function(v) {\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n\r\n    /// Get requests for an object (incomplete implementation)\r\n    /// ctx: { entity }\r\n    function objectRequests(ctx, name, field) {\r\n        return new Promise(function(res, rej) {\r\n            let entity = ctx.entity;\r\n            if (!entity || !entity.objectId) {\r\n                res([]);\r\n                return;\r\n            }\r\n            page.requests(entity[am7model.jsonModelKey], entity.objectId).then(function(v) {\r\n                res(v);\r\n            });\r\n        });\r\n    }\r\n\r\n    /// ========================================\r\n    /// EXPORT\r\n    /// ========================================\r\n\r\n    let membership = {\r\n        /// Member operations\r\n        pickMember: pickMember,\r\n        addMember: addMember,\r\n        deleteMember: deleteMember,\r\n        objectMembers: objectMembers,\r\n        memberObjects: memberObjects,\r\n\r\n        /// Entity operations\r\n        pickEntity: pickEntity,\r\n        addEntity: addEntity,\r\n        openEntity: openEntity,\r\n        deleteEntity: deleteEntity,\r\n\r\n        /// Child/Parent operations\r\n        reparent: reparent,\r\n        pickChild: pickChild,\r\n        addChild: addChild,\r\n        deleteChild: deleteChild,\r\n\r\n        /// Special operations\r\n        objectControls: objectControls,\r\n        objectRequests: objectRequests\r\n    };\r\n\r\n    /// Register with page.components\r\n    if (typeof page !== \"undefined\" && page.components) {\r\n        page.components.membership = membership;\r\n    }\r\n\r\n}());\r\n\n\n;/* === client/components/tableEntry.js === */\n(function() {\r\n    /// Table Entry Management Component\r\n    /// Handles table row editing, adding, and removing entries\r\n    ///\r\n    /// This component provides functions for managing table entries that can be\r\n    /// used by objectPage or other components. Each function receives a context object\r\n    /// with the necessary state and callbacks.\r\n\r\n    /// ========================================\r\n    /// ENTRY STATE MANAGEMENT\r\n    /// ========================================\r\n\r\n    /// Edit selected entries (switch to edit mode)\r\n    /// ctx: { valuesState }\r\n    function editEntry(ctx) {\r\n        let valuesState = ctx.valuesState || {};\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            if (state.selected) {\r\n                state.mode = 'edit';\r\n            }\r\n        });\r\n        m.redraw();\r\n    }\r\n\r\n    /// Cancel entry editing (reset state)\r\n    /// ctx: { resetValuesState }\r\n    function cancelEntry(ctx, name) {\r\n        if (ctx.resetValuesState) {\r\n            ctx.resetValuesState();\r\n        }\r\n        m.redraw();\r\n    }\r\n\r\n    /// ========================================\r\n    /// ENTRY CRUD OPERATIONS\r\n    /// ========================================\r\n\r\n    /// Delete selected entries\r\n    /// ctx: { entity, valuesState, inst }\r\n    function deleteEntry(ctx, name) {\r\n        let aP = [];\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n        let inst = ctx.inst;\r\n        let model = page.context();\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            if (state.selected) {\r\n                /// Handle specific entry types\r\n                if (name === 'episodes' || name === 'messages' || name === 'attributes' || name === 'elementValues') {\r\n                    /// Need to confirm the attribute type, this assumes it's an array\r\n                    let ov = entity[state.attribute][state.index];\r\n                    entity[state.attribute] = entity[state.attribute].filter(function(a, i) {\r\n                        return i !== state.index;\r\n                    });\r\n                    delete valuesState[k];\r\n                    if (ov && am7model.hasIdentity(ov)) {\r\n                        aP.push(page.deleteObject(ov[am7model.jsonModelKey], ov.objectId));\r\n                    } else if (inst) {\r\n                        inst.change(name);\r\n                    }\r\n                }\r\n                else if (name === 'controls') {\r\n                    if (model.controls && model.controls[entity.objectId]) {\r\n                        let ctl = model.controls[entity.objectId][state.index];\r\n                        delete model.controls[entity.objectId][state.index];\r\n                        if (ctl && ctl.objectId) {\r\n                            aP.push(new Promise(function(res, rej) {\r\n                                am7client.delete(\"CONTROL\", ctl.objectId, function(s, v) {\r\n                                    res();\r\n                                });\r\n                            }));\r\n                        }\r\n                        console.log(\"DELETE\", ctl);\r\n                    }\r\n                }\r\n                else {\r\n                    console.log(\"Handle delete \" + name, state);\r\n                }\r\n            }\r\n        });\r\n\r\n        return Promise.all(aP).then(function() {\r\n            m.redraw();\r\n        });\r\n    }\r\n\r\n    /// Create a new entry in a list field\r\n    /// ctx: { entity, valuesState, inst }\r\n    function newEntry(ctx, name) {\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n        let inst = ctx.inst;\r\n\r\n        if (!entity || !entity[am7model.jsonModelKey]) {\r\n            console.error(\"Entity not available\");\r\n            return;\r\n        }\r\n\r\n        let mf = am7model.getModelField(entity[am7model.jsonModelKey], name);\r\n        if (!mf) {\r\n            console.error(\"Object does not define '\" + name + \"'\");\r\n            return;\r\n        }\r\n\r\n        if (mf.type === 'list' && mf.baseModel) {\r\n            if (!entity[name]) entity[name] = [];\r\n            if (inst && !inst.changes.includes(name)) inst.changes.push(name);\r\n\r\n            let ne;\r\n            if (name === 'attributes') {\r\n                ne = am7client.newAttribute(\"\", \"\");\r\n            } else {\r\n                ne = am7model.newPrimitive(mf.baseModel);\r\n            }\r\n\r\n            entity[name].push(ne);\r\n            let idx = entity[name].length - 1;\r\n            valuesState[name + \"-\" + idx] = {\r\n                attribute: name,\r\n                index: idx,\r\n                selected: true,\r\n                mode: 'edit'\r\n            };\r\n            m.redraw();\r\n        } else {\r\n            console.error(\"Unhandled new entry type: \" + mf.type);\r\n        }\r\n    }\r\n\r\n    /// Check/save entry changes\r\n    /// ctx: { entity, valuesState, inst, foreignData }\r\n    function checkEntry(ctx, name, field, tableType, tableForm, props) {\r\n        let entity = ctx.entity;\r\n        let valuesState = ctx.valuesState || {};\r\n        let foreignData = ctx.foreignData || {};\r\n        let inst = ctx.inst;\r\n\r\n        if (!entity || !entity[am7model.jsonModelKey]) {\r\n            console.error(\"Entity not available\");\r\n            return Promise.resolve();\r\n        }\r\n\r\n        let formName = tableType.substring(tableType.lastIndexOf(\".\") + 1);\r\n        let fieldView = am7model.forms[formName];\r\n        let parentField = am7model.getModelField(entity[am7model.jsonModelKey], name);\r\n        let aP = [];\r\n\r\n        Object.keys(valuesState).forEach(function(k) {\r\n            let state = valuesState[k];\r\n            if (state.mode === 'edit') {\r\n                let idx = state.index;\r\n                let entry;\r\n                if (field.foreign) {\r\n                    entry = foreignData[state.fieldName || name][idx];\r\n                } else {\r\n                    entry = entity[state.fieldName || name][idx];\r\n                }\r\n\r\n                let einst = am7model.prepareInstance(entry, tableForm);\r\n\r\n                Object.keys(tableForm.fields).forEach(function(fk) {\r\n                    let tableField = am7model.getModelField(tableType, fk);\r\n                    let e = document.querySelector(\"[name='\" + fk + \"-\" + idx + \"']\");\r\n\r\n                    if (!e) {\r\n                        console.warn(\"Element not found for field: \" + fk + \"-\" + idx);\r\n                        return;\r\n                    }\r\n\r\n                    if (tableField.virtual) {\r\n                        console.log(\"Skipping virtual field\");\r\n                    } else {\r\n                        let useType = tableField.type;\r\n\r\n                        if (useType === 'flex') {\r\n                            if (entry.valueType) {\r\n                                useType = entry.valueType.toLowerCase();\r\n                            }\r\n                        }\r\n\r\n                        switch (useType) {\r\n                            case 'boolean':\r\n                                entry[fk] = (e.value.match(/^true$/gi) != null);\r\n                                break;\r\n                            case 'int':\r\n                                entry[fk] = parseInt(e.value);\r\n                                break;\r\n                            case 'double':\r\n                            case 'long':\r\n                                entry[fk] = parseFloat(e.value);\r\n                                break;\r\n                            case 'enum':\r\n                            case 'string':\r\n                                entry[fk] = e.value;\r\n                                break;\r\n                            case 'list':\r\n                            case 'array':\r\n                                einst.api[fk](e.value);\r\n                                break;\r\n                            default:\r\n                                console.warn(\"Unhandled entry type: \" + useType);\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                if ((parentField?.foreign || parentField?.referenced) && !fieldView?.standardUpdate && am7model.hasIdentity(entity)) {\r\n                    console.log(\"Patching object: \" + name, entry);\r\n                    if (entry.objectId) {\r\n                        aP.push(am7client.patch(entry));\r\n                    } else {\r\n                        entry[am7model.jsonModelKey] = tableType;\r\n                        if (am7model.inherits(tableType, \"common.reference\")) {\r\n                            entry.referenceId = entity.id;\r\n                            entry.referenceModel = entity[am7model.jsonModelKey];\r\n                        }\r\n                        aP.push(am7client.create(tableType, entry));\r\n                    }\r\n                }\r\n                else if ((!parentField?.foreign && !parentField?.referenced) || fieldView?.standardUpdate) {\r\n                    if (inst) inst.change(name);\r\n                }\r\n                else {\r\n                    console.warn(\"Foreign data, not updating: \" + name, entry);\r\n                }\r\n            }\r\n        });\r\n\r\n        return Promise.all(aP).then(function(aB) {\r\n            if (!aB || !aB.filter(function(b) { return !b; }).length) {\r\n                if (ctx.resetValuesState) {\r\n                    ctx.resetValuesState();\r\n                }\r\n                m.redraw();\r\n            } else {\r\n                console.warn(\"Error updating record: \" + aB);\r\n            }\r\n        });\r\n    }\r\n\r\n    /// ========================================\r\n    /// EXPORT\r\n    /// ========================================\r\n\r\n    let tableEntry = {\r\n        editEntry: editEntry,\r\n        deleteEntry: deleteEntry,\r\n        newEntry: newEntry,\r\n        checkEntry: checkEntry,\r\n        cancelEntry: cancelEntry\r\n    };\r\n\r\n    /// Register with page.components\r\n    if (typeof page !== \"undefined\" && page.components) {\r\n        page.components.tableEntry = tableEntry;\r\n    }\r\n\r\n}());\r\n\n\n;/* === client/components/emoji.js === */\n(function () {\r\n\r\n    let emojiLoadReq;\r\n    let emojiDict;\r\n    let emojiReq;\r\n    let emojiDesc;\r\n\r\n    let emojiCat;\r\n    let emojiSubCat;\r\n    let emojiResults = [];\r\n\r\n    function searchEmojis(e) {\r\n        let search = e.target.value.trim().toLowerCase();\r\n        emojiCat = undefined;\r\n        if(search.length == 0){\r\n            emojiResults = [];\r\n            m.redraw();\r\n            return;\r\n        }\r\n        findEmojis(search).then((results) => {\r\n            emojiResults = results.map((o) => {\r\n                return emojiMenuButton(o);\r\n            });\r\n            if (emojiResults.length == 0) {\r\n                emojiResults = [m(\"div\", { class: \"context-menu-item\" }, \"No emojis found\")];\r\n            }\r\n            m.redraw();\r\n        });\r\n    }\r\n\r\n    function emojiMenuButton(o){\r\n        return m(\"button\", {\r\n            class: \"context-menu-item text-left\",\r\n            onclick: function () {\r\n                page.navigable.menu(\"#emojiContextMenu\");\r\n                navigator.clipboard.writeText(o.emoji);\r\n                page.toast(\"info\", o.emoji + \" copied to clipboard\", 2000);\r\n            }\r\n        }, [\r\n            m(\"span\", { class: \"emoji\" }, o.emoji),\r\n            m(\"span\", { class: \"ml-2\" }, o.name)\r\n        ]);\r\n    }\r\n\r\n    function emojiCategories(){\r\n        let ret = [];\r\n        if(!emojiLoadReq && !emojiDict){\r\n            emojiLoadReq = true;\r\n            loadEmojiDict().then(() => {\r\n                m.redraw();\r\n            });\r\n            return ret;\r\n        };\r\n        if(emojiCat){\r\n            ret.push(m(\"button\", {class: \"context-menu-item text-left\", onclick: function () { emojiCat = undefined; emojiSubCat = undefined; m.redraw(); }}, [\r\n                m(\"span\", { class: \"ml-2\" }, emojiCat)\r\n            ]));\r\n            if(emojiSubCat){\r\n                ret.push(m(\"button\", {class: \"context-menu-item text-left\", onclick: function () { emojiSubCat = undefined; m.redraw(); }}, [\r\n                    m(\"span\", { class: \"ml-2\" }, emojiSubCat)\r\n                ]));\r\n            }\r\n        }\r\n        \r\n        if(emojiDict){\r\n            let ejs = (emojiCat ? emojiDict[emojiCat] : emojiDict);\r\n            if(emojiSubCat){\r\n                ejs = ejs[emojiSubCat];\r\n            }\r\n            for(let e in ejs){\r\n                let itm = e;\r\n                if(emojiSubCat){\r\n                    ret.push(emojiMenuButton(ejs[e]));\r\n                }\r\n                else{\r\n\r\n                    ret.push(m(\"button\", {\r\n                        class: \"context-menu-item text-left\",\r\n                        onclick: function () {\r\n                            //page.navigable.menu(\".context-menu-48\");\r\n                            if(emojiCat){\r\n                                emojiSubCat = e;\r\n                            }\r\n                            else{\r\n                                emojiCat = e;\r\n                                emojiSubCat = undefined;\r\n                            }\r\n                            \r\n                            m.redraw();\r\n                        }\r\n                    }, [\r\n                        m(\"span\", { class: \"ml-2\" }, e)\r\n                    ]));\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    function emojiContextButton() {\r\n        let ico = m(\"span\", { class: \"material-symbols-outlined\" }, \"add_reaction\");\r\n        return m(\"button\", { id: \"emojiContextMenuButton\", class: \"context-menu-button\" }, [ico]);\r\n    }\r\n    \r\n\r\n\r\n    function renderEmojiButton() {\r\n        return m(\"div\", { class: \"context-menu-container\" }, [\r\n            emojiContextButton(),\r\n            m(\"div\", { id: \"emojiContextMenu\", class: \"transition transition-0 context-menu-48\" }, [\r\n                m(\"input\", {type: \"text\", class: \"ml-0 mr-0 context-menu-input text-field\", placeholder: \"Search emojis\", oninput: searchEmojis}),\r\n                (emojiResults && emojiResults.length > 0 ? emojiResults : emojiCategories())\r\n            ])\r\n        ])\r\n    }\r\n\r\n    function markdownEmojis(text) {\r\n      if(!emojiDict){\r\n        loadEmojiDict().then(() => {\r\n            m.redraw();\r\n        });\r\n        return text;\r\n      }\r\n\r\n      let ea = Array.from(new Set(extractEmojis(text)));\r\n      for(let i = 0; i < ea.length; i++){\r\n        let desc = findEmojiDesc(ea[i]);\r\n        let txt = desc?.alt || desc?.description;\r\n        if(!txt) txt = findEmojiName(ea[i]);\r\n\r\n        let lbl = \"[\" + ea[i] + \"](## \\\"\" + txt + \"\\\")\"; \r\n        text = text.replaceAll(ea[i], lbl);\r\n      }\r\n      return text;\r\n    }\r\n\r\n    async function loadEmojiDict(){\r\n        if(!emojiDict){\r\n            if(!emojiReq){\r\n                emojiReq = true;\r\n                let edd = await m.request({ method: 'GET', url: \"/common/emojiDesc.json\", withCredentials: true });\r\n                if(edd && edd.length > 0){\r\n                    emojiDesc = edd;\r\n                }\r\n                let ed = await m.request({ method: 'GET', url: \"/common/emojis.categories.json\", withCredentials: true });\r\n                if(ed && ed.emojis){\r\n                    emojiDict = ed.emojis;\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n    function findEmojiDesc(emoji) {\r\n        let desc;\r\n        if(emojiDesc){\r\n            let ad = emojiDesc.filter(e => e.emoji === emoji);\r\n            if(ad && ad.length > 0){\r\n                desc = ad[0];\r\n            };\r\n        }\r\n        return desc;\r\n    }\r\n\r\n    function findEmojiName(targetEmoji) {\r\n        for (const categoryName in emojiDict) {\r\n            const subCategories = emojiDict[categoryName];\r\n            for (const subCategoryName in subCategories) {\r\n                const emojiList = subCategories[subCategoryName];\r\n                const foundEmoji = emojiList.find(emoji => emoji.emoji === targetEmoji.trim());\r\n                if (foundEmoji) {\r\n                    return foundEmoji.name;\r\n                }\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    async function findEmojis(targetEmoji) {\r\n        await loadEmojiDict();\r\n        let be = extractEmojis(targetEmoji).length > 0;\r\n        let rea = !be ? \"emoji\" : \"name\";\r\n        let ar = [];\r\n        let et = targetEmoji.trim();\r\n        for (const categoryName in emojiDict) {\r\n            const subCategories = emojiDict[categoryName];\r\n            for (const subCategoryName in subCategories) {\r\n                const emojiList = subCategories[subCategoryName];\r\n                const foundEmoji = emojiList.find(emoji => (be && emoji.emoji === et) || (!be && emoji.name.toLowerCase().indexOf(et.toLowerCase()) > -1));\r\n                if (foundEmoji) {\r\n                    //return foundEmoji[rea];\r\n                    ar.push({\r\n                        name: foundEmoji.name,\r\n                        emoji: foundEmoji.emoji,\r\n                        category: categoryName,\r\n                        subCategory: subCategoryName\r\n                    });\r\n                }\r\n            }\r\n        }\r\n          \r\n        return ar;\r\n    }\r\n\r\n    function extractEmojis(text) {\r\n        if (!text || typeof text !== 'string') {\r\n            return [];\r\n        }\r\n        const emojiRegex = /\\p{Emoji_Presentation}|\\p{Extended_Pictographic}/gu;\r\n        const matches = text.match(emojiRegex);\r\n        return matches || [];\r\n    }\r\n\r\n    async function exportEmojis(delim) {\r\n        await loadEmojiDict();\r\n        // Define the header row for the TSV file\r\n        const headers = [\r\n            'Category',\r\n            'Subcategory',\r\n            'Emoji',\r\n            'Name',\r\n            'Keywords',\r\n            'Unicode'\r\n        ];\r\n        let tsvContent = headers.join(delim) + '\\n';\r\n\r\n        // Iterate over each category in the JSON data\r\n        for(let category in emojiDict){\r\n            //const categoryName = category.name || 'N/A';\r\n            for(let subCategory in emojiDict[category]){\r\n            // Iterate over each emoji within the category\r\n                let ems = emojiDict[category][subCategory];\r\n\r\n                if (Array.isArray(ems)) {\r\n                    ems.forEach(emoji => {\r\n                        const emojiChar = emoji.emoji || '';\r\n                        const name = emoji.name || 'N/A';\r\n                        // Join keywords with a comma, or provide 'N/A' if none exist\r\n                        const keywords = Array.isArray(emoji.keywords) ? emoji.keywords.join(', ') : 'N/A';\r\n                        const unicode = emoji.unicode || 'N/A';\r\n\r\n                        // Create a row array and join with tabs\r\n                        const row = [\r\n                            category,\r\n                            subCategory,\r\n                            emojiChar,\r\n                            name,\r\n                            keywords,\r\n                            unicode\r\n                        ];\r\n                        tsvContent += row.join('\\t') + '\\n';\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        return tsvContent;\r\n    }\r\n\r\n    let emoji = {\r\n        menuButton: renderEmojiButton,\r\n        markdownEmojis,\r\n        findEmojis,\r\n        findEmojiDesc,\r\n        emojis: () => emojiDict,\r\n        emojisDesc: () => emojiDesc,\r\n        loadEmojiDict,\r\n        exportEmojis,\r\n        component: {\r\n            \r\n            oncreate: function (x) {\r\n                page.navigable.addContextMenu(\"#emojiContextMenu\", \"#emojiContextMenuButton\");\r\n            },\r\n            oninit: function(){\r\n                page.navigable.setupPendingContextMenus();\r\n            },\r\n            onupdate: function(){\r\n                page.navigable.setupPendingContextMenus();\r\n            },\r\n            view: function (x) {\r\n                return renderEmojiButton();\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    page.components.emoji = emoji;\r\n\r\n}());\r\n\n\n;/* === client/components/audio.js === */\n(function () {\r\n    let audioMap = {};\r\n    let audioSource = {};\r\n    let visualizers = {};\r\n    let recorder;\r\n    let upNext = [];\r\n\r\n    function newMagic8() {\r\n        return {\r\n            id: page.uid(),\r\n            audioMotionTop: undefined,\r\n            audioMotionBottom: undefined,\r\n            audio1: undefined,\r\n            audio1Content: undefined,\r\n            audio2: undefined,\r\n            audio2Content: undefined,\r\n            lastAudio: 0,\r\n            configuring: false,\r\n            lastContent: undefined // Track content changes\r\n        };\r\n    }\r\n\r\n    let magic8 = newMagic8();\r\n\r\n    function clearMagic8(audioMagic8) {\r\n\r\n        let preserveContent = magic8.lastContent;\r\n        upNext = [];\r\n\r\n        if (magic8.audio1) {\r\n            stopAudioSources(magic8.audio1);\r\n        }\r\n        if (magic8.audio2) {\r\n            stopAudioSources(magic8.audio2);\r\n        }\r\n\r\n        if (!audioMagic8) {\r\n            clearAudioSource();\r\n        }\r\n\r\n        if (magic8.audioMotionTop) {\r\n            magic8.audioMotionTop.stop();\r\n            magic8.audioMotionTop.destroy();\r\n        }\r\n        if (magic8.audioMotionBottom) {\r\n            magic8.audioMotionBottom.stop();\r\n            magic8.audioMotionBottom.destroy();\r\n        }\r\n\r\n        let canvasTop = document.getElementById(\"waveform-top\");\r\n        let canvasBottom = document.getElementById(\"waveform-bottom\");\r\n        if (canvasTop) canvasTop.innerHTML = \"\";\r\n        if (canvasBottom) canvasBottom.innerHTML = \"\";\r\n\r\n        if (magic8.audio1 && magic8.audio1.name) {\r\n            delete audioSource[magic8.audio1.name];\r\n        }\r\n        if (magic8.audio2 && magic8.audio2.name) {\r\n            delete audioSource[magic8.audio2.name];\r\n        }\r\n\r\n        magic8 = newMagic8();\r\n\r\n        if (audioMagic8) {\r\n            magic8.lastContent = preserveContent;\r\n        }\r\n    }\r\n\r\n    function configureMagic8(inst, chatCfg, audioMagic8, prune) {\r\n        if (!audioMagic8) {\r\n            return;\r\n        }\r\n\r\n        if (magic8.configuring) {\r\n            // console.warn(\"Magic8 is already configuring, skipping...\");\r\n            return;\r\n        }\r\n\r\n        let aMsg = chatCfg?.history?.messages;\r\n        if (!aMsg || !aMsg.length) {\r\n            return;\r\n        }\r\n\r\n        let messagesToProcess = aMsg.slice(-2);\r\n        let currentContent = messagesToProcess.map(m => m?.content || \"\").join(\"|\");\r\n\r\n        // If already configured with the same content AND visualizers exist, don't reconfigure\r\n        if (magic8.lastContent === currentContent && magic8.audioMotionTop && magic8.audioMotionBottom) {\r\n            /// console.log(\"Magic8 already configured with same content, skipping...\");\r\n            return;\r\n        }\r\n\r\n        // Check if canvases exist before proceeding\r\n        let canvasTop = document.getElementById(\"waveform-top\");\r\n        let canvasBottom = document.getElementById(\"waveform-bottom\");\r\n        if (!canvasTop || !canvasBottom) {\r\n            return;\r\n        }\r\n\r\n        let contentChanged = magic8.lastContent !== currentContent;\r\n\r\n        // Only clear and reconfigure if content has actually changed\r\n        if (contentChanged) {\r\n            //console.log(\"Magic8 content changed, reconfiguring...\");\r\n            clearMagic8(false);\r\n            magic8.lastContent = currentContent;\r\n        } else if (!magic8.audioMotionTop || !magic8.audioMotionBottom) {\r\n            // Only reconfigure visualizers if they don't exist but content is the same\r\n            //console.log(\"Magic8 visualizers missing, recreating...\");\r\n        } else {\r\n            // Everything is already configured properly\r\n            return;\r\n        }\r\n\r\n        magic8.configuring = true;\r\n        let aP = [];\r\n\r\n        // Get profile IDs\r\n        let sysProfileId = chatCfg?.system?.profile?.objectId;\r\n        let usrProfileId = chatCfg?.user?.profile?.objectId;\r\n        if (!sysProfileId || !usrProfileId) {\r\n            console.warn(\"No system or user profile for chat\");\r\n            magic8.configuring = false;\r\n            return;\r\n        }\r\n\r\n        // Only create new audio sources if content changed or they don't exist\r\n        if (contentChanged || !magic8.audio1 || !magic8.audio2) {\r\n            messagesToProcess.forEach((m, i) => {\r\n                if (!m) return;\r\n                // console.log(\"Processing Magic8 message:\", i, m.role, m.content?.substring(0, 30) + \"...\");\r\n                let actualIndex = aMsg.length - 1 + i;\r\n                let name = inst.api.objectId() + \" - \" + actualIndex;\r\n                let profId = (m.role == \"assistant\") ? sysProfileId : usrProfileId;\r\n\r\n                let cnt = prune ? prune(m.content) : m.content;\r\n                if (cnt.length) {\r\n                    aP.push(createAudioSource(name, profId, cnt).then((aud) => {\r\n                        if (!aud) return;\r\n\r\n                        aud.name = name; // Store name for cleanup\r\n\r\n                        if (m.role == \"assistant\") {\r\n                            console.log(\"Configure Magic8 audio 1 (assistant)\");\r\n                            magic8.audio1 = aud;\r\n                            magic8.audio1Content = cnt;\r\n                            magic8.lastAudio = 1;\r\n                        } else {\r\n                            console.log(\"Configure Magic8 audio 2 (user)\");\r\n                            magic8.audio2 = aud;\r\n                            magic8.audio2Content = cnt;\r\n                            magic8.lastAudio = 2;\r\n                        }\r\n                    }).catch(err => {\r\n                        console.error(\"Error creating audio source for Magic8:\", err);\r\n                    }));\r\n                }\r\n            });\r\n        }\r\n\r\n        Promise.all(aP).then(() => {\r\n            // Ensure we still have valid canvases after async operations\r\n            canvasTop = document.getElementById(\"waveform-top\");\r\n            canvasBottom = document.getElementById(\"waveform-bottom\");\r\n            if (!canvasTop || !canvasBottom) {\r\n                magic8.configuring = false;\r\n                return;\r\n            }\r\n\r\n            // Only create new visualizers if they don't exist\r\n            if (!magic8.audioMotionTop || !magic8.audioMotionBottom) {\r\n                let props = {\r\n                    overlay: true,\r\n                    bgAlpha: 0,\r\n                    gradient: 'prism',\r\n                    showBgColor: true,\r\n                    showSource: false,\r\n                    showScaleY: false,\r\n                    showScaleX: false\r\n                };\r\n\r\n                let props1 = Object.assign({ height: canvasTop.offsetHeight, source: magic8.audio1?.source }, props);\r\n                let props2 = Object.assign({ height: canvasBottom.offsetHeight, source: magic8.audio2?.source }, props);\r\n\r\n                magic8.audioMotionTop = new AudioMotionAnalyzer(canvasTop, props1);\r\n                magic8.audioMotionBottom = new AudioMotionAnalyzer(canvasBottom, props2);\r\n\r\n                // Set up click handlers\r\n                canvasTop.onclick = function (e) {\r\n                    togglePlayMagic8(magic8.audio1, magic8.audio2);\r\n                };\r\n                canvasBottom.onclick = function (e) {\r\n                    togglePlayMagic8(magic8.audio2, magic8.audio1);\r\n                };\r\n            }\r\n\r\n            // Clear any existing upNext queue to prevent old audio from auto-starting\r\n            upNext = [];\r\n\r\n            // Auto-start the most recent audio when content changes\r\n            if (contentChanged && magic8.lastAudio && magic8[\"audio\" + magic8.lastAudio]) {\r\n                let currentAudio = magic8[\"audio\" + magic8.lastAudio];\r\n                // console.log(\"Starting Magic8 audio after content change:\", magic8.lastAudio);\r\n                setTimeout(() => {\r\n                    togglePlayAudioSource(currentAudio, true);\r\n                }, 100);\r\n            }\r\n\r\n            magic8.configuring = false;\r\n            // console.log(\"Magic8 configuration complete\");\r\n        }).catch(err => {\r\n            console.error(\"Error configuring Magic8:\", err);\r\n            magic8.configuring = false;\r\n        });\r\n    }\r\n    let bgAudio = false;\r\n    let bgAnim = false;\r\n    let bgImg = true;\r\n    let images = [];\r\n    /// At the moment, this is just a group id \r\n    let imgBase = [132,1546,1545,1547]; \r\n    // let imgBase = [3261];\r\n    let imgUrl;\r\n    const imgCfg = {\r\n        isA_onTop: false,\r\n        isTransitioning: false,\r\n        imageA_src: undefined,\r\n        imageB_src: undefined\r\n    };\r\n\r\n    // The onload handler that triggers the visual transition\r\n    const imageTransition = () => {\r\n        // Prevent re-triggering during a transition\r\n        if (imgCfg.isTransitioning) return;\r\n        imgCfg.isTransitioning = true;\r\n        setTimeout(() => {\r\n            if (imgCfg.isA_onTop) {\r\n                imgCfg.imageA_src = images[Math.floor(Math.random() * images.length)];\r\n            }\r\n            else {\r\n                imgCfg.imageB_src = images[Math.floor(Math.random() * images.length)];\r\n            }\r\n            imgCfg.isA_onTop = !imgCfg.isA_onTop;\r\n            imgCfg.isTransitioning = false;\r\n            m.redraw();\r\n        }, 3000);\r\n    };\r\n\r\n    function getMagic8View(chatCfg, profile) {\r\n\r\n        // Get profile image URLs if available\r\n        let sysUrl, usrUrl;\r\n        if (profile) {\r\n            if (chatCfg.system?.profile?.portrait) {\r\n                let pp = chatCfg.system.profile.portrait;\r\n                sysUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/256x256\";\r\n            }\r\n            if (chatCfg.user?.profile?.portrait) {\r\n                let pp = chatCfg.user.profile.portrait;\r\n                usrUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/256x256\";\r\n            }\r\n        }\r\n\r\n        let gimg = \"\";\r\n        if (bgImg && !profile && imgBase.length && images.length == 0) {\r\n            // console.log(\"Loading magic8 images from base\", imgBase);\r\n            let q = am7client.newQuery(\"data.data\");\r\n            //q.field(\"groupId\", imgBase);\r\n            let qg = q.field(null, null);\r\n            qg.comparator = \"group_or\";\r\n            qg.fields = imgBase.map((a) => {\r\n                return {\r\n                    name: \"groupId\",\r\n                    comparator: \"equals\",\r\n                    value: a\r\n                }\r\n            });\r\n            q.range(0, 0);\r\n            imgBase = [];\r\n            page.search(q).then((res) => {\r\n\r\n                if (res && res.results) {\r\n                    images = res.results.map((r) => {\r\n                        return g_application_path + \"/media/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + r.groupPath + \"/\" + r.name;\r\n                    });\r\n                    imgCfg.imageA_src = images[Math.floor(Math.random() * images.length)];\r\n                    imgCfg.imageB_src = images[Math.floor(Math.random() * images.length)];\r\n\r\n                    m.redraw();\r\n                }\r\n            });\r\n        }\r\n        if (bgImg && images.length > 0) {\r\n            const imageClasses = 'absolute top-0 left-0 w-full h-full rounded-full object-cover transition-all ease-in-out duration-300';\r\n\r\n            gimg = m(\"div\", { class: 'relative w-full h-full' }, [\r\n                // Image A\r\n                m(\"img\", {\r\n                    key: 'A',\r\n                    objectFit: \"contain\",\r\n                    objectPosition: \"center\",\r\n                    src: imgCfg.imageA_src,\r\n                    class: `${imageClasses} ${imgCfg.isA_onTop && imgCfg.isTransitioning ? 'opacity-0 blur-md' : 'opacity-50 dark:opacity-50 blur-0'}`,\r\n                    onload: !imgCfg.isA_onTop ? imageTransition : null,\r\n                    onerror: ()=> {page.toast(\"error\", \"Failed to load image: \" + imgCfg.imageA_src); imageTransition();}\r\n                }),\r\n                // Image B\r\n                m(\"img\", {\r\n                    key: 'B',\r\n                    objectFit: \"contain\",\r\n                    objectPosition: \"center\",\r\n                    src: imgCfg.imageB_src,\r\n                    class: `${imageClasses} ${!imgCfg.isA_onTop && imgCfg.isTransitioning ? 'opacity-0 blur-md' : 'opacity-50 dark:opacity-50 blur-0'}`,\r\n                    onload: imgCfg.isA_onTop ? imageTransition : null,\r\n                    onerror: ()=> {page.toast(\"error\", \"Failed to load image: \" + imgCfg.imageB_src); imageTransition();}\r\n                })\r\n            ]);\r\n\r\n        }\r\n\r\n        // bg-gradient-to-br from-slate-100 via-slate-200 to-slate-300 shadow-[inset_0_10px_20px_rgba(255,255,255,0.1),inset_0_-10px_20px_rgba(0,0,0,0.2)]\r\n        return m(\"div\", {\r\n            key: \"magic8-container\", // Use a stable key instead of magic8.id\r\n            class: `\r\n      relative aspect-square w-[90vw] max-w-[800px] max-h-[800px] mx-auto\r\n      rounded-full overflow-hidden\r\n      \r\n      ring-2 ring-white/20\r\n    `\r\n        }, [\r\n            !sysUrl && !usrUrl && gimg,\r\n            // System (assistant) profile image - upper hemisphere\r\n            sysUrl && m(\"div\", {\r\n                class: `\r\n        absolute top-0 left-0 w-full h-1/2 z-0\r\n        pointer-events-none\r\n        opacity-60 blur-sm\r\n        bg-cover\r\n      `,\r\n                style: {\r\n                    backgroundImage: `url('${sysUrl}')`,\r\n                    backgroundPosition: \"top center\"\r\n                }\r\n            }),\r\n\r\n            // User profile image - lower hemisphere\r\n            usrUrl && m(\"div\", {\r\n                class: `\r\n        absolute bottom-0 left-0 w-full h-1/2 z-0\r\n        pointer-events-none\r\n        opacity-60 blur-sm\r\n        bg-cover\r\n      `,\r\n                style: {\r\n                    backgroundImage: `url('${usrUrl}')`,\r\n                    backgroundPosition: \"top center\"\r\n                }\r\n            }),\r\n\r\n            // Top waveform canvas\r\n            m(\"div\", {\r\n                id: \"waveform-top\",\r\n                class: `\r\n        absolute top-0 left-0 w-full h-1/2 z-10\r\n      `\r\n            }),\r\n\r\n            // Bottom waveform canvas (inverted)\r\n            m(\"div\", {\r\n                id: \"waveform-bottom\",\r\n                class: `\r\n        absolute bottom-0 left-0 w-full h-1/2 z-10\r\n        transform scale-y-[-1]\r\n      `\r\n            }),\r\n            /// bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.15)_0%,transparent_70%)]\r\n            // ...rest of your overlays and effects...\r\n            m(\"div\", {\r\n                class: `\r\n        absolute inset-0 rounded-full pointer-events-none\r\n        \r\n      `\r\n            }),\r\n            // bg-[radial-gradient(circle_at_30%_30%,rgba(255,255,255,0.3)_0%,transparent_40%)]\r\n            m(\"div\", {\r\n                class: `\r\n        absolute top-0 left-0 w-full h-full pointer-events-none rounded-full\r\n        \r\n        mix-blend-screen\r\n      `\r\n            }),\r\n            // bg-gradient-to-t from-black/20 to-transparent\r\n            m(\"div\", {\r\n                class: `\r\n        absolute bottom-0 left-0 w-full h-1/2\r\n        \r\n        pointer-events-none\r\n      `\r\n            }),\r\n            bgAnim && m(\"canvas\", {\r\n                id: \"spiral-overlay\",\r\n                class: `\r\n                    absolute z-20 pointer-events-none\r\n                    opacity-20 w-full h-full top-0 left-0\r\n                `,\r\n                oncreate: ({ dom }) => {\r\n                    drawSpiral(dom);\r\n                    //drawMandala(dom);\r\n                }\r\n            })\r\n        ]);\r\n    }\r\n\r\n    function drawMandala(canvas) {\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const width = canvas.width = canvas.offsetWidth;\r\n        const height = canvas.height = canvas.offsetHeight;\r\n        const centerX = width / 2;\r\n        const centerY = height / 2;\r\n\r\n        let frame = 0;\r\n\r\n        function animate() {\r\n            ctx.clearRect(0, 0, width, height);\r\n            ctx.save();\r\n\r\n            const pulse = 1 + 0.08 * Math.sin(frame * 0.02); // gentle scale\r\n            const rotation = frame * 0.002;\r\n            const hue = (frame * 0.6) % 360;\r\n            const petals = 12;\r\n            const layers = 4;\r\n\r\n            ctx.translate(centerX, centerY);\r\n            ctx.scale(pulse, pulse);\r\n            ctx.rotate(rotation);\r\n\r\n            for (let layer = 0; layer < layers; layer++) {\r\n                const radius = 60 + layer * 30;\r\n                const petalLength = 30 + layer * 10;\r\n                const petalWidth = 12;\r\n\r\n                for (let i = 0; i < petals; i++) {\r\n                    const angle = (i * 2 * Math.PI) / petals;\r\n\r\n                    const x = radius * Math.cos(angle);\r\n                    const y = radius * Math.sin(angle);\r\n\r\n                    ctx.save();\r\n                    ctx.translate(x, y);\r\n                    ctx.rotate(angle + rotation);\r\n\r\n                    ctx.beginPath();\r\n                    ctx.ellipse(0, 0, petalWidth, petalLength, 0, 0, 2 * Math.PI);\r\n                    ctx.strokeStyle = `hsl(${(hue + i * 30) % 360}, 100%, 75%)`;\r\n                    ctx.shadowColor = ctx.strokeStyle;\r\n                    ctx.shadowBlur = 8;\r\n                    ctx.lineWidth = 2;\r\n                    ctx.stroke();\r\n\r\n                    ctx.restore();\r\n                }\r\n            }\r\n\r\n            ctx.restore();\r\n            frame++;\r\n            requestAnimationFrame(animate);\r\n        }\r\n\r\n        animate();\r\n    }\r\n\r\n    function drawSpiral(canvas) {\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const width = canvas.width = canvas.offsetWidth;\r\n        const height = canvas.height = canvas.offsetHeight;\r\n        const centerX = width / 2;\r\n        const centerY = height / 2;\r\n\r\n        let frame = 0;\r\n        let spiralSpeed = 0.01;\r\n        let pulseSpeed = 0.005;\r\n        let hue = 0;\r\n\r\n        function animate() {\r\n            ctx.clearRect(0, 0, width, height);\r\n\r\n            const pulse = 1 + 0.1 * Math.sin(frame * pulseSpeed); // gentle scale\r\n\r\n            // Color cycling: hue shift over time\r\n            hue = (frame * 0.5) % 360;\r\n            const strokeColor = `hsl(${hue}, 100%, 80%)`;\r\n\r\n            ctx.beginPath();\r\n            ctx.strokeStyle = strokeColor;\r\n            ctx.shadowColor = strokeColor;\r\n            ctx.shadowBlur = 10;\r\n            ctx.lineWidth = 2;\r\n\r\n            let angle = 0;\r\n            let radius = 0;\r\n            ctx.moveTo(centerX, centerY);\r\n\r\n            for (let i = 0; i < 2000; i++) {\r\n                radius = i * 0.1 * pulse;\r\n                angle += 0.02;\r\n                const x = centerX + radius * Math.cos(angle + frame * spiralSpeed);\r\n                const y = centerY + radius * Math.sin(angle + frame * spiralSpeed);\r\n                ctx.lineTo(x, y);\r\n            }\r\n\r\n            ctx.stroke();\r\n            frame++;\r\n            requestAnimationFrame(animate);\r\n        }\r\n\r\n        animate();\r\n    }\r\n\r\n    function newRecorder() {\r\n        return {\r\n            uid: page.uid\r\n        }\r\n    }\r\n\r\n    function togglePlayAudio(id) {\r\n        let aud = document.getElementById(id);\r\n        if (!aud) return;\r\n        aud.paused ? aud.play() : aud.pause();\r\n    }\r\n\r\n    function isStreamSilent() {\r\n        if (!recorder || !recorder.analyzer) {\r\n            console.warn(\"Analyzer not available\", recorder?.analyzer);\r\n            return;\r\n        }\r\n        let threshold = 3;\r\n        let bufferLength = recorder.analyzer.fftSize;\r\n        let dataArray = new Uint8Array(bufferLength);\r\n\r\n        // Get the current waveform data\r\n        recorder.analyzer.getByteTimeDomainData(dataArray);\r\n\r\n        // Find the maximum amplitude in the buffer\r\n        let maxAmplitude = 0;\r\n        for (let i = 0; i < bufferLength; i++) {\r\n            // The values are 0-255, with 128 being the center (silence)\r\n            let amplitude = Math.abs(dataArray[i] - 128);\r\n            if (amplitude > maxAmplitude) {\r\n                maxAmplitude = amplitude;\r\n            }\r\n        }\r\n        console.log(maxAmplitude + \" < \" + threshold);\r\n        return maxAmplitude <= threshold;\r\n    }\r\n\r\n    /// currently only setup for live streaming to extract text, not to actually record the audio\r\n    ///\r\n    function recordWithVisualizer(stream, handler, saveHandler, options = {}) {\r\n        if (recorder) {\r\n            return recorder.view;\r\n        }\r\n\r\n        // Default options\r\n        let config = {\r\n            maxSilenceSeconds: options.maxSilenceSeconds || null, // null = no auto-stop\r\n            silenceThreshold: options.silenceThreshold || 3,\r\n            chunkInterval: options.chunkInterval || 2000,\r\n            autoRestart: options.autoRestart !== false, // default true\r\n            maxSilenceBeforeRestart: options.maxSilenceBeforeRestart || 5\r\n        };\r\n\r\n        recorder = newRecorder();\r\n\r\n        recorder.view = m(\"div\", {\r\n            id: \"recorder-visualizer\",\r\n            class: \"w-[80%]\",\r\n            oncreate: function (vnode) {\r\n                // Check if a visualizer is already running\r\n                if (visualizers.recorder) {\r\n                    try {\r\n                        visualizers.recorder.destroy();\r\n                    } catch (e) {\r\n                        console.warn(\"Error destroying existing visualizer:\", e);\r\n                    }\r\n                    delete visualizers.recorder;\r\n                }\r\n\r\n                navigator.mediaDevices.getUserMedia({\r\n                    audio: {\r\n                        echoCancellation: true,\r\n                        noiseSuppression: true,\r\n                        autoGainControl: true\r\n                    }\r\n                })\r\n                    .then(mediaStream => {\r\n                        let audioCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n                        let analyzer = audioCtx.createAnalyser();\r\n                        analyzer.fftSize = 2048;\r\n                        analyzer.smoothingTimeConstant = 0.8;\r\n\r\n                        recorder.analyzer = analyzer;\r\n                        recorder.context = audioCtx;\r\n                        recorder.stream = mediaStream;\r\n\r\n                        let source = audioCtx.createMediaStreamSource(mediaStream);\r\n                        source.connect(analyzer);\r\n\r\n                        let props = {\r\n                            source: analyzer,\r\n                            height: 40,\r\n                            overlay: true,\r\n                            bgAlpha: 0,\r\n                            gradient: 'prism',\r\n                            showBgColor: true,\r\n                            showSource: false,\r\n                            showScaleY: false,\r\n                            showScaleX: false,\r\n                            volume: 0\r\n                        };\r\n\r\n                        try {\r\n                            recorder.motionAnalyzer = new AudioMotionAnalyzer(vnode.dom, props);\r\n                            recorder.motionAnalyzer.volume = 0;\r\n                            visualizers.recorder = recorder.motionAnalyzer;\r\n                        } catch (e) {\r\n                            console.error(\"Error creating AudioMotionAnalyzer:\", e);\r\n                            vnode.dom.textContent = \"Error: Could not create audio visualizer.\";\r\n                            return;\r\n                        }\r\n\r\n                        let chunks = [];\r\n                        let mediaRecorder;\r\n\r\n                        try {\r\n                            mediaRecorder = new MediaRecorder(mediaStream, {\r\n                                mimeType: 'audio/webm;codecs=opus'\r\n                            });\r\n                        } catch (e) {\r\n                            try {\r\n                                mediaRecorder = new MediaRecorder(mediaStream);\r\n                            } catch (e2) {\r\n                                console.error(\"MediaRecorder not supported:\", e2);\r\n                                vnode.dom.textContent = \"Error: Recording not supported in this browser.\";\r\n                                return;\r\n                            }\r\n                        }\r\n\r\n                        recorder.recorder = mediaRecorder;\r\n\r\n                        let silenceCount = 0;\r\n                        let totalSilenceTime = 0;\r\n                        let silenceStartTime = null;\r\n                        let isCurrentlySilent = false;\r\n\r\n                        function ab_b64(buf) {\r\n                            return btoa(buf.reduce(\r\n                                function (data, val) {\r\n                                    return data + String.fromCharCode(val);\r\n                                },\r\n                                \"\"\r\n                            ));\r\n                        }\r\n\r\n                        async function getAudioBase64(blob) {\r\n                            try {\r\n                                let buff = await blob.arrayBuffer();\r\n                                return ab_b64(new Uint8Array(buff));\r\n                            } catch (e) {\r\n                                console.error(\"Error converting audio to base64:\", e);\r\n                                return null;\r\n                            }\r\n                        }\r\n\r\n                        async function sendChunk(chunk, close = false) {\r\n                            try {\r\n                                window.dbgBlob = chunk;\r\n                                // console.log(\"Sending chunk...\", chunk.size, \"bytes\");\r\n                                let b64 = await getAudioBase64(chunk);\r\n\r\n                                if (b64 && page.wss) {\r\n                                    await page.wss.send(\"audio\", b64, undefined, undefined);\r\n                                }\r\n\r\n                                if (close) {\r\n                                    page.audioStream = undefined;\r\n                                }\r\n                            } catch (e) {\r\n                                console.error(\"Error sending audio chunk:\", e);\r\n                            }\r\n                        }\r\n\r\n                        function checkSilence() {\r\n                            let isSilent = isStreamSilent();\r\n                            let currentTime = Date.now();\r\n\r\n                            if (isSilent && !isCurrentlySilent) {\r\n                                // Just became silent\r\n                                isCurrentlySilent = true;\r\n                                silenceStartTime = currentTime;\r\n                            } else if (!isSilent && isCurrentlySilent) {\r\n                                // Just stopped being silent\r\n                                if (silenceStartTime) {\r\n                                    let silenceDuration = (currentTime - silenceStartTime) / 1000;\r\n                                    totalSilenceTime += silenceDuration;\r\n                                }\r\n                                isCurrentlySilent = false;\r\n                                silenceStartTime = null;\r\n                                silenceCount = 0; // Reset restart counter on speech\r\n                            }\r\n\r\n                            return isSilent;\r\n                        }\r\n\r\n                        mediaRecorder.ondataavailable = event => {\r\n                            try {\r\n                                if (event.data && event.data.size > 0) {\r\n                                    let isSilent = checkSilence();\r\n\r\n                                    if (!isSilent) {\r\n                                        chunks.push(event.data);\r\n                                        if (mediaStream && !mediaStream.getTracks().some(t => !t.enabled)) {\r\n                                            sendChunk(event.data);\r\n                                        }\r\n                                    } else {\r\n                                        silenceCount++;\r\n\r\n                                        // Check for auto-restart based on silence chunks\r\n                                        if (config.autoRestart && silenceCount >= config.maxSilenceBeforeRestart) {\r\n                                            console.log(\"Restarting recorder due to prolonged silence...\");\r\n                                            silenceCount = 0;\r\n\r\n                                            try {\r\n                                                mediaRecorder.stop();\r\n                                                setTimeout(() => {\r\n                                                    if (recorder && recorder.recorder && recorder.recorder.state === 'inactive') {\r\n                                                        mediaRecorder.start(config.chunkInterval);\r\n                                                    }\r\n                                                }, 100);\r\n                                            } catch (e) {\r\n                                                console.error(\"Error restarting recorder:\", e);\r\n                                            }\r\n                                        }\r\n\r\n                                        // Check for auto-stop based on total silence time\r\n                                        if (config.maxSilenceSeconds) {\r\n                                            let currentSilenceTime = isCurrentlySilent && silenceStartTime ?\r\n                                                (Date.now() - silenceStartTime) / 1000 : 0;\r\n                                            let totalCurrentSilence = totalSilenceTime + currentSilenceTime;\r\n\r\n                                            if (totalCurrentSilence >= config.maxSilenceSeconds) {\r\n                                                console.log(`Auto-stopping recording after ${totalCurrentSilence}s of silence`);\r\n                                                toggleRecord(); // Stop recording\r\n                                                return;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                } else {\r\n                                    console.warn(\"No audio data in chunk\");\r\n                                }\r\n                            } catch (e) {\r\n                                console.error(\"Error processing audio data:\", e);\r\n                            }\r\n                        };\r\n\r\n                        mediaRecorder.onstop = () => {\r\n                            try {\r\n                                console.log(\"MediaRecorder stopped, processing\", chunks.length, \"chunks\");\r\n\r\n                                if (chunks.length === 0) {\r\n                                    console.warn(\"No audio chunks to process\");\r\n                                    return;\r\n                                }\r\n\r\n                                let audioBlob = new Blob(chunks, {\r\n                                    type: mediaRecorder.mimeType || 'audio/webm'\r\n                                });\r\n\r\n                                console.log(\"Created audio blob:\", audioBlob.size, \"bytes\");\r\n\r\n                                // Send final chunk if not streaming\r\n                                if (!mediaStream || mediaStream.getTracks().some(t => !t.enabled)) {\r\n                                    sendChunk(audioBlob, true);\r\n                                }\r\n\r\n                                // Save if handler provided\r\n                                if (saveHandler) {\r\n                                    getAudioBase64(audioBlob).then((b64) => {\r\n                                        if (b64) {\r\n                                            saveHandler(mediaRecorder.mimeType || \"audio/webm\", b64);\r\n                                        }\r\n                                    }).catch(e => {\r\n                                        console.error(\"Error saving audio:\", e);\r\n                                    });\r\n                                }\r\n\r\n                                chunks = []; // Clear chunks\r\n                            } catch (e) {\r\n                                console.error(\"Error in onstop handler:\", e);\r\n                            }\r\n                        };\r\n\r\n                        mediaRecorder.onerror = (event) => {\r\n                            console.error(\"MediaRecorder error:\", event.error);\r\n                            page.toast(\"error\", \"Recording error: \" + (event.error?.message || \"Unknown error\"));\r\n                        };\r\n\r\n                        // Initialize audio stream handler\r\n                        if (handler) {\r\n                            page.audioStream = newAudioStream(handler);\r\n                        }\r\n\r\n                        // Start recording\r\n                        try {\r\n                            mediaRecorder.start(config.chunkInterval);\r\n                            console.log(\"Recording started with config:\", config);\r\n                        } catch (e) {\r\n                            console.error(\"Error starting recorder:\", e);\r\n                            vnode.dom.textContent = \"Error: Could not start recording.\";\r\n                        }\r\n\r\n                    }).catch(err => {\r\n                        console.error('Error accessing microphone:', err);\r\n                        let errorMsg = \"Error: Could not access microphone.\";\r\n\r\n                        if (err.name === 'NotAllowedError') {\r\n                            errorMsg = \"Error: Microphone access denied. Please allow microphone access and try again.\";\r\n                        } else if (err.name === 'NotFoundError') {\r\n                            errorMsg = \"Error: No microphone found. Please check your audio devices.\";\r\n                        } else if (err.name === 'NotReadableError') {\r\n                            errorMsg = \"Error: Microphone is being used by another application.\";\r\n                        }\r\n\r\n                        vnode.dom.textContent = errorMsg;\r\n                        page.toast(\"error\", errorMsg);\r\n                    });\r\n            },\r\n\r\n            onremove: function () {\r\n                stopRecording();\r\n            }\r\n        });\r\n\r\n        return recorder?.view || \"\";\r\n    }\r\n\r\n    function newAudioStream(h) {\r\n        return {\r\n            onaudioupdate: (v) => {\r\n\r\n            },\r\n            onaudiosttupdate: (m) => {\r\n                if (h) {\r\n                    h(m);\r\n                }\r\n            },\r\n            onaudiouerror: (v) => {\r\n\r\n            }\r\n        };\r\n    }\r\n\r\n    function stopRecording() {\r\n        if (recorder) {\r\n            if (recorder.recorder) {\r\n                recorder.recorder.stop();\r\n            }\r\n            if (recorder.stream) {\r\n                recorder.stream.getTracks().forEach(track => track.stop());\r\n            }\r\n            if (recorder.motionAnalyzer) {\r\n                recorder.motionAnalyzer.destroy();\r\n            }\r\n            recorder = undefined;\r\n        }\r\n    }\r\n\r\n    function extractText(dataB64) {\r\n        window.dbgBase64 = dataB64;\r\n        let vprops = { \"audio_sample\": dataB64, \"uid\": page.uid() };\r\n        m.request({ method: 'POST', url: g_application_path + \"/rest/voice/tts\", withCredentials: true, body: vprops }).then((d) => {\r\n            console.log(\"Received\", d);\r\n        }).catch((x) => {\r\n            page.toast(\"error\", \"Failed to extract text from audio - is the audio service running?\");\r\n        });\r\n\r\n    }\r\n\r\n    function clearAudioSource() {\r\n        // console.error(\"Clear audio sources\");\r\n        for (let id in audioSource) {\r\n            let aud = audioSource[id];\r\n            if (aud && aud.started && aud.context.state != \"closed\") {\r\n                // aud.source.stop();\r\n                aud.context.close();\r\n            }\r\n        }\r\n        audioSource = {};\r\n        audioMap = {};\r\n\r\n    }\r\n    function unconfigureAudio(enabled) {\r\n        if (enabled) return;\r\n        //clearMagic8(true);\r\n        // console.info(\"Unconfiguring audio visualizers\");\r\n\r\n        upNext = [];\r\n        clearAudioSource();\r\n        for (let id in visualizers) {\r\n\r\n            if (visualizers[id]) {\r\n                if (!visualizers[id].pending && !visualizers[id].lateLoad) {\r\n                    visualizers[id].stop();\r\n                    visualizers[id].destroy();\r\n                }\r\n                delete visualizers[id];\r\n            }\r\n        }\r\n    }\r\n\r\n    function configureVisualizer(aud, autoPlay) {\r\n        let props = {\r\n            height: 60,\r\n            overlay: true,\r\n            bgAlpha: 0,\r\n            showBgColor: true,\r\n            showSource: false,\r\n            gradient: \"prism\",\r\n            showScaleY: false,\r\n            showScaleX: false\r\n        };\r\n\r\n        if (visualizers[aud.id] && !visualizers[aud.id].lateLoad) {\r\n            /// console.warn(\"Audio visualizer already configured for\", aud.id);\r\n            return;\r\n        }\r\n\r\n        visualizers[aud.id] = { pending: true };\r\n\r\n        let oM = getAudioMapForContainer(aud.id);\r\n        if (!oM) {\r\n            console.warn(\"Failed to find map for \" + aud.id);\r\n            console.warn(audioMap);\r\n            return;\r\n        }\r\n        console.info(\"Configuring audio visualizer for\", aud.id, oM.name);\r\n        //let cont = aud.parentNode;\r\n\r\n        createAudioSource(oM.name, oM.profileId, oM.content).then((o) => {\r\n            if (!o) {\r\n                console.warn(\"Failed to retrieve audio source\", oM.name);\r\n                console.warn(audioMap);\r\n                console.warn(audioSource);\r\n                return;\r\n            }\r\n            let props1 = Object.assign({ source: o.source, onclick: function () { togglePlayAudioSource(o); } }, props);\r\n            let audioMotion = new AudioMotionAnalyzer(aud, props1);\r\n            visualizers[aud.id] = audioMotion;\r\n            if (autoPlay || oM.autoPlay) {\r\n                if (getRunningAudioSources().length > 0) {\r\n                    upNext.push(o);\r\n                }\r\n                else {\r\n                    togglePlayAudioSource(o);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    function configureAudio(enabled) {\r\n        if (!enabled) {\r\n            // unconfigureAudio();\r\n            return;\r\n        }\r\n        //let aa = document.querySelectorAll(\"audio\");\r\n        let aa = document.querySelectorAll(\"div[id*='chatAudioContainer-']\");\r\n\r\n        for (let i = 0; i < aa.length; i++) {\r\n            let aud = aa[i];\r\n            if (visualizers[aud.id]) continue;\r\n            if (i < (aa.length - 2)) {\r\n                visualizers[aud.id] = { lateLoad: true };\r\n            }\r\n            else {\r\n                configureVisualizer(aud);\r\n            }\r\n        }\r\n    }\r\n\r\n    function getAudioMapForContainer(containerId) {\r\n        let aM = Object.values(audioMap).filter(k => k.containerId == containerId);\r\n        if (!aM.length) {\r\n            return;\r\n        }\r\n        return aM[0];\r\n    }\r\n\r\n    function getRunningAudioSources() {\r\n        return Object.values(audioSource).filter(aud => aud.started && aud.context.state == \"running\");\r\n    }\r\n\r\n    function stopAudioSources(aud) {\r\n        let running = getRunningAudioSources();\r\n\r\n        running.forEach(r => {\r\n            console.log(\"Stopping other audio sources\", r.id, aud?.id, (r.id != aud?.id), r);\r\n            if (!aud || r.id != aud.id) {\r\n                togglePlayAudioSource(r, false, true);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    function togglePlayMagic8(aud, aud2) {\r\n        // console.log(\"Toggle play Magic8\", aud, aud2);\r\n        togglePlayAudioSource(aud, true);\r\n    }\r\n\r\n    function togglePlayAudioSource(aud, autoStop, noStart) {\r\n        if (autoStop) {\r\n            upNext = [];\r\n        }\r\n        if (typeof aud == \"string\") {\r\n            if (visualizers[aud] && visualizers[aud].lateLoad) {\r\n                console.log(\"Late configure visualizer\", aud);\r\n                stopAudioSources();\r\n                configureVisualizer(document.querySelectorAll(\"div[id*='\" + aud + \"']\")[0], true);\r\n                return;\r\n            }\r\n\r\n            let am = getAudioMapForContainer(aud);\r\n            if (am && audioSource[am.name]) {\r\n                aud = audioSource[am.name];\r\n            }\r\n\r\n        }\r\n        if (!aud) {\r\n            console.warn(\"Invalid audio reference\");\r\n            return;\r\n        }\r\n\r\n        if (autoStop) {\r\n            stopAudioSources(aud);\r\n        }\r\n        if(noStart){\r\n            return;\r\n        }\r\n        // console.warn(\"Starting audio source\", aud);\r\n        if (!aud.started) {\r\n            if(aud.context){\r\n                if (aud.context.state === \"suspended\") {\r\n                    aud.context.resume().then(() => {\r\n                        try { aud.source.start(0); } catch { }\r\n                        aud.started = true;\r\n                    });\r\n                } else if (aud.context.state === \"running\") {\r\n                    aud.source.start(0);\r\n                    aud.started = true;\r\n                } else {\r\n                    console.warn(\"Handle state \" + aud.context.state, audio.context);\r\n                }\r\n            }\r\n            else{\r\n                console.warn(\"Audio context not available\");\r\n            }\r\n\r\n            // Re-create the source node for every playback to avoid DOMException\r\n            aud.source = aud.context.createBufferSource();\r\n            aud.source.buffer = aud.buffer;\r\n            aud.source.connect(aud.context.destination);\r\n            aud.source.start(0);\r\n            aud.started = true;\r\n\r\n        } else if (aud.context.state == \"suspended\") {\r\n            console.log(\"Resume\");\r\n            aud.context.resume();\r\n        } else if (aud.context.state != \"closed\") {\r\n            console.log(\"Suspend\");\r\n            aud.context.suspend();\r\n        } else {\r\n            console.error(\"Handle state \" + aud.context.state);\r\n        }\r\n\r\n        aud.source.onended = function () {\r\n            aud.started = false;\r\n            if (upNext.length > 0) {\r\n                togglePlayAudioSource(upNext.shift());\r\n            }\r\n        };\r\n    }\r\n\r\n    function createAudioVisualizer(name, idx, profileId, autoPlay, content) {\r\n        let contId = \"chatAudioContainer-\" + (idx);\r\n        let aud = m(\"div\", { class: \"audio-container block w-full\", id: \"chatAudioContainer-\" + (idx), onclick: function () { togglePlayAudioSource(contId, true); } }, \"\");\r\n        if (!audioMap[name]) {\r\n            audioMap[name] = { id: page.uid(), index: idx, name, profileId, content, autoPlay, containerId: contId, pending: false };\r\n        }\r\n\r\n        return aud;\r\n    }\r\n\r\n    function base64ToArrayBuffer(base64) {\r\n        let cleanedBase64 = base64.replace(/^data:audio\\/\\w+;base64,/, '');\r\n\r\n        let binaryString = atob(cleanedBase64);\r\n        let len = binaryString.length;\r\n        let bytes = new Uint8Array(len);\r\n\r\n        for (let i = 0; i < len; i++) {\r\n            bytes[i] = binaryString.charCodeAt(i);\r\n        }\r\n\r\n        return bytes.buffer;\r\n    }\r\n\r\n    async function createAudioSource(name, profileId, content) {\r\n        if (content) {\r\n            /// Strip emojis out - https://stackoverflow.com/questions/10992921/how-to-remove-emoji-code-using-javascript\r\n            content = content.replace(/([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g, \"\");\r\n            /// Escape quotes\r\n            content = content.replace(/[\"\\*]+/g, \"\");\r\n        }\r\n        let tmpAud;\r\n        if (!content || content.length == 0) {\r\n            console.warn(\"No content provided for audio source creation\");\r\n            return;\r\n        }\r\n        if (!audioMap[name]) {\r\n            tmpAud = audioMap[name] = { name, profileId, content, pending: false };\r\n        }\r\n        if (!audioMap[name].data && !audioMap[name].pending) {\r\n            audioMap[name].pending = true;\r\n            let vprops = { \"text\": content, \"speed\": 1.2, voiceProfileId: profileId };\r\n            if (!vprops.voiceProfileId) {\r\n                vprops.engine = \"piper\";\r\n                vprops.speaker = \"en_GB-alba-medium\";\r\n            }\r\n            console.log(\"Synthesize '\" + name + \"'\");\r\n            let d;\r\n            try {\r\n                d = await m.request({ method: 'POST', url: g_application_path + \"/rest/voice/\" + name, withCredentials: true, body: vprops });\r\n            }\r\n            catch (e) {\r\n                console.error(\"Error synthesizing audio:\", e);\r\n                console.error(vprops);\r\n            }\r\n            if (!audioMap[name]) {\r\n                console.error(\"Ruh-Roh, Raggy\");\r\n                audioMap[name] = tmpAud;\r\n            }\r\n            if (d) {\r\n                audioMap[name].data = d;\r\n                audioMap[name].pending = false;\r\n            }\r\n            else {\r\n                page.toast(\"error\", \"Failed to synthesize audio - is the audio service running?\");\r\n                audioMap[name].error = true;\r\n                audioMap[name].pending = false;\r\n            };\r\n        }\r\n\r\n        if (audioMap[name] && audioMap[name].data && !audioMap[name].error && !audioMap[name].pending) {\r\n\r\n            let o = audioMap[name].data;\r\n            if (!audioSource[name]) {\r\n                let audioContext = new AudioContext();\r\n                let audioBuffer = await audioContext.decodeAudioData(base64ToArrayBuffer(o.dataBytesStore));\r\n                let sourceNode = audioContext.createBufferSource();\r\n                sourceNode.buffer = audioBuffer;\r\n                audioSource[name] = {\r\n                    id: page.uid(),\r\n                    context: audioContext,\r\n                    buffer: audioBuffer,\r\n                    started: false,\r\n                    source: sourceNode\r\n                }\r\n            }\r\n        }\r\n        return audioSource[name];\r\n    }\r\n\r\n    let recording = false;\r\n\r\n    function toggleRecord() {\r\n        recording = !recording;\r\n    }\r\n\r\n    function recordButton() {\r\n        return m(\"button\", { class: \"button\", onclick: toggleRecord }, m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"adaptive_audio_mic\" + (recording ? \"\" : \"_off\")));\r\n    }\r\n\r\n    function recordField(ctl) {\r\n        if (!recognition) {\r\n            // Find the correct SpeechRecognition object for the browser\r\n            let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n\r\n            // Check if the browser supports the API\r\n            if (SpeechRecognition) {\r\n                recognition = new SpeechRecognition();\r\n\r\n                // --- Configuration ---\r\n                recognition.continuous = true; // Keep listening even after a pause\r\n                recognition.lang = 'en-US';    // Set the language\r\n                recognition.interimResults = true; // Get results as they are being spoken\r\n            } else {\r\n                // If not supported, check for specific browsers and show a message.\r\n                const ua = navigator.userAgent.toLowerCase();\r\n                if (ua.includes(\"firefox\")) {\r\n                    page.toast(\"info\", \"To enable speech-to-text, go to about:config and set media.webspeech.recognition.enable to true.\", 10000);\r\n                } else if (navigator.brave) {\r\n                     page.toast(\"info\", \"To enable speech-to-text in Brave, go to brave://settings/shields and set 'Fingerprinting blocking' to 'Standard' or 'Allow all'.\", 10000);\r\n                }\r\n\r\n                // If not supported, return an empty element so nothing is rendered.\r\n                return m.fragment(\"\");\r\n            }\r\n        }\r\n\r\n        // The rest of the function remains the same as it was correctly implemented in the previous step.\r\n\r\n        let currentHandler;\r\n        let finalTranscript = '';\r\n\r\n        return m('button.button', {\r\n            class: (recording ? 'active animate-pulse' : '') + \" p-1\",\r\n            onclick: function (e) {\r\n                if (recording) {\r\n                    recognition.stop();\r\n                    return;\r\n                }\r\n\r\n                let baseText = ctl(null);\r\n                if(baseText && baseText.length > 0) baseText += \" \";\r\n\r\n                recording = true;\r\n                finalTranscript = '';\r\n\r\n                recognition.onresult = (event) => {\r\n                    let interimTranscript = '';\r\n                    for (let i = event.resultIndex; i < event.results.length; ++i) {\r\n                        const transcript = event.results[i][0].transcript;\r\n                        if (event.results[i].isFinal) {\r\n                            finalTranscript += transcript.trim() + ' ';\r\n                            baseText += transcript.trim() + ' ';\r\n                        } else {\r\n                            interimTranscript += transcript;\r\n                        }\r\n                    }\r\n                    ctl(baseText + interimTranscript);\r\n                    m.redraw();\r\n                };\r\n\r\n                recognition.onend = () => {\r\n                    recording = false;\r\n                    m.redraw();\r\n                };\r\n                recognition.start();\r\n            },\r\n        }, m('span.material-symbols-outlined.material-icons-20', recording ? 'mic' : 'mic_off'));\r\n    }\r\n\r\n    let recognition;\r\n\r\n\r\n    \r\n    let toneCtx;\r\n    let leftOsc, rightOsc;\r\n    let leftGain, rightGain;\r\n    let masterGain;\r\n    let merger;\r\n    let baseFreq = 440;\r\n    let minBeat = 4;\r\n    let maxBeat = 6;\r\n    let sweepDurationMin = 10;\r\n    let sweepInterval;\r\n\r\n    function startBinauralSweep() {\r\n        if(!bgAudio){\r\n            return;\r\n        }\r\n        toneCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n\r\n        // Oscillators\r\n        leftOsc = toneCtx.createOscillator();\r\n        rightOsc = toneCtx.createOscillator();\r\n\r\n        // Gains\r\n        leftGain = toneCtx.createGain();\r\n        rightGain = toneCtx.createGain();\r\n        masterGain = toneCtx.createGain();\r\n\r\n        let dcBlocker = toneCtx.createBiquadFilter();\r\n        dcBlocker.type = \"highpass\";\r\n        dcBlocker.frequency.value = 20; // 20 Hz blocks DC\r\n\r\n\r\n        // Set master gain to 0 before connecting\r\n        masterGain.gain.setValueAtTime(0, toneCtx.currentTime);\r\n\r\n        // Merger to route left/right to stereo\r\n        merger = toneCtx.createChannelMerger(2);\r\n\r\n        // Connect chains\r\n        leftOsc.connect(leftGain).connect(merger, 0, 0); // Left channel\r\n        rightOsc.connect(rightGain).connect(merger, 0, 1); // Right channel\r\n\r\n        // Connect merger to master gain\r\n        merger.connect(masterGain);\r\n\r\n        // Connect master gain to DC blocker\r\n        masterGain.connect(dcBlocker);\r\n\r\n        // Connect DC blocker to destination\r\n        dcBlocker.connect(toneCtx.destination);\r\n\r\n        // Set frequencies\r\n        leftOsc.frequency.setValueAtTime(baseFreq, toneCtx.currentTime);\r\n        rightOsc.frequency.setValueAtTime(baseFreq + maxBeat, toneCtx.currentTime);\r\n\r\n        // Start oscillators\r\n        leftOsc.start();\r\n        rightOsc.start();\r\n\r\n        // Now ramp gain up smoothly AFTER oscillators are started, with a slight delay\r\n        const rampTime = 0.5; // seconds\r\n        const targetVolume = 0.35;\r\n        const delay = 0.05; // 50ms delay\r\n\r\n        const startTime = toneCtx.currentTime + delay;\r\n        masterGain.gain.cancelScheduledValues(toneCtx.currentTime);\r\n        masterGain.gain.setValueAtTime(0, toneCtx.currentTime);\r\n        masterGain.gain.linearRampToValueAtTime(targetVolume, startTime + rampTime);\r\n\r\n        // Start the frequency sweep\r\n        scheduleSweep();\r\n        sweepInterval = setInterval(scheduleSweep, sweepDurationMin * 60 * 1000);\r\n    }\r\n\r\n    function stopBinauralSweep() {\r\n        if(!bgAudio){\r\n            return;\r\n        }\r\n\r\n        if (sweepInterval) clearInterval(sweepInterval);\r\n\r\n        if (masterGain && toneCtx) {\r\n            const now = toneCtx.currentTime;\r\n            masterGain.gain.cancelScheduledValues(now);\r\n            masterGain.gain.setValueAtTime(masterGain.gain.value, now);\r\n            masterGain.gain.linearRampToValueAtTime(0, now + 0.3); // ramp down over 0.3s\r\n\r\n            setTimeout(() => {\r\n                if (leftOsc) {\r\n                    try { leftOsc.stop(); } catch { }\r\n                    leftOsc.disconnect();\r\n                }\r\n                if (rightOsc) {\r\n                    try { rightOsc.stop(); } catch { }\r\n                    rightOsc.disconnect();\r\n                }\r\n                if (masterGain) masterGain.disconnect();\r\n                if (toneCtx) toneCtx.close();\r\n\r\n                leftOsc = rightOsc = leftGain = rightGain = masterGain = merger = toneCtx = null;\r\n            }, 320); // Wait for ramp down before stopping/disconnecting\r\n        } else {\r\n            // fallback: just stop everything\r\n            if (leftOsc) { try { leftOsc.stop(); } catch { } leftOsc.disconnect(); }\r\n            if (rightOsc) { try { rightOsc.stop(); } catch { } rightOsc.disconnect(); }\r\n            if (masterGain) masterGain.disconnect();\r\n            if (toneCtx) toneCtx.close();\r\n\r\n            leftOsc = rightOsc = leftGain = rightGain = masterGain = merger = toneCtx = null;\r\n        }\r\n    }\r\n\r\n    function scheduleSweep() {\r\n        const now = toneCtx.currentTime;\r\n        const halfCycle = (sweepDurationMin * 60) / 2;\r\n\r\n        rightOsc.frequency.cancelScheduledValues(now);\r\n        rightOsc.frequency.setValueAtTime(baseFreq + maxBeat, now);\r\n        rightOsc.frequency.linearRampToValueAtTime(baseFreq + minBeat, now + halfCycle);\r\n        rightOsc.frequency.linearRampToValueAtTime(baseFreq + maxBeat, now + 2 * halfCycle);\r\n    }\r\n    \r\n    /*\r\n    let toneCtx;\r\n    let leftOsc, rightOsc;\r\n    let leftGain, rightGain;\r\n    let merger;\r\n\r\n    function startBinauralSweep(baseFreq = 440, beatFreq = 4) {\r\n\r\n      toneCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n\r\n      // Create two oscillators\r\n      leftOsc = toneCtx.createOscillator();\r\n      rightOsc = toneCtx.createOscillator();\r\n\r\n      // Left: base frequency, Right: base + beat frequency\r\n      leftOsc.frequency.value = baseFreq;\r\n      rightOsc.frequency.value = baseFreq + beatFreq;\r\n\r\n      // Create stereo panning\r\n      leftGain = toneCtx.createGain();\r\n      leftGain.gain.value = 0.2;\r\n      rightGain = toneCtx.createGain();\r\n    rightGain.gain.value = 0.2;\r\n      // Pan hard left/right\r\n      const splitter = toneCtx.createChannelSplitter(2);\r\n      const merger = toneCtx.createChannelMerger(2);\r\n\r\n      leftOsc.connect(leftGain);\r\n      rightOsc.connect(rightGain);\r\n\r\n      leftGain.connect(merger, 0, 0);  // left to left channel\r\n      rightGain.connect(merger, 0, 1); // right to right channel\r\n\r\n      merger.connect(toneCtx.destination);\r\n\r\n      // Start oscillators\r\n      leftOsc.start();\r\n      rightOsc.start();\r\n    }\r\n\r\n    function stopBinauralSweep() {\r\n        return;\r\n      if (leftOsc) leftOsc.stop();\r\n      if (rightOsc) rightOsc.stop();\r\n      if (toneCtx) toneCtx.close();\r\n    }\r\n    */\r\n    /// Registry for new audio source controllers (from audioComponents.js)\r\n    let audioSourceControllers = {};\r\n\r\n    function registerAudioSource(id, controller) {\r\n        audioSourceControllers[id] = controller;\r\n    }\r\n\r\n    function unregisterAudioSource(id) {\r\n        delete audioSourceControllers[id];\r\n    }\r\n\r\n    function stopAllAudioSourceControllers(except) {\r\n        Object.values(audioSourceControllers).forEach(controller => {\r\n            if (controller !== except && controller.isPlaying && controller.isPlaying()) {\r\n                controller.stop();\r\n            }\r\n        });\r\n    }\r\n\r\n    let audio = {\r\n        configureAudio,\r\n        unconfigureAudio,\r\n        togglePlayAudio,\r\n        createAudioVisualizer,\r\n        createAudioSource,\r\n        clearAudioSource: clearAudioSource,\r\n        hasAudioMap: (name) => audioMap[name] ? true : false,\r\n        recordButton,\r\n        recordField,\r\n        recordWithVisualizer,\r\n        extractText,\r\n        recording: () => recording,\r\n        configureMagic8,\r\n        getMagic8View,\r\n        clearMagic8,\r\n        startBinauralSweep,\r\n        stopBinauralSweep,\r\n        stopAudioSources,\r\n        // New audio component integration\r\n        registerAudioSource,\r\n        unregisterAudioSource,\r\n        stopAllAudioSourceControllers,\r\n        component: {\r\n\r\n            oncreate: function (x) {\r\n\r\n            },\r\n            oninit: function () {\r\n\r\n            },\r\n            onupdate: function () {\r\n\r\n            },\r\n            view: function (x) {\r\n                return renderRecordButton();\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    page.components.audio = audio;\r\n\r\n}());\r\n\n\n;/* === client/components/audioComponents.js === */\n(function () {\r\n    /**\r\n     * Simple hash function for generating stable identifiers from content\r\n     */\r\n    function simpleHash(str) {\r\n        let hash = 0;\r\n        if (!str || str.length === 0) return hash.toString(36);\r\n        for (let i = 0; i < str.length; i++) {\r\n            let char = str.charCodeAt(i);\r\n            hash = ((hash << 5) - hash) + char;\r\n            hash = hash & hash; // Convert to 32bit integer\r\n        }\r\n        return Math.abs(hash).toString(36);\r\n    }\r\n\r\n    /**\r\n     * AudioSource Component - Manages audio playback with Web Audio API\r\n     *\r\n     * Features:\r\n     * - Handles audio synthesis and buffering\r\n     * - Manages playback state (play/pause/stop)\r\n     * - Recreates buffer source nodes for replay (since they're one-shot)\r\n     * - Provides analyzer node for visualization\r\n     * - Auto-stops other audio sources when playing (optional)\r\n     */\r\n\r\n    function createAudioSource(attrs) {\r\n        let state = {\r\n            id: attrs.id || page.uid(),\r\n            name: attrs.name,\r\n            profileId: attrs.profileId,\r\n            content: attrs.content,\r\n            context: null,\r\n            buffer: null,\r\n            sourceNode: null,\r\n            analyzerNode: null,\r\n            isPlaying: false,\r\n            isLoading: false,\r\n            error: null,\r\n            onPlayStateChange: attrs.onPlayStateChange || (() => {}),\r\n            autoStopOthers: attrs.autoStopOthers !== false\r\n        };\r\n\r\n        async function synthesizeAudio() {\r\n            if (!state.content || state.content.length === 0) {\r\n                state.error = \"No content provided\";\r\n                return false;\r\n            }\r\n\r\n            state.isLoading = true;\r\n            state.error = null;\r\n            m.redraw();\r\n\r\n            try {\r\n                //console.log(\"Synthesizing audio for:\", state.name);\r\n\r\n                // Clean content (remove emojis, quotes, etc.)\r\n                let cleanContent = state.content\r\n                    .replace(/([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g, \"\")\r\n                    .replace(/[\"\\*]+/g, \"\");\r\n\r\n                // Prepare voice synthesis request\r\n                let vprops = {\r\n                    text: cleanContent,\r\n                    speed: 1.2,\r\n                    voiceProfileId: state.profileId\r\n                };\r\n\r\n                if (!vprops.voiceProfileId) {\r\n                    vprops.engine = \"piper\";\r\n                    vprops.speaker = \"en_GB-alba-medium\";\r\n                }\r\n\r\n                //console.log(\"Requesting synthesis with props:\", vprops);\r\n\r\n                // Request audio synthesis\r\n                let response = await m.request({\r\n                    method: 'POST',\r\n                    url: g_application_path + \"/rest/voice/\" + state.name,\r\n                    withCredentials: true,\r\n                    body: vprops\r\n                });\r\n\r\n                //console.log(\"Synthesis response received for:\", state.name);\r\n\r\n                // Create audio context and decode\r\n                state.context = new AudioContext();\r\n                state.analyzerNode = state.context.createAnalyser();\r\n                state.analyzerNode.fftSize = 2048;\r\n                state.analyzerNode.smoothingTimeConstant = 0.8;\r\n\r\n                // Decode audio data\r\n                let arrayBuffer = base64ToArrayBuffer(response.dataBytesStore);\r\n                state.buffer = await state.context.decodeAudioData(arrayBuffer);\r\n\r\n                //console.log(\"Audio decoded successfully for:\", state.name);\r\n\r\n                state.isLoading = false;\r\n                m.redraw();\r\n                return true;\r\n\r\n            } catch (err) {\r\n                console.error(\"Error synthesizing audio for\", state.name, \":\", err);\r\n                state.error = err.message || \"Failed to synthesize audio\";\r\n                state.isLoading = false;\r\n                m.redraw();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        function base64ToArrayBuffer(base64) {\r\n            let cleanedBase64 = base64.replace(/^data:audio\\/\\w+;base64,/, '');\r\n            let binaryString = atob(cleanedBase64);\r\n            let len = binaryString.length;\r\n            let bytes = new Uint8Array(len);\r\n            for (let i = 0; i < len; i++) {\r\n                bytes[i] = binaryString.charCodeAt(i);\r\n            }\r\n            return bytes.buffer;\r\n        }\r\n\r\n        function createSourceNode() {\r\n            if (!state.context || !state.buffer) {\r\n                console.warn(\"Cannot create source node: context or buffer missing\");\r\n                return null;\r\n            }\r\n\r\n            // Create new buffer source (required for replay)\r\n            let source = state.context.createBufferSource();\r\n            source.buffer = state.buffer;\r\n\r\n            // Connect: source -> analyzer -> destination\r\n            source.connect(state.analyzerNode);\r\n            state.analyzerNode.connect(state.context.destination);\r\n\r\n            // Handle playback end\r\n            source.onended = () => {\r\n                state.isPlaying = false;\r\n                state.sourceNode = null;\r\n                state.onPlayStateChange(false);\r\n                m.redraw();\r\n            };\r\n\r\n            return source;\r\n        }\r\n\r\n        async function play() {\r\n            // Auto-stop other audio sources (both old and new systems)\r\n            if (state.autoStopOthers) {\r\n                if (page.components.audio) {\r\n                    // Stop old system audio sources\r\n                    page.components.audio.stopAudioSources();\r\n                    // Stop new system audio source controllers\r\n                    page.components.audio.stopAllAudioSourceControllers(api);\r\n                }\r\n            }\r\n\r\n            // Load audio if not already loaded\r\n            if (!state.buffer && !state.isLoading) {\r\n                let success = await synthesizeAudio();\r\n                if (!success) {\r\n                    console.error(\"Failed to synthesize audio for:\", state.name);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Wait for loading to complete\r\n            if (state.isLoading) {\r\n                console.warn(\"Audio is still loading:\", state.name);\r\n                return;\r\n            }\r\n\r\n            // If already playing, don't start again\r\n            if (state.isPlaying) {\r\n                console.warn(\"Audio is already playing:\", state.name);\r\n                return;\r\n            }\r\n\r\n            // Ensure we have a context\r\n            if (!state.context) {\r\n                console.error(\"No audio context available\");\r\n                return;\r\n            }\r\n\r\n            // Resume context if suspended\r\n            if (state.context.state === \"suspended\") {\r\n                await state.context.resume();\r\n            }\r\n\r\n            // Always create a new source node (Web Audio API requirement)\r\n            state.sourceNode = createSourceNode();\r\n            if (!state.sourceNode) {\r\n                console.error(\"Failed to create source node\");\r\n                return;\r\n            }\r\n\r\n            // Start playback\r\n            try {\r\n                state.sourceNode.start(0);\r\n                state.isPlaying = true;\r\n                state.onPlayStateChange(true);\r\n                m.redraw();\r\n            } catch (err) {\r\n                console.error(\"Error starting audio:\", err, state.name);\r\n                state.isPlaying = false;\r\n                state.sourceNode = null;\r\n            }\r\n        }\r\n\r\n        function pause() {\r\n            if (state.context && state.context.state === \"running\") {\r\n                state.context.suspend();\r\n                state.isPlaying = false;\r\n                state.onPlayStateChange(false);\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        function resume() {\r\n            if (state.context && state.context.state === \"suspended\") {\r\n                state.context.resume();\r\n                state.isPlaying = true;\r\n                state.onPlayStateChange(true);\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        function stop() {\r\n            if (state.sourceNode) {\r\n                try {\r\n                    state.sourceNode.stop();\r\n                } catch (e) {\r\n                    // May already be stopped\r\n                }\r\n                state.sourceNode = null;\r\n            }\r\n            if (state.context && state.context.state !== \"closed\") {\r\n                state.context.suspend();\r\n            }\r\n            state.isPlaying = false;\r\n            state.onPlayStateChange(false);\r\n            m.redraw();\r\n        }\r\n\r\n        function togglePlayPause() {\r\n            // console.log(\"togglePlayPause called on audio source:\", state.name, \"isPlaying:\", state.isPlaying);\r\n            if (state.isPlaying) {\r\n                pause();\r\n            } else if (state.context && state.context.state === \"suspended\" && state.sourceNode) {\r\n                resume();\r\n            } else {\r\n                play();\r\n            }\r\n        }\r\n\r\n        function destroy() {\r\n            stop();\r\n            if (state.context && state.context.state !== \"closed\") {\r\n                state.context.close();\r\n            }\r\n            // Unregister from audio system\r\n            if (page.components.audio && page.components.audio.unregisterAudioSource) {\r\n                page.components.audio.unregisterAudioSource(state.id);\r\n            }\r\n            state.context = null;\r\n            state.buffer = null;\r\n            state.sourceNode = null;\r\n            state.analyzerNode = null;\r\n        }\r\n\r\n        let api = {\r\n            state,\r\n            play,\r\n            pause,\r\n            resume,\r\n            stop,\r\n            togglePlayPause,\r\n            destroy,\r\n            getAnalyzerNode: () => state.analyzerNode,\r\n            getContext: () => state.context,\r\n            isPlaying: () => state.isPlaying,\r\n            isLoading: () => state.isLoading,\r\n            hasError: () => state.error !== null\r\n        };\r\n\r\n        // Register with audio system\r\n        if (page.components.audio && page.components.audio.registerAudioSource) {\r\n            page.components.audio.registerAudioSource(state.id, api);\r\n            // console.log(\"Registered audio source:\", state.id, \"name:\", state.name);\r\n        }\r\n\r\n        return api;\r\n    }\r\n\r\n\r\n    /**\r\n     * AudioVisualizer Component - Mithril component for audio visualization\r\n     *\r\n     * Features:\r\n     * - Uses AudioMotionAnalyzer for visualization\r\n     * - Click to play/pause\r\n     * - Configurable appearance\r\n     * - Auto-cleanup on remove\r\n     */\r\n\r\n    function AudioVisualizer() {\r\n        function tryCreateVisualizer(vnode, attrs) {\r\n            if (vnode.state.visualizer) return; // Already created\r\n\r\n            // Use the current audioSource from attrs\r\n            let currentAudioSource = attrs.audioSource || vnode.state.audioSourceController;\r\n            if (!currentAudioSource) {\r\n                return;\r\n            }\r\n\r\n            let analyzerNode = currentAudioSource.getAnalyzerNode();\r\n            if (!analyzerNode) {\r\n                // Analyzer not ready yet, will retry\r\n                return;\r\n            }\r\n\r\n            // Use calculated height from DOM or provided height\r\n            let height = vnode.state.calculatedHeight || attrs.height || 60;\r\n\r\n            // Default visualizer properties\r\n            let props = {\r\n                source: analyzerNode,\r\n                height: height,\r\n                overlay: true,\r\n                bgAlpha: attrs.bgAlpha !== undefined ? attrs.bgAlpha : 0,\r\n                gradient: attrs.gradient || 'prism',\r\n                showBgColor: attrs.showBgColor !== undefined ? attrs.showBgColor : true,\r\n                showSource: false,\r\n                showScaleY: false,\r\n                showScaleX: false,\r\n                ...(attrs.visualizerProps || {})\r\n            };\r\n\r\n            try {\r\n                vnode.state.visualizer = new AudioMotionAnalyzer(vnode.dom, props);\r\n                //console.log(\"AudioMotionAnalyzer created successfully for audio source:\", currentAudioSource.state.name, \"height:\", height);\r\n\r\n                // Clear the check interval once created\r\n                if (vnode.state.checkInterval) {\r\n                    clearInterval(vnode.state.checkInterval);\r\n                    vnode.state.checkInterval = null;\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Error creating AudioMotionAnalyzer:\", err);\r\n            }\r\n        }\r\n\r\n        return {\r\n            oncreate: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n\r\n                // Store state on vnode.state to prevent sharing between component instances\r\n                vnode.state.visualizer = null;\r\n                vnode.state.checkInterval = null;\r\n                vnode.state.audioSourceController = attrs.audioSource;\r\n\r\n                if (!vnode.state.audioSourceController) {\r\n                    console.warn(\"AudioVisualizer: No audio source provided\");\r\n                    return;\r\n                }\r\n\r\n                // Calculate actual height from DOM element if not specified\r\n                let actualHeight = attrs.height;\r\n                if (!actualHeight && vnode.dom) {\r\n                    actualHeight = vnode.dom.clientHeight;\r\n                }\r\n\r\n                // Store calculated height for visualizer creation\r\n                vnode.state.calculatedHeight = actualHeight || 60;\r\n\r\n                // Try to create visualizer immediately\r\n                tryCreateVisualizer(vnode, attrs);\r\n\r\n                // If not ready, check periodically until analyzer is available\r\n                if (!vnode.state.visualizer) {\r\n                    vnode.state.checkInterval = setInterval(() => {\r\n                        tryCreateVisualizer(vnode, attrs);\r\n                    }, 100);\r\n                }\r\n            },\r\n\r\n            onremove: function(vnode) {\r\n                // Clear check interval if still running\r\n                if (vnode.state.checkInterval) {\r\n                    clearInterval(vnode.state.checkInterval);\r\n                    vnode.state.checkInterval = null;\r\n                }\r\n\r\n                // Destroy visualizer if created\r\n                if (vnode.state.visualizer) {\r\n                    try {\r\n                        vnode.state.visualizer.stop();\r\n                        vnode.state.visualizer.destroy();\r\n                    } catch (err) {\r\n                        console.warn(\"Error destroying visualizer:\", err);\r\n                    }\r\n                    vnode.state.visualizer = null;\r\n                }\r\n            },\r\n\r\n            view: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                let cssClass = \"audio-visualizer \" + (attrs.class || \"\");\r\n\r\n                return m(\"div\", {\r\n                    class: cssClass,\r\n                    style: attrs.style || \"\",\r\n                    onclick: (e) => {\r\n                        e.stopPropagation();\r\n                        // Always use the current audioSource from attrs, not the cached one\r\n                        let currentAudioSource = attrs.audioSource;\r\n                        if (currentAudioSource) {\r\n                            //console.log(\"AudioVisualizer clicked, audio source ID:\", currentAudioSource.state.id, \"name:\", currentAudioSource.state.name);\r\n                            //console.log(\"About to call togglePlayPause on:\", currentAudioSource.state.name);\r\n                            currentAudioSource.togglePlayPause();\r\n                        } else {\r\n                            console.warn(\"AudioVisualizer clicked but no audio source available\");\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n    }\r\n\r\n\r\n    /**\r\n     * SimpleAudioPlayer Component - Complete audio player with visualizer\r\n     *\r\n     * Combines AudioSource controller and AudioVisualizer component\r\n     * for easy integration with play/pause/delete controls\r\n     */\r\n\r\n    function SimpleAudioPlayer() {\r\n        return {\r\n            oninit: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n\r\n                // console.log(\"SimpleAudioPlayer oninit - ID:\", attrs.id, \"Name:\", attrs.name, \"Key:\", attrs.key);\r\n\r\n                // Store state on vnode.state to prevent sharing between component instances\r\n                vnode.state.visualizer = null;\r\n                vnode.state.checkInterval = null;\r\n                vnode.state.autoPlayInitiated = false;\r\n\r\n                // Create audio source controller and store on vnode.state\r\n                vnode.state.audioSource = createAudioSource({\r\n                    id: attrs.id,\r\n                    name: attrs.name,\r\n                    profileId: attrs.profileId,\r\n                    content: attrs.content,\r\n                    autoStopOthers: attrs.autoStopOthers,\r\n                    onPlayStateChange: (isPlaying) => {\r\n                        if (attrs.onPlayStateChange) {\r\n                            attrs.onPlayStateChange(isPlaying);\r\n                        }\r\n                        m.redraw();\r\n                    }\r\n                });\r\n\r\n                // console.log(\"SimpleAudioPlayer created audio source:\", vnode.state.audioSource.state.name);\r\n            },\r\n\r\n            oncreate: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                // console.log(\"SimpleAudioPlayer oncreate - ID:\", attrs.id, \"Looking for element:\", attrs.id + \"-viz\");\r\n\r\n                // Auto-load audio (synthesize without playing) if requested\r\n                if ((attrs.autoLoad || attrs.autoPlay) && !vnode.state.audioSource.state.buffer && !vnode.state.audioSource.state.isLoading) {\r\n                    // console.log(\"Auto-loading audio for:\", vnode.state.audioSource.state.name);\r\n                    // Trigger synthesis by calling the internal synthesizeAudio\r\n                    // We need to access the internal state, so let's just trigger a play and immediately pause\r\n                    setTimeout(async () => {\r\n                        if (vnode.state.audioSource && !vnode.state.audioSource.state.buffer) {\r\n                            // Manually call synthesize\r\n                            let state = vnode.state.audioSource.state;\r\n                            if (!state.content || state.content.length === 0) {\r\n                                return;\r\n                            }\r\n\r\n                            state.isLoading = true;\r\n                            state.error = null;\r\n                            m.redraw();\r\n\r\n                            try {\r\n                                // console.log(\"Synthesizing audio for:\", state.name);\r\n                                let cleanContent = state.content\r\n                                    .replace(/([\\u2700-\\u27BF]|[\\uE000-\\uF8FF]|\\uD83C[\\uDC00-\\uDFFF]|\\uD83D[\\uDC00-\\uDFFF]|[\\u2011-\\u26FF]|\\uD83E[\\uDD10-\\uDDFF])/g, \"\")\r\n                                    .replace(/[\"\\*]+/g, \"\");\r\n\r\n                                let vprops = {\r\n                                    text: cleanContent,\r\n                                    speed: 1.2,\r\n                                    voiceProfileId: state.profileId\r\n                                };\r\n\r\n                                if (!vprops.voiceProfileId) {\r\n                                    vprops.engine = \"piper\";\r\n                                    vprops.speaker = \"en_GB-alba-medium\";\r\n                                }\r\n\r\n                                let response = await m.request({\r\n                                    method: 'POST',\r\n                                    url: g_application_path + \"/rest/voice/\" + state.name,\r\n                                    withCredentials: true,\r\n                                    body: vprops\r\n                                });\r\n\r\n                                state.context = new AudioContext();\r\n                                state.analyzerNode = state.context.createAnalyser();\r\n                                state.analyzerNode.fftSize = 2048;\r\n                                state.analyzerNode.smoothingTimeConstant = 0.8;\r\n\r\n                                let arrayBuffer = base64ToArrayBuffer(response.dataBytesStore);\r\n                                state.buffer = await state.context.decodeAudioData(arrayBuffer);\r\n\r\n                                //console.log(\"Audio decoded successfully for:\", state.name);\r\n                                state.isLoading = false;\r\n                                m.redraw();\r\n                            } catch (err) {\r\n                                console.error(\"Error synthesizing audio for\", state.name, \":\", err);\r\n                                state.error = err.message || \"Failed to synthesize audio\";\r\n                                state.isLoading = false;\r\n                                m.redraw();\r\n                            }\r\n                        }\r\n                    }, 50);\r\n                }\r\n\r\n                // Auto-play if requested (only once on first oncreate)\r\n                if (attrs.autoPlay && !vnode.state.autoPlayInitiated) {\r\n                    vnode.state.autoPlayInitiated = true;\r\n                    //console.log(\"Initiating auto-play for:\", vnode.state.audioSource.state.name);\r\n                    setTimeout(() => {\r\n                        if (vnode.state.audioSource) {\r\n                            vnode.state.audioSource.play();\r\n                        }\r\n                    }, attrs.autoPlayDelay || 100);\r\n                }\r\n\r\n                function base64ToArrayBuffer(base64) {\r\n                    let cleanedBase64 = base64.replace(/^data:audio\\/\\w+;base64,/, '');\r\n                    let binaryString = atob(cleanedBase64);\r\n                    let len = binaryString.length;\r\n                    let bytes = new Uint8Array(len);\r\n                    for (let i = 0; i < len; i++) {\r\n                        bytes[i] = binaryString.charCodeAt(i);\r\n                    }\r\n                    return bytes.buffer;\r\n                }\r\n\r\n                // Create visualizer for this specific audio source\r\n                let tryCreateVisualizer = () => {\r\n                    if (vnode.state.visualizer) {\r\n                        //console.log(\"Visualizer already exists for:\", vnode.state.audioSource.state.name);\r\n                        return;\r\n                    }\r\n\r\n                    let analyzerNode = vnode.state.audioSource.getAnalyzerNode();\r\n                    if (!analyzerNode) {\r\n                        //console.log(\"No analyzer node yet for:\", vnode.state.audioSource.state.name);\r\n                        return; // Not ready yet\r\n                    }\r\n\r\n                    let vizElement = document.getElementById(attrs.id + \"-viz\");\r\n                    if (!vizElement) {\r\n                        //console.warn(\"No viz element found for ID:\", attrs.id + \"-viz\");\r\n                        return;\r\n                    }\r\n\r\n                    //console.log(\"Creating AudioMotionAnalyzer for:\", vnode.state.audioSource.state.name, \"on element:\", attrs.id + \"-viz\");\r\n\r\n                    let props = {\r\n                        source: analyzerNode,\r\n                        height: attrs.height || 60,\r\n                        overlay: true,\r\n                        bgAlpha: attrs.bgAlpha !== undefined ? attrs.bgAlpha : 0,\r\n                        gradient: attrs.gradient || 'prism',\r\n                        showBgColor: attrs.showBgColor !== undefined ? attrs.showBgColor : true,\r\n                        showSource: false,\r\n                        showScaleY: false,\r\n                        showScaleX: false,\r\n                        ...(attrs.visualizerProps || {})\r\n                    };\r\n\r\n                    try {\r\n                        vnode.state.visualizer = new AudioMotionAnalyzer(vizElement, props);\r\n                        // console.log(\"AudioMotionAnalyzer successfully created for:\", vnode.state.audioSource.state.name, \"Element ID:\", attrs.id + \"-viz\");\r\n\r\n                        if (vnode.state.checkInterval) {\r\n                            clearInterval(vnode.state.checkInterval);\r\n                            vnode.state.checkInterval = null;\r\n                        }\r\n                    } catch (err) {\r\n                        console.error(\"Error creating AudioMotionAnalyzer:\", err);\r\n                    }\r\n                };\r\n\r\n                // Try immediately\r\n                tryCreateVisualizer();\r\n\r\n                // If not ready, check periodically\r\n                if (!vnode.state.visualizer) {\r\n                    vnode.state.checkInterval = setInterval(tryCreateVisualizer, 100);\r\n                }\r\n            },\r\n\r\n            onremove: function(vnode) {\r\n                // Clean up interval if still running\r\n                if (vnode.state.checkInterval) {\r\n                    clearInterval(vnode.state.checkInterval);\r\n                    vnode.state.checkInterval = null;\r\n                }\r\n\r\n                // Clean up visualizer\r\n                if (vnode.state.visualizer) {\r\n                    try {\r\n                        vnode.state.visualizer.destroy();\r\n                    } catch (e) {\r\n                        console.error(\"Error destroying visualizer:\", e);\r\n                    }\r\n                    vnode.state.visualizer = null;\r\n                }\r\n\r\n                // Clean up audio source\r\n                if (vnode.state.audioSource) {\r\n                    vnode.state.audioSource.destroy();\r\n                    vnode.state.audioSource = null;\r\n                }\r\n            },\r\n\r\n            view: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                let audioSource = vnode.state.audioSource;\r\n\r\n                if (!audioSource) {\r\n                    return m(\"div\", { class: \"audio-player-error min-h-[60px] flex items-center justify-center\" },\r\n                        \"Audio player not initialized\"\r\n                    );\r\n                }\r\n\r\n                if (audioSource.hasError()) {\r\n                    return m(\"div\", {\r\n                        class: \"audio-player-error min-h-[60px] flex items-center justify-center gap-2 text-red-500\"\r\n                    }, [\r\n                        m(\"span\", { class: \"material-icons text-sm\" }, \"error\"),\r\n                        m(\"span\", { class: \"text-xs\" }, \"Failed to load audio\")\r\n                    ]);\r\n                }\r\n\r\n                if (audioSource.isLoading()) {\r\n                    return m(\"div\", {\r\n                        class: \"audio-player-loading min-h-[60px] flex items-center justify-center gap-2\"\r\n                    }, [\r\n                        m(\"span\", { class: \"material-icons text-sm animate-spin\" }, \"refresh\"),\r\n                        m(\"span\", { class: \"text-xs\" }, \"Loading...\")\r\n                    ]);\r\n                }\r\n\r\n                let isPlaying = audioSource.isPlaying();\r\n\r\n                return m(\"div\", {\r\n                    class: (attrs.visualizerClass || \"\") + \" audio-player-container relative block rounded-lg overflow-hidden\",\r\n                    style: `height: ${attrs.height || 60}px; min-width: 80%;`,\r\n                    key: attrs.id + \"-container\"\r\n                }, [\r\n                    // Visualizer div - AudioMotionAnalyzer will be created directly on this element\r\n                    m(\"div\", {\r\n                        key: attrs.id + \"-viz\",\r\n                        id: attrs.id + \"-viz\",\r\n                        class: \"w-full h-full block cursor-pointer\",\r\n                        style: attrs.visualizerStyle || \"\",\r\n                        onclick: (e) => {\r\n                            e.stopPropagation();\r\n                            console.log(\"Visualizer div clicked - Element ID:\", attrs.id + \"-viz\");\r\n                            if (vnode.state.audioSource) {\r\n                                console.log(\"  Audio source name:\", vnode.state.audioSource.state.name);\r\n                                console.log(\"  Audio source ID:\", vnode.state.audioSource.state.id);\r\n                                console.log(\"  Has visualizer:\", !!vnode.state.visualizer);\r\n                                vnode.state.audioSource.togglePlayPause();\r\n                            } else {\r\n                                console.error(\"  No audio source in vnode.state!\");\r\n                            }\r\n                        }\r\n                    }),\r\n\r\n                    // Small controls overlay in bottom-right corner\r\n                    m(\"div\", {\r\n                        key: attrs.id + \"-controls\",\r\n                        class: \"absolute bottom-2 right-2 flex items-center gap-2 z-10\"\r\n                    }, [\r\n                        // Play/Pause indicator (small icon, semi-transparent)\r\n                        m(\"div\", {\r\n                            class: \"p-1 rounded-full bg-black/30 dark:bg-white/30\",\r\n                            title: isPlaying ? \"Playing\" : \"Paused\"\r\n                        }, m(\"span\", { class: \"material-icons text-base text-white\" }, isPlaying ? \"volume_up\" : \"volume_off\")),\r\n\r\n                        // Delete button (if onDelete provided)\r\n                        attrs.onDelete && m(\"button\", {\r\n                            class: \"audio-control-btn p-1 rounded-full bg-red-500/70 hover:bg-red-600 transition-colors\",\r\n                            onclick: (e) => {\r\n                                e.stopPropagation();\r\n                                if (audioSource) {\r\n                                    audioSource.stop();\r\n                                }\r\n                                attrs.onDelete();\r\n                            },\r\n                            title: \"Delete audio\"\r\n                        }, m(\"span\", { class: \"material-icons text-base text-white\" }, \"close\"))\r\n                    ])\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n\r\n    /**\r\n     * Magic8Ball Component - Dual audio visualizer in a circular design\r\n     *\r\n     * Shows two audio sources (typically assistant and user) in a split-circle\r\n     * visualization with profile images as background\r\n     */\r\n\r\n    function Magic8Ball() {\r\n        let audioSource1 = null;  // Top/Assistant\r\n        let audioSource2 = null;  // Bottom/User\r\n        let lastContentHash = null;\r\n        let backgroundImages = [];\r\n        let imageBaseGroupsLoaded = false;\r\n        let hasAutoPlayedForHash = {};  // Track which content hashes have auto-played\r\n\r\n        function getContentHash(messages) {\r\n            if (!messages || !messages.length) return null;\r\n            let lastTwo = messages.slice(-2);\r\n            return lastTwo.map(m => m?.content || \"\").join(\"|\");\r\n        }\r\n\r\n        // Create or get existing audio source for a message\r\n        function getOrCreateAudioSource(name, profId, content, role) {\r\n            // Check if we already have this audio source\r\n            let existingSource = (role === \"assistant\") ? audioSource1 : audioSource2;\r\n            if (existingSource && existingSource.state.name === name) {\r\n                console.log(\"Reusing existing audio source:\", name);\r\n                return existingSource;\r\n            }\r\n\r\n            // Destroy old source for this role if it exists with different name\r\n            if (existingSource) {\r\n                console.log(\"Destroying old audio source for role:\", role, \"old name:\", existingSource.state.name);\r\n                existingSource.destroy();\r\n            }\r\n\r\n            console.log(\"Creating new audio source:\", name);\r\n            return createAudioSource({\r\n                id: name,\r\n                name: name,\r\n                profileId: profId,\r\n                content: content,\r\n                autoStopOthers: true,\r\n                onPlayStateChange: () => {\r\n                    if (window.m && window.m.redraw) {\r\n                        window.m.redraw();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function setupAudioSources(vnode, shouldAutoPlay) {\r\n            let attrs = vnode.attrs;\r\n            let messages = attrs.messages || [];\r\n\r\n            if (!messages.length) {\r\n                return;\r\n            }\r\n\r\n            // Process last 2 messages (or just 1 if that's all we have)\r\n            let messagesToProcess = messages.slice(-2);\r\n            let sysProfileId = attrs.systemProfileId;\r\n            let usrProfileId = attrs.userProfileId;\r\n            let prune = attrs.pruneContent || ((c) => c);\r\n\r\n            // Create audio source controllers (reuse if same name)\r\n            messagesToProcess.forEach((msg) => {\r\n                if (!msg) return;\r\n\r\n                let content = prune(msg.content);\r\n                if (!content || content.length === 0) return;\r\n\r\n                let contentHash = simpleHash(content);\r\n                let name = attrs.instanceId + \"-\" + msg.role + \"-\" + contentHash;\r\n                let profId = (msg.role === \"assistant\") ? sysProfileId : usrProfileId;\r\n\r\n                let audioSource = getOrCreateAudioSource(name, profId, content, msg.role);\r\n\r\n                if (msg.role === \"assistant\") {\r\n                    audioSource1 = audioSource;\r\n                } else {\r\n                    audioSource2 = audioSource;\r\n                }\r\n            });\r\n\r\n            // Auto-play the most recent message only if:\r\n            // 1. shouldAutoPlay is true (first view or content changed)\r\n            // 2. We haven't already auto-played for this content hash\r\n            let currentHash = getContentHash(messages);\r\n            if (shouldAutoPlay && !hasAutoPlayedForHash[currentHash]) {\r\n                hasAutoPlayedForHash[currentHash] = true;\r\n                // console.log(\"Auto-playing for content hash:\", currentHash);\r\n\r\n                setTimeout(() => {\r\n                    if (messagesToProcess.length > 0) {\r\n                        let lastMsg = messagesToProcess[messagesToProcess.length - 1];\r\n                        if (lastMsg.role === \"assistant\" && audioSource1) {\r\n                            audioSource1.play();\r\n                        } else if (lastMsg.role === \"user\" && audioSource2) {\r\n                            audioSource2.play();\r\n                        }\r\n                    }\r\n                }, 100);\r\n            }\r\n        }\r\n\r\n        return {\r\n            oninit: function(vnode) {\r\n                // Initialize state on vnode.state\r\n                vnode.state.bgImageIndex = 0;\r\n                vnode.state.bgAnimationInterval = null;\r\n                vnode.state.imageA_src = null;\r\n                vnode.state.imageB_src = null;\r\n                vnode.state.isA_onTop = false;\r\n                vnode.state.isTransitioning = false;\r\n                vnode.state.initialized = false;\r\n            },\r\n\r\n            oncreate: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                let messages = attrs.messages || [];\r\n                let contentHash = getContentHash(messages);\r\n\r\n                if (!messages.length) {\r\n                    return;\r\n                }\r\n\r\n                lastContentHash = contentHash;\r\n                vnode.state.initialized = true;\r\n\r\n                // Load background images from group IDs if not in profile mode\r\n                let useProfile = attrs.useProfile !== false;\r\n                let sysUrl = attrs.systemProfileImageUrl;\r\n                let usrUrl = attrs.userProfileImageUrl;\r\n\r\n                if (!useProfile && !sysUrl && !usrUrl && attrs.imageBaseGroups && attrs.imageBaseGroups.length > 0 && !imageBaseGroupsLoaded) {\r\n                    imageBaseGroupsLoaded = true;\r\n                    console.log(\"Loading Magic8Ball background images from groups:\", attrs.imageBaseGroups);\r\n\r\n                    let q = am7client.newQuery(\"data.data\");\r\n                    let qg = q.field(null, null);\r\n                    qg.comparator = \"group_or\";\r\n                    qg.fields = attrs.imageBaseGroups.map((groupId) => {\r\n                        return {\r\n                            name: \"groupId\",\r\n                            comparator: \"equals\",\r\n                            value: groupId\r\n                        };\r\n                    });\r\n                    q.range(0, 0);\r\n\r\n                    page.search(q).then((res) => {\r\n                        if (res && res.results) {\r\n                            backgroundImages = res.results.map((r) => {\r\n                                return g_application_path + \"/media/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + r.groupPath + \"/\" + r.name;\r\n                            });\r\n\r\n                            console.log(\"Loaded\", backgroundImages.length, \"background images for Magic8Ball\");\r\n\r\n                            if (backgroundImages.length > 0) {\r\n                                vnode.state.imageA_src = backgroundImages[Math.floor(Math.random() * backgroundImages.length)];\r\n                                vnode.state.imageB_src = backgroundImages[Math.floor(Math.random() * backgroundImages.length)];\r\n                                m.redraw();\r\n                            }\r\n                        }\r\n                    }).catch((err) => {\r\n                        console.error(\"Error loading Magic8Ball background images:\", err);\r\n                    });\r\n                }\r\n\r\n                // Setup audio sources and auto-play (first time = true)\r\n                setupAudioSources(vnode, true);\r\n            },\r\n\r\n            onupdate: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                let messages = attrs.messages || [];\r\n                let contentHash = getContentHash(messages);\r\n\r\n                // Only process if content has actually changed\r\n                if (contentHash !== lastContentHash) {\r\n                    console.log(\"Magic8Ball content changed from\", lastContentHash, \"to\", contentHash);\r\n                    lastContentHash = contentHash;\r\n\r\n                    // Setup audio sources and auto-play (content changed = true)\r\n                    setupAudioSources(vnode, true);\r\n                }\r\n                // If content is the same, don't do anything - don't recreate or auto-play\r\n            },\r\n\r\n            onremove: function() {\r\n                // Clean up audio sources\r\n                if (audioSource1) {\r\n                    audioSource1.destroy();\r\n                    audioSource1 = null;\r\n                }\r\n                if (audioSource2) {\r\n                    audioSource2.destroy();\r\n                    audioSource2 = null;\r\n                }\r\n            },\r\n\r\n            view: function(vnode) {\r\n                let attrs = vnode.attrs;\r\n                let sysUrl = attrs.systemProfileImageUrl;\r\n                let usrUrl = attrs.userProfileImageUrl;\r\n\r\n                console.log(\"Magic8Ball view - sysUrl:\", sysUrl, \"usrUrl:\", usrUrl, \"bgImages:\", backgroundImages.length);\r\n\r\n                // Image transition handler (called on image load)\r\n                let imageTransition = () => {\r\n                    if (vnode.state.isTransitioning || backgroundImages.length === 0) return;\r\n                    vnode.state.isTransitioning = true;\r\n\r\n                    setTimeout(() => {\r\n                        if (vnode.state.isA_onTop) {\r\n                            vnode.state.imageA_src = backgroundImages[Math.floor(Math.random() * backgroundImages.length)];\r\n                        } else {\r\n                            vnode.state.imageB_src = backgroundImages[Math.floor(Math.random() * backgroundImages.length)];\r\n                        }\r\n                        vnode.state.isA_onTop = !vnode.state.isA_onTop;\r\n                        vnode.state.isTransitioning = false;\r\n                        m.redraw();\r\n                    }, 3000);\r\n                };\r\n\r\n                let imageClasses = 'absolute top-0 left-0 w-full h-full rounded-full object-cover transition-all ease-in-out duration-300';\r\n\r\n                return m(\"div\", {\r\n                    key: \"magic8-container\",\r\n                    class: `\r\n                        relative aspect-square w-[90vw] max-w-[800px] max-h-[800px] mx-auto\r\n                        rounded-full overflow-hidden\r\n                        ring-2 ring-white/20\r\n                    `\r\n                }, [\r\n                    // Background images with crossfade if no profile images\r\n                    !sysUrl && !usrUrl && backgroundImages.length > 0 && m(\"div\", {\r\n                        class: \"absolute top-0 left-0 w-full h-full rounded-full overflow-hidden\",\r\n                        style: \"z-index: 0;\"\r\n                    }, [\r\n                        // Image A\r\n                        vnode.state.imageA_src && m(\"img\", {\r\n                            key: \"bg-A\",\r\n                            src: vnode.state.imageA_src,\r\n                            class: `${imageClasses} ${vnode.state.isA_onTop && vnode.state.isTransitioning ? 'opacity-0 blur-md' : 'opacity-50 blur-0'}`,\r\n                            loading: \"eager\",\r\n                            onload: !vnode.state.isA_onTop ? imageTransition : null,\r\n                            onerror: () => {\r\n                                console.error(\"Failed to load image:\", vnode.state.imageA_src);\r\n                                imageTransition();\r\n                            }\r\n                        }),\r\n                        // Image B\r\n                        vnode.state.imageB_src && m(\"img\", {\r\n                            key: \"bg-B\",\r\n                            src: vnode.state.imageB_src,\r\n                            class: `${imageClasses} ${!vnode.state.isA_onTop && vnode.state.isTransitioning ? 'opacity-0 blur-md' : 'opacity-50 blur-0'}`,\r\n                            loading: \"eager\",\r\n                            onload: vnode.state.isA_onTop ? imageTransition : null,\r\n                            onerror: () => {\r\n                                console.error(\"Failed to load image:\", vnode.state.imageB_src);\r\n                                imageTransition();\r\n                            }\r\n                        })\r\n                    ]),\r\n\r\n                    // System (assistant) profile image - upper hemisphere\r\n                    sysUrl && m(\"img\", {\r\n                        class: `\r\n                            absolute top-0 left-0 w-full h-1/2 z-0\r\n                            pointer-events-none opacity-60 blur-sm object-cover\r\n                        `,\r\n                        src: sysUrl,\r\n                        loading: \"eager\",\r\n                        style: \"object-position: top center;\"\r\n                    }),\r\n\r\n                    // User profile image - lower hemisphere\r\n                    usrUrl && m(\"img\", {\r\n                        class: `\r\n                            absolute bottom-0 left-0 w-full h-1/2 z-0\r\n                            pointer-events-none opacity-60 blur-sm object-cover\r\n                        `,\r\n                        src: usrUrl,\r\n                        loading: \"eager\",\r\n                        style: \"object-position: top center;\"\r\n                    }),\r\n\r\n                    // Top visualizer (assistant)\r\n                    audioSource1 && m(AudioVisualizer, {\r\n                        audioSource: audioSource1,\r\n                        class: \"absolute top-0 left-0 w-full h-1/2 z-10\",\r\n                        visualizerProps: {\r\n                            overlay: true,\r\n                            bgAlpha: 0,\r\n                            gradient: 'prism',\r\n                            showBgColor: true,\r\n                            showSource: false,\r\n                            showScaleY: false,\r\n                            showScaleX: false\r\n                        }\r\n                    }),\r\n\r\n                    // Bottom visualizer (user, inverted)\r\n                    audioSource2 && m(AudioVisualizer, {\r\n                        audioSource: audioSource2,\r\n                        class: \"absolute bottom-0 left-0 w-full h-1/2 z-10 transform scale-y-[-1]\",\r\n                        visualizerProps: {\r\n                            overlay: true,\r\n                            bgAlpha: 0,\r\n                            gradient: 'prism',\r\n                            showBgColor: true,\r\n                            showSource: false,\r\n                            showScaleY: false,\r\n                            showScaleX: false\r\n                        }\r\n                    }),\r\n\r\n                    // Overlay effects\r\n                    m(\"div\", {\r\n                        class: \"absolute inset-0 rounded-full pointer-events-none\"\r\n                    })\r\n                ]);\r\n            }\r\n        };\r\n    }\r\n\r\n\r\n    // Export to page.components\r\n    if (!page.components.audioComponents) {\r\n        page.components.audioComponents = {};\r\n    }\r\n\r\n    page.components.audioComponents = {\r\n        createAudioSource,\r\n        AudioVisualizer,\r\n        SimpleAudioPlayer,\r\n        Magic8Ball,\r\n        simpleHash\r\n    };\r\n\r\n}());\r\n\n\n;/* === client/components/camera.js === */\n(function () {\r\n    let isCapturing =  false;\r\n    let isInitialized = false;\r\n    let videoEl = null;\r\n    let deviceInit = false;\r\n    let videoDevices = [];\r\n    let selectedDeviceId = null;\r\n    let API_ENDPOINT = g_application_path + '/rest/face/analyze';\r\n    let CAPTURE_INTERVAL_SECONDS = 5;\r\n    let captureIntervalId = 0;\r\n    am7model.models.push(\r\n    {\r\n        name: \"cameraOptions\", icon: \"camera\", fields: [\r\n            {\r\n                name: \"device\",\r\n                label: \"Device\",\r\n                type: 'list',\r\n                limit: []\r\n            }\r\n        ]\r\n    });\r\n\r\n    am7model.forms.cameraOptions = {\r\n        label: \"Camera Options\",\r\n        fields: {\r\n            device: {\r\n                layout: 'full'\r\n            }\r\n        }\r\n    };\r\n\r\n    function videoElement(){\r\n        return document.querySelector('#facecam');\r\n    }\r\n\r\n     async function initializeAndFindDevices(fCaptureHandler) {\r\n        if(deviceInit){\r\n            return;\r\n        }\r\n        deviceInit = true;\r\n        let stream;\r\n\r\n        try {\r\n            stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n        } catch (err) {\r\n            console.error(\"Initial permission error:\", err);\r\n            return;\r\n        }\r\n\r\n        stream.getTracks().forEach(track => track.stop());\r\n\r\n        try {\r\n            const devices = await navigator.mediaDevices.enumerateDevices();\r\n            videoDevices = devices.filter(device => device.kind === 'videoinput');\r\n            \r\n            if (videoDevices.length > 0) {\r\n                selectedDeviceId = videoDevices[0].deviceId;\r\n                isInitialized = true;\r\n                am7model.getModelField(\"cameraOptions\", \"device\").limit = videoDevices.map(device => (device.label));\r\n                if(videoDevices.length > 1){\r\n                    console.log(\"Multiple cameras found, prompting user to select.\");\r\n                    pickCamera(fCaptureHandler);\r\n                }\r\n                else{\r\n                    console.log(\"Single camera found, starting capture.\");\r\n                    startCapture(fCaptureHandler);\r\n                }\r\n            } else {\r\n                page.toast(\"warn\", \"No webcams found.\");\r\n            }\r\n        } catch (err) {\r\n            page.toast(\"error\", \"Error finding devices.\");\r\n            console.error(\"Device enumeration error:\", err);\r\n        }\r\n\r\n    }\r\n\r\n    function pickCamera(fCaptureHandler){\r\n        let entity = am7model.newPrimitive(\"cameraOptions\");\r\n        let inst = am7model.prepareInstance(entity, am7model.forms.cameraOptions);\r\n        let cfg = {\r\n            label: \"Camera Options\",\r\n            entityType: \"cameraOptions\",\r\n            size: 50,\r\n            data: {entity, inst},\r\n            confirm: async function (data) {\r\n                let selectedLabel = data.entity.device;\r\n                console.log(\"Camera selected:\", selectedLabel);\r\n                let device = videoDevices.find(d => d.label.toLowerCase() === selectedLabel.toLowerCase());\r\n                if(device){\r\n                    selectedDeviceId = device.deviceId;\r\n                    startCapture(fCaptureHandler);\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"Selected camera not found: \" + selectedLabel);\r\n                }\r\n                page.components.dialog.endDialog();\r\n            },\r\n            cancel: async function (data) {\r\n                page.components.dialog.endDialog();\r\n            }\r\n        };\r\n        page.components.dialog.setDialog(cfg);\r\n    }\r\n\r\n    async function startCapture(fCaptureHandler) {\r\n        console.log(\"Starting capture with selected camera.\");\r\n        if (!selectedDeviceId) {\r\n            page.toast(\"warn\", \"Please select a camera first.\");\r\n            return;\r\n        }\r\n        if(isCapturing) {\r\n            page.toast(\"warn\", \"Capture is already in progress.\");\r\n            return;\r\n        }\r\n\r\n        isCapturing = true;\r\n        let videoEl = videoElement();\r\n        if(!videoEl){\r\n            page.toast(\"error\", \"Video element not found.\");\r\n            return;\r\n        }\r\n        if (videoEl.srcObject) {\r\n            videoEl.srcObject.getTracks().forEach(track => track.stop());\r\n        }\r\n\r\n        const constraints = { video: { deviceId: { exact: selectedDeviceId } } };\r\n                \r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia(constraints);\r\n            videoEl.srcObject = stream;\r\n            videoEl.onplaying = () => {\r\n                captureIntervalId = setInterval(\r\n                    () => captureAndSend(fCaptureHandler), \r\n                    CAPTURE_INTERVAL_SECONDS * 1000\r\n                );\r\n            };\r\n        } catch (err) {\r\n            isCapturing = false;\r\n            console.error(\"getUserMedia error:\", err);\r\n            page.toast(\"error\", \"getUserMedia error:\", err);\r\n        }\r\n    }\r\n    let capturing = false;\r\n    async function captureAndSend(fCaptureHandler) {\r\n        let videoEl = videoElement();\r\n        console.log(\"Capture and send triggered.\");\r\n        if (!videoEl || videoEl.paused || videoEl.ended) {\r\n            return;\r\n        }\r\n        if(capturing){\r\n            console.log(\"Capture already in progress, skipping this interval.\");\r\n            return;\r\n        }\r\n        capturing = true;\r\n                \r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = videoEl.videoWidth;\r\n        canvas.height = videoEl.videoHeight;\r\n        const context = canvas.getContext('2d');\r\n        context.drawImage(videoEl, 0, 0, canvas.width, canvas.height);\r\n\r\n        const imageData = canvas.toDataURL('image/jpeg', 0.9); // 0.9 is quality\r\n\r\n        let resp = await m.request({\r\n            method: 'POST',\r\n            url: API_ENDPOINT,\r\n            withCredentials: true,\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: { image_data: imageData }\r\n        });\r\n        if(fCaptureHandler && typeof fCaptureHandler === 'function') {\r\n            fCaptureHandler(resp);\r\n        }\r\n        // console.log(\"Capture and send complete:\", resp);\r\n        capturing = false;\r\n        return resp;\r\n    }\r\n    let camera = {\r\n        devices: ()=> videoDevices,\r\n        deviceId: ()=> selectedDeviceId,\r\n        startCapture,\r\n        stopCapture: function(){\r\n            //console.log(\"Stopping camera capture.\");\r\n            let videoEl = videoElement();\r\n            if (videoEl && videoEl.srcObject) {\r\n             videoEl.srcObject.getTracks().forEach(track => track.stop());\r\n            }\r\n            isCapturing = false;\r\n\r\n        },\r\n        videoView: ()=>  m('video#facecam', { autoplay: true, muted: true, playsinline: true, class: \"absolute top-0 left-0 opacity-0\", style: \"width: 1px; height: 1px;\" }),\r\n        cameraListView: () => m('select', {class: \"select-field-full\", onchange: e => { selectedDeviceId = e.target.value; }, disabled: isCapturing, value: selectedDeviceId},\r\n            videoDevices.map(device => \r\n                m('option', { value: device.deviceId }, device.label || `Camera (${device.deviceId.slice(0, 8)})`)\r\n            )\r\n        ),\r\n        cameraPickButton: () => m('button', {onclick: startCapture, disabled: isCapturing},'Start'),\r\n        initializeAndFindDevices,\r\n    };\r\n\r\n    page.components.camera = camera;\r\n\r\n}());\r\n\n\n;/* === client/view/main.js === */\n(function(){\r\n    const mainPage = {};\r\n    let vnode;\r\n    let nodeMain;\r\n\r\n    mainPage.view = {\r\n        oninit : function(x){\r\n\r\n        },\r\n        oncreate : function (x) {\r\n            nodeMain = document.querySelector(\"div.content-main\");\r\n        },\r\n        onremove : function(x){\r\n            //if(app) app.destroy();\r\n        },\r\n\r\n        view: function () {\r\n            //console.log(\"Render main\");\r\n            vnode = [m(\"div\",{class : \"content-outer\"},[\r\n                m(page.components.navigation),\r\n                m(\"div\",{class : \"content-main\"},[\r\n                    page.contentRouter()\r\n                ])\r\n            ]), page.components.dialog.loadDialog(), page.loadToast()];\r\n            return vnode;\r\n        }\r\n    };\r\n\r\n    page.views.main = mainPage.view;\r\n}());\r\n\n\n;/* === client/view/sig.js === */\n(function(){\r\n    const signInPage = {};\r\n    let vnode;\r\n\r\n    am7model.models.push({\r\n        name: \"login\",\r\n        icon: \"login\",\r\n        label: \"Login\",\r\n        fields: [\r\n            {name: \"organization\", default: \"/Public\", type: \"string\"},\r\n            {name: \"userName\", type: \"string\", \"rules\": [\"$notEmpty\"]},\r\n            {name: \"password\", type: \"string\", \"rules\": [\"$notEmpty\"]},\r\n            {name: \"specifyOrganizationPath\", type: \"string\"}\r\n        ]\r\n    });\r\n\r\n    /// Option chain: ?.\r\n    /// Null coalesce: ?? (eg: let x = null ?? prop)\r\n    /// Promise.allSettled\r\n\r\n    am7model.forms.login = {\r\n        label : \"Login\",\r\n        commands : {\r\n            login : {\r\n                label : 'Login',\r\n                icon : 'login',\r\n                action : 'login'\r\n            }\r\n        },\r\n        fields: {\r\n            organization: {\r\n                layout: \"full\",\r\n                format: \"list\",\r\n                values : [\"/Public\", \"/Development\", \"/System\"]\r\n            },\r\n            userName: {\r\n                layout: \"full\",\r\n                label: \"Name\"\r\n            },\r\n            password: {\r\n                layout: \"full\",\r\n                label: \"Password\",\r\n                type: \"password\"\r\n            }\r\n        }\r\n    };\r\n \r\n    let inst = am7model.newInstance(\"login\", am7model.forms.login);\r\n    window.dbgInst = inst;\r\n    inst.action(\"login\", doLogin);\r\n\r\n    function doLogin(){\r\n        if(!inst.validate()){\r\n            page.toast(\"warn\", \"Please fill in all fields\");\r\n            return;\r\n        }\r\n        uwm.login(inst.api.organization(), inst.api.userName(), inst.api.password(), 0, function(s){\r\n            if(s == null){\r\n                page.toast(\"error\", \"Login was unsuccessful\");\r\n            }\r\n            else{\r\n                page.toast(\"info\", \"Logged in as \" + s.name);\r\n                page.router.refresh();\r\n            }\r\n            \r\n        });\r\n        inst.api.password(\"\");\r\n    }\r\n    \r\n    let organizations = [\"Specify ...\",\"/Public\",\"/Development\",\"/System\"];\r\n\r\n    function toggleSpecify(){\r\n        let oSel = document.querySelector(\"#selOrganizationList\");\r\n        let i = oSel.selectedIndex;\r\n        if(i == -1){\r\n            i = 1;\r\n        }\r\n        document.querySelector(\"#specifyOrganizationPath\").style.display = ((i == 0) ? \"block\" : \"none\");\r\n    }\r\n\r\n    function orgFieldDesigner(i, e, v){\r\n        return m(\"div\",[\r\n            m(\"label\",{\r\n            class : \"block\",\r\n            for : \"organization\"\r\n            },[\r\n            \"Organization\"\r\n            ]),\r\n            organizationField()\r\n        ]);\r\n    }\r\n\r\n    function organizationField(){\r\n        return [\r\n            m(\"select\", {id: \"selOrganizationList\", onchange: inst.handleChange(\"organization\", toggleSpecify), class: \"w-full page-select reactive-arrow\"},\r\n                organizations.map((o, i)=>m(\"option\",{value:o,selected:(o==inst.api.organization())}, o)),\r\n            ),\r\n            m(\"input\",{\r\n                class : \"hidden text-field-full\",\r\n                type : \"text\",\r\n                id : \"specifyOrganizationPath\",\r\n                onchange: inst.handleChange(\"organization\"),\r\n                placeholder : \"/Custom\"\r\n            }) \r\n        ];\r\n    }\r\n\r\n    inst.designer(\"organization\", orgFieldDesigner);\r\n    inst.viewProperties(\"password\", { onkeydown : function(e){ if (e.which == 13) doLogin(); }});\r\n    inst.viewProperties(\"userName\", { autocapitalize  : \"off\" });\r\n\r\n \r\n    \r\n    signInPage.view = {\r\n        oninit : function(x){\r\n\r\n        },\r\n        oncreate : function (x) {\r\n            //document.querySelector(\"#selOrganizationList\").selectedIndex = 1;\r\n           /// toggleSpecify();\r\n            // app = page.space(entityName, x, entity);\r\n\r\n        },\r\n        onremove : function(x){\r\n\r\n        },\r\n\r\n        view: function () {\r\n            vnode = m(\"div\",{\r\n                class : \"screen-center-gray\"\r\n            },[\r\n                m(\"div\",{\r\n                    class : \"box-shadow-white\"\r\n                },[\r\n                    am7view.form(inst), page.loadToast()\r\n                ])\r\n                \r\n            ]);\r\n\r\n            return vnode;\r\n        }\r\n    };\r\n\r\n    page.views.sig = signInPage.view;\r\n}());\r\n\n\n;/* === client/view/saur.js === */\n(function(){\r\n    const authenticatedPage = {};\r\n    let vnode;\r\n    let entityName = \"sig\";\r\n    let app;\r\n    let entity = {\r\n\r\n    };\r\n    authenticatedPage.view = {\r\n        oninit : function(x){\r\n            // console.log(x);\r\n        },\r\n        oncreate : function (x) {\r\n            app = page.space(entityName, x, entity);\r\n        },\r\n        onremove : function(x){\r\n            if(app) app.destroy();\r\n        },\r\n\r\n        view: function () {\r\n            vnode = m(\"div\",{\r\n                class : \"screen-center-gray\"\r\n                , \"avoid\" : 1\r\n            },[\r\n  \r\n            ]);\r\n            return vnode;\r\n        }\r\n    };\r\n\r\n    page.views.saur = authenticatedPage.view;\r\n}());\r\n\n\n;/* === client/view/list.js === */\n(function () {\r\n\r\n  function newListControl() {\r\n\r\n    const listPage = {};\r\n    let app;\r\n    let wentBack = false;\r\n    let carousel = false;\r\n    let gridMode = 0;\r\n    let fullMode = false;\r\n    let maxMode = false;\r\n    let info = true;\r\n    let listType;\r\n    let baseListType;\r\n    let listContainerId;\r\n    let navContainerId = null;\r\n    let navFilter = null;\r\n    let pickerMode = false;\r\n    let embeddedMode = false;\r\n    let embeddedController;\r\n    let pickerHandler;\r\n    let pickerCancel;\r\n    let containerMode = false;\r\n    let defaultRecordCount = 10;\r\n    let defaultIconRecordCount = 40;\r\n    let modType;\r\n    let infiniteScroll = false;\r\n    let showFooter = false;\r\n    let showIconFooter = false;\r\n    let navigateByParent = false;\r\n    let systemList = false;\r\n    let pagination = page.pagination();\r\n\r\n    let dnd;\r\n    let taggingInProgress = false;\r\n    let taggingAbort = false;\r\n\r\n    function textField(sClass, id, plc, fKeyHandler) {\r\n      return m(\"input\", { placeholder: plc, onkeydown: fKeyHandler, id: id, type: \"text\", class: sClass });\r\n    }\r\n\r\n    function addNew() {\r\n      let pg = pagination.pages();\r\n      if (embeddedMode && embeddedController && embeddedController.addNew) {\r\n        console.info(\"Embedded add\");\r\n        embeddedController.addNew(pg.resultType, pg.containerId);\r\n      }\r\n      else {\r\n        let path = \"/\" + (m.route.get().match(/plist/) ? \"pnew\" : \"new\") + \"/\" + pg.resultType + \"/\" + pg.containerId;\r\n        console.info(\"Path\", path);\r\n        /// Note: Adding a key because cycling through the same view with different objects needs a full DOM rebuild to correctly disconnect the sync code\r\n        ///\r\n        m.route.set(path, { key: Date.now() });\r\n      }\r\n    }\r\n\r\n    function getSelected() {\r\n      let pages = pagination.pages();\r\n      return pages.pageResults[pages.currentPage].filter((v) => { return (pages.pageState[v.objectId] && pages.pageState[v.objectId].checked); })\r\n    }\r\n\r\n    function getSelectedIndices() {\r\n      let pages = pagination.pages();\r\n      let aRes = pages.pageResults[pages.currentPage];\r\n      let aSel = [];\r\n      Object.keys(pages.pageState).forEach((k) => {\r\n        if (pages.pageState[k].checked) {\r\n          let idx = aRes.findIndex((v) => v.objectId === k);\r\n          if (idx > -1) aSel.push(idx);\r\n        }\r\n      });\r\n      return aSel;\r\n    }\r\n\r\n    function getType(o) {\r\n      return (o[am7model.jsonModelKey] ? o[am7model.jsonModelKey] : listType);\r\n    }\r\n\r\n    function editItem(o) {\r\n      if (!o || o == null) {\r\n        console.error(\"Invalid object\");\r\n        return;\r\n      }\r\n      if (embeddedMode && embeddedController && embeddedController.addNew) {\r\n        embeddedController.editItem(o);\r\n      }\r\n      else {\r\n        m.route.set(\"/view/\" + getType(o) + \"/\" + o.objectId);\r\n      }\r\n    }\r\n\r\n    function editSelected() {\r\n      let idx = getSelectedIndices();\r\n      if (idx.length) {\r\n        let pages = pagination.pages();\r\n        editItem(pages.pageResults[pages.currentPage][idx[0]]);\r\n      }\r\n    }\r\n    async function deleteSelected() {\r\n      let contType = pagination.pages().containerType;\r\n      let subType = pagination.pages().containerSubType;\r\n      let bBucket = (subType && subType.match(/^(bucket|account|person)$/gi));\r\n      let label = (bBucket ? \"Remove\" : \"Delete\");\r\n      page.components.dialog.confirm(label + \" selected objects?\", async function () {\r\n        let idx = getSelectedIndices();\r\n        if (idx.length) {\r\n          let pages = pagination.pages();\r\n          let aP = [];\r\n          for (let i = 0; i < idx.length; i++) {\r\n            let obj = pages.pageResults[pages.currentPage][idx[i]];\r\n\r\n            if (bBucket) {\r\n              aP.push(page.member(contType, listContainerId, getType(obj), obj.objectId, false).then((r) => { if(r) page.toast(\"success\", \"Removed member\"); else page.toast(\"error\", \"Failed to remove member\"); }));\r\n            }\r\n            else {\r\n              aP.push(page.deleteObject(getType(obj), obj.objectId).then((r) => { if(r) page.toast(\"success\", \"Deleted object\"); else page.toast(\"error\", \"Failed to delete object\"); }));\r\n            }\r\n          }\r\n          await Promise.all(aP);\r\n          pagination.new();\r\n          m.redraw();\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n    async function applyTagsToList() {\r\n      // If already in progress, abort\r\n      if (taggingInProgress) {\r\n        taggingAbort = true;\r\n        page.toast(\"warn\", \"Aborting tag operation...\");\r\n        m.redraw();\r\n        return;\r\n      }\r\n\r\n      let pages = pagination.pages();\r\n      if (!pages.containerId || !pages.container) {\r\n        page.toast(\"error\", \"No container selected\");\r\n        return;\r\n      }\r\n\r\n      let groupId = pages.container.id;\r\n      if (!groupId) {\r\n        page.toast(\"error\", \"Container does not have a valid group ID\");\r\n        return;\r\n      }\r\n\r\n      // Build query to find data in the group, then filter for images client-side\r\n      let q = am7client.newQuery(\"data.data\");\r\n      q.field(\"groupId\", groupId);\r\n      q.entity.request = [\"id\", \"objectId\", \"name\", \"contentType\"];\r\n      q.range(0, 500);\r\n\r\n      page.toast(\"info\", \"Searching for images...\");\r\n      let qr = await page.search(q);\r\n\r\n      if (!qr || !qr.results || !qr.results.length) {\r\n        page.toast(\"warn\", \"No data found in this group\");\r\n        return;\r\n      }\r\n\r\n      // Filter for images only\r\n      let images = qr.results.filter(r => r.contentType && r.contentType.match(/^image\\//i));\r\n      if (!images.length) {\r\n        page.toast(\"warn\", \"No images found in this group\");\r\n        return;\r\n      }\r\n      taggingInProgress = true;\r\n      taggingAbort = false;\r\n      m.redraw();\r\n\r\n      let successCount = 0;\r\n      let errorCount = 0;\r\n\r\n      page.toast(\"info\", \"Tagging \" + images.length + \" images...\", 10000);\r\n\r\n      for (let i = 0; i < images.length; i++) {\r\n        if (taggingAbort) {\r\n          page.toast(\"warn\", \"Tag operation aborted at \" + i + \" of \" + images.length);\r\n          break;\r\n        }\r\n\r\n        let img = images[i];\r\n        page.toast(\"info\", \"Tagging \" + (i + 1) + \" of \" + images.length + \": \" + img.name, 5000);\r\n        try {\r\n          let tags = await page.applyImageTags(img.objectId);\r\n          if (tags) {\r\n            successCount++;\r\n          }\r\n        }\r\n        catch (e) {\r\n          console.error(\"Failed to tag image: \" + img.name, e);\r\n          errorCount++;\r\n        }\r\n      }\r\n\r\n      taggingInProgress = false;\r\n      taggingAbort = false;\r\n\r\n      if (successCount > 0 || errorCount > 0) {\r\n        page.toast(\"success\", \"Completed: \" + successCount + \" tagged\" + (errorCount > 0 ? \", \" + errorCount + \" errors\" : \"\"));\r\n      }\r\n\r\n      m.redraw();\r\n    }\r\n\r\n    function closeSelected() {\r\n      carousel = false;\r\n      pagination.pages().currentItem = undefined;\r\n      //pagination.new();\r\n      m.redraw();\r\n    }\r\n\r\n    function openSelected() {\r\n\r\n      /// open first selected\r\n      page.components.pdf.clear();\r\n      let idx = getSelectedIndices();\r\n      if (idx.length) {\r\n        carousel = true;\r\n        pagination.pages().currentItem = idx[0];\r\n        m.redraw();\r\n      }\r\n\r\n      /// Opens to multiple windows\r\n      /// pagination.routeToResult();\r\n    }\r\n    function navigateUp() {\r\n      let pages = pagination.pages();\r\n      if (pages.container) {\r\n        let type = listType;\r\n        if (type) {\r\n          type = modType.type || type;\r\n        }\r\n        let path;\r\n        if (type === 'auth.group') {\r\n          path = pages.container.path.substring(0, pages.container.path.lastIndexOf(\"/\"));\r\n          page.navigateToPath(type, modType, path).then((id) => {\r\n            if (embeddedMode || pickerMode) {\r\n              navContainerId = id;\r\n              m.redraw();\r\n            }\r\n            else {\r\n              page.listByType((containerMode ? baseListType : type), id);\r\n            }\r\n          });\r\n        }\r\n        else if (am7model.isParent(modType) && navigateByParent) {\r\n          let objectId = m.route.param(\"objectId\");\r\n          let q = am7view.viewQuery(am7model.newInstance(useType));\r\n          q.field(\"objectId\", objectId);\r\n\r\n          am7client.search(q, function (qr) {\r\n            let v;\r\n            if (qr && qr.results.length) v = qr[0];\r\n            //am7client.get(type, objectId, function(v){\r\n            if (v != null) {\r\n              /// this shouldn't be hit\r\n              /// am7model.inherits(modType, \"data.directory\")\r\n              if (v.parentId == 0 && am7model.isGroup(modType)) {\r\n                console.warn(\"Navigate up from zero parent shouldn't be hit unless at the top - resetting out of parent mode\");\r\n                page.navigateToPath(type, modType, v.groupPath).then((id) => {\r\n                  page.listByType((containerMode ? baseListType : type), id, false);\r\n                });\r\n                //navigateByParent = false;\r\n                //page.listByType((containerMode ? baseListType : type), v.objectId, false);\r\n              }\r\n              else {\r\n                am7client.get(type, v.parentId, function (v2) {\r\n                  if (v2 != null) {\r\n                    page.listByType((containerMode ? baseListType : type), v2.objectId, true);\r\n                  }\r\n                });\r\n              }\r\n            }\r\n          });\r\n        }\r\n        else {\r\n          console.error(\"Handle \" + type);\r\n        }\r\n      }\r\n    }\r\n\r\n    async function navigateToPathId(grp) {\r\n      let ltype = baseListType;\r\n\r\n      if (embeddedMode || pickerMode) {\r\n        let byParent = (am7model.isParent(modType) && type !== 'auth.group');\r\n        navContainerId = grp.objectId;\r\n        if (byParent) navigateByParent = true;\r\n        m.redraw();\r\n      }\r\n      else {\r\n        m.route.set(\"/list/\" + (containerMode ? baseListType : ltype) + \"/\" + grp.objectId, { key: Date.now() });\r\n      }\r\n    }\r\n\r\n    async function openSystemLibrary() {\r\n      let grp = await page.systemLibrary(baseListType);\r\n      navigateToPathId(grp);\r\n    }\r\n\r\n    async function openOlio(){\r\n      let og = await page.findObject(\"auth.group\", \"DATA\", \"/Olio/Universes\");\r\n      navigateToPathId(og);\r\n    }\r\n\r\n    async function openFavorites() {\r\n      let fav = await page.favorites();\r\n      navigateToPathId(fav);\r\n    }\r\n\r\n    async function openPath(path) {\r\n      let grp = await page.findObject(\"auth.group\", \"DATA\", path);\r\n      if(!grp){\r\n        page.toast(\"error\", \"Path not found: \" + path);\r\n        return;\r\n      }\r\n      navigateToPathId(grp);\r\n    }\r\n\r\n\r\n    function navigateDown(sel) {\r\n      let idx = getSelectedIndices();\r\n      let type = listType;\r\n      if (type) {\r\n        type = modType.type || type;\r\n      }\r\n      let byParent = (am7model.isParent(modType) && type !== 'auth.group');\r\n      if (sel && !sel[am7model.jsonModelKey]) sel = null;\r\n      if (sel || idx.length) {\r\n        let pages = pagination.pages();\r\n        let obj = sel || pages.pageResults[pages.currentPage][idx[0]];\r\n        // containerMode || \r\n        if (embeddedMode || pickerMode) {\r\n          //console.log(\"Nav down: \" + obj.objectId);\r\n          navContainerId = obj.objectId;\r\n          if (byParent) navigateByParent = true;\r\n          //pagination.new();\r\n          m.redraw();\r\n        }\r\n        else {\r\n          let ltype = obj[am7model.jsonModelKey] || baseListType;\r\n          m.route.set(\"/\" + (byParent ? 'p' : '') + \"list/\" + (containerMode ? baseListType : ltype) + \"/\" + obj.objectId, { key: Date.now() });\r\n        }\r\n      }\r\n    }\r\n\r\n    function listSystemType() {\r\n      systemList = !systemList;\r\n      pagination.new();\r\n      m.redraw();\r\n    }\r\n\r\n    function openItem(o) {\r\n      let pages = pagination.pages();\r\n      let aRes = pages.pageResults[pages.currentPage];\r\n      let idx = aRes.findIndex((v) => v.objectId === o.objectId);\r\n      if (idx > -1) {\r\n        carousel = true;\r\n        pages.currentItem = idx;\r\n        m.redraw();\r\n      }\r\n      //openSelected();\r\n\r\n      /// Opens to a window\r\n      /// pagination.routeToResult(o);\r\n    }\r\n\r\n    function selectResult(o) {\r\n      let state = pagination.state(o);\r\n      state.checked = !state.checked;\r\n      m.redraw();\r\n    }\r\n\r\n    function toggleInfo() {\r\n      info = !info;\r\n      m.redraw();\r\n    }\r\n\r\n    function toggleContainer() {\r\n      containerMode = !containerMode;\r\n      pagination.new();\r\n      m.redraw();\r\n    }\r\n    function toggleGrid(bOff) {\r\n      if (typeof bOff == 'boolean' && !bOff) gridMode = 0;\r\n      else gridMode++;\r\n      if (gridMode > 2) gridMode = 0;\r\n      let rc = defaultRecordCount;\r\n      if (gridMode == 1) rc = defaultIconRecordCount;\r\n      let pages = pagination.pages();\r\n      if (embeddedMode || pickerMode) {\r\n        // Reset pagination and start fresh with new record count\r\n        pagination.new();\r\n        pagination.update(listType, listContainerId, navigateByParent, navFilter, 0, rc, systemList);\r\n        m.redraw();\r\n      }\r\n      else {\r\n        m.route.set(pagination.url(1, rc), { key: Date.now() });\r\n      }\r\n    }\r\n\r\n    function toggleCarousel() {\r\n      carousel = !carousel;\r\n      m.redraw();\r\n    }\r\n\r\n    function toggleCarouselFull(bForce) {\r\n      if (typeof bForce == \"boolean\") {\r\n        fullMode = bForce;\r\n      }\r\n      else {\r\n        fullMode = !fullMode;\r\n        if (embeddedController) {\r\n          embeddedController.toggleFullMode();\r\n        }\r\n        else {\r\n          m.redraw();\r\n        }\r\n      }\r\n    }\r\n\r\n    function toggleCarouselMax() {\r\n      maxMode = !maxMode;\r\n      m.redraw();\r\n    }\r\n\r\n    function displayGrid() {\r\n      return am7decorator.gridListView(getListController());\r\n    }\r\n\r\n    function getListController(){\r\n      return {\r\n        containerMode,\r\n        listPage,\r\n        showIconFooter,\r\n        embeddedMode,\r\n        pickerMode,\r\n        results: getCurrentResults,\r\n        gridMode,\r\n        info,\r\n        pagination,\r\n        fullMode,\r\n        maxMode,\r\n        listType,\r\n        edit: editItem,\r\n        move: moveCarousel,\r\n        moveTo: moveCarouselTo,\r\n        select: selectResult,\r\n        open: openItem,\r\n        down: navigateDown,\r\n        onscroll: checkScrollPagination,\r\n        toggleCarousel,\r\n        toggleCarouselFull,\r\n        toggleCarouselMax,\r\n        toggleInfo\r\n      };\r\n    }\r\n \r\n    function displayList() {\r\n      let results = [];\r\n      let rset;\r\n      let pages = pagination.pages();\r\n      page.checkFavorites();\r\n\r\n      if (pages.pageResults[pages.currentPage]) {\r\n        if (infiniteScroll) {\r\n          rset = [].concat.apply([], pagination.pages().pageResults.slice(1, pages.currentPage + 1));\r\n        }\r\n        else rset = pages.pageResults[pages.currentPage];\r\n      }\r\n\r\n      //lreturn am7decorator.polarListView(getListController(), rset);\r\n      return am7decorator.tabularView(getListController(), rset);\r\n    }\r\n\r\n    function checkScrollPagination() {\r\n      if (!infiniteScroll) return;\r\n      let pages = pagination.pages();\r\n\r\n      let list = document.querySelector('[rid=resultList]');\r\n      let limit = (list.clientHeight + list.scrollTop) > (list.scrollHeight - 10);\r\n      if (pages.currentPage != pages.pageCount && limit) {\r\n        // console.log(\"peak ahead\");\r\n        list.removeEventListener('scroll', checkScrollPagination);\r\n        pagination.next();\r\n      }\r\n    }\r\n\r\n    function getOptionButton(type){\r\n      let optButton;\r\n      let selected = (getSelectedIndices().length > 0);\r\n      if (containerMode || type === 'auth.group' || am7model.isParent(modType)) {\r\n        let disableUp = (type !== 'auth.group' && am7model.isParent(modType) && !navigateByParent)\r\n        optButton = [pagination.button(\"button\" + (disableUp ? \" inactive\" : \"\"), \"north_west\", \"\", navigateUp), pagination.button(\"button\" + (!selected ? \" inactive\" : \"\"), \"south_east\", \"\", navigateDown)]\r\n      }\r\n      else if (!pickerMode) {\r\n        optButton = pagination.button(\"button\" + (carousel ? \" active\" : \"\"), \"view_carousel\", \"\", toggleCarousel);\r\n      }\r\n      return optButton;\r\n    }\r\n\r\n    function getAdminButtons(type){\r\n      let rs = page.context().roles;\r\n      let buttons = [];\r\n      let cnt = pagination.pages().container;\r\n      let favSel = \"\";\r\n      if (type.match(/^policy\\.policy/) || rs.accountAdmin || (rs.roleReader && type.match(/^auth\\.role$/gi)) || (rs.permissionReader && type.match(/^auth\\.permission$/gi))) {\r\n        buttons.push(pagination.button(\"button mr-4\" + (systemList ? \" active\" : \"\"), \"admin_panel_settings\", \"\", listSystemType));\r\n      }\r\n      else if (am7model.system.library[type]) {\r\n        if (cnt && cnt.path.match(/^\\/Library/gi)) favSel = \" bg-orange-200 active\";\r\n        buttons.push(pagination.button(\"button mr-4\" + (systemList ? \" active\" + favSel : \"\"), \"admin_panel_settings\", \"\", openSystemLibrary));\r\n      }\r\n      return buttons;\r\n    }\r\n\r\n    function getPickerButton(){\r\n      let buttons = [];\r\n      if (pickerMode) {\r\n        buttons.push(pagination.button(\"button\", \"check\", \"\", function () { pickerHandler(getSelected()); }));\r\n        if (pickerCancel) {\r\n          buttons.push(pagination.button(\"button\", \"close\", \"\", function () { pickerCancel(); }));\r\n        }\r\n      }\r\n      return buttons;\r\n    }\r\n\r\n    function getActionButtons(type){\r\n      let buttons = [];\r\n      if (!pickerMode && !containerMode) {\r\n        let selected = (getSelectedIndices().length > 0);\r\n        buttons.push(pagination.button(\"button mr-4\", (fullMode ? \"close_fullscreen\" : \"open_in_new\"), \"\", toggleCarouselFull));\r\n        if (!modType.systemNew) buttons.push(pagination.button(\"button\", \"add\", \"\", addNew));\r\n        if(type && type == \"olio.charPerson\"){\r\n          buttons.push(pagination.button(\"button\", \"steppers\", \"\", am7model.forms.commands.characterWizard));\r\n        }\r\n        buttons.push(pagination.button(\"button\" + (!selected ? \" inactive\" : \"\"), \"file_open\", \"\", openSelected));\r\n        buttons.push(pagination.button(\"button\" + (!selected ? \" inactive\" : \"\"), \"edit\", \"\", editSelected));\r\n        let bBucket = (pagination.pages().containerSubType && pagination.pages().containerSubType.match(/^(bucket|account|person)$/gi));\r\n        buttons.push(pagination.button(\"button\" + (!selected ? \" inactive\" : \"\"), (bBucket ? \"playlist_remove\" : \"delete\"), \"\", deleteSelected));\r\n        if(type && type == \"data.data\"){\r\n          buttons.push(pagination.button(\"button\" + (taggingInProgress ? \" active\" : \"\"), \"sell\", \"\", applyTagsToList));\r\n        }\r\n      }\r\n\r\n      return buttons;\r\n    }\r\n\r\n    function getPageToggleButtons(type){\r\n      let buttons = [];\r\n      buttons.push(pagination.button(\"button\" + (gridMode > 0 ? \" active\" : \"\"), (gridMode <= 1 ? \"apps\" : \"grid_view\"), \"\", toggleGrid));\r\n      if (!embeddedMode && (!containerMode || !type.match(/^auth\\.group$/gi)) && modType.group) buttons.push(pagination.button(\"button\" + (navigateByParent ? \" inactive\" : (containerMode ? \" active\" : \"\")), 'group_work', \"\", toggleContainer));\r\n      buttons.push( pagination.button(\"button\" + (info ? \" active\" : \"\"), \"info\", \"\", toggleInfo));\r\n      return buttons;\r\n    }\r\n\r\n    function getGroupSearchButtons(){\r\n      let buttons = [];\r\n      if (am7model.isGroup(modType)) {\r\n        let plc = \"\";\r\n        let cnt = pagination.pages().container;\r\n        if(cnt && cnt.path) plc = cnt.path;\r\n        buttons.push(textField(\"text-field\", \"listFilter\", plc, function (e) { if (e.which == 13) doFilter(); },));\r\n        buttons.push(pagination.button(\"button\", \"search\", null, doFilter));\r\n      }\r\n      return buttons;\r\n    }\r\n\r\n    function getOlioButtons(){\r\n      let buttons = [];\r\n      let oliSel = \"\";\r\n      let cnt = pagination.pages().container;\r\n      if (cnt && cnt.path.match(/^\\/olio/gi)) oliSel = \" bg-orange-200 active\";\r\n      buttons.push(pagination.button(\"button\" + oliSel, \"globe\", \"\", openOlio));\r\n      return buttons;\r\n    }\r\n\r\n    function getFavoriteButtons(){\r\n      let buttons = [];\r\n      let cnt = pagination.pages().container;\r\n      let favSel = \"\";\r\n      if (cnt && cnt.name.match(/favorites/gi)) favSel = \" bg-orange-200 active\";\r\n      buttons.push(pagination.button(\"button\" + favSel, \"favorite\", \"\", openFavorites));\r\n      return buttons;\r\n    }\r\n\r\n    function getActionButtonBar(type){\r\n      let buttons = [];\r\n      buttons.push(getPickerButton());\r\n      buttons.push(getAdminButtons(type));\r\n      buttons.push(getActionButtons(type));\r\n      buttons.push(getOlioButtons());\r\n      buttons.push(getFavoriteButtons());\r\n      buttons.push(getOptionButton(type));\r\n      buttons.push(getPageToggleButtons(type));\r\n      buttons.push(getGroupSearchButtons());\r\n      return buttons;\r\n    }\r\n\r\n    function getListViewInner(type) {\r\n\r\n      let buttons = getActionButtonBar(type);\r\n\r\n      let fdoh = function (e) {\r\n        e.preventDefault();\r\n      };\r\n      let fdrh = dnd.doDrop;\r\n\r\n      return m(\"div\", { ondragover: fdoh, ondrop: fdrh, class: \"list-results-container\" }, [\r\n        m(\"div\", { class: \"list-results\" }, [\r\n          m(\"div\", { class: \"result-nav-outer\" }, [\r\n            m(\"div\", { class: \"result-nav-inner\" }, [\r\n              m(\"div\", { class: \"result-nav tab-container\" },\r\n                buttons\r\n              ),\r\n              m(\"nav\", { class: \"result-nav\" }, [\r\n                pagination.pageButtons()\r\n              ])\r\n            ])\r\n          ]),\r\n          (gridMode > 0 ? displayGrid() : displayList()),\r\n          (showFooter ? pagination.pageBarView() : \"\")\r\n        ])\r\n      ]);\r\n    }\r\n\r\n    function doFilter() {\r\n      navFilter = document.querySelector(\"[id=listFilter]\").value;\r\n      if (!navFilter.length) navFilter = null;\r\n\r\n      else if(navFilter.indexOf(\"..\") > -1 || navFilter.indexOf(\"~\") > -1 || navFilter.indexOf(\"/\") > -1){\r\n        let npath = page.normalizePath(navFilter, pagination.pages().container);\r\n        if(npath){\r\n          openPath(npath);\r\n        }\r\n        return;\r\n      }\r\n\r\n      let red = false;\r\n      if (embeddedMode || pickerMode) {\r\n        //m.redraw();\r\n        red = true;\r\n      }\r\n\r\n      else pagination.filter(navFilter, red);\r\n    }\r\n\r\n    function getListView() {\r\n      let type = m.route.param(\"type\");\r\n      return m(\"div\", { class: \"content-outer\" }, [\r\n        (fullMode ? \"\" : m(page.components.navigation)),\r\n        m(\"div\", { class: \"content-main\" }, [\r\n          getListViewInner(type)\r\n        ])\r\n      ]);\r\n    }\r\n\r\n   \r\n\r\n    function moveCarouselTo(i) {\r\n      let pages = pagination.pages();\r\n      wentBack = false;\r\n      pages.currentItem = i;\r\n      m.redraw();\r\n    }\r\n\r\n    function moveCarousel(i) {\r\n      let pages = pagination.pages();\r\n      let pr = pages.pageResults[pages.currentPage];\r\n      page.components.pdf.clear();\r\n      wentBack = false;\r\n\r\n      let idx = pages.currentItem + i;\r\n      if (pr && idx >= pr.length) {\r\n        if (pages.currentPage < pages.pageCount) pagination.next(embeddedMode || pickerMode);\r\n      }\r\n      else if (idx < 0) {\r\n        if (pages.currentPage > 1) {\r\n          wentBack = true;\r\n          pagination.prev(embeddedMode || pickerMode);\r\n        }\r\n      }\r\n      else {\r\n        pages.currentItem = idx;\r\n        m.redraw();\r\n      }\r\n    }\r\n\r\n\r\n\r\n    function getCurrentResults(){\r\n      let pages = pagination.pages();\r\n      let pr = pages.pageResults[pages.currentPage];\r\n      if (pr) {\r\n        if (wentBack) {\r\n          pages.currentItem = pr.length - 1;\r\n        }\r\n        if (pages.currentItem < 0 && pr.length) pages.currentItem = 0;\r\n      }\r\n      return pr;\r\n    }\r\n\r\n\r\n\r\n    function navListKey(e) {\r\n      wentBack = false;\r\n      //if(carousel || gridMode){\r\n      switch (e.keyCode) {\r\n        /// <\r\n        case 37:\r\n          //if((gridMode && !carousel) || e.shiftKey){\r\n          if (!carousel || e.shiftKey) {\r\n            wentBack = true;\r\n            pagination.prev(embeddedMode || pickerMode);\r\n          }\r\n          else moveCarousel(-1);\r\n          break;\r\n        /// >\r\n        case 39:\r\n          //if((gridMode && !carousel) || e.shiftKey)\r\n          if (!carousel || e.shiftKey) {\r\n            pagination.next(embeddedMode || pickerMode);\r\n          }\r\n          else moveCarousel(1);\r\n          break;\r\n        /// ESC\r\n        case 27:\r\n          if (carousel) toggleCarousel();\r\n          else if (gridMode > 0) toggleGrid(false);\r\n          else if (fullMode) toggleCarouselFull();\r\n          break;\r\n      }\r\n\r\n      // }\r\n    }\r\n\r\n    function initParams(vnode) {\r\n      ;\r\n      listType = vnode.attrs.type || m.route.param(\"type\") || \"data\";\r\n\r\n      modType = am7model.getModel(listType);\r\n      if (!modType) {\r\n        console.error(\"Missing modType for type \" + listType);\r\n      }\r\n      else {\r\n        navigateByParent = vnode.attrs.navigateByParent || (m.route.get().match(/^\\/plist/) != null);\r\n        if (navigateByParent && !am7model.isParent(modType)) {\r\n          console.warn(\"Type is not clustered by parent\");\r\n          navigateByParent = false;\r\n        }\r\n      }\r\n      baseListType = listType;\r\n      if (modType.group && containerMode && !listType.match(/^auth\\.group$/gi)) listType = 'auth.group';\r\n      listContainerId = navContainerId || vnode.attrs.objectId || m.route.param(\"objectId\");\r\n      if (!embeddedMode && !pickerMode) navContainerId = null;\r\n    }\r\n\r\n    function update(vnode) {\r\n      initParams(vnode);\r\n      let listFilter = navFilter || vnode.attrs.filter || m.route.param(\"filter\");\r\n      if (listFilter) listFilter = decodeURI(listFilter);\r\n\r\n      let pages = pagination.pages();\r\n      // In embedded/picker mode, skip update if pagination has results to avoid resetting state\r\n      if ((embeddedMode || pickerMode) && pages.counted && pages.currentPage > 0) {\r\n        return;\r\n      }\r\n      let currentDefaultRecordCount = (gridMode == 1) ? defaultIconRecordCount : defaultRecordCount;\r\n      let startRecord = vnode.attrs.startRecord || m.route.param(\"startRecord\");\r\n      let recordCount = vnode.attrs.recordCount || m.route.param(\"recordCount\") || currentDefaultRecordCount;\r\n      pagination.update(listType, listContainerId, navigateByParent, listFilter, startRecord, recordCount, systemList);\r\n\r\n      if(carousel){\r\n        let pr = getCurrentResults();\r\n        let cient = pr ? pr[pagination.pages().currentItem] : undefined;\r\n        if(cient && page.context().contextObjects[cient.objectId]){\r\n          if(page.components.pdf.viewer(cient.objectId)){\r\n            page.components.pdf.viewers[cient.objectId].init(1.0);\r\n          }\r\n        }\r\n      }\r\n     }\r\n\r\n    listPage.closeView = function () {\r\n      closeSelected();\r\n    };\r\n\r\n    listPage.pagination = function () {\r\n      return pagination;\r\n    };\r\n\r\n    listPage.view = {\r\n      oninit: function (x) {\r\n        dnd = page.components.dnd;\r\n        initParams(x);\r\n        document.documentElement.addEventListener(\"keydown\", navListKey);\r\n      },\r\n      oncreate: function (x) {\r\n        fullMode = x.attrs.fullMode || fullMode;\r\n        pickerMode = x.attrs.pickerMode;\r\n        embeddedMode = x.attrs.embeddedMode;\r\n        embeddedController = x.attrs.embeddedController;\r\n        pickerHandler = x.attrs.pickerHandler;\r\n        pickerCancel = x.attrs.pickerCancel;\r\n        pagination.setEmbeddedMode(embeddedMode || pickerMode);\r\n        update(x);\r\n      },\r\n      onupdate: function (x) {\r\n        update(x);\r\n      },\r\n      onremove: function (x) {\r\n        page.components.pdf.clear();\r\n        navFilter = null;\r\n        document.documentElement.removeEventListener(\"keydown\", navListKey);\r\n        pagination.stop();\r\n        if (app) app.destroy();\r\n      },\r\n\r\n      view: function (vnode) {\r\n        let v;\r\n        if (vnode.attrs.pickerMode || (!carousel && vnode.attrs.embeddedMode)) v = getListViewInner(vnode.attrs.type);\r\n        else if (carousel) {\r\n          if (vnode.attrs.embeddedMode) v = am7decorator.carouselItem(getListController());\r\n          else v = v = am7decorator.carouselView(getListController());\r\n        }\r\n        else v = getListView();\r\n        if (vnode.attrs.pickerMode || vnode.attrs.embeddedMode) return v;\r\n        return [v, page.components.dialog.loadDialog(), page.loadToast()];\r\n      }\r\n    };\r\n    window.dbgList = listPage;\r\n    return listPage;\r\n  }\r\n\r\n  page.views.list = newListControl;\r\n}());\r\n\n\n;/* === client/view/object.js === */\n(function(){\r\n    function newObjectPage(){\r\n        let objectPage = {};\r\n        let entity;\r\n        let inst;\r\n        let pinst = {};\r\n        let oinst = {};\r\n        let app;\r\n        let tabIndex = 0;\r\n        let pickerMode = {};\r\n        let childPickerMode;\r\n        let fullMode = false;\r\n        let designMode = false;\r\n        let caller;\r\n        let callerIndex;\r\n        let callerActive;\r\n\r\n        let pendingResponse;\r\n        let valuesState = {};\r\n        let foreignData = {};\r\n        let definition;\r\n        let listView = page.views.list().view;\r\n\r\n        let embeddedMode = false;\r\n        let embeddedController;\r\n        let showFooter = false;\r\n\r\n        let objectType;\r\n        let objectId;\r\n        \r\n        let objectNew;\r\n        let parentNew;\r\n        let streamSeg;\r\n        let pdfViewer;\r\n        let parentProperty;\r\n\r\n        objectPage.pinst = function(){\r\n            return pinst;\r\n        };\r\n        objectPage.oinst = function(){\r\n            return oinst;\r\n        };\r\n\r\n        function toggleFullMode(){\r\n            fullMode = !fullMode;\r\n            if(embeddedController){\r\n                embeddedController.toggleFullMode();\r\n            }\r\n            else{\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        function printJSONToWindow(){\r\n            let s = JSON.stringify(inst.entity, null, 2);\r\n            let bu = page.blobUrl(\"data:text/json;base64,\" + Base64.encode(s));\r\n            let w = window.open(bu, inst.entity.name);\r\n        }\r\n\r\n        async function toggleDesignMode(){\r\n            if(!designMode){\r\n                /// Refresh the entity byte array when temporarily shifting views in the event it changed\r\n                /// Note: this is necessary because the field is not directly associated to the view, and isn't picked up by synchronizing the component.\r\n                let mt = document.querySelector(\"[name='contentType']\").value;\r\n                let txtEl = document.querySelector(\"[name='dataBytesStore-mt']\");\r\n                if(mt.match(/javascript/gi) && txtEl && txtEl.value === \"\"){\r\n                    let v = await m.request({method: \"GET\", responseType: \"text\", withCredentials: true, url: g_application_path + \"/rest/script/template\"});\r\n                    console.log(g_application_path + \"/rest/script/template\", v);\r\n                    if(v && v != null){\r\n                        txtEl.value = v;\r\n                        toggleDesignMode();\r\n                        return;\r\n                    }\r\n                    \r\n                }\r\n                if(txtEl){\r\n                    inst.api.dataBytesStore(txtEl.value);\r\n                    if(inst.api.compressionType){\r\n                        inst.api.compressionType(\"none\");\r\n                    }\r\n                }\r\n            }\r\n            else if(designMode && objectPage.transitionHandler){\r\n                objectPage.transitionHandler(objectPage, entity);\r\n            }\r\n            designMode = !designMode;\r\n            m.redraw();\r\n        }\r\n\r\n        function doUpdate(){\r\n            if(!entity){\r\n                console.error(\"No entity defined\");\r\n                return;\r\n            }\r\n            if(!entity[am7model.jsonModelKey] || entity[am7model.jsonModelKey] === 'UNKNOWN'){\r\n                console.error(\"Unknown entity type\");\r\n                return;\r\n            }\r\n            let syncText = true;\r\n            /// If clicking 'update' while in design mode, transfer the rich edit buffer back to the entity\r\n            ///\r\n            if(designMode && objectPage.transitionHandler){\r\n                console.log(\"Consume design buffer\");\r\n                objectPage.transitionHandler(objectPage, entity);\r\n                syncText = false;\r\n                designMode = false;\r\n            }\r\n\r\n            /// Synchronize the form with the entity\r\n            /// \r\n            if(entity[am7model.jsonModelKey].match(/^data\\.data$/i)){\r\n                if(am7view.isBinary(entity)){\r\n                    console.log(\"Don't update binary content via form.\");\r\n                    inst.api.dataBytesStore(\"\");\r\n                    inst.unchange(\"dataBytesStore\")\r\n                }\r\n                else if(syncText){\r\n                    if(!inst.changes.includes(\"dataBytesStore\")) inst.changes.push(\"dataBytesStore\");\r\n                    let txtEl = document.querySelector(\"[name='dataBytesStore-mt']\");\r\n                    if(txtEl){\r\n                        inst.api.dataBytesStore(txtEl.value);\r\n                        if(inst.api.compressionType){\r\n                            inst.api.compressionType(\"none\");\r\n                        }\r\n                    }\r\n                    else{\r\n                        console.warn(\"Did not locate textarea\"); \r\n                    }\r\n                }\r\n            }\r\n            else if(entity[am7model.jsonModelKey].match(/^message$/i)){\r\n                let txtEl = document.querySelector(\"[name='data-mt']\");\r\n                if(!inst.changes.includes(\"data\")) inst.changes.push(\"data\");\r\n                if(txtEl) entity.data = Base64.encode(txtEl.value);\r\n                else{\r\n                    console.warn(\"Did not locate textarea\"); \r\n                }\r\n            }\r\n            let bpatch = am7model.hasIdentity(entity);\r\n\r\n            if(!inst.validate(true)){\r\n                page.toast(\"warn\", \"Please fill in all fields\");\r\n                return;\r\n            }\r\n\r\n            /// check for updates via nested object references\r\n            /// Eg: Object.childObject.property\r\n            let aP = [];\r\n            Object.keys(pinst).forEach(k => {\r\n                if(!inst.field(k).foreign){\r\n                    console.log(\"Field not foreign: \" + k);\r\n                    inst.change(k);\r\n                }\r\n                else{\r\n                    let e = pinst[k];\r\n                    let upatch = e.hasIdentity();\r\n                    let puint = (upatch ? e.patch() : e.entity);\r\n                    /// Make sure to create the object, even if it has no changes\r\n                    /// OR - if nothing has changed, it needs to be stripped off the entity, pinst, and oinst \r\n                    \r\n                    if(puint && bpatch && (!upatch || e.changes.length)){\r\n    \r\n                        aP.push(am7client[upatch ? \"patch\" : \"create\"](e.entity[am7model.jsonModelKey], puint, function(v){\r\n                            e.resetChanges();\r\n                            if(!upatch){\r\n                                for(let i in v){\r\n                                    e.entity[i] = v[i];\r\n                                }\r\n                                /// For create operations, substitute the whole object for the minimal id reference received in the response\r\n\r\n                                inst.api[k](v);\r\n                            }\r\n                            else{\r\n                                inst.unchange(k);\r\n                            }\r\n                        }));\r\n                    }\r\n                }\r\n            });\r\n            if(aP.length){\r\n                Promise.all(aP).then(() => {\r\n                    console.log(\"Continue with base update\");\r\n                    doUpdate();\r\n                });\r\n                return;\r\n            }\r\n\r\n            if(!inst.changes.length){\r\n                page.toast(\"warn\", \"No changes were detected, so nothing was updated\");\r\n                return;\r\n            }\r\n            \r\n            let uint = (bpatch ? inst.patch() : entity);\r\n            if(!uint){\r\n                page.toast(\"warn\", \"No patch fields were identified, so nothing was updated\");\r\n                console.warn(\"Nothing to update\");\r\n                return;\r\n            }\r\n\r\n            am7client[bpatch ? \"patch\" : \"create\"](entity[am7model.jsonModelKey], uint, function(v){\r\n                if(v != null){\r\n                    page.toast(\"success\", \"Saved!\");\r\n                    let bNew = objectNew || parentNew;\r\n                    inst.resetChanges();\r\n                    if(entity[am7model.jsonModelKey].match(/message/i)){\r\n                        history.back();\r\n                    }\r\n                    else{\r\n                        am7client.clearCache(entity[am7model.jsonModelKey], false, function(){\r\n                            if(!bpatch){\r\n                                entity = v;\r\n                            }\r\n                            page.clearContextObject(entity.objectId);\r\n                            objectNew = false;\r\n                            parentNew = false;\r\n                            if(embeddedMode && embeddedController){\r\n                                embeddedController.editItem(entity);\r\n                            }\r\n                            else if(bNew){\r\n                                let uri = \"/view/\" + entity[am7model.jsonModelKey] + \"/\" + entity.objectId;\r\n                                m.route.set(uri, {key: entity.objectId});\r\n                            }\r\n                            else{\r\n                                m.redraw();\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                else{\r\n                    page.toast(\"error\", \"An error occurred while trying to update the object\");\r\n                    console.error(v);\r\n                }\r\n            });\r\n        }\r\n        function cancelPicker(bNoRefresh){\r\n            if(childPickerMode){\r\n                childPickerMode.cancelPicker(bNoRefresh);\r\n                childPickerMode = undefined;\r\n            }\r\n            pickerMode.enabled = false;\r\n            if(!bNoRefresh){\r\n                m.redraw();\r\n            }\r\n        }\r\n        function enablePicker(bNoRefresh){\r\n            pickerMode.enabled = true;\r\n            if(caller){\r\n                caller.setChildPickerMode(objectPage);\r\n            }\r\n            if(!bNoRefresh){\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        function doCancel(){\r\n            if(pickerMode.enabled || childPickerMode){\r\n                cancelPicker();\r\n            }\r\n            else if(embeddedMode && embeddedController){\r\n                embeddedController.cancelView();\r\n            }\r\n            else{\r\n                history.back();\r\n                m.redraw();\r\n            }\r\n        }\r\n        \r\n        async function chatInto(){\r\n            page.components.dialog.chatInto(inst.entity);\r\n        }\r\n\r\n        async function applyTags(){\r\n            if(!entity || !entity.objectId) return;\r\n            if(!entity.contentType || !entity.contentType.match(/^image\\//gi)){\r\n                page.toast(\"warn\", \"Tag application is only available for images\");\r\n                return;\r\n            }\r\n            page.toast(\"info\", \"Applying image tags...\");\r\n            try {\r\n                let tags = await page.applyImageTags(entity.objectId);\r\n                console.log(\"applyImageTags result:\", tags);\r\n                if(tags && Array.isArray(tags) && tags.length){\r\n                    page.toast(\"success\", \"Applied \" + tags.length + \" tags\");\r\n                }\r\n                else if(tags){\r\n                    page.toast(\"success\", \"Tags applied\");\r\n                }\r\n                else {\r\n                    page.toast(\"warn\", \"No tags were applied\");\r\n                }\r\n            }\r\n            catch(e){\r\n                console.error(e);\r\n                page.toast(\"error\", \"Failed to apply tags\");\r\n            }\r\n        }\r\n        \r\n        async function doCopy(){\r\n            if(!entity || !entity.objectId) return;\r\n            if(am7model.hasField(entity[am7model.jsonModelKey], \"name\")){\r\n                entity.name += \" Copy\";\r\n            }\r\n            entity.objectId = undefined;\r\n            entity.id = undefined;\r\n            entity.urn = undefined;\r\n            delete entity.vaultId;\r\n            delete entity.vaulted;\r\n            delete entity.keyId;\r\n            resetEntity(entity);\r\n            m.redraw();\r\n        }\r\n        async function doDelete(){\r\n            if(!entity || !entity.objectId) return;\r\n            let type = entity[am7model.jsonModelKey];\r\n            let path = entity.groupPath;\r\n            page.components.dialog.confirm(\"Delete this object?\", async function(){\r\n                await page.deleteObject(entity[am7model.jsonModelKey], entity.objectId);\r\n                history.back();\r\n            });\r\n        }\r\n        function buttonTab(active, label, fHandler){\r\n            let icoName = (active ? \"tab\" : \"tab_unselected\");\r\n            let cls = \"button-tab\" + (active ? \" button-tab-active\" : \"\");\r\n            return m(\"button\", {class : cls, onclick : fHandler}, m(\"span\",{class : \"material-icons-outlined mr-2\"}, icoName), label);\r\n        }\r\n        function switchTab(i){\r\n            tabIndex = i;\r\n            cancelPicker();\r\n        }\r\n\r\n        function getFormatForContentType(format){\r\n            if(!entity || !entity.contentType){\r\n                return \"textarea\";\r\n            }\r\n\r\n            let mt = entity.contentType;\r\n            if(!am7view.isBinary(entity, mt)) format = 'textarea';\r\n            else if(mt.match(/^image/)) format = 'image';\r\n            else if(mt.match(/pdf$/)) format = 'pdf';\r\n            else{\r\n                console.warn(\"Unhandled contentType: \" + mt);\r\n            }\r\n\r\n            return format;\r\n        }\r\n\r\n\r\n        async function postRender(){\r\n            if(!entity){\r\n                return;\r\n            }\r\n            if(pdfViewer){\r\n                pdfViewer.init(0.5);\r\n            }\r\n\r\n        }\r\n\r\n\r\n        function getFormCommands(name, form, field, bSel, bEdit, bAdjust){\r\n            if(!form.commands) return [];\r\n            let iter = 0;\r\n            return Object.keys(form.commands).map((k)=>{\r\n                let cmd = form.commands[k];\r\n                let active = false;\r\n                /// check for a condition to restrict activation\r\n                if(cmd.requiredAttribute && !cmd.condition){\r\n                    if(entity && entity[cmd.requiredAttribute]){\r\n                        active = true;\r\n                    }\r\n                }\r\n                else if(!cmd.condition || (bSel && cmd.condition.includes(\"select\")) || (bEdit && cmd.condition.includes(\"edit\"))) active = true;\r\n\r\n                let icon = cmd.icon;\r\n                let func = cmd.function;\r\n                if(cmd.altCondition && bEdit && cmd.altCondition.includes(\"edit\")){\r\n                    func = cmd.altFunction;\r\n                    icon = cmd.altIcon;\r\n                }\r\n                iter++;\r\n                let cls = \"button\" + (active ? \"\" : \" inactive\") + (bAdjust && iter == 1 ? \" ml-4\" : \"\");\r\n                return page.iconButton(cls, icon, \"\", function(){\r\n                    objectPage[func](name, field, (field ? field.baseModel : name), form, cmd.properties);\r\n                });\r\n            })\r\n        }\r\n        function getFormCommandView(name, form, field, bSel, bEdit){\r\n            if(!form.commands) return [];\r\n            return [m(\"div\",{class: \"result-nav-outer\"},[\r\n                m(\"div\",{class: \"result-nav-inner\"},[   \r\n                    m(\"div\",{class: \"result-nav\"},\r\n                        getFormCommands(name, form, field, bSel, bEdit)\r\n                    )\r\n                ])\r\n        ])];\r\n        }\r\n\r\n        function getValuesForFormField(name, fieldView, field, fieldClass, hidden){\r\n            let cmds = [];\r\n            let rows = [];\r\n            /// Get the field for the viewModel off the itemType of the supplied field\r\n            if(!entity) return rows;\r\n\r\n            if(!field.function){\r\n                console.error(\"Expected the field for \" + name + \" to specify a function\");\r\n                return rows;\r\n            }\r\n\r\n            return objectPage[field.function](name, fieldView, field, fieldClass, hidden);\r\n        }\r\n\r\n        function getValuesForTableField(name, fieldView, field, fieldClass, hidden){\r\n            let cmds = [];\r\n            let rows = [];\r\n            /// Get the field for the viewModel off the itemType of the supplied field\r\n            if(!entity) return rows;\r\n            if(!field.baseModel){\r\n                console.error(\"Expected the itemType to include field definitions for formatting the table\");\r\n                return rows;\r\n            }\r\n            if(!fieldView.form){\r\n                console.error(\"Expected the field view for \" + name + \" to specify an additional form\");\r\n                console.log(fieldView);\r\n                return rows;\r\n            }\r\n            let tableType = field.baseModel;\r\n            if(tableType == \"$self\"){\r\n                tableType = entity[am7model.jsonModelKey];\r\n            }\r\n            let tableForm = fieldView.form;\r\n            let bEdit = false;\r\n            let bSel = false;\r\n            if(field.foreign){\r\n                if(!foreignData[name]){\r\n                    if(field.function){\r\n                        objectPage[field.function](name, field).then((data) => {\r\n                            foreignData[name] = data;\r\n                            m.redraw();\r\n                        });\r\n                        return rows;\r\n                    }\r\n                }\r\n            }\r\n\r\n            Object.keys(valuesState).forEach((k)=>{\r\n                let state = valuesState[k];\r\n                if(state.attribute === name){\r\n                    if(state.mode === 'edit') bEdit = true;\r\n                    if(state.selected) bSel = true;\r\n                }\r\n            });\r\n            if(!hidden && tableForm.commands){\r\n                cmds = getFormCommandView(name, tableForm, field, bSel, bEdit);\r\n            }\r\n\r\n            let rowModel = [];\r\n            Object.keys(tableForm.fields).forEach((k)=>{\r\n                let tableField = am7model.getModelField(tableType, k, am7view.typeToModel(entity[field.foreignType]));\r\n                let tableFieldView = tableForm.fields[k];\r\n                rowModel.push({name: k, fieldView : tableFieldView, field : tableField});\r\n            });\r\n            \r\n            if(!hidden){\r\n                rows.push(m(\"tr\",rowModel.map((r)=>{\r\n                    if(!r.field){\r\n                        r.field = am7model.getModelField(tableType, r.name);\r\n                    }\r\n                    return m(\"th\", r.fieldView?.label || r.field?.label);\r\n                })));\r\n            }\r\n\r\n            if(entity){\r\n                \r\n                let vals;\r\n                if(inst.api[name]) vals = inst.api[name]();\r\n                else if(field.foreign) vals = foreignData[name];\r\n                else if(field.parentProperty){\r\n                    if(entity[field.parentProperty]){\r\n                        vals = entity[field.parentProperty][name];\r\n                    }\r\n                }\r\n                else vals = entity[name];\r\n                if(vals && field.type.match(/^(array|list)$/)){\r\n                    vals.forEach((v, i) => {\r\n                        if(!valuesState[name + \"-\" + i]){\r\n                            valuesState[name + \"-\" + i] = {attribute: name, foreign: field.foreign, index : i, selected: false, mode: 'view'};\r\n                        }\r\n                        let state = valuesState[name + \"-\" + i];\r\n                        let rowClass = \"\";\r\n                        if(state.selected) rowClass = \"row-field-active\";\r\n                        let selectHandler;\r\n                        if(state.mode === 'view'){\r\n                            rowClass += \" row-field\";\r\n                            selectHandler = function(){\r\n                                valuesState[name + \"-\" + i].selected = !valuesState[name + \"-\" + i].selected;\r\n                                m.redraw();\r\n                            }\r\n                        }\r\n                        let cv;\r\n                        if(v && v[am7model.jsonModelKey]){\r\n                            cv = am7model.prepareInstance(v, fieldView?.form);\r\n                        }\r\n\r\n\r\n                        rows.push(m(\"tr\", {class: rowClass, onclick : selectHandler},\r\n                            rowModel.map((rm)=>{\r\n                                if(state.mode == 'edit'){\r\n                                    return m(\"td\", modelField(rm.name, rm.fieldView, rm.field, rm.name + \"-\" + i, (cv ? cv.api[rm.name]() : v[rm.name]), true, v, fieldView?.form));\r\n                                }\r\n                                else{\r\n                                    let val;\r\n\r\n                                    if(rm?.field?.pickerProperty){\r\n                                        let findVal = v[rm.field.pickerProperty.entity];\r\n                                        let ctx = page.context();\r\n                    \r\n                                        if(findVal){\r\n                                            if(typeof findVal === 'object'){\r\n                                                val = findVal.name;\r\n                                            }\r\n                                            else if(!ctx.contextObjects[findVal]){\r\n                                                let type = rm.field.pickerType;\r\n                                                if(!type || type === 'self') type = v[am7model.jsonModelKey];\r\n                                                else type = type;\r\n                                                if(type.match(/^\\./)){\r\n                                                    type = v[rm.field.pickerType.slice(1)];\r\n                                                }\r\n                                                page.openObject(type, findVal).then((a)=>{\r\n                                                    m.redraw();\r\n                                                });\r\n                                            }\r\n                                            else {\r\n                                                val = ctx.contextObjects[findVal].name;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    else{\r\n                                        val = (cv ? cv.api[rm.name]() : v[rm.name]);\r\n                                    }\r\n                                    return m(\"td\", \"\" + val);\r\n                                }\r\n                            })\r\n                        ))\r\n                    })\r\n                }\r\n                else{\r\n                    // console.log(\"What to do: \" + name + \" / \" + field.type + \" / \" + vals);\r\n                }\r\n            }\r\n\r\n            return [cmds, m(\"table\",{class: fieldClass}, rows)];\r\n        }\r\n\r\n        let spans = [\"row-span-1\",\"row-span-2\", \"row-span-3\", \"row-span-4\", \"row-span-5\"];\r\n        let spans2 = [\"row-span-auto\",\"row-span-full\"];\r\n\r\n        function modelFieldContainer(name, fieldView, field){\r\n            let className = \"field-grid-item-full\";\r\n            if(fieldView.layout == \"half\") className = \"field-grid-item-half\";\r\n            else if(fieldView.layout == \"fifth\") className = \"field-grid-item-fifth\";\r\n            else if(fieldView.layout == \"two-thirds\") className = \"field-grid-item-two-thirds\";\r\n            else if(fieldView.layout == \"third\") className = \"field-grid-item-third\";\r\n            else if(fieldView.layout == \"one\") className = \"field-grid-item-one\";\r\n            if(fieldView.rows) className += \" \" + spans[fieldView.rows-1];\r\n            let labelClass = \"field-label\";\r\n            let show = am7view.showField(inst, fieldView);\r\n            \r\n            if(!show){\r\n                labelClass += \" text-gray-300\"\r\n            }\r\n            let lbl = (fieldView.label || field.label || field.name);\r\n            return m(\"div\",{class: className},[\r\n                m(\"label\",{class : labelClass, for: name}, lbl), //  || name\r\n                modelField(name, fieldView, field)\r\n            ]);\r\n\r\n        }\r\n\r\n        function getObjectProperty(name, field){\r\n            let val;\r\n            if(!entity || entity === null) return val;\r\n\r\n            if(field.baseModel && field.typeAttribute){\r\n                let vVal = entity[field.typeAttribute]\r\n                if(!vVal){\r\n                    console.log(\"Entity doesn't define \" + field.typeAttribute);\r\n                    return val;\r\n                }\r\n                if(field.property){\r\n                    let vProp = vVal[field.property];\r\n                    if(!vProp){\r\n                        console.warn(field.typeAttribute + \" doesn't define \" + field.property);\r\n                        return val;\r\n                    }\r\n                    val = vProp;\r\n                }\r\n            }\r\n\r\n            return val;\r\n        }\r\n\r\n        function updateChange(evt, field){\r\n            if(entity && field && field.pickerProperty && field.pickerProperty.entity){\r\n                entity[field.pickerProperty.entity] = (evt.srcElement || evt.target).value;\r\n            }\r\n        }\r\n\r\n\r\n\r\n        function modelField(name, fieldView, field, altName, altVal, noChange, altEntity, altForm){\r\n\r\n            let useEntity = altEntity || entity;\r\n            let format = (fieldView?.form?.format || fieldView.format || field.format || am7view.getFormatForType(field.type));\r\n            let useName = altName || name;\r\n            let view = [];\r\n            let disabled = false;\r\n            let fieldClass = \"\";\r\n            if(inst.validationErrors[name]){\r\n                fieldClass += \"field-error\";\r\n            }\r\n            else if(field.readOnly || fieldView.readOnly){\r\n                disabled = true;\r\n                fieldClass += \"field-disabled\";\r\n            }\r\n            else if(field.required){\r\n                fieldClass += \"field-required\";\r\n            }\r\n\r\n            if(field.foreign && field.type.match(/^(model|list)$/) && fieldView.autocreate && (!entity[name] || !entity[name].length)){\r\n                let aom = getPrimitive(field.baseModel);\r\n                let aname = \"Auto \" + field.baseModel + \" \" + page.luid();\r\n                if(am7model.hasField(field.baseModel, \"name\")){\r\n                    aom.name = aname;\r\n                }\r\n                if(field.type == 'model'){\r\n                    entity[field.name] = aom;\r\n                }\r\n                else if(field.type == 'list'){\r\n                    entity[field.name] = [aom];\r\n                }\r\n            }\r\n\r\n            let defVal = (inst && !altEntity && inst.api[name] ? inst.api[name]() : undefined);\r\n            if(field.function && objectPage[field.function] && !field.foreign){\r\n                if(field.promise){\r\n                    defVal = foreignData[name];\r\n                    if(!defVal){\r\n\r\n                        objectPage[field.function](name, field).then((v) => {\r\n                            foreignData[name] = v;\r\n                            inst.api[name](v);\r\n                            m.redraw();\r\n                        });\r\n                    }\r\n                }\r\n                else{\r\n                    defVal = objectPage[field.function](name, field);\r\n                }\r\n            }\r\n            else if(altVal){\r\n\r\n                defVal = altVal;\r\n            }\r\n\r\n            let fHandler;\r\n            if(!noChange && !disabled && !field.command){\r\n                fHandler = inst.handleChange(name, updateChange)\r\n            }\r\n\r\n            if(format === 'contentType'){\r\n                useName = name + \"-mt\";\r\n                format = getFormatForContentType(format);\r\n            }\r\n\r\n            if(field.property && !defVal){\r\n                defVal = getObjectProperty(name, field);\r\n            }\r\n\r\n            let show = am7view.showField(inst, fieldView);\r\n            let annot = \"\";\r\n            if(inst.validationErrors[name]){\r\n                annot = am7view.errorLabel(inst.validationErrors[name]);\r\n            }\r\n            if(!show) fieldClass += \" hidden\";\r\n\r\n            /// Build context for field renderers\r\n            let rendererCtx = {\r\n                inst: inst,\r\n                entity: entity,\r\n                useEntity: useEntity,\r\n                field: field,\r\n                fieldView: fieldView,\r\n                name: name,\r\n                useName: useName,\r\n                defVal: defVal,\r\n                fieldClass: fieldClass,\r\n                disabled: disabled,\r\n                fHandler: fHandler,\r\n                show: show,\r\n                objectPage: objectPage,\r\n                /// Callbacks for complex renderers\r\n                updateChange: updateChange,\r\n                doFieldPicker: doFieldPicker,\r\n                doFieldOpen: doFieldOpen,\r\n                doFieldClear: doFieldClear,\r\n                printJSONToWindow: printJSONToWindow,\r\n                getValuesForTableField: getValuesForTableField,\r\n                getValuesForFormField: getValuesForFormField,\r\n                /// Special state for certain renderers\r\n                pdfViewer: pdfViewer,\r\n                streamSeg: streamSeg,\r\n                loadStream: function(streamId) {\r\n                    page.stream(streamId).then((o) => {\r\n                        streamSeg = o;\r\n                        m.redraw();\r\n                    });\r\n                }\r\n            };\r\n\r\n            /// Try to use the new formFieldRenderers component\r\n            if(page.components.formFieldRenderers && page.components.formFieldRenderers.has(format)){\r\n                let rendered = page.components.formFieldRenderers.render(format, rendererCtx);\r\n                if(rendered){\r\n                    view.push(...rendered);\r\n                    view.push(annot);\r\n                    return view;\r\n                }\r\n            }\r\n\r\n            /// Fallback to original switch for any unhandled formats\r\n            switch(format){\r\n                default:\r\n                    console.error(\"Handle: \" + format);\r\n                    break;\r\n            }\r\n            view.push(annot);\r\n            return view;\r\n        }\r\n        async function doFieldOpen(field){\r\n            if(!entity || !field.pickerProperty) return;\r\n            let id;\r\n            let type = (entity[am7model.jsonModelKey] ? entity[am7model.jsonModelKey] : undefined);\r\n            let prop = field.pickerProperty.entity;\r\n            if(field.pickerType && !field.pickerType.match(/^self$/)) type = field.pickerType;\r\n            if(type.match(/^\\./)){\r\n                type = entity[type.slice(1)];\r\n            }\r\n            if(field.pickerProperty.selected === '{object}') id = entity[prop].objectId;\r\n            else id = entity[prop];\r\n            if(id && type){\r\n                if(typeof id == \"number\" || id.match(/^am:/)){\r\n                    let obj2 = await page.openObject(type, id);\r\n                    if(obj2 != null){\r\n                        id = obj2.objectId;\r\n                    }\r\n                }\r\n                let uri = \"/view/\" + type + \"/\" + id;\r\n                m.route.set(uri, {key: id});            \r\n            }\r\n            else{\r\n                console.warn(\"Missing id or type: \" + id + \", \" + type);\r\n            }\r\n        }\r\n\r\n        function doFieldClear(field){\r\n            if(!entity || !field.pickerProperty) return;\r\n            let prop = field.pickerProperty.entity;\r\n            if(field.pickerProperty.selected === '{object}' || typeof entity[prop] == \"string\") inst.api[prop](null);\r\n            else if(typeof entity[prop] == \"number\") inst.api[prop](0);\r\n            updateChange();\r\n\r\n            /// Clear the server cache because the parent may have a cached copy of the child\r\n            ///\r\n            if(prop === 'parentId'){\r\n                am7client.clearCache(entity[am7model.jsonModelKey], false, function(){});\r\n            }\r\n        }\r\n        function doFieldPicker(field, useName, altEntity, altPath, pickerHandler){\r\n            let useEntity = altEntity || entity;\r\n            if(!useEntity || !field.pickerProperty){\r\n                console.log(\"Invalid entity or field property\",useEntity,field);\r\n                return;\r\n            }\r\n            let mat;\r\n            let type = (entity[am7model.jsonModelKey] ? entity[am7model.jsonModelKey] : undefined);\r\n            let setType = false;\r\n            /// Special handling for embedding pickers in disconnected tables\r\n            ///\r\n            if(\r\n                field.pickerProperty.foreign\r\n                &&\r\n                useName\r\n                &&\r\n                (mat = useName.match(/(\\-\\d+)$/)) != null\r\n                &&\r\n                field.pickerType\r\n                &&\r\n                field.pickerType.match(/^\\./)\r\n            ){\r\n                // console.log(field.pickerType.slice(1) + mat[1]);\r\n                let el = document.querySelector(\"[name='\" + field.pickerType.slice(1) + mat[1] + \"']\");\r\n                type = el.value.toLowerCase();\r\n                setType = true;\r\n            }\r\n            else{\r\n                if(field.pickerType && field.pickerType !== 'self') type = field.pickerType;\r\n                if(type.match(/^\\./)){\r\n                    type = useEntity[type.slice(1)].toLowerCase();\r\n                }\r\n            }\r\n            if(!type.match(/^unknown$/gi)){\r\n                preparePicker(type, function(data){\r\n                    if(data && data.length){\r\n                        if(useEntity == inst.entity){\r\n                            \r\n                            if(field.pickerProperty.selected === '{object}'){\r\n                                if(field.pickerProperty.entity.match(/\\./)){\r\n                                    let pv = field.pickerProperty.entity.split(\".\");\r\n                                    if(pinst[pv[0]]){\r\n                                        inst[pv[0]].api(data[0]);\r\n                                        pinst[pv[0]].api[pv[1]](data[0]);\r\n                                    }\r\n                                    else{\r\n                                        console.warn(\"didn't find \" + pv[0]);\r\n                                    }\r\n                                }\r\n                                else{\r\n                                    inst.api[field.pickerProperty.entity](data[0]);\r\n                                }\r\n                            }\r\n                            else{\r\n                                console.log(\"Update\", field.pickerProperty.entity);\r\n                                inst.api[field.pickerProperty.entity](data[0][field.pickerProperty.selected]);\r\n                            }\r\n                            cancelPicker(true);\r\n                            if(setType){\r\n                                inst.api[field.pickerType.slice(1)](type);\r\n                            }\r\n\r\n                        }\r\n                        else{\r\n                            if(field.pickerProperty.selected === '{object}') useEntity[field.pickerProperty.entity] = data[0];\r\n                            else useEntity[field.pickerProperty.entity] = data[0][field.pickerProperty.selected];\r\n                            cancelPicker(true);\r\n                            if(setType){\r\n                                useEntity[field.pickerType.slice(1)] = type;\r\n                            }\r\n                        }\r\n                        updateChange();\r\n                        inst.action(useName);\r\n                        if(pickerHandler){\r\n                            pickerHandler(objectPage, inst, field, useName, data[0]);\r\n                        }\r\n                        /// Clear the server cache because the parent may have a cached copy of the child\r\n                        ///\r\n                        if(!useEntity[am7model.jsonModelKey] || useEntity[am7model.jsonModelKey].match(/message/i)) m.redraw();\r\n                        else{\r\n                            am7client.clearCache(useEntity[am7model.jsonModelKey], false, function(){\r\n                                m.redraw();\r\n                            });\r\n                        }\r\n                    }\r\n                }, altPath || field.pickerProperty.path);\r\n            }\r\n        }\r\n        function modelForm(active, type, form){\r\n            \r\n            if(pickerMode.enabled && active){\r\n                /// force the current form to inactive to make way for the list\r\n                active = false;\r\n            }\r\n            \r\n            if(form.model){\r\n                if(!inst){\r\n                    return \"\";\r\n                }\r\n                if(!form.property){\r\n                    console.warn(\"A property is required\");\r\n                    return m(\"div\", \"Property name required for form\");\r\n                }\r\n                let minst;\r\n                \r\n                if(!pinst[form.property]){\r\n\r\n                    let mf = am7model.getModelField(type, form.property);\r\n                    if(!mf || !mf.baseModel){\r\n                        console.warn(\"Property does not exist or does not define a baseModel\");\r\n                        return m(\"div\", \"Incorrect property cited for a model form\");\r\n                    }\r\n                    let mo = inst.api[form.property]();\r\n                    let oid;\r\n                    let cinst;\r\n                    if(mo){\r\n                        oid = mo.objectId;\r\n                    }\r\n                    else{\r\n                        mo = getPrimitive(mf.baseModel);\r\n                        inst.api[form.property](mo);\r\n                        /// force the model def because certain settings will result in an empty object\r\n                        mo[am7model.jsonModelKey] = mf.baseModel;\r\n\r\n                    }\r\n                    minst = am7model.prepareInstance(mo);\r\n                    pinst[form.property] = minst;\r\n                    oinst[form.property] = page.views.object();\r\n                }\r\n                else{\r\n                    minst = pinst[form.property];\r\n                }\r\n                let ooinst = oinst[form.property];\r\n                let props = {\r\n                    freeForm: true,\r\n                    freeFormEntity: minst.entity,\r\n                    freeFormType: minst.model.name,\r\n                    parentProperty: form.property,\r\n                    objectId: minst.entity.objectId,\r\n                    callerIndex: tabIndex,\r\n                    caller: objectPage,\r\n                    callerActive: active\r\n                  };\r\n                return m(ooinst.view, props);\r\n            }\r\n            \r\n\r\n\r\n            let outF = [];\r\n            Object.keys(form.fields).forEach((e)=>{\r\n                let field = form.fields[e].field || am7model.getModelField(type, e);\r\n                if(!field){\r\n                    console.warn(\"Failed to find field \" + e + \" for \" + type);\r\n                    console.warn(form);\r\n                }\r\n                else{\r\n                    outF.push(modelFieldContainer(e, form.fields[e], field));\r\n                }\r\n            });\r\n            return m(\"div\", {class: \"field-grid-6\" + (!active ? \" hidden\" : \"\")}, outF);\r\n\r\n        }\r\n        function modelPicker(active){\r\n            let pickList = \"\";\r\n            if(pickerMode.enabled && active){\r\n                pickList = m(listView, {\r\n                    type: pickerMode.type,\r\n                    objectId: pickerMode.containerId,\r\n                    startRecord: 0,\r\n                    recordCount: 0,\r\n                    pickerMode: true,\r\n                    pickerHandler : pickerMode.handler,\r\n                    pickerCancel : cancelPicker\r\n                });\r\n            }\r\n            return pickList;\r\n        }\r\n        function getForm(){\r\n            let type = objectType;\r\n            let form = inst.form;\r\n            if(!form){\r\n                console.error(\"Invalid form for \" + type);\r\n                return;\r\n            }\r\n            /// Need to keep pick list separate from the form for style reasons\r\n            ///\r\n            let forms = [];\r\n            let pickList;\r\n\r\n            let cactive = (callerIndex == undefined || callerActive);\r\n\r\n            let active = (tabIndex == 0) && cactive;\r\n\r\n            let mForm = modelForm(active, type, form);\r\n            if(active) pickList = modelPicker(active);\r\n            forms.push(mForm);\r\n            (form.forms || []).forEach((f, i)=>{\r\n                active = (tabIndex == (i + 1)) && cactive;\r\n                let cForm = am7model.forms[f];\r\n                if(!cForm){\r\n                    console.warn(\"Failed to find form \" + f);\r\n                }\r\n                else{\r\n                    mForm = modelForm(active, type, cForm);\r\n                    if(active) pickList = modelPicker(active);\r\n                    forms.push(mForm);\r\n                }\r\n            });\r\n            return [m(\"div\",{class: \"results-overflow\" + (pickerMode.enabled || designMode ? \" hidden\" : \"\") + (caller ? \" p-0 m-0\": \"\")}, forms), pickList];\r\n        }\r\n\r\n        function getFormTabs(){\r\n            if(!entity) return \"\";\r\n            let type = objectType;\r\n            let modType = inst.model;\r\n            if(!inst){\r\n                return \"\";\r\n            }\r\n            let form = inst.form;\r\n            if(!form){\r\n                console.warn(\"Invalid form for \" + type);\r\n                return;\r\n            }\r\n\r\n            let tabs = [];\r\n            let active = (tabIndex == 0);\r\n            tabs.push(buttonTab(active, form.label || type, function(){ switchTab(0);}));\r\n            form.forms.forEach((f, i)=>{\r\n                active = (tabIndex == (i+1));\r\n                let cForm = am7model.forms[f];\r\n                if(!cForm){\r\n                    console.warn(\"Failed to find form to construct tab \" + f);\r\n                }\r\n                else{\r\n                    let show = am7view.showField(inst, cForm);\r\n                    if(show) tabs.push(buttonTab(active, cForm.label || f, function(){ switchTab(i + 1);}));\r\n                }\r\n            });\r\n            return tabs;\r\n        }\r\n\r\n        function getFooter(){\r\n            let footer = \"\";\r\n            if(showFooter){\r\n                footer = m(\"div\",{class: \"result-nav-outer\"},[\r\n                m(\"div\",{class: \"result-nav-inner\"},[\r\n                    m(\"div\",{class: \"count-label\"},\"...\"),\r\n                        m(\"nav\",{class: \"result-nav\"},[\r\n                        \"Bottom\"\r\n                        ])\r\n                    ])\r\n                ]);\r\n            }\r\n            return footer;\r\n        }\r\n\r\n        function getObjectViewInner(){\r\n\r\n            let bNew = objectNew || parentNew;\r\n            let designable = (entity && entity.contentType && entity.contentType.match(/(^text\\/(css|plain)$|\\/x-javascript$)/gi)) ? true : false;\r\n\r\n            let altCls = '';\r\n            if(inst.changes.length){\r\n                altCls = ' warn';\r\n            }\r\n\r\n            let type = objectType;\r\n            let form = am7model.forms[type.substring(type.lastIndexOf(\".\") + 1)];\r\n            if(!form){\r\n                console.warn(\"Invalid form for \" + type);\r\n                return \"\";\r\n            }\r\n\r\n            let footer = getFooter();\r\n            return m(\"div\",{class : \"list-results-container\"},[\r\n                m(\"div\",{class : \"list-results\"},[\r\n                m(\"div\",{class: \"result-nav-outer\"},[\r\n                    m(\"div\",{class: \"result-nav-inner\"},[\r\n                        m(\"div\",{class: \"result-nav tab-container\"},[\r\n                            page.iconButton(\"button mr-4\", (fullMode ? \"close_fullscreen\" : \"open_in_new\"), \"\", toggleFullMode),\r\n                            page.iconButton(\"button\" + altCls,\"save\", \"\", doUpdate),\r\n                            (designable ? page.iconButton(\"button\" + (designMode ? \" active\" : \"\"),\"design_services\", \"\", toggleDesignMode) : \"\"),\r\n                            page.iconButton(\"button\",\"cancel\", \"\", doCancel),\r\n                            (bNew ? \"\" : page.iconButton(\"button\",\"content_copy\", \"\", doCopy)),\r\n                            (bNew ? \"\" : page.iconButton(\"button\",\"query_stats\", \"\", chatInto)),\r\n                            (bNew || type !== \"olio.charPerson\" ? \"\" : page.iconButton(\"button\",\"photo_library\", \"\", function(){ page.imageGallery([], inst); })),\r\n                            (bNew || type !== \"data.data\" ? \"\" : page.iconButton(\"button\",\"sell\", \"\", applyTags)),\r\n                            (bNew ? \"\" : page.iconButton(\"button\",\"delete_outline\", \"\", doDelete)),\r\n                            getFormCommands(type, form, null, false, false, true)\r\n                        ]),\r\n                        m(\"div\",{class: (designMode ? \" hidden\" : \"result-nav tab-container\")},\r\n                            getFormTabs()\r\n                        )\r\n                    ])\r\n                ]),\r\n                getForm(),\r\n                (designable ? m(page.components.designer, {entity:entity, visible: designMode, caller: objectPage}) : \"\"),\r\n                footer\r\n            ])\r\n        ]);\r\n        }\r\n        function getObjectView(){\r\n\r\n            return m(\"div\",{class : \"content-outer\"},[\r\n                (!entity || fullMode ? \"\" : m(page.components.navigation)),\r\n                m(\"div\",{class : \"content-main\"},[\r\n                    getObjectViewInner()\r\n            ])\r\n            ]);\r\n            \r\n        }\r\n        function getPrimitive(type){\r\n\r\n            let model = page.context();\r\n            let bNew = objectNew;//m.route.get().match(/^\\/new/gi);\r\n            let modType = am7model.getModel(type);\r\n            let primitive = am7model.newPrimitive(type);\r\n            let cobj;\r\n\r\n            if(bNew && (cobj = model.contextObjects[objectId])){\r\n                if(am7model.isGroup(modType)){\r\n                    \r\n                    if(type === 'auth.group'){\r\n                        primitive.parentId = cobj.id;\r\n                    }\r\n                    else{\r\n                        primitive.groupPath = cobj.path;\r\n                        primitive.groupId = cobj.id;\r\n                    }\r\n                    /// Note: org path is ignored on create, instead using the authenticated principle's organization, so this is only set for display purposes\r\n                    if(page.authenticated()) primitive.organizationPath = cobj.organizationPath;\r\n                }\r\n                else if(am7model.isParent(modType) && type.match(/^(auth\\.role|auth\\.permission)$/gi)){\r\n                    primitive.parentId = cobj.id;\r\n                    primitive.path = cobj.path;\r\n                }\r\n                else{\r\n                    console.warn(\"Handle not a group for \" + type);\r\n                }\r\n            }\r\n            if(model.pendingEntity){\r\n                Object.keys(model.pendingEntity).forEach((i) => {\r\n                    if(!i.match(/^(parentId|parentPath|groupPath)$/)){\r\n                        primitive[i] = model.pendingEntity[i];\r\n                    }\r\n                });\r\n                model.pendingEntity = undefined;\r\n            }\r\n\r\n            return primitive;\r\n        }\r\n\r\n        function setEntity(vnode){\r\n            let type = objectType;\r\n            valuesState = {};\r\n            foreignData = {};\r\n            pickerMode = {};\r\n            entity = null;\r\n            tabIndex = 0;\r\n\r\n            let model = page.context();\r\n            let bNew = objectNew;\r\n            let bPNew = parentNew;\r\n            let modType = am7model.getModel(type);\r\n            if(vnode && vnode.attrs.freeForm){\r\n                entity = vnode.attrs.freeFormEntity || {schema: objectType};\r\n                if(entity[am7model.jsonModelKey] && am7model.hasIdentity(entity)){\r\n                    let q = am7view.viewQuery(am7model.newInstance(type));\r\n                    /// Force query to include objectId - it's possible it wasn't requested for an embedded form, and doesn't belong in a common query suggestion\r\n                    /// This is because the membership operations depend on the objectId vs. the id or urn.\r\n                    ///\r\n                    if(am7model.hasField(type, \"objectId\") && !q.entity.request.filter(r => r == \"objectId\").length){\r\n                        q.entity.request.push(\"objectId\");\r\n                    }\r\n\r\n                    if(entity.id){\r\n                        q.field(\"id\", entity.id);    \r\n                    }\r\n                    else if(entity.objectId){\r\n                        q.field(\"objectId\", entity.objectId);\r\n                    }\r\n                    am7client.search(q, function(qr){\r\n                        if(qr && qr.count){\r\n                            let v = qr.results[0];\r\n                            entity = v;\r\n                            setApp(vnode);\r\n                        }\r\n                        else{\r\n                            console.warn(\"Failed to search for \" + q.key());\r\n                        }\r\n                    });\r\n                }\r\n                else{\r\n                    setApp(vnode);\r\n                }\r\n\r\n            }\r\n            else if(objectId){\r\n                if(!model.contextObjects[objectId]){\r\n                    let useType = type;\r\n                    if(bNew && am7model.isGroup(modType)) useType = 'auth.group';\r\n                    let q = am7view.viewQuery(am7model.newInstance(useType));\r\n                    q.field(\"objectId\", objectId);\r\n                    am7client.search(q, function(qr){\r\n                        if(qr && qr.count){\r\n                            let v = qr.results[0];\r\n                            model.contextObjects[objectId] = v;\r\n                            resetEntity((bPNew || bNew ? getPrimitive(type) : v));\r\n                            if(bPNew && am7model.isParent(modType)) entity.parentId = model.contextObjects[objectId].id;\r\n                            setApp(vnode);\r\n                        }\r\n                        else{\r\n                            console.warn(\"Failed to search for \" + q.key());\r\n                        }\r\n                    });\r\n                }\r\n                else{\r\n                    entity = ((bPNew || bNew) ? getPrimitive(type) : model.contextObjects[objectId]);\r\n                    if(bPNew && am7model.isParent(modType)) entity.parentId = model.contextObjects[objectId].id;\r\n                    setApp(vnode);\r\n                }\r\n            }\r\n            else{\r\n                console.warn(\"Should only hit this for non group / parent objects!!!\");\r\n                entity = getPrimitive(type);\r\n                setApp(vnode);\r\n            }\r\n        }\r\n        function resetEntity(e){\r\n            if(e && e[am7model.jsonModelKey]){\r\n                entity = e;\r\n            }\r\n            pinst = {};\r\n            oinst = {};\r\n            setInst();\r\n        }\r\n\r\n        function setInst(vnode){\r\n            inst = undefined;\r\n            pdfViewer = undefined;\r\n            if(entity){\r\n                if(vnode?.attrs?.freeFormInstance){\r\n                    inst = vnode?.attrs?.freeFormInstance;\r\n                }\r\n                else{\r\n                    let fname = entity[am7model.jsonModelKey].substring(entity[am7model.jsonModelKey].lastIndexOf(\".\") + 1);\r\n                    inst = am7model.prepareInstance(entity, am7model.forms[fname]);\r\n                }\r\n                \r\n                let mt = inst?.entity?.contentType;\r\n                if(mt && mt.match(/pdf$/i)){\r\n                    pdfViewer = page.components.pdf.viewer(inst);\r\n                }\r\n\r\n                inst.observe(objectPage);\r\n            }\r\n\r\n        }\r\n\r\n        \r\n\r\n        function setApp(vnode){\r\n            let ldraw = !inst;\r\n            if(entity[am7model.jsonModelKey]){\r\n                setInst(vnode);\r\n                if(!caller){\r\n                    window.dbgObj = objectPage;\r\n                    window.dbgInst = inst;\r\n                    window.dbgPinst = pinst;\r\n                }\r\n            }\r\n            if(caller){\r\n                caller.callback('set', objectPage, inst, undefined, parentProperty);\r\n            }\r\n            else{\r\n                postRender();\r\n                m.redraw();\r\n            }\r\n        }\r\n\r\n        function preparePicker(type, handler, altPath){\r\n\r\n            return new Promise((res, rej)=>{\r\n\r\n                let model = am7model.getModel(type);\r\n                if(!model){\r\n                    console.error(\"Invalid model for '\" + type + \"'\");\r\n                    rej();\r\n                }\r\n                pickerMode.tabIndex = tabIndex;\r\n                pickerMode.type = type;\r\n                pickerMode.handler = handler;\r\n                if(am7model.isGroup(model) || am7model.isParent(model)) pickerMode.pickPath = altPath || am7view.path(type);\r\n                if(am7model.isGroup(model)){\r\n                    am7client.make(\"auth.group\",\"data\", pickerMode.pickPath, function(v){\r\n                        pickerMode.containerId = v.objectId;\r\n\r\n                        enablePicker();\r\n                        res();\r\n                    });\r\n                }\r\n                else if(type.match(/^(auth\\.role|auth\\.permission)$/)){\r\n                    am7client.user(type, \"user\", function(v){\r\n                        uwm.getDefaultParentForType(type, v).then((parObj) =>{\r\n                            pickerMode.containerId = parObj.objectId;\r\n\r\n                            enablePicker();\r\n                            res();\r\n                        });\r\n                    });\r\n\r\n                }\r\n                else if(type.match(/^system\\.user$/)){\r\n                    enablePicker();\r\n                    res();\r\n                }\r\n                else{\r\n                    console.warn(\"Handle pick \" + type);\r\n                }\r\n            });\r\n        }\r\n        \r\n        objectPage.mergeEntity = function(e, s, baseModel){\r\n            let ue = s || entity;\r\n            if(!e){\r\n                return;\r\n            }\r\n            if(!e[am7model.jsonModelKey]) e[am7model.jsonModelKey] = ue[am7model.jsonModelKey] || baseModel;\r\n            if(!e[am7model.jsonModelKey]){\r\n                console.warn(\"Cannot find model\", e);\r\n                return;\r\n            }\r\n\r\n            let x = Object.assign(ue, e);\r\n            let af = am7model.getModelFields(e[am7model.jsonModelKey]);\r\n            af.forEach(f => {\r\n                if((f.type == 'list' || f.type == 'model') && f.foreign && f.baseModel){\r\n                    if(f.type == 'model' && !ue[f.name] && e[f.name]){\r\n                        ue[f.name] = getPrimitive(f.baseModel);\r\n                    }\r\n                    else if(f.type == 'list'){\r\n                        ue[f.name] = [];\r\n                        for(let c in e[f.name]){\r\n                            ue[f.name].push(getPrimitive(f.baseModel));\r\n                        }\r\n                    }\r\n                    if(e[f.name] ){\r\n                        objectPage.mergeEntity(entity[f.name], e[f.name], f.baseModel);\r\n                    }\r\n                }\r\n            });\r\n            \r\n            am7model.applyModelNames(x);\r\n            if(!s) resetEntity(x);\r\n\r\n        };\r\n        objectPage.resetEntity = resetEntity;\r\n        objectPage.getModel = function(name, fieldView, field, fieldClass){\r\n            console.log(name, fieldView, field, fieldClass);\r\n            return entity[am7model.jsonModelKey];\r\n        }\r\n        \r\n        objectPage.objectControls = function(name, field){\r\n            return page.components.membership.objectControls(getMembershipContext(field), name, field);\r\n        };\r\n\r\n        objectPage.objectRequests = function(name, field){\r\n            return page.components.membership.objectRequests(getMembershipContext(field), name, field);\r\n        };\r\n\r\n\r\n        objectPage.deleteChild = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.deleteChild(getMembershipContext(field), name, field, tableType, tableForm, props);\r\n        };\r\n\r\n        objectPage.addChild = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.addChild(getMembershipContext(field), name, tableType, tableForm, props);\r\n        };\r\n\r\n        /// Helper to build membership context\r\n        function getMembershipContext(field) {\r\n            return {\r\n                entity: entity,\r\n                inst: inst,\r\n                field: field,\r\n                valuesState: valuesState,\r\n                foreignData: foreignData,\r\n                caller: caller,\r\n                objectPage: objectPage,\r\n                parentProperty: parentProperty,\r\n                preparePicker: preparePicker,\r\n                cancelPicker: cancelPicker,\r\n                updateChange: updateChange\r\n            };\r\n        }\r\n\r\n        /// Helper to build table entry context\r\n        function getTableEntryContext() {\r\n            return {\r\n                entity: entity,\r\n                inst: inst,\r\n                valuesState: valuesState,\r\n                foreignData: foreignData,\r\n                resetValuesState: function() {\r\n                    valuesState = {};\r\n                }\r\n            };\r\n        }\r\n\r\n        objectPage.addEntity = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.addEntity(getMembershipContext(field), name, tableType, tableForm, props);\r\n        };\r\n\r\n        objectPage.openEntity = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.openEntity(getMembershipContext(field), name, field, tableType, tableForm, props);\r\n        };\r\n\r\n        objectPage.deleteEntity = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.deleteEntity(getMembershipContext(field), name, field, tableType, tableForm, props);\r\n        };\r\n\r\n        objectPage.deleteMember = function(name, field, tableType, tableForm){\r\n            return page.components.membership.deleteMember(getMembershipContext(field), name, field, tableType, tableForm);\r\n        };\r\n\r\n        objectPage.addMember = function(name, field, tableType, tableForm, props){\r\n            return page.components.membership.addMember(getMembershipContext(field), name, field.baseModel, tableForm, props);\r\n        }\r\n\r\n        objectPage.memberObjects = function(name, field){\r\n            return page.components.membership.memberObjects(getMembershipContext(field), name, field);\r\n        };\r\n\r\n        objectPage.objectMembers = function(name, field){\r\n            return page.components.membership.objectMembers(getMembershipContext(field), name, field);\r\n        };\r\n\r\n        objectPage.editEntry = function(){\r\n            return page.components.tableEntry.editEntry(getTableEntryContext());\r\n        };\r\n\r\n        objectPage.deleteEntry = function(name){\r\n            return page.components.tableEntry.deleteEntry(getTableEntryContext(), name);\r\n        };\r\n\r\n        objectPage.newEntry = function(name){\r\n            return page.components.tableEntry.newEntry(getTableEntryContext(), name);\r\n        };\r\n\r\n        objectPage.checkEntry = function(name, field, tableType, tableForm, props){\r\n            return page.components.tableEntry.checkEntry(getTableEntryContext(), name, field, tableType, tableForm, props);\r\n        };\r\n\r\n        objectPage.cancelEntry = function(name){\r\n            return page.components.tableEntry.cancelEntry(getTableEntryContext(), name);\r\n        };\r\n\r\n        objectPage.getEntity = function(){\r\n            return entity;\r\n        };\r\n        objectPage.getInstance = function(){\r\n            return inst;\r\n        };\r\n        objectPage.preparePicker = preparePicker;\r\n        objectPage.pickerMode = function(){ return pickerMode;};\r\n        objectPage.enablePicker = enablePicker;\r\n        objectPage.cancelPicker = cancelPicker;\r\n\r\n        objectPage.setChildPickerMode = function(p){\r\n            console.log(p);\r\n            childPickerMode = p;\r\n        };\r\n\r\n        objectPage.pickerEnabled = function(){\r\n            return pickerMode.enabled;\r\n        };\r\n\r\n        objectPage.endPicker = function(){\r\n            pickerMode.enabled = false;\r\n            m.redraw();\r\n        };\r\n\r\n        objectPage.clear = function(){\r\n            if(pdfViewer){\r\n                pdfViewer.clear();\r\n            }\r\n\r\n            pdfViewer = undefined;\r\n            \r\n            if(app) app.destroy();\r\n            entity = null;\r\n            inst = null;\r\n            app = null;\r\n\r\n            /// don't clear pendingEntity\r\n            /// pendingEntity = undefined;\r\n            pendingResponse = undefined;\r\n            definition = undefined;\r\n\r\n            tabIndex = 0;\r\n            pickerMode = {clear:true};\r\n            fullMode = false;\r\n            designMode = false;\r\n        };\r\n\r\n        objectPage.makeFact = async function(name, field, tableType, tableForm, props){\r\n            let path = am7view.path(\"fact\");\r\n            let group = await page.findObject(\"auth.group\", \"data\", path);\r\n            let gpath = \"/new/fact/\" + group.objectId;\r\n\r\n            if(!name.match(/^(auth\\.group|auth\\.role|auth\\.permission|identity\\.person|identity\\.account|system\\.user|data\\.data|policy\\.function|policy\\.operation)$/gi)){\r\n                console.error(\"Unsupported fact import type \" + (entity ? entity.urn : \"null\"));\r\n                return;\r\n            }\r\n            let fact = am7model.newPrimitive(\"fact\");\r\n            fact.factType = \"FACTORY\";\r\n            fact.sourceType = \"unknown\";\r\n            if(name.match(/^role$/gi)){\r\n                fact.factType = \"role\";\r\n                fact.sourceType = entity.type;\r\n            }\r\n            else if(name.match(/^permission$/gi)){\r\n                fact.factType = \"static\";\r\n                fact.sourceType = entity.type;\r\n            }\r\n            else if(name.match(/^auth\\.group$/gi)){\r\n                fact.factType = \"permission\";\r\n                fact.sourceType = entity.type;\r\n            }\r\n            fact.sourceUrn = entity.urn;\r\n            fact.factoryType = entity[am7model.jsonModelKey];\r\n            fact.name = entity.name + \" Fact\";\r\n            fact.description = \"Fact representing a relative link to \" + entity.name + \" as \" + entity.urn + \" in organization \" + entity.organizationPath;\r\n\r\n            /// Note: Adding a key because cycling through the same view with different objects needs a full DOM rebuild to correctly disconnect the sync code\r\n            ///\r\n            page.context().pendingEntity = fact;\r\n            console.log(\"Pend Out\", fact);\r\n            m.route.set(gpath, {key: Date.now()});\r\n        };\r\n\r\n        objectPage.execute = function(name, field, type, form, properties){\r\n            pendingResponse = undefined;\r\n            am7client.executeScript(entity.urn, function(v){\r\n                pendingResponse = v;\r\n                m.redraw();\r\n            });\r\n        };\r\n\r\n        objectPage.evaluate = function(name, field, type, form, properties){\r\n            if(!definition){\r\n                console.error(\"Expected definition\");\r\n                return;\r\n            }\r\n            let prq = azn.createPolicyRequest(definition);\r\n            prq.facts.forEach((p, i)=>{\r\n                let e = document.querySelector(\"input[name=parameter-\" + i + \"]\");\r\n                p.factData = e.value;\r\n                p.sourceUrn = e.value;\r\n            });\r\n            console.log(prq);\r\n            am7client.evaluate(prq, function(v){\r\n                if(v === null) pendingResponse = \"Error\";\r\n                else pendingResponse = v.response;\r\n                console.log(v);\r\n                m.redraw();\r\n            });\r\n        };\r\n\r\n        objectPage.define = function(){\r\n            if(definition){\r\n                return definition.parameters.map((p, i)=>{\r\n                    return m(\"tr\", [\r\n                        m(\"td\", p.name),\r\n                        m(\"td\", p.factoryType),\r\n                        m(\"td\", m(\"input\", {name: \"parameter-\" + i, type: \"text\", class: \"text-field-full\", placeholder: \"\"}))\r\n                    ]);\r\n                });\r\n            }\r\n            else if(definition === null){\r\n                return [m(\"tr\",m(\"td\",\"Error\"))];\r\n            }\r\n            else{\r\n                am7client.define(entity.objectId, function(v){\r\n                    definition = v;\r\n                    m.redraw();\r\n                });\r\n                return [];\r\n            }\r\n        };\r\n\r\n        objectPage.objectExecute = function(name, fieldView, field, fieldClass, hidden){\r\n            let cmds = [];\r\n            let rows = [];\r\n            if(!field){\r\n                return rows;\r\n            }\r\n            let form = fieldView.form;\r\n            if(!form){\r\n                console.warn(\"Expected form\");\r\n                return rows;\r\n            }\r\n            if(fieldView.properties && fieldView.properties.prepare){\r\n                rows.push(objectPage[fieldView.properties.prepare]());\r\n            }\r\n\r\n            cmds = getFormCommandView(name, fieldView.form, field, false, false);\r\n\r\n            if(pendingResponse){\r\n                rows.push(m(\"tr\", m(\"td\", \r\n                    (typeof pendingResponse == \"object\" ? JSON.stringify(pendingResponse) : pendingResponse)\r\n                )));\r\n            }\r\n            return [cmds, m(\"table\",{class: fieldClass}, rows)];\r\n        };\r\n        objectPage.tabIndex = function(){\r\n            return tabIndex;\r\n        };\r\n        objectPage.caller = function(){\r\n            return caller;\r\n        };\r\n        objectPage.report = function(stype, obj, cinst){\r\n            if(caller){\r\n                caller.callback(stype, obj, cinst, undefined, parentProperty);\r\n            }\r\n        };\r\n\r\n        objectPage.callback = function(stype, obj, cinst, cname, pname){\r\n            if(pname && !inst.changes.includes(pname)){\r\n                inst.changes.push(pname);\r\n            }\r\n            if(stype == 'set'){\r\n                if(cinst){\r\n                    pinst[pname] = cinst;\r\n                }\r\n            }\r\n            else if(stype == 'update'){\r\n                /// If the child object doesn't have an identity, and the current object doesn't have an identity, then let the initial create handle it\r\n\r\n                if(!am7model.hasIdentity(cinst.entity)){\r\n                    if(am7model.hasIdentity(inst.entity)){\r\n                        /// create cinst\r\n                        /// check for reference\r\n\r\n                    }\r\n                    else{\r\n                        /// nothing to do, let it be picked up by default nested create\r\n                        ///\r\n                        console.log(\"Handle with entity create \" + pname);\r\n                    }\r\n                }\r\n                else{\r\n                    /// Handled as patch operation in doUpdate\r\n                    let uname = cname || pname;\r\n                    let fld = am7model.getModelField(cinst.entity[am7model.jsonModelKey], uname);\r\n                    if(fld && fld.type == \"list\" && fld.foreign && fld.baseType == \"model\"){\r\n                        console.log(\"Patch member\", obj);\r\n                        let members = cinst.api[uname]();\r\n                        let aP = [];\r\n                        members.forEach((t)=>{\r\n                            aP.push(new Promise((res, rej)=>{\r\n                                console.log(cinst.entity[am7model.jsonModelKey], inst.api[pname]().objectId, t[am7model.jsonModelKey], t.objectId);\r\n                                am7client.member(cinst.entity[am7model.jsonModelKey], inst.api[pname]().objectId, uname, t[am7model.jsonModelKey], t.objectId, true, function(v){\r\n                                    res(v);\r\n                                })\r\n                            }));\r\n                        });\r\n                        Promise.all(aP).then(()=>{\r\n                            m.redraw();\r\n                        });\r\n                    }\r\n                    else{\r\n                        /// Nothing to do - parent was updated\r\n                    }\r\n                }\r\n                \r\n            }\r\n        };\r\n        objectPage.picker = doFieldPicker;\r\n        objectPage.view = {\r\n            debug: function(){\r\n                return foreignData;\r\n            },\r\n            oninit : function(x){\r\n                fullMode = x.attrs.fullMode || fullMode;\r\n                embeddedMode = x.attrs.embeddedMode;\r\n                embeddedController = x.attrs.embeddedController;\r\n                objectType = x.attrs.freeFormType || x.attrs.type || m.route.param(\"type\");\r\n                objectId = x.attrs.objectId || m.route.param(\"objectId\");\r\n                objectNew = x.attrs.new || m.route.get().match(/^\\/new/gi);\r\n                parentNew = x.attrs.parentNew || m.route.get().match(/^\\/pnew/gi);\r\n                parentProperty = x.attrs.parentProperty;\r\n                caller = x.attrs.caller;\r\n                if(x.attrs.pickerCfg){\r\n                    pickerMode = x.attrs.pickerCfg;\r\n                }\r\n                setEntity(x);\r\n\r\n            },\r\n            sync: function(){\r\n                \r\n            },\r\n            oncreate : function (x) {\r\n                page.navigable.setupPendingContextMenus();\r\n            },\r\n            onupdate : function(x){\r\n                page.navigable.setupPendingContextMenus();\r\n                postRender();\r\n            },\r\n            onunload : function(x){\r\n\r\n            },\r\n            onremove : function(x){\r\n                objectPage.clear();\r\n                page.navigable.cleanupContextMenus();\r\n            },\r\n\r\n            view: function (vnode) {\r\n                callerIndex = vnode.attrs.callerIndex;\r\n                callerActive = vnode.attrs.callerActive;\r\n\r\n                if(!page.authenticated() || !inst) return m(\"\");\r\n                if(vnode.attrs.freeForm){\r\n                    return getForm();\r\n                }                    \r\n                else if(embeddedMode) return [getObjectViewInner(), page.components.dialog.loadDialog(), page.loadToast()];\r\n                else return [getObjectView(), page.components.dialog.loadDialog(), page.loadToast()];\r\n            }\r\n        };\r\n        return objectPage;\r\n    }\r\n    page.views.object = newObjectPage;\r\n}());\r\n\n\n;/* === client/view/navigator.js === */\n(function(){\r\n\r\n    function newNavigatorControl(){\r\n  \r\n        const navigator = {};\r\n        let fullMode = false;\r\n        let showFooter = false;\r\n        let pagination = page.pagination();\r\n        let listView;\r\n        let treeView;\r\n        let altView;\r\n\r\n        function getNavigatorTopMenuView(){\r\n          /*\r\n          return m(\"div\", {class: \"result-nav-outer\"}, [\r\n            m(\"div\", {class: \"result-nav-inner\"}, [\r\n              m(\"div\", {class: \"result-nav\"}, [\r\n                m(\"button\", {class: \"button\"}, m(\"span\", {class: \"material-icons material-icons-24\"}, \"save\"))\r\n              ]),\r\n              m(\"div\", {class: \"result-nav\"}, [\r\n                m(\"button\", {class: \"button\"}, [m(\"span\", {class: \"material-icons material-icons-24\"}, \"tab\"), \" Meta\"])\r\n              ])\r\n            ])\r\n          ])\r\n          */\r\n         return [];\r\n        }\r\n\r\n        function getSplitContainerView(){\r\n          let splitLeft = \"\";\r\n          if(!fullMode) splitLeft = getSplitLeftContainerView();\r\n          return m(\"div\", {class: \"results-fixed\", onselectstart: function(e){ e.preventDefault();}},\r\n            m(\"div\", {class: \"splitcontainer\"}, [\r\n              splitLeft,\r\n              getSplitRightContainerView()\r\n            ])\r\n          );\r\n        }\r\n\r\n        function getSplitRightContainerView(){\r\n          let cls = \"splitrightcontainer\";\r\n          if(fullMode) cls = \"splitfullcontainer\";\r\n          return m(\"div\", {class: cls}, [\r\n              getResultsView()     \r\n          ]);\r\n        }\r\n\r\n        function getSplitLeftContainerView(){\r\n          let tree = m(treeView, {\r\n            origin,\r\n            list:listView\r\n          });\r\n          return m(\"div\", {\r\n            class: \"splitleftcontainer\",\r\n            ondragover: function(e){\r\n              e.preventDefault();\r\n            }\r\n          }, [\r\n            //m(\"div\", {class: \"splitoverflow\"}, [\r\n              tree\r\n            //])\r\n          ]);\r\n        }\r\n        function getResultsView(){\r\n          let ret = \"\";\r\n          let mtx = treeView.selectedNode();\r\n          if(!mtx) return ret;\r\n          if(altView){\r\n            return m(altView.view.view, {\r\n              fullMode,\r\n              type: altView.type,\r\n              objectId: altView.containerId,\r\n              new: altView.new,\r\n              parentNew: altView.parentNew,\r\n              embeddedMode: true,\r\n              embeddedController: navigator\r\n            });\r\n  \r\n          }\r\n          // console.log(mtx);\r\n          return m(listView.view, {\r\n            fullMode,\r\n            type: mtx.listEntityType,\r\n            objectId: mtx.id,\r\n            startRecord: 0,\r\n            recordCount: 0,\r\n            embeddedMode: true,\r\n            embeddedController: navigator\r\n          });\r\n        }\r\n\r\n        function getNavigatorBottomMenuView(){\r\n          if(!showFooter) return \"\";\r\n\r\n          return m(\"div\", {class: \"result-nav-outer\"}, \r\n            m(\"div\", {class: \"result-nav-inner\"}, [\r\n              m(\"div\", {class: \"result-nav\"}, \"...\"),\r\n              m(\"div\", {class: \"result-nav\"}, \"Bottom\")\r\n            ])\r\n          );\r\n        }\r\n      \r\n        function getNavigatorView(vnode){\r\n            return m(\"div\",{class : \"content-outer\"},[\r\n              (fullMode ? \"\" : m(page.components.navigation, {hideBreadcrumb: true})),\r\n              m(\"div\",{class : \"content-main\"},\r\n                m(\"div\", {class: \"list-results-container\"},\r\n                  m(\"div\", {class: \"list-results\"}, [\r\n                    getNavigatorTopMenuView(),\r\n                    getSplitContainerView(),\r\n                    getNavigatorBottomMenuView()\r\n                  ])\r\n                )\r\n              )\r\n            ]);\r\n        }\r\n        \r\n        navigator.toggleFullMode = function(){\r\n          fullMode = !fullMode;\r\n          m.redraw();\r\n        }\r\n\r\n        navigator.cancelView = function(){\r\n          altView = undefined;\r\n          fullMode = false;\r\n          m.redraw();\r\n        };\r\n\r\n        navigator.editItem = function(object){\r\n          if(!object) return;\r\n          altView = {\r\n            fullMode,\r\n            view: page.views.object(),\r\n            type: object[am7model.jsonModelKey],\r\n            containerId: object.objectId\r\n          };\r\n          m.redraw();\r\n        };\r\n\r\n        navigator.addNew = function(type, containerId, parentNew){\r\n          altView = {\r\n            fullMode,\r\n            view: page.views.object(),\r\n            type,\r\n            containerId,\r\n            parentNew,\r\n            new: true\r\n          };\r\n          m.redraw();\r\n        };\r\n        navigator.view = {\r\n            oninit : function(vnode){\r\n                let ctx = page.user.homeDirectory;\r\n                // if(am7community.getCommunityMode()) ctx = am7community.getCommunityProjectGroup();\r\n                origin = vnode.attrs.origin || ctx;\r\n                if(!listView) listView = page.views.list();\r\n                if(!treeView) treeView = page.components.tree();\r\n                //if(!objectView) objectView = page.views.object();\r\n                //document.documentElement.addEventListener(\"keydown\", navListKey);\r\n            },\r\n            oncreate : function (x) {\r\n              // app = page.space(entityName, x, pagination.entity);\r\n            },\r\n            onupdate : function(x){\r\n\r\n            },\r\n            onremove : function(x){\r\n              // document.documentElement.removeEventListener(\"keydown\", navListKey);\r\n              page.navigable.cleanupContextMenus();\r\n              pagination.stop();\r\n              // if(app) app.destroy();\r\n            },\r\n  \r\n            view: function (vnode) {\r\n              let v = getNavigatorView(vnode);\r\n                return [v, page.components.dialog.loadDialog(), page.loadToast()];\r\n            }\r\n        };\r\n        return navigator;\r\n    }\r\n      page.views.navigator = newNavigatorControl;\r\n  }());\r\n  \n\n;/* === client/view/chat.js === */\n\r\n(function () {\r\n\r\n  am7model.forms.chatRequest = {\r\n    label: \"Chat Request\",\r\n    commands: {\r\n      cmdPeek: {\r\n        label: 'Peek',\r\n        icon: 'man',\r\n        action: 'doPeek'\r\n      }\r\n    },\r\n    fields: {\r\n      prompt: {\r\n        layout: 'full',\r\n        format: 'list'\r\n      },\r\n      chat: {\r\n        layout: 'full',\r\n        format: 'list'\r\n      },\r\n\r\n      session: {\r\n        layout: 'full'\r\n      }\r\n    }\r\n  };\r\n  /// TODO: There are two different methods for constructing the object view: 1) the newer generic am7view, and 2) the legacy though still more complex object component view\r\n  /// So some form fields are not interoperable, like 'list' for am7view must be 'select' for the object component view.\r\n  am7model.forms.newChatRequest = {\r\n    label: \"Chat Request\",\r\n    fields: {\r\n      promptConfig: {\r\n        layout: 'third',\r\n        format: 'picker',\r\n        field: {\r\n          format: 'picker',\r\n          pickerType: \"olio.llm.promptConfig\",\r\n          pickerProperty: {\r\n            selected: \"{object}\",\r\n            entity: \"promptConfig\"\r\n          },\r\n          label: \"Prompt Config\"\r\n        }\r\n      },\r\n      chatConfig: {\r\n        layout: 'third',\r\n        format: 'picker',\r\n        field: {\r\n          format: 'picker',\r\n          pickerType: \"olio.llm.chatConfig\",\r\n          pickerProperty: {\r\n            selected: \"{object}\",\r\n            entity: \"chatConfig\"\r\n          },\r\n          label: \"Chat Config\"\r\n        }\r\n      },\r\n      name: {\r\n        label: \"Chat Name\",\r\n        layout: 'third'\r\n      },\r\n      setting: {\r\n        label: \"Setting\",\r\n        layout: 'full'\r\n      }\r\n    }\r\n  };\r\n\r\n  function newChatControl() {\r\n\r\n    let inst;\r\n    const chat = {};\r\n    let fullMode = false;\r\n    let showFooter = false;\r\n    let pagination = page.pagination();\r\n    let listView;\r\n    let treeView;\r\n    let altView;\r\n    let aPCfg;\r\n    let aCCfg;\r\n    let aSess;\r\n    let audioText = \"\";\r\n    let chatCfg = newChatConfig();\r\n\r\n    let camera = false;\r\n    let audio = false;\r\n    let audioMagic8 = false;\r\n\r\n    let hideThoughts = true;\r\n    let editIndex = -1;\r\n    let editMode = false;\r\n\r\n    let profile = false;\r\n\r\n    function doClear() {\r\n      clearEditMode();\r\n      inst = undefined;\r\n      chatCfg = newChatConfig();\r\n    }\r\n\r\n    function pickSession(obj) {\r\n      doClear();\r\n      inst = am7model.prepareInstance(obj);\r\n      window.dbgInst = inst;\r\n      doPeek();\r\n    }\r\n\r\n    async function chatInto() {\r\n      page.components.dialog.chatInto(inst.entity, inst, aCCfg)\r\n    }\r\n\r\n    async function doCancel() {\r\n      clearEditMode();\r\n      chatCfg.pending = false;\r\n      chatCfg.peek = false;\r\n      chatCfg.history = [];\r\n      if(inst && inst.api.objectId()){\r\n        let chatReq = {\r\n          schema: inst.model.name,\r\n          objectId: inst.api.objectId(),\r\n          uid: page.uid()\r\n        };\r\n\r\n        return m.request({ method: 'POST', url: g_application_path + \"/rest/chat/clear\", withCredentials: true, body: chatReq }).then((r) => {\r\n          m.redraw();\r\n        });\r\n      }\r\n    }\r\n\r\n    function newChatStream() {\r\n\r\n      let cfg = {\r\n        streamId: undefined,\r\n        request: undefined,\r\n\r\n        onchatcomplete: (id) => {\r\n          console.log(\"Chat completed: \" + id);\r\n          if (page.chatStream && !page.chatStream.streamId == id) {\r\n            console.warn(\"Mismatched stream identifiers\");\r\n          }\r\n          clearChat();\r\n          m.redraw();\r\n        },\r\n        onchaterror: (id, msg) => {\r\n          page.toast(\"error\", \"Chat error: \" + msg, 5000);\r\n          clearChat();\r\n          m.redraw();\r\n        },\r\n        onchatstart: (id, req) => {\r\n          // console.log(\"Start chat...\");\r\n          if (!chatCfg) {\r\n            console.warn(\"Invalid chat configuration\");\r\n            return;\r\n          }\r\n          if (!chatCfg.history) chatCfg.history = {};\r\n          if (!chatCfg.history.messages) chatCfg.history.messages = [];\r\n          chatCfg.history.messages.push({ role: \"assistant\", content: \"\" });\r\n        },\r\n        onchatupdate: (id, msg) => {\r\n          // console.log(\"Chat update: \" + msg);\r\n          if (!chatCfg.history.messages.length) {\r\n            console.error(\"Unexpected chat history\");\r\n            return;\r\n          }\r\n          let m1 = chatCfg.history.messages[chatCfg.history.messages.length - 1];\r\n          if (m1.role != \"assistant\") {\r\n            console.error(\"Expected assistant message to be the most recent\");\r\n            return;\r\n          }\r\n\r\n          m1.content += msg;\r\n          m.redraw();\r\n        }\r\n      }\r\n\r\n      function clearChat() {\r\n        page.chatStream = undefined;\r\n        chatCfg.streaming = false;\r\n        chatCfg.pending = false;\r\n      }\r\n\r\n      return cfg;\r\n    }\r\n\r\n    function doStop() {\r\n      if (!chatCfg.streaming) {\r\n        return;\r\n      }\r\n      let chatReq = {\r\n        schema: inst.model.name,\r\n        objectId: inst.api.objectId(),\r\n        uid: page.uid(),\r\n        message: \"[stop]\"\r\n      };\r\n\r\n      page.wss.send(\"chat\", JSON.stringify(chatReq), undefined, inst.model.name);\r\n    }\r\n\r\n    function doChat() {\r\n      clearEditMode();\r\n      if (chatCfg.pending) {\r\n        console.warn(\"Chat is pending\");\r\n        return;\r\n      }\r\n      if (chatCfg.streaming) {\r\n        console.warn(\"Chat is streaming - TODO - interrupt\");\r\n        return;\r\n      }\r\n      let msg = page.components.audio.recording() ? audioText : document.querySelector(\"[name='chatmessage']\").value; ///e?.target?.value;\r\n      if (!chatCfg.peek) {\r\n        doPeek().then(() => {\r\n          doChat();\r\n        })\r\n      }\r\n      else {\r\n        pushHistory();\r\n        chatCfg.pending = true;\r\n        let data = page.components.dnd.workingSet.map(r => { return JSON.stringify({ schema: r.schema, objectId: r.objectId }); });\r\n\r\n        let chatReq = {\r\n          schema: inst.model.name,\r\n          objectId: inst.api.objectId(),\r\n          uid: page.uid(),\r\n          message: msg + (msg.length && faceProfile ? \"\\n(Metrics: \" + JSON.stringify(faceProfile) + \")\": \"\"),\r\n          data\r\n        };\r\n        try {\r\n          if (chatCfg?.chat.stream) {\r\n            page.chatStream = newChatStream();\r\n            chatCfg.streaming = true;\r\n            page.wss.send(\"chat\", JSON.stringify(chatReq), undefined, inst.model.name);\r\n          }\r\n          else {\r\n            m.request({ method: 'POST', url: g_application_path + \"/rest/chat/text\", withCredentials: true, body: chatReq }).then((r) => {\r\n              if (!chatCfg.history) chatCfg.history = {};\r\n              chatCfg.history.messages = r?.messages || [];\r\n              chatCfg.pending = false;\r\n              // Audio components will automatically update when messages change\r\n            });\r\n          }\r\n        }\r\n        catch (e) {\r\n          console.error(\"Error in chat\", e);\r\n          chatCfg.pending = false;\r\n        }\r\n      }\r\n    }\r\n\r\n    async function deleteChat(s) {\r\n      am7chat.deleteChat(s, false, async function () {\r\n        aSess = undefined;\r\n        await loadConfigList();\r\n        doClear();\r\n        m.redraw();\r\n      });\r\n    }\r\n\r\n    /// Note: Chatmessage isn't defined in its own model, and should be to avoid all the goofy checks\r\n    function pushHistory() {\r\n      let msg = page.components.audio.recording() ? audioText : document.querySelector(\"[name='chatmessage']\").value;\r\n      if (!chatCfg.history) chatCfg.history = {};\r\n      if (!chatCfg.history.messages) chatCfg.history.messages = [];\r\n      chatCfg.history.messages.push({ role: \"user\", content: msg });\r\n      if (page.components.audio.recording()) {\r\n        audioText = \"\";\r\n      }\r\n      else {\r\n        document.querySelector(\"[name='chatmessage']\").value = \"\";\r\n      }\r\n      m.redraw();\r\n    }\r\n\r\n    function getHistory() {\r\n      if (!inst) {\r\n        return;\r\n      }\r\n\r\n      let chatReq = {\r\n        schema: inst.model.name,\r\n        objectId: inst.api.objectId(),\r\n        uid: page.uid()\r\n      };\r\n      return m.request({ method: 'POST', url: g_application_path + \"/rest/chat/history\", withCredentials: true, body: chatReq });\r\n    }\r\n\r\n    function newChatConfig() {\r\n      return {\r\n        peek: false,\r\n        history: undefined,\r\n        pending: false\r\n      };\r\n    }\r\n\r\n\r\n    function doPeek() {\r\n      if (chatCfg.peek || !inst) {\r\n        return Promise.resolve();\r\n      }\r\n\r\n      let c1 = inst.api.promptConfig();\r\n      let c2 = inst.api.chatConfig();\r\n      let p;\r\n      if (c1 && c2) {\r\n        /// Looking up the prompt and chat config to get the full objects\r\n        ///\r\n        chatCfg.peek = true;\r\n        p = new Promise((res, rej) => {\r\n          m.request({ method: 'GET', url: g_application_path + \"/rest/chat/config/prompt/\" + c1.name, withCredentials: true })\r\n            .then((c) => {\r\n              chatCfg.prompt = c;\r\n\r\n              m.request({ method: 'GET', url: g_application_path + \"/rest/chat/config/chat/\" + c2.name, withCredentials: true }).then((c3) => {\r\n                chatCfg.chat = c3;\r\n                chatCfg.system = c3.systemCharacter;\r\n                chatCfg.user = c3.userCharacter;\r\n                getHistory().then((h) => {\r\n                  chatCfg.peek = true;\r\n                  chatCfg.history = h;\r\n                  m.redraw();\r\n                  res();\r\n                }).catch((e) => {\r\n                  console.warn(\"Error in chat history\", e);\r\n                  chatCfg.peek = false;\r\n                });\r\n              }).catch((e) => {\r\n                  console.warn(\"Error in chat config\", e);\r\n                  chatCfg.peek = false;\r\n                });;\r\n            });\r\n        });\r\n      }\r\n      else {\r\n        console.warn(\"No prompt or chat config\");\r\n        p = Promise.resolve();\r\n      }\r\n      return p;\r\n    }\r\n\r\n    function getChatTopMenuView() {\r\n\r\n      return [];\r\n    }\r\n\r\n    function getSplitContainerView() {\r\n      let splitLeft = \"\";\r\n      if (!fullMode) splitLeft = getSplitLeftContainerView();\r\n      // , onselectstart: function (e) { e.preventDefault(); }\r\n      return m(\"div\", { class: \"results-fixed\" },\r\n        m(\"div\", { class: \"splitcontainer\" }, [\r\n          splitLeft,\r\n          getSplitRightContainerView()\r\n        ])\r\n      );\r\n    }\r\n\r\n    function getSplitRightContainerView() {\r\n      let cls = \"splitrightcontainer\";\r\n      if (fullMode) cls = \"splitfullcontainer\";\r\n      return m(\"div\", { class: cls }, [\r\n        getResultsView()\r\n      ]);\r\n    }\r\n\r\n    chat.callback = function () {\r\n\r\n    };\r\n\r\n    function getSplitLeftContainerView() {\r\n      /*\r\n      inst.formField(\"prompt\").hide = sess;\r\n      inst.formField(\"chat\").hide = sess;\r\n      inst.formField(\"session\").hide = sess;\r\n      */\r\n      let vsess = aSess || [];\r\n\r\n      return m(\"div\", {\r\n        class: \"splitleftcontainer\",\r\n        ondragover: function (e) {\r\n          e.preventDefault();\r\n        }\r\n      }, [\r\n        // am7view.form(inst),\r\n        //         m(\"button\", { class: \"flyout-button\", onclick: openChatSettings }, [m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"add\"), \"New Chat\"]),\r\n        vsess.map((s, i) => {\r\n          let bNew = s.objectId == undefined;\r\n          let bDel = \"\";\r\n          if (bNew) {\r\n            bDel = m(\"button\", { class: \"menu-button content-end mr-2\", onclick: openChatSettings }, m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"add\"));\r\n            //m(\"button\", {class: \"menu-button material-symbols-outlined material-icons-24 mr-2\"},\"add\");\r\n          }\r\n          else {\r\n            bDel = m(\"button\", { class: \"menu-button content-end mr-2\", onclick: function (e) { e.preventDefault(); deleteChat(s); return false; } }, m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"delete_outline\"));\r\n          }\r\n          return m(\"button\", {\r\n            class: \"flyout-button\" + (inst && s.name == inst.api.name() ? \" active\" : \"\"), onclick: function () {\r\n              pickSession(s);\r\n            }\r\n          }, [bDel, s.name]);\r\n        })\r\n\r\n      ]);\r\n    }\r\n\r\n\r\n    function openChatSettings(cinst) {\r\n      page.components.dialog.chatSettings(cinst && cinst.model ? cinst : undefined, async function (e) {\r\n\r\n        //let obj = await page.createObject(e);\r\n        let chatReq = {\r\n          schema: e[am7model.jsonModelKey],\r\n          name: e.name,\r\n          objectId: e.objectId,\r\n          chatConfig: { objectId: e.chatConfig.objectId },\r\n          promptConfig: { objectId: e.promptConfig.objectId },\r\n          uid: page.uid()\r\n        };\r\n        let obj = await m.request({ method: 'POST', url: g_application_path + \"/rest/chat/new\", withCredentials: true, body: chatReq });\r\n        inst = am7model.prepareInstance(obj);\r\n        window.dbgInst = inst;\r\n        aSess = undefined;\r\n        doClear();\r\n        await am7client.clearCache();\r\n        await loadConfigList();\r\n        doPeek();\r\n      });\r\n    }\r\n\r\n    function toggleAudio() {\r\n      // Stop all currently playing audio from both old and new systems\r\n      if (page.components.audio) {\r\n        page.components.audio.stopAudioSources();\r\n        page.components.audio.stopAllAudioSourceControllers();\r\n      }\r\n\r\n      // Cycle through audio modes: Off -> Standard Audio -> Magic8 -> Off\r\n      if (audio && !audioMagic8) {\r\n        // Standard Audio -> Magic8\r\n        audio = false;\r\n        audioMagic8 = true;\r\n      }\r\n      else if (audioMagic8) {\r\n        // Magic8 -> Off\r\n        audio = false;\r\n        audioMagic8 = false;\r\n      }\r\n      else {\r\n        // Off -> Standard Audio\r\n        audio = true;\r\n        audioMagic8 = false;\r\n      }\r\n\r\n      // Trigger redraw to update the view with new audio mode\r\n      m.redraw();\r\n    }\r\n    \r\n    let faceProfile;\r\n    function handleFaceMetricCapture(imageData) {\r\n      if(imageData && imageData.results?.length){\r\n        let id = imageData.results[0];\r\n       faceProfile = {\r\n          emotion: id.dominant_emotion,\r\n          emotions: Object.fromEntries(\r\n            Object.entries(id.emotion_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n          ),\r\n          /*\r\n          gender: id.dominant_gender,\r\n          genders: Object.fromEntries(\r\n            Object.entries(id.gender_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n          ),\r\n          */\r\n          race: id.dominant_race\r\n          /*\r\n          races: Object.fromEntries(\r\n            Object.entries(id.race_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n          ),\r\n          */\r\n          //age: id.age\r\n        };\r\n      }\r\n    }\r\n\r\n    function toggleProfile() {\r\n      profile = !profile;\r\n    }\r\n    function toggleCamera() {\r\n      camera = !camera;\r\n      if(camera){\r\n        if(!page.components.camera.devices().length){\r\n          page.components.camera.initializeAndFindDevices(handleFaceMetricCapture);\r\n        }\r\n        else{\r\n          page.components.camera.startCapture(handleFaceMetricCapture);\r\n        }\r\n      }\r\n      else{\r\n        page.components.camera.stopCapture();\r\n      }\r\n    }\r\n\r\n    function toggleThoughts() {\r\n      hideThoughts = !hideThoughts;\r\n    }\r\n\r\n    function clearEditMode() {\r\n      editMode = false;\r\n      editIndex = -1;\r\n    }\r\n\r\n    /// Currently only editing the last assistant message\r\n    /// The reasoning: The message history used for display is a truncated version of what's in the chat request\r\n    /// Alternately, this could be a separate API, but that seems unnecessary at the moment\r\n    async function editMessageHistory(idx, cnt) {\r\n\r\n      let q = am7view.viewQuery(am7model.newInstance(inst.api.sessionType()));\r\n      q.field(\"id\", inst.api.session().id);\r\n      let qr = await page.search(q);\r\n      if (qr && qr.results.length > 0) {\r\n        console.log(\"Patching session data\", qr.results[0].objectId);\r\n        let req = qr.results[0];\r\n\r\n        /// change the contents of the last message \r\n        req.messages[req.messages.length - 1].content = cnt;\r\n        let patch = await page.patchObject(req);\r\n        clearEditMode();\r\n        await am7client.clearCache();\r\n        await doCancel();\r\n        await doPeek();\r\n      }\r\n      else {\r\n        console.error(\"Failed to find session data to edit\", qr);\r\n      }\r\n      clearEditMode();\r\n    }\r\n    function toggleEditMode(idx) {\r\n      if (editMode) {\r\n\r\n        /// Put message back in the history\r\n        ///\r\n        editMessageHistory(idx, document.getElementById(\"editMessage\").value);\r\n      }\r\n      else {\r\n        editMode = true;\r\n        editIndex = idx;\r\n      }\r\n    }\r\n\r\n    function getResultsView() {\r\n      if (!inst) {\r\n        return \"\";\r\n      }\r\n      if (audioMagic8) {\r\n        // Use new Magic8Ball component\r\n        let sysUrl, usrUrl;\r\n        if (profile && chatCfg.system?.profile?.portrait) {\r\n          let pp = chatCfg.system.profile.portrait;\r\n          sysUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/256x256\";\r\n        }\r\n        if (profile && chatCfg.user?.profile?.portrait) {\r\n          let pp = chatCfg.user.profile.portrait;\r\n          usrUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/256x256\";\r\n        }\r\n\r\n        return m(page.components.audioComponents.Magic8Ball, {\r\n          instanceId: inst.api.objectId(),\r\n          messages: chatCfg.history?.messages || [],\r\n          systemProfileId: chatCfg?.system?.profile?.objectId,\r\n          userProfileId: chatCfg?.user?.profile?.objectId,\r\n          systemProfileImageUrl: sysUrl,\r\n          userProfileImageUrl: usrUrl,\r\n          useProfile: profile,\r\n          imageBaseGroups: [132, 1546, 1545, 1547],  // Hard-coded group IDs for background images\r\n          pruneContent: pruneAll\r\n        });\r\n      }\r\n      let c1g = \"man\";\r\n      let c1l = \"Nobody\";\r\n      let c2g = \"man\";\r\n      let c2l = \"Nobody\";\r\n      if (chatCfg.system) {\r\n        c1l = chatCfg.system.name;\r\n        if (chatCfg.system.gender == \"female\") {\r\n          c1g = \"woman\";\r\n        }\r\n      }\r\n      if (chatCfg.user) {\r\n        c2l = chatCfg.user.name;\r\n        if (chatCfg.user.gender == \"female\") {\r\n          c2g = \"woman\";\r\n        }\r\n      }\r\n\r\n      let c1i = m(\"span\", { class: \"material-icons-outlined\" }, c1g);\r\n      let c2i = m(\"span\", { class: \"material-icons-outlined\" }, c2g);\r\n      if (chatCfg.system?.profile?.portrait) {\r\n        let pp = chatCfg.system.profile.portrait;\r\n        let dataUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/96x96\";\r\n        // h-8 w-8\r\n        c1i = m(\"img\", { onclick: function () { page.imageView(pp); }, class: \"mr-4 rounded-full\", src: dataUrl });\r\n      }\r\n\r\n      if (chatCfg.user?.profile?.portrait) {\r\n        let pp = chatCfg.user.profile.portrait;\r\n        let dataUrl = g_application_path + \"/thumbnail/\" + am7client.dotPath(am7client.currentOrganization) + \"/data.data\" + pp.groupPath + \"/\" + pp.name + \"/96x96\";\r\n        // h-8 w-8 \r\n        c2i = m(\"img\", { onclick: function () { page.imageView(pp); }, class: \"ml-4 rounded-full\", src: dataUrl });\r\n      }\r\n\r\n      let midx = -1;\r\n      let aidx = 1;\r\n      let amsg = chatCfg.history?.messages || [];\r\n      let hasAutoPlayedThisSession = false;\r\n      let msgs = amsg.map((msg) => {\r\n        midx++;\r\n        let align = \"justify-start\";\r\n        let txt = \"bg-gray-600 text-white\";\r\n        // console.log(msg);\r\n        if (msg.role == \"user\") {\r\n          align = \"justify-end\";\r\n          txt = \"dark:bg-gray-900 dark:text-white bg-gray-200 text-black\";\r\n        }\r\n        let cnt = msg.content || \"\";\r\n        let ectl = \"\";\r\n        let ecls = \"\";\r\n        let bectl = false;\r\n        let lastMsg = (midx == (chatCfg.history.messages.length - 1));\r\n        if (hideThoughts && !editMode) {\r\n          cnt = pruneOut(cnt, \"--- CITATION\", \"END CITATIONS ---\")\r\n          // cnt = pruneTag(cnt, \"citation\");\r\n        }\r\n        if (msg.role == \"assistant\") {\r\n          bectl = (editMode && editIndex == midx);\r\n\r\n          /// Only edit last message\r\n          if (midx == chatCfg.history.messages.length - 1) {\r\n            ectl = m(\"span\", { onclick: function () { toggleEditMode(midx); }, class: \"material-icons-outlined text-slate-\" + (bectl ? 200 : 700) }, \"edit\");\r\n          }\r\n          if (hideThoughts && !editMode) {\r\n            cnt = pruneToMark(cnt, \"<|reserved_special_token\");\r\n            cnt = pruneTag(cnt, \"think\");\r\n            cnt = pruneTag(cnt, \"thought\");\r\n            cnt = pruneOther(cnt);\r\n          }\r\n\r\n          if (bectl) {\r\n            ecls = \"w-full \";\r\n            cnt = m(\"textarea\", { id: \"editMessage\", class: \"text-field textarea-field-full\" }, cnt);\r\n          }\r\n\r\n        }\r\n        if (!bectl && hideThoughts) {\r\n          cnt = pruneToMark(cnt, \"(Metrics\");\r\n          cnt = pruneToMark(cnt, \"(Reminder\");\r\n          cnt = pruneToMark(cnt, \"(KeyFrame\");\r\n        }\r\n        if (!editMode && cnt.trim().length == 0) {\r\n          return \"\";\r\n        }\r\n\r\n        if (typeof cnt == \"string\") {\r\n          //cnt = cnt.replace(/\\r/,\"\").split(\"\\n\").map((l)=>{return m(\"p\", l)});\r\n          cnt = m.trust(marked.parse(cnt = page.components.emoji.markdownEmojis(cnt.replace(/\\r/, \"\"))));\r\n        }\r\n        let aud = \"\";\r\n\r\n        if (chatCfg.chat && audio && !chatCfg.streaming) {\r\n          let profileId;\r\n          if (msg.role == \"assistant\") {\r\n            profileId = chatCfg?.system?.profile?.objectId;\r\n          }\r\n          else {\r\n            profileId = chatCfg?.user?.profile?.objectId;\r\n          }\r\n\r\n          // Generate stable name based on chat objectId, role, and content hash\r\n          let contentForHash = pruneAll(msg.content);\r\n          let contentHash = page.components.audioComponents.simpleHash(contentForHash);\r\n          let name = inst.api.objectId() + \"-\" + msg.role + \"-\" + contentHash;\r\n\r\n          // Auto-play only the last message, and only once per session\r\n          let shouldAutoPlay = lastMsg && !hasAutoPlayedThisSession;\r\n          if (shouldAutoPlay) {\r\n            hasAutoPlayedThisSession = true;\r\n          }\r\n\r\n          // Use new SimpleAudioPlayer component with stable key based on content\r\n          aud = m(page.components.audioComponents.SimpleAudioPlayer, {\r\n            key: name, // Use stable key based on content hash (same content = same component)\r\n            id: name + \"-\" + aidx,\r\n            name: name,\r\n            profileId: profileId,\r\n            content: contentForHash,\r\n            autoLoad: true,  // Always load audio to create visualizer\r\n            autoPlay: shouldAutoPlay,\r\n            autoPlayDelay: 200,\r\n            autoStopOthers: true,\r\n            visualizerClass: \"audio-container block w-full\",\r\n            height: 60,\r\n            gradient: \"prism\",\r\n            onDelete: () => {\r\n              // Optional: Handle audio deletion if needed\r\n              console.log(\"Delete audio:\", name);\r\n            }\r\n          });\r\n\r\n          aidx++;\r\n        }\r\n        return m(\"div\", { class: \"relative receive-chat flex \" + align },\r\n          [ectl, m(\"div\", { class: ecls + \"px-5 mb-2 \" + txt + \" py-2 text-base max-w-[80%] border rounded-md font-light\" },\r\n            (audio ? aud : m(\"p\", cnt))\r\n            //,aud\r\n          )]\r\n        );\r\n      });\r\n      let flds = [m(\"div\", { class: \"flex justify-between\" }, [\r\n        m(\"div\", { class: \"flex items-center\" }, [\r\n          c1i,\r\n          m(\"span\", { class: \"text-gray-400 text-base pl-4\" }, c1l)\r\n        ]),\r\n        m(\"div\", { class: \"flex items-center\" }, [\r\n\r\n          m(\"span\", { class: \"text-gray-400 text-base pl-4\" }, c2l),\r\n          c2i\r\n        ])\r\n      ])\r\n      ];\r\n      let setting = inst.api.setting();\r\n      let setLbl = \"\";\r\n      if (setting) {\r\n        setLbl = m(\"div\", { class: \"relative receive-chat flex justify-start\"},\r\n          setLbl = m(\"div\", { class:  \"px-5 mb-2 bg-gray-200 dark:bg-gray-900 dark:text-white text-black py-2 text-base w-full border rounded-md font-light\" },\r\n             m(\"p\", \"Setting: \" + setting)\r\n\r\n          )\r\n        );\r\n      }\r\n      \r\n      let ret = [(profile ? m(\"div\", { class: \"bg-white dark:bg-black user-info-header px-5 py-3\" }, flds) : \"\"), m(\"div\", { id: \"messages\", class: \"h-full w-full overflow-y-auto\" }, [\r\n        setLbl,\r\n        msgs\r\n      ])];\r\n\r\n      return ret;\r\n    }\r\n\r\n    function pruneAll(cnt) {\r\n      cnt = pruneToMark(cnt, \"<|reserved_special_token\");\r\n      cnt = pruneTag(cnt, \"think\");\r\n      cnt = pruneTag(cnt, \"thought\");\r\n      cnt = pruneToMark(cnt, \"(Metrics\");\r\n      cnt = pruneToMark(cnt, \"(Reminder\");\r\n      cnt = pruneToMark(cnt, \"(KeyFrame\");\r\n      cnt = pruneOther(cnt);\r\n      return cnt;\r\n    }\r\n\r\n    function pruneOther(cnt) {\r\n      cnt = cnt.replace(/\\[interrupted\\]/g, \"\");\r\n      return cnt;\r\n    }\r\n\r\n    function pruneToMark(cnt, mark) {\r\n      let idx = cnt.indexOf(mark);\r\n      if (idx > -1) {\r\n        cnt = cnt.substring(0, idx);\r\n      }\r\n      return cnt;\r\n    }\r\n\r\n    function pruneOut(cnt, start, end){\r\n      let idx1 = cnt.indexOf(start);\r\n      let idx2 = cnt.indexOf(end);\r\n      if(idx1 > -1 && idx2 > -1 && idx2 > idx1){\r\n        cnt = cnt.substring(0, idx1) + cnt.substring(idx2 + end.length, cnt.length);  \r\n      }\r\n      return cnt;\r\n    }\r\n\r\n    function pruneTag(cnt, tag) {\r\n      let tdx1 = cnt.toLowerCase().indexOf(\"<\" + tag + \">\");\r\n      let maxCheck = 20;\r\n      let check = 0;\r\n      while (tdx1 > -1) {\r\n        if (check++ >= maxCheck) {\r\n          console.error(\"Break on loop!\");\r\n          break;\r\n        }\r\n\r\n        let tdx2 = cnt.toLowerCase().indexOf(\"</\" + tag + \">\");\r\n        if (tdx1 > -1 && tdx2 > -1 && tdx2 > tdx1) {\r\n          cnt = cnt.substring(0, tdx1) + cnt.substring(tdx2 + tag.length + 3, cnt.length);\r\n        }\r\n        tdx1 = cnt.toLowerCase().indexOf(\"<\" + tag + \">\");\r\n      }\r\n      return cnt;\r\n    }\r\n\r\n    function getChatBottomMenuView() {\r\n      // if(!showFooter) return \"\";\r\n\r\n      let pendBar = m(\"div\", { class: \"w-[80%] p-4 flex flex-col\" },\r\n        m(\"div\", { class: \"relative bg-gray-200 rounded\" },\r\n          m(\"div\", { class: \"absolute top-0 h-4 w-full rounded pending-blue\" })\r\n        )\r\n      );\r\n\r\n      let placeText = \"Start typing...\";\r\n      if (!inst) {\r\n        placeText = \"Select or create a chat to begin...\";\r\n      }\r\n      else if (chatCfg.pending) {\r\n        placeText = \"Waiting ...\";\r\n      }\r\n      let msgProps = { type: \"text\", name: \"chatmessage\", class: \"text-field w-[80%]\", placeholder: placeText, onkeydown: function (e) { if (e.which == 13) doChat(e); } };\r\n      let input = m(\"input[\" + (!inst || chatCfg.pending ? \"disabled='true'\" : \"\") + \"]\", msgProps);\r\n\r\n      return m(\"div\", { class: \"result-nav-outer\" },\r\n        m(\"div\", { class: \"results-fixed\" },\r\n          m(\"div\", { class: \"splitcontainer\" }, [\r\n            m(\"div\", { class: \"splitleftcontainer\" },\r\n              m(\"button\", { class: \"flyout-button\", onclick: openChatSettings },\r\n                [m(\"span\", { class: \"material-symbols-outlined material-icons-24\" }, \"add\"), \"New Chat\"]\r\n              )\r\n            ),\r\n            m(\"div\", { class: \"splitrightcontainer result-nav-inner\" },\r\n\r\n              m(\"div\", { class: \"tab-container result-nav w-full\" }, [\r\n                page.iconButton(\"button\",  (fullMode ? \"close_fullscreen\" : \"open_in_new\"), \"\", toggleFullMode),\r\n                page.iconButton(\"button\",  \"cancel\", \"\", doCancel),\r\n                // (camera ? \" animate-pulse\" : \"\")\r\n                page.iconButton(\"button\",  (camera ? \"photo_camera\" : \"no_photography\"), \"\", toggleCamera),\r\n                page.iconButton(\"button\",  (profile ? \"account_circle\" : \"account_circle_off\"), \"\", toggleProfile),\r\n                page.iconButton(\"button\",  (audio ? \"volume_up\" : (audioMagic8 ? \"counter_8\" : \"volume_mute\")), \"\", toggleAudio),\r\n                page.iconButton(\"button\",  \"query_stats\", \"\", chatInto),\r\n                page.iconButton(\"button\",  \"visibility\" + (hideThoughts ? \"\" : \"_off\"), \"\", toggleThoughts),\r\n                page.components.audio.recordButton(),\r\n                (page.components.audio.recording() ? page.components.audio.recordWithVisualizer(true, function (text) { audioText += text; console.log(text); }, function (contentType, b64) { handleAudioSave(contentType, b64); }) : (chatCfg.pending ? pendBar : input)),\r\n                page.iconButton(\"button\",  \"stop\", \"\", doStop),\r\n                page.iconButton(\"button\",  \"chat\", \"\", doChat)\r\n              ])\r\n            )\r\n          ]),\r\n        )\r\n      );\r\n    }\r\n    \r\n    async function handleAudioSave(mimeType, base64) {\r\n      let name = inst.api.objectId() + \" - \" + (chatCfg?.history?.messages?.length || 1);\r\n      console.log(\"Save:\", name);\r\n      let cdir = await page.makePath(\"auth.group\", \"data\", \"~/Data/Recordings\");\r\n      let sinst = am7model.newInstance(\"data.data\");\r\n      sinst.api.groupPath(cdir.path);\r\n      sinst.api.organizationId(page.user.organizationId);\r\n      sinst.api.contentType(mimeType);\r\n      sinst.api.name(name);\r\n      sinst.entity.dataBytesStore = base64;\r\n    }\r\n\r\n    function navKey(e) {\r\n      switch (e.keyCode) {\r\n        /// ESC\r\n        case 27:\r\n          if (fullMode) toggleFullMode();\r\n          break;\r\n      }\r\n    }\r\n\r\n    let lastCount = -1;\r\n    function scrollToLast() {\r\n      if (!inst) {\r\n        return;\r\n      }\r\n      let oMsg = document.getElementById(\"messages\");\r\n      if (!oMsg) return;\r\n      let msgs = oMsg.querySelectorAll(\":scope > div\");\r\n      if (msgs.length > 1 && lastCount != msgs.length) {\r\n        lastCount = msgs.length;\r\n        msgs[lastCount - 1].scrollIntoView();\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n\r\n    async function loadConfigList() {\r\n      await am7client.clearCache(undefined, true);\r\n      let dir = await page.findObject(\"auth.group\", \"DATA\", \"~/Chat\");\r\n      if (aPCfg == undefined) {\r\n        aPCfg = await am7client.list(\"olio.llm.promptConfig\", dir.objectId, null, 0, 0);\r\n        if (aPCfg && aPCfg.length && inst && inst.api.promptConfig() == null) inst.api.promptConfig(aPCfg[0]);\r\n      }\r\n      if (aCCfg == undefined) {\r\n        aCCfg = await am7client.list(\"olio.llm.chatConfig\", dir.objectId, null, 0, 0);\r\n        if (aCCfg && aCCfg.length && inst && inst.api.chatConfig() == null) inst.api.chatConfig(aCCfg[0]);\r\n\r\n      }\r\n      let dir2 = await page.findObject(\"auth.group\", \"DATA\", \"~/ChatRequests\");\r\n      if (aSess == undefined) {\r\n        aSess = await am7client.list(\"olio.llm.chatRequest\", dir2.objectId, null, 0, 0);\r\n        if (aSess && aSess.length && !inst) pickSession(aSess[0]);\r\n      }\r\n\r\n    }\r\n\r\n    function getChatView(vnode) {\r\n\r\n      if (aPCfg == undefined && aCCfg == undefined) {\r\n        loadConfigList().then(() => {\r\n          if (aCCfg.length > 0) {\r\n            doPeek();\r\n          }\r\n          m.redraw();\r\n        });\r\n      }\r\n\r\n\r\n      return m(\"div\", { class: \"content-outer\" }, [\r\n        (fullMode ? \"\" : m(page.components.navigation, { hideBreadcrumb: true })),\r\n        m(\"div\", { class: \"content-main\" },\r\n          m(\"div\", { class: \"list-results-container\" },\r\n            m(\"div\", { class: \"list-results\" }, [\r\n              (camera ? page.components.camera.videoView() : \"\"),\r\n              getChatTopMenuView(),\r\n              getSplitContainerView(),\r\n              getChatBottomMenuView()\r\n            ])\r\n          )\r\n        )\r\n      ]);\r\n    }\r\n\r\n    function toggleFullMode() {\r\n      fullMode = !fullMode;\r\n      m.redraw();\r\n    }\r\n\r\n    chat.toggleFullMode = toggleFullMode\r\n    chat.cancelView = function () {\r\n      altView = undefined;\r\n      fullMode = false;\r\n      m.redraw();\r\n    };\r\n    chat.editItem = function (object) {\r\n      if (!object) return;\r\n      console.log(\"Edit\", object);\r\n      altView = {\r\n        fullMode,\r\n        view: page.views.object(),\r\n        type: object[am7model.jsonModelKey],\r\n        containerId: object.objectId\r\n      };\r\n      m.redraw();\r\n    };\r\n    chat.addNew = function (type, containerId, parentNew) {\r\n      altView = {\r\n        fullMode,\r\n        view: page.views.object(),\r\n        type,\r\n        containerId,\r\n        parentNew,\r\n        new: true\r\n      };\r\n      m.redraw();\r\n    };\r\n\r\n    chat.view = {\r\n      oninit: function (vnode) {\r\n        let ctx = page.user.homeDirectory;\r\n        let bPopSet = false;\r\n        origin = vnode.attrs.origin || ctx;\r\n\r\n        if (window.remoteEntity) {\r\n          inst = am7model.prepareInstance(remoteEntity, am7model.forms.chatSettings);\r\n          bPopSet = true;\r\n          delete window.remoteEntity;\r\n        }\r\n\r\n        document.documentElement.addEventListener(\"keydown\", navKey);\r\n\r\n        if (bPopSet) {\r\n          openChatSettings(inst);\r\n        }\r\n\r\n\r\n      },\r\n      oncreate: function (x) {\r\n        page.navigable.setupPendingContextMenus();\r\n      },\r\n      onupdate: function (x) {\r\n        page.navigable.setupPendingContextMenus();\r\n        scrollToLast();\r\n\r\n        // Audio components (SimpleAudioPlayer and Magic8Ball) manage themselves\r\n        // No need to configure old audio system\r\n      },\r\n      onremove: function (x) {\r\n        page.navigable.cleanupContextMenus();\r\n        pagination.stop();\r\n        document.documentElement.removeEventListener(\"keydown\", navKey);\r\n\r\n        // Stop all audio sources (both old and new systems)\r\n        if (page.components.audio) {\r\n          page.components.audio.stopBinauralSweep();\r\n          page.components.audio.stopAudioSources();\r\n          page.components.audio.stopAllAudioSourceControllers();\r\n        }\r\n\r\n        page.components.camera.stopCapture();\r\n      },\r\n\r\n      view: function (vnode) {\r\n        let v = getChatView(vnode);\r\n        return [v, page.components.dialog.loadDialog(), page.loadToast()];\r\n      }\r\n    };\r\n    return chat;\r\n  }\r\n  page.views.chat = newChatControl;\r\n}());\r\n\n\n;/* === client/view/game.js === */\n(function(){\r\n    const game = {};\r\n    let fullMode = false;\r\n    let components = {};\r\n    function toggleFullMode(){\r\n        fullMode = !fullMode;\r\n        m.redraw();\r\n    }\r\n\r\n    function getGameComponent(){\r\n        let parm = m.route.param(\"name\") || \"tetris\";\r\n        if(!components[parm]){\r\n            components[parm] = page.components[parm];\r\n        }\r\n        return components[parm];\r\n    }\r\n\r\n    function keyHandler(e){\r\n        let component = getGameComponent();\r\n        if(component && component.keyHandler) return component.keyHandler(e);\r\n        return;\r\n    }\r\n\r\n    function doSave(){\r\n        let component = getGameComponent();\r\n        if(component.saveGame) component.saveGame();\r\n    }\r\n\r\n    function getGameView(){\r\n        let comp = getGameComponent();\r\n        return m(\"div\",{class : \"content-outer\"},[\r\n            (fullMode ? \"\" : m(page.components.navigation)),\r\n            m(\"div\",{class : \"content-main\"},[\r\n                m(\"div\",{class : \"list-results-container\"},[\r\n                    m(\"div\",{class : \"list-results\"},[\r\n                    m(\"div\",{class: \"result-nav-outer\"},[\r\n                        m(\"div\",{class: \"result-nav-inner\"},[\r\n                            m(\"div\",{class: \"result-nav tab-container\"},[\r\n                                page.iconButton(\"button mr-4\", (fullMode ? \"close_fullscreen\" : \"open_in_new\"), \"\", toggleFullMode),\r\n                                page.iconButton(\"button\" + (comp && comp.isChanged && comp.isChanged() ? \" warn\" : \"\"),\"save\", \"\", doSave),\r\n                                page.iconButton(\"button\",\"cancel\", \"\", function(){ history.back(); }),\r\n                                (comp && comp.commands ? comp.commands() : \"\")\r\n                            ]),\r\n                            m(\"div\",{class: \"result-nav tab-container\"},\r\n                               comp ? comp.scoreCard() : \"\"\r\n                            )\r\n                        ])\r\n                    ]),\r\n                    m(comp ? comp : \"\", {caller: game})\r\n                ])\r\n            ])\r\n        ]),\r\n         page.components.dialog.loadDialog(), page.loadToast()\r\n        ]);\r\n          \r\n    }\r\n    game.view = {\r\n        oninit : function(x){\r\n            document.addEventListener(\"keydown\", keyHandler);\r\n        },\r\n        oncreate : function (x) {\r\n          \r\n          page.navigable.setupPendingContextMenus();\r\n        },\r\n        onupdate : function(x){\r\n\r\n        },\r\n        onunload : function(x){\r\n            console.log(\"Unloading ...\");\r\n        },\r\n        onremove : function(x){\r\n            document.removeEventListener(\"keydown\", keyHandler);\r\n          page.navigable.cleanupContextMenus();\r\n        },\r\n\r\n        view: function (vnode) {\r\n            if(!page.authenticated()) return m(\"\");\r\n            return getGameView();\r\n        }\r\n    };\r\n    page.views.game = game.view;\r\n}());\r\n\n\n;/* === client/view/hyp.js === */\n(function(){\r\n    let canvas, ctx, particles;\r\n    // This will be updated by the Mithril component based on biometrics\r\n    let particleColor = { r: 150, g: 180, b: 255 }; \r\n    const PARTICLE_COUNT = 100;\r\n    let imgBase = [218, 220, 130, 172, 173]; //[282, 281, 283, 284, 265, 266, 267]; // [218, 220, 130, 172, 173];//[307]; //\r\n    let imageUrls = [];\r\n\r\n    /*\r\n        \"https://images.unsplash.com/photo-1485470733090-0aae1788d5af?q=80&w=1920&auto=format&fit=crop\", \"https://images.unsplash.com/photo-1476610182048-b716b8518a2a?q=80&w=1920&auto=format&fit=crop\", \"https://images.unsplash.com/photo-1594724889613-2895123d49f6?q=80&w=1920&auto=format&fit=crop\", \"https://images.unsplash.com/photo-1448375240586-882707db888b?q=80&w=1920&auto=format&fit=crop\", \"https://images.unsplash.com/photo-150220952416-acea59203632?q=80&w=1920&auto=format&fit=crop\", \"https://images.unsplash.com/photo-1505373333342-429910b3765e?q=80&w=1920&auto=format&fit=crop\"\r\n        ],\r\n    */\r\n    let canvasInitialized = false;\r\n    function setupCanvas() {\r\n        if(canvasInitialized) return;\r\n        canvas = document.getElementById('visual-canvas');\r\n        if (!canvas){\r\n            console.error(\"Canvas element not found.\");\r\n            return;\r\n        }\r\n        canvasInitialized = true;\r\n        ctx = canvas.getContext('2d');\r\n        canvas.width = window.innerWidth;\r\n        canvas.height = window.innerHeight;\r\n\r\n        particles = [];\r\n        for (let i = 0; i < PARTICLE_COUNT; i++) {\r\n            particles.push(createParticle());\r\n        }\r\n\r\n        animateCanvas();\r\n    }\r\n\r\n    function createParticle(p) {\r\n        return {\r\n            x: p ? p.x : Math.random() * canvas.width,\r\n            y: p ? p.y : Math.random() * canvas.height,\r\n            vx: (Math.random() - 0.5) * 0.5,\r\n            vy: (Math.random() - 0.5) * 0.5,\r\n            radius: Math.random() * 3 + 1,\r\n            alpha: Math.random() * 0.5 + 0.1\r\n        };\r\n    }\r\n\r\n    function animateCanvas() {\r\n        if (!ctx) return;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        particles.forEach(p => {\r\n            p.x += p.vx;\r\n            p.y += p.vy;\r\n\r\n            if (p.x < 0 || p.x > canvas.width) p.vx *= -1;\r\n            if (p.y < 0 || p.y > canvas.height) p.vy *= -1;\r\n            \r\n            p.alpha -= 0.001;\r\n            if(p.alpha <= 0){\r\n                Object.assign(p, createParticle());\r\n            }\r\n\r\n            ctx.beginPath();\r\n            ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\r\n            // Use the dynamic particleColor\r\n            ctx.fillStyle = `rgba(${particleColor.r}, ${particleColor.g}, ${particleColor.b}, ${p.alpha})`;\r\n            ctx.fill();\r\n        });\r\n\r\n        requestAnimationFrame(animateCanvas);\r\n    }\r\n    \r\n    window.addEventListener('resize', () => {\r\n        if (canvas) {\r\n            canvas.width = window.innerWidth;\r\n            canvas.height = window.innerHeight;\r\n        }\r\n    });\r\n\r\n        //let faceProfile;\r\n    function handleFaceMetricCapture(imageData) {\r\n      if(imageData && imageData.results?.length){\r\n        let id = imageData.results[0];\r\n        HypnoApp.processBiometricData(id);\r\n        //console.log(id);\r\n        /*\r\n        faceProfile = {\r\n            emotion: id.dominant_emotion,\r\n            emotions: Object.fromEntries(\r\n                Object.entries(id.emotion_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n            ),\r\n\r\n            gender: id.dominant_gender,\r\n            genders: Object.fromEntries(\r\n                Object.entries(id.gender_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n            ),\r\n\r\n            race: id.dominant_race,\r\n            races: Object.fromEntries(\r\n                Object.entries(id.race_scores).map(([key, value]) => {let vf = value; return [key, vf.toFixed(2)];})\r\n            ),\r\n            age: id.age\r\n            };\r\n                console.log(id);\r\n              */\r\n      }\r\n\r\n    }\r\n\r\n    // --- Mithril.js Application ---\r\n    const HypnoApp = {\r\n        // --- State Management ---\r\n        enableAudio: false,\r\n        isStarted: false,\r\n        audioReady: false,\r\n        synth: null,\r\n        lfo: null,\r\n        distractionText: \"...\",\r\n        coreText: \"\",\r\n        imageUrl: \"\",\r\n        biometricData: null,\r\n        biometricClues: [],\r\n        theme: {\r\n            background: \"bg-gray-900\",\r\n            mainText: \"text-blue-100\",\r\n            shadow: \"rgba(180, 210, 255, 0.4)\",\r\n        },\r\n\r\n        // --- Content Arrays ---\r\n        distractions: [\r\n            \"Listen to the space between sounds...\", \"The feeling of now is the memory of later...\", \"What if right was left?\", \"Remember to forget...\", \"A thought is just a visitor...\", \"Up is down if you allow it...\", \"Focus on everything and nothing...\", \"The future was yesterday...\", \"Notice your breath without changing it...\", \"See the silence...\"\r\n        ],\r\n        coreMessages: [\"peace of mind\", \"purity of essence\", \"peace and harmony\"],\r\n        \r\n        // --- Color & Theme Mappings ---\r\n        emotionThemes: {\r\n            neutral: { background: \"bg-gray-800\", mainText: \"text-blue-200\", shadow: \"rgba(180, 210, 255, 0.4)\" },\r\n            happy:   { background: \"bg-yellow-900\", mainText: \"text-yellow-100\", shadow: \"rgba(255, 230, 150, 0.5)\" },\r\n            sad:     { background: \"bg-indigo-900\", mainText: \"text-indigo-200\", shadow: \"rgba(190, 200, 255, 0.4)\" },\r\n            angry:   { background: \"bg-red-900\", mainText: \"text-red-200\", shadow: \"rgba(255, 180, 180, 0.5)\" },\r\n            fear:    { background: \"bg-purple-900\", mainText: \"text-purple-200\", shadow: \"rgba(220, 180, 255, 0.4)\" },\r\n            surprise:{ background: \"bg-pink-900\", mainText: \"text-pink-200\", shadow: \"rgba(255, 180, 220, 0.5)\" },\r\n            disgust: { background: \"bg-green-900\", mainText: \"text-green-200\", shadow: \"rgba(180, 255, 180, 0.4)\" },\r\n        },\r\n\r\n        raceColors: {\r\n            white: [255, 220, 180],\r\n            black: [100, 75, 50],\r\n            asian: [255, 235, 160],\r\n            'East Asian': [255, 235, 160],\r\n            'Southeast Asian': [255, 235, 160],\r\n            indian: [200, 160, 120],\r\n            'middle eastern': [220, 190, 150],\r\n            'latino hispanic': [180, 130, 90]\r\n        },\r\n\r\n        genderColors: {\r\n            Man: [180, 200, 255], // A cool, light blue\r\n            Woman: [255, 200, 220] // A warm, light pink\r\n        },\r\n\r\n        // --- Biometric Processing ---\r\n        processBiometricData: function(data) {\r\n            //console.log(data);\r\n            HypnoApp.biometricData = data;\r\n            let clues = [];\r\n\r\n            // 1. Update Theme based on Emotion\r\n            const emotion = data.dominant_emotion || \"neutral\";\r\n            //console.log(data.dominant_emotion, emotion);\r\n            HypnoApp.theme = HypnoApp.emotionThemes[emotion] || HypnoApp.emotionThemes.neutral;\r\n            clues.push(`A state of ${emotion}.`);\r\n\r\n            // 2. Generate Particle Color from Race and Gender\r\n            let raceBlendedColor = null;\r\n            let raceTotalScore = 0;\r\n            for (const race in data.race_scores) {\r\n                if (data.race_scores[race] > 0 && HypnoApp.raceColors[race]) {\r\n                    raceTotalScore += data.race_scores[race];\r\n                }\r\n            }\r\n            if (raceTotalScore > 0) {\r\n                let r = 0, g = 0, b = 0;\r\n                for (const race in data.race_scores) {\r\n                        if (data.race_scores[race] > 0 && HypnoApp.raceColors[race]) {\r\n                        const weight = data.race_scores[race] / raceTotalScore;\r\n                        r += HypnoApp.raceColors[race][0] * weight;\r\n                        g += HypnoApp.raceColors[race][1] * weight;\r\n                        b += HypnoApp.raceColors[race][2] * weight;\r\n                    }\r\n                }\r\n                raceBlendedColor = { r: r, g: g, b: b };\r\n                clues.push(`A tapestry of heritage.`);\r\n            }\r\n\r\n            let genderBlendedColor = null;\r\n            let genderTotalScore = 0;\r\n            for (const gender in data.gender_scores) {\r\n                if (data.gender_scores[gender] > 0 && HypnoApp.genderColors[gender]) {\r\n                    genderTotalScore += data.gender_scores[gender];\r\n                }\r\n            }\r\n            if (genderTotalScore > 0) {\r\n                let r = 0, g = 0, b = 0;\r\n                for (const gender in data.gender_scores) {\r\n                    if (data.gender_scores[gender] > 0 && HypnoApp.genderColors[gender]) {\r\n                        const weight = data.gender_scores[gender] / genderTotalScore;\r\n                        r += HypnoApp.genderColors[gender][0] * weight;\r\n                        g += HypnoApp.genderColors[gender][1] * weight;\r\n                        b += HypnoApp.genderColors[gender][2] * weight;\r\n                    }\r\n                }\r\n                genderBlendedColor = { r: r, g: g, b: b };\r\n            }\r\n\r\n            if (raceBlendedColor && genderBlendedColor) {\r\n                // Average the two colors\r\n                particleColor = {\r\n                    r: Math.round((raceBlendedColor.r + genderBlendedColor.r) / 2),\r\n                    g: Math.round((raceBlendedColor.g + genderBlendedColor.g) / 2),\r\n                    b: Math.round((raceBlendedColor.b + genderBlendedColor.b) / 2)\r\n                };\r\n            } else if (raceBlendedColor) {\r\n                particleColor = { r: Math.round(raceBlendedColor.r), g: Math.round(raceBlendedColor.g), b: Math.round(raceBlendedColor.b) };\r\n            } else if (genderBlendedColor) {\r\n                particleColor = { r: Math.round(genderBlendedColor.r), g: Math.round(genderBlendedColor.g), b: Math.round(genderBlendedColor.b) };\r\n            }\r\n\r\n            // 3. Generate Clues for Age and Gender\r\n            if (data.age) {\r\n                clues.push(`${data.age} years of experience.`);\r\n            }\r\n            if (data.dominant_gender) {\r\n                clues.push(`An expression of ${data.dominant_gender.toLowerCase()} energy.`);\r\n            }\r\n            \r\n            HypnoApp.biometricClues = clues;\r\n            //console.log(this, HypnoApp.biometricClues);\r\n            m.redraw();\r\n        },\r\n\r\n        // --- Component Methods ---\r\n        startExperience: function() {\r\n            if(HypnoApp.isStarted){\r\n                return;\r\n            }            \r\n\r\n            HypnoApp.isStarted = true;\r\n\r\n                if(!page.components.camera.devices().length){\r\n                    page.components.camera.initializeAndFindDevices(handleFaceMetricCapture);\r\n                }\r\n                else{\r\n                    page.components.camera.startCapture(handleFaceMetricCapture);\r\n                }\r\n\r\n            if (imgBase.length && imageUrls.length == 0) {\r\n                let q = am7client.newQuery(\"data.data\");\r\n                let qg = q.field(null, null);\r\n                qg.comparator = \"group_or\";\r\n                qg.fields = imgBase.map((a) => {\r\n                    return {\r\n                        name: \"groupId\",\r\n                        comparator: \"equals\",\r\n                        value: a\r\n                    }\r\n                });\r\n                q.range(0, 0);\r\n                window.dbgQ = q;\r\n                imgBase = [];\r\n                am7client.search(q, function(res){\r\n\r\n                    if (res && res.results) {\r\n                        imageUrls = res.results.map((r) => {\r\n                            return g_application_path + \"/media/Public/data.data\" + r.groupPath + \"/\" + r.name;\r\n                        });\r\n                        console.log(imageUrls.length);\r\n                        \r\n                        HypnoApp.cycleContent();\r\n                        m.redraw();\r\n                    }\r\n                });\r\n            }\r\n\r\n            \r\n            if (HypnoApp.enableAudio && !HypnoApp.audioReady) {\r\n                Tone.start().then(() => {\r\n                    HypnoApp.synth = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.1, decay: 0.2, sustain: 0.5, release: 1 } }).toDestination();\r\n                    HypnoApp.lfo = new Tone.LFO({ frequency: \"8n\", min: 200, max: 220 }).connect(HypnoApp.synth.frequency).start();\r\n                    Tone.Transport.start();\r\n                    HypnoApp.synth.triggerAttack(210);\r\n                    HypnoApp.audioReady = true;\r\n                });\r\n            }\r\n            \r\n        },\r\n        \r\n        cycleContent: function() {\r\n            HypnoApp.distractionText = HypnoApp.distractions[Math.floor(Math.random() * HypnoApp.distractions.length)];\r\n            HypnoApp.coreText = HypnoApp.coreMessages[Math.floor(Math.random() * HypnoApp.coreMessages.length)];\r\n            HypnoApp.imageUrl = (imageUrls.length ? imageUrls[Math.floor(Math.random() * imageUrls.length)] : \"\");\r\n            m.redraw();\r\n        },\r\n\r\n        // --- Lifecycle Hooks ---\r\n        oncreate: function(vnode) {\r\n\r\n            HypnoApp.contentInterval = setInterval(() => HypnoApp.cycleContent(), 5000);\r\n            HypnoApp.cycleContent();\r\n            //console.log(\"HypnoApp created\");\r\n            // Initial biometric data processing with the provided example\r\n            const initialData = {\"age\":41,\"dominant_gender\":\"Man\",\"dominant_emotion\":\"neutral\",\"dominant_race\":\"white\",\"emotion_scores\":{\"angry\":0.18,\"disgust\":0,\"fear\":0.09,\"happy\":0,\"sad\":0.32,\"surprise\":0.01,\"neutral\":0.39},\"race_scores\":{\"asian\":1.46,\"indian\":0.09,\"black\":0.01,\"white\":87.78,\"middle eastern\":4.13,\"latino hispanic\":6.5},\"gender_scores\":{\"Woman\":0.01,\"Man\":99.98},\"face_confidence\":0.94};\r\n            HypnoApp.processBiometricData(initialData);\r\n        },\r\n        oninit: function(){\r\n\r\n        },\r\n        onupdate: function(){\r\n\r\n        },\r\n        onremove: function() {\r\n            //console.log(\"HypnoApp removed\");\r\n            page.components.camera.stopCapture();\r\n            clearInterval(HypnoApp.contentInterval);\r\n            if (HypnoApp.synth) {\r\n                HypnoApp.synth.triggerRelease();\r\n                HypnoApp.lfo.stop();\r\n                Tone.Transport.stop();\r\n            }\r\n        },\r\n\r\n        // --- View ---\r\n        view: function() {\r\n            if (!HypnoApp.isStarted) {\r\n\r\n\r\n                return [m(\".h-screen.w-screen.flex.items-center.justify-center.bg-gray-900\",\r\n                    m(\".text-center.p-8.bg-gray-800.rounded-lg.shadow-2xl\", [\r\n                        m(\"h1.text-3xl.font-bold.mb-4.text-blue-200\", \"Biometric Feedback Session\"),\r\n                        m(\"p.text-lg.mb-6.text-gray-300\", \"This experience adapts to you. Please use headphones for the best effect.\"),\r\n                        m(\"button.px-8.py-3.bg-blue-600.text-white.font-bold.rounded-full.hover:bg-blue-500.transition-colors.duration-300.shadow-lg\", { onclick: () => HypnoApp.startExperience() }, \"Begin\")\r\n                    ])\r\n                ), page.components.dialog.loadDialog()];\r\n            }\r\n            \r\n            return [m(\".relative.h-screen.w-screen.transition-colors.duration-1000\", { class: HypnoApp.theme.background }, [\r\n                m(\"img.absolute.top-0.left-0.w-full.h-full.object-cover.z-0.opacity-50.animate-[fadeIn_3s_ease-in-out]\", { src: HypnoApp.imageUrl, alt: \"Background\" }),\r\n                m(\"canvas\", {oncreate: setupCanvas, id: \"visual-canvas\", class: \"absolute top-0 left-0 z-5\"}),\r\n                m(\".absolute.top-0.left-0.z-10.h-full.w-full.p-4.bg-black.bg-opacity-40\", {  }, [\r\n                    \r\n                    // Distraction Text (Top)\r\n                    m(\"div.absolute.top-1/4.left-1/2.-translate-x-1/2.text-center\", {},\r\n                        m(\"p.text-xl.text-gray-300.opacity-75[style={text-shadow: '0 0 5px rgba(0,0,0,0.7)'}]\", {  }, HypnoApp.distractionText)\r\n                    ),\r\n\r\n                    // Core Message (Center)\r\n                    m(\"div.absolute.top-1/2.left-1/2.-translate-x-1/2.-translate-y-1/2.text-center\", { },\r\n                        m(\"h1\", {class : \"text-5xl font-bold transition-colors duration-1000 opacity-75 \" + HypnoApp.theme.mainText,\r\n                            style: { textShadow: `0 0 8px rgba(255, 255, 255, 0.3), 0 0 20px ${HypnoApp.theme.shadow}` }\r\n                            \r\n                        }, HypnoApp.coreText.toUpperCase())\r\n                    ),\r\n                    \r\n                    // Biometric Clues (Bottom)\r\n                    m(\".absolute.bottom-8.left-1/2.-translate-x-1/2.text-center.text-sm.text-gray-400.opacity-60.p-2.rounded-lg.bg-black.bg-opacity-20\",\r\n                        HypnoApp.biometricClues.map(clue => m(\"p\", {  }, clue))\r\n                    )\r\n                ])\r\n            ]), page.components.camera.videoView(), page.components.dialog.loadDialog()];\r\n        }\r\n    };\r\n\r\n    page.views.hyp = HypnoApp;\r\n}());\n\n;/* === client/applicationRouter.js === */\n(function(){\r\n\r\n    let routes = {\r\n        \r\n        \"/sig\": page.views.sig,\r\n        \"/saur\": page.views.saur,\r\n        \"/main\" : page.views.main,\r\n        \"/nav\" : page.views.navigator().view,\r\n        \"/chat\" : page.views.chat().view,\r\n        \"/new/:objectId\" : page.views.object().view,\r\n        \"/new/:type/:objectId\" : page.views.object().view,\r\n        \"/pnew/:type/:objectId\" : page.views.object().view,\r\n        \"/view/:type/:objectId\" : page.views.object().view,\r\n        \"/list/:type\" : page.views.list().view,\r\n        \"/list/:type/:objectId\" : page.views.list().view,\r\n        \"/plist/:type/:objectId\" : page.views.list().view,\r\n        \"/game\" : page.views.game,\r\n        \"/game/:name\" : page.views.game,\r\n        \"/cardGame\": page.views.cardGame,\r\n        \"/hyp\": page.views.hyp\r\n    };\r\n    \r\n    \r\n\r\n    function init(){\r\n        window.addEventListener(\"beforeunload\", takeDown);\r\n        refreshApplication();\r\n    }\r\n    \r\n    function takeDown(){\r\n        console.log(\"Unload\");\r\n        if(page.wss){\r\n            page.wss.close();\r\n        }\r\n    }\r\n\r\n    function refreshApplication() {\r\n        \r\n        am7client.principal().then((usr) => {\r\n            let rt = window.location.hash.slice(window.location.hash.indexOf(\"/\"));\r\n            page.application = undefined;\r\n            page.user = usr;\r\n            \r\n            if(usr == null){\r\n                page.wss.close();\r\n                rt = \"/sig\";\r\n                m.route.set(rt);\r\n                m.route(document.body, rt, routes);\r\n                \r\n            }\r\n            else{\r\n                am7client.currentOrganization = usr.organizationPath;\r\n                am7client.application().then((app) => {\r\n                    page.application = app;\r\n                    if(app && app != null){\r\n                        for(let v in app){\r\n                            if(app[v] instanceof Array){\r\n                                am7model.updateListModel(app[v], am7model.getModelField(app.schema, v));\r\n                            }\r\n                        }\r\n                        setContextRoles(app);\r\n                        if(!rt.length || rt == \"/sig\") rt = \"/main\";\r\n                        page.wss.connect();\r\n                    }\r\n                    else{\r\n                        rt = \"/sig\";\r\n                    }\r\n                    m.route.set(rt);\r\n                    m.route(document.body, rt, routes);\r\n                });\r\n            }\r\n            \r\n           \r\n        });\r\n\r\n        page.router = {\r\n            refresh: refreshApplication,\r\n            routes,\r\n            route: function(path, node){\r\n                m.route.set(path);\r\n            }\r\n        };\r\n    };\r\n\r\n    init();\r\n\r\n    function hasRole(roles, role){\r\n        return (roles.filter(r => r.name.toLowerCase() === role.toLowerCase()).length > 0);\r\n    }\r\n    function setContextRoles(app){\r\n        let ctxRoles = page.context().roles;\r\n        let roles = (app && app.userRoles ? app.userRoles : []);\r\n\r\n        ctxRoles.user = hasRole(roles, 'accountusers');\r\n        ctxRoles.api = hasRole(roles, 'apiusers');\r\n        ctxRoles.userReader = hasRole(roles, 'accountusersreader');\r\n        ctxRoles.roleReader = hasRole(roles, 'rolereaders');\r\n        ctxRoles.permissionReader = hasRole(roles, 'permissionreaders');\r\n        ctxRoles.author = hasRole(roles, 'articleauthors');\r\n        ctxRoles.systemAdmin = hasRole(roles, 'systemadministrators');\r\n        ctxRoles.accountAdmin = hasRole(roles, 'accountadministrators');\r\n        ctxRoles.dataAdmin = hasRole(roles, 'dataadministrators');\r\n        ctxRoles.objectAdmin = hasRole(roles, 'objectadministrators');\r\n        ctxRoles.scriptExecutor = hasRole(roles, 'scriptexecutors');\r\n        ctxRoles.admin = (ctxRoles.systemAdmin || ctxRoles.accountAdmin);\r\n    }\r\n\r\n}());\r\n\n"],
  "mappings": "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,KAAQ,YACV,EACF,CACE,OAAU,uBACV,KAAQ,SACR,MAAS,SACT,MAAS,CACP,gBACA,cACA,iBACA,cACA,mBACA,iBACF,EACA,KAAQ,QACV,EACA,CACE,OAAU,uBACV,KAAQ,OACR,MAAS,QACT,MAAS,CACP,OACA,cACA,uBACF,EACA,KAAQ,cACV,CACF,EACA,MAAS,CACP,cAAiB,CACf,OACA,UACA,OACA,WACA,SACA,OACA,OACA,MACA,OACA,OACA,QACA,SACA,YACA,WACA,SACA,SACF,EACA,yBAA4B,CAC1B,UACA,SACA,OACA,SACA,SACA,SACF,EACA,gBAAmB,CACjB,UACA,QACA,SACA,SACA,aACF,EACA,sBAAyB,CACvB,UACA,eACA,SACA,aACA,aACA,UACF,EACA,eAAkB,CAChB,UACA,MACA,UACA,SACA,SACA,QACA,OACA,UACA,WACA,QACA,OACA,SACA,UACA,eACA,YACA,QACA,OACA,SACA,WACF,EACA,iBAAoB,CAClB,UACA,oBACA,cACA,SACA,UACA,OACF,EACA,yBAA4B,CAC1B,UACA,UACA,OACA,SACA,YACA,UACA,YACA,SACF,EACA,iBAAoB,CAClB,UACA,QACA,SACA,cACA,aACA,UACA,OACA,MACF,EACA,+BAAkC,CAChC,UACA,gBACA,oBACA,kBACF,EACA,mBAAsB,CACpB,UACA,MACA,UACA,SACA,aACA,UACA,YACA,sBACA,eACA,yBACA,SACA,KACA,WACA,UACA,iBACA,qBACA,OACA,QACA,YACA,UACF,EACA,oBAAuB,CACrB,UACA,OACA,MACF,EACA,kBAAqB,CACnB,UACA,MACA,MACA,OACA,YACA,sBACA,eACA,wBACF,EACA,mBAAsB,CACpB,UACA,UACA,IACF,EACA,gBAAmB,CACjB,UACA,QACA,QACA,MACA,QACA,SACF,EACA,2BAA8B,CAC5B,UACA,aACA,QACA,eACA,UACA,UACA,OACA,QACF,EACA,sBAAyB,CACvB,UACA,SACA,OACA,QACA,SACA,SACA,UACA,KACF,EACA,gBAAmB,CACjB,UACA,QACF,EACA,mBAAsB,CACpB,UACA,kBACA,kBACA,OACA,qBACA,qBACA,QACA,cACA,YACA,UACA,MACA,WACF,EACA,eAAkB,CAChB,UACA,mBACA,kBACA,WACF,EACA,aAAgB,CACd,UACA,QACA,OACA,aACA,WACA,YACA,SACA,UACA,OACA,WACA,UACA,UACA,YACA,WACF,EACA,iBAAoB,CAClB,UACA,aACA,OACA,MACF,EACA,cAAiB,CACf,UACA,UACA,OACA,SACA,OACA,QACF,EACA,cAAiB,CACf,UACA,MACA,WACA,eACA,OACA,SACA,UACA,OACF,EACA,iBAAoB,CAClB,UACA,OACA,OACA,SACA,QACA,SACF,EACA,kBAAqB,CACnB,UACA,QACA,aACA,WACA,UACF,EACA,0BAA6B,CAC3B,UACA,YACA,SACA,OACF,EACA,cAAiB,CACf,YACA,aACA,SACF,EACA,qBAAwB,CACtB,UACA,OACA,SACA,SACA,aACF,EACA,gBAAmB,CACjB,UACA,YACA,WACA,YACA,aACA,gBACA,qBACA,eACA,UACF,EACA,mBAAsB,CACpB,UACA,OACA,QACA,OACA,aACA,UACA,OACA,SACA,SACA,aACF,EACA,sBAAyB,CACvB,UACA,eACA,SACA,SACA,OACF,EACA,uBAA0B,CACxB,UACA,gBACA,SACA,OACA,UACA,oBACA,mBACA,QACA,SACA,UACF,EACA,cAAiB,CACf,UACA,cACA,eACA,OACA,IACF,EACA,iBAAoB,CAClB,UACA,SACA,QACA,UACA,OACA,OACA,SACF,EACA,aAAgB,CACd,UACA,UACA,OACA,QACF,EACA,aAAgB,CACd,UACA,SACA,MACF,EACA,oBAAuB,CACrB,UACA,MACA,gBACA,iBACA,UACA,UACF,EACA,kBAAqB,CACnB,UACA,UACA,gBACA,QACA,UACA,QACA,OACA,UACA,QACF,EACA,oBAAuB,CACrB,UACA,QACA,WACA,SACA,eACA,cACA,WACA,UACA,sBACA,YACA,YACA,WACA,SACF,EACA,gBAAmB,CACjB,UACA,QACA,SACA,SACA,MACA,OACA,UACA,OACA,OACA,WACA,OACA,UACA,WACA,SACA,QACA,UACA,cACA,gBACA,cACA,OACA,UACA,QACA,OACA,MACA,WACA,SACA,OACA,YACA,UACA,YACA,UACA,SACA,MACF,EACA,mBAAsB,CACpB,UACA,OACA,OACA,SACF,EACA,eAAkB,CAChB,UACA,OACA,SACF,EACA,YAAe,CACb,UACA,UACA,OACA,OACA,SACA,OACF,EACA,aAAgB,CACd,UACA,QACA,SACA,SACA,aACF,EACA,mBAAsB,CACpB,UACA,eACA,SACA,aACA,aACA,UACF,EACA,mBAAsB,CACpB,UACA,UACA,WACA,cACA,MACF,EACA,cAAiB,CACf,UACA,SACA,MACA,OACA,UACA,WACA,YACF,EACA,qBAAwB,CACtB,UACA,UACA,WACA,eACA,OACF,EACA,kBAAqB,CACnB,cACA,cACA,aACA,iBACA,UACA,UACA,gBACA,cACA,cACA,YACF,EACA,iBAAoB,CAClB,UACA,WACA,QACA,aACA,WACF,EACA,mBAAsB,CACpB,UACA,gBACA,SACA,OACA,SACA,OACA,YACA,aACA,eACA,WACF,EACA,sBAAyB,CACvB,eACA,aACA,WACA,YACA,cACA,gBACA,iBACA,OACA,QACA,WACA,gBACA,gBACA,WACA,kBACA,YACA,cACA,YACA,SACF,EACA,gBAAmB,CACjB,UACA,YACA,YACA,OACA,SACA,QACA,UACA,mBACA,OACA,OACA,aACA,cACF,EACA,kBAAqB,CACnB,QACA,YACA,OACA,YACA,QACA,YACA,OACA,YACA,SACF,EACA,oBAAuB,CACrB,UACA,cACA,SACA,cACA,WACA,UACA,SACF,EACA,kBAAqB,CACnB,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,OACA,MACA,MACA,QACA,OACA,OACA,MACA,QACA,QACA,OACA,MACA,SACA,SACA,WACA,UACF,EACA,aAAgB,CACd,cACA,QACA,MACA,UACA,aACA,gBACA,OACA,SACA,WACA,UACA,WACA,eACA,OACA,WACA,WACA,WACA,cACA,SACA,WACA,YACA,OACA,UACA,MACF,EACA,iBAAoB,CAClB,cACA,gBACA,QACA,QACA,OACA,aACA,aACA,gBACA,aACA,gBACA,UACA,MACA,SACA,SACA,WACA,UACA,OACA,WACA,WACA,WACA,SACA,WACA,OACA,gBACF,EACA,oBAAuB,CACrB,cACA,OACA,SACA,WACA,SACA,WACA,SACA,SACA,WACA,cACA,UACA,WACA,aACA,YACA,aACA,YACA,OACA,SACA,SACA,YACA,WACA,oBACA,uBACA,OACA,WACA,cACA,SACA,YACA,OACA,SACA,gBACA,WACA,SACA,UACA,OACA,WACA,YACA,WACA,SACF,EACA,kBAAqB,CACnB,aACA,WACA,SACA,aACA,SACF,EACA,gBAAmB,CACjB,iBACA,YACA,cACA,cACA,kBACF,EACA,wBAA2B,CACzB,UACA,aACA,eACA,WACA,aACA,OACA,OACA,QACA,WACA,cACA,MACA,WACF,EACA,aAAgB,CACd,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,GACF,EACA,eAAkB,CAChB,MACA,YACA,YACA,aACA,wBACA,UACA,WACA,WACA,YACA,gBACA,aACA,YACA,eACA,aACA,aACA,eACA,YACA,aACA,WACA,WACA,eACA,eACA,kBACA,mBACA,WACA,WACA,aACA,OACA,gBACA,YACA,cACA,UACA,YACA,SACA,SACA,WACA,aACA,eACA,YACA,SACF,EACA,aAAgB,CACd,UACA,oBACA,uBACA,UACA,UACA,iBACF,EACA,oBAAuB,CACrB,WACA,aACA,YACA,SACA,WACA,SACF,EACA,eAAkB,CAChB,gBACA,gBACA,kBACA,kBACA,uBACA,qBACA,qBACA,gBACA,gBACA,gBACA,qBACA,qBACA,OACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,uBACA,uBACA,gBACA,gBACA,gBACA,eACF,EACA,aAAgB,CACd,cACA,QACA,WACA,WACA,cACA,kBACA,WACA,aACA,UACA,SACA,OACA,SACA,YACF,EACA,kBAAqB,CACnB,OACA,WACA,QACA,KACA,OACA,SACA,OACA,YACA,YACA,OACA,QACA,YACA,YACA,SACF,EACA,aAAgB,CACd,IACA,MACA,IACA,IACA,KACA,IACF,EACA,mBAAsB,CACpB,UACA,QACA,SACA,QACF,CACF,EACA,OAAU,CACR,CACE,KAAQ,cACR,SAAY,GACZ,OAAU,CACR,CACE,MAAS,OACT,KAAQ,OACR,KAAQ,SACR,SAAY,GACZ,MAAS,GACT,UAAa,GACb,UAAa,IACb,MAAS,CACP,WACF,EACA,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,UACR,KAAQ,OACR,SAAY,GACZ,QAAW,GACX,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,MAAS,CACP,UACF,EACA,OAAU,CACR,CACE,KAAQ,WACR,KAAQ,SACR,SAAY,GACZ,SAAY,GACZ,UAAa,GACb,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,uBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,aACR,KAAQ,OACR,SAAY,QACZ,UAAa,mBACb,WAAc,GACd,gBAAmB,GACnB,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,yBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,mBACR,KAAQ,SACR,QAAW,GACX,UAAa,sBACb,aAAgB,iBAChB,SAAY,gDACZ,SAAY,EACZ,UAAa,IACf,EACA,CACE,KAAQ,iBACR,KAAQ,OACR,SAAY,GACZ,QAAW,GACX,MAAS,GACT,cAAiB,GACjB,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,YACR,KAAQ,UACR,UAAa,GACb,UAAa,KACf,EACA,CACE,KAAQ,kBACR,KAAQ,OACR,SAAY,SACZ,UAAa,GACb,QAAW,GACX,UAAa,MACf,CACF,CACF,EACA,CACE,KAAQ,oBACR,SAAY,GACZ,MAAS,CACP,IACF,EACA,OAAU,CACR,CACE,KAAQ,KACR,MAAS,KACT,KAAQ,OACR,MAAS,GACT,SAAY,GACZ,SAAY,GACZ,QAAW,GACX,SAAY,GACZ,WAAc,GACd,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,SAAY,CACV,iBACA,kBACA,uBACA,yBACA,kBACA,mBACF,EACA,QAAW,8CACX,MAAS,CACP,KACA,WACA,UACA,gBACF,EACA,OAAU,CAAC,CACb,EACA,CACE,KAAQ,aACR,SAAY,GACZ,MAAS,CACP,KACF,EACA,OAAU,CACR,CACE,KAAQ,MACR,KAAQ,SACR,SAAY,GACZ,SAAY,+CACZ,SAAY,EACZ,SAAY,GACZ,UAAa,IACb,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,YACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,UACR,UAAa,GACb,UAAa,KACf,CACF,CACF,EACA,CACE,KAAQ,cACR,SAAY,GACZ,SAAY,CACV,mBACA,aACA,WACF,EACA,QAAW,8CACX,MAAS,CACP,KACA,MACA,WACA,SACF,EACA,OAAU,CAAC,CACb,EACA,CACE,KAAQ,qBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,WACR,KAAQ,OACR,SAAY,QACZ,UAAa,iBACb,QAAW,GACX,gBAAmB,GACnB,UAAa,MACf,CACF,CACF,EACA,CACE,KAAQ,eACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,OACR,SAAY,QACZ,UAAa,WACb,QAAW,GACX,cAAiB,GACjB,gBAAmB,EACrB,CACF,CACF,EACA,CACE,KAAQ,gBACR,SAAY,CACV,cACA,cACA,qBACA,cACF,EACA,SAAY,GACZ,MAAS,CACP,MACF,EACA,OAAU,CAAC,CACb,EACA,CACE,KAAQ,gBACR,SAAY,GACZ,MAAS,CACP,UACF,EACA,WAAc,CACZ,MAAS,CACP,CACE,OAAU,CACR,UACF,EACA,MAAS,CACP,cACF,CACF,CACF,CACF,EACA,OAAU,CACR,CACE,KAAQ,WACR,KAAQ,OACR,aAAgB,KAChB,UAAa,QACb,SAAY,GACZ,MAAS,GACT,QAAW,EACX,UAAa,GACb,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,cACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,SACR,QAAW,GACX,SAAY,gDACZ,SAAY,CACd,CACF,CACF,EACA,CACE,KAAQ,sBACR,SAAY,CACV,gBACA,gBACA,aACF,EACA,YAAe,CACb,gBACF,EACA,KAAQ,SACR,MAAS,eACT,YAAe,6DACf,OAAU,CACR,CACE,KAAQ,OACR,UAAa,2DACb,KAAQ,OACR,SAAY,GACZ,MAAS,GACT,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,cAAiB,CACf,MACF,EACA,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,KACR,KAAQ,OACR,SAAY,GACZ,SAAY,GACZ,QAAW,EACb,EACA,CACE,KAAQ,WACR,KAAQ,SACR,SAAY,GACZ,SAAY,GACZ,UAAa,EACf,EACA,CACE,KAAQ,OACR,KAAQ,SACR,SAAY,EACd,EACA,CACE,KAAQ,aACR,KAAQ,SACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,uBACR,SAAY,CACV,iBACF,EACA,cAAiB,CACf,MACF,EACA,OAAU,CACR,CACE,KAAQ,iBACR,KAAQ,MACV,CACF,CACF,EACA,CACE,KAAQ,iCACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,qBACR,UAAa,8BACb,KAAQ,QACR,QAAW,GACX,OAAU,CACR,MAAS,CACP,KAAQ,CACN,qBACF,CACF,CACF,EACA,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,cACR,YAAe,CACb,sBACF,EACA,SAAY,CACV,gBACA,gCACF,EACA,KAAQ,gBACR,MAAS,OACT,WAAc,CACZ,MAAS,CACP,CACE,OAAU,CACR,MACF,EACA,MAAS,CACP,UACF,CACF,CACF,CACF,EACA,GAAM,CACJ,OAAU,+CACZ,EACA,YAAe,wCACf,OAAU,CACR,MAAS,CACP,OAAU,CACR,uBACF,EACA,KAAQ,CACN,wBACA,qBACF,EACA,OAAU,CACR,uBACF,EACA,OAAU,CACR,uBACF,EACA,MAAS,CACP,uBACF,CACF,CACF,EACA,MAAS,CACP,OACA,eACF,EACA,OAAU,CACR,CACE,KAAQ,gBACR,UAAa,aACb,KAAQ,QACR,QAAW,GACX,OAAU,CACR,MAAS,CACP,KAAQ,CACN,qBACF,CACF,CACF,EACA,UAAa,IACf,EACA,CACE,KAAQ,SACR,UAAa,yDACb,KAAQ,OACR,UAAa,GACb,UAAa,MACf,EACA,CACE,KAAQ,OACR,UAAa,mDACb,KAAQ,OACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,MAAS,CACP,SACF,EACA,OAAU,CACR,CACE,KAAQ,UACR,KAAQ,OACR,aAAgB,KAChB,UAAa,aACb,MAAS,GACT,UAAa,GACb,UAAa,GACf,EACA,CACE,KAAQ,YACR,KAAQ,SACR,QAAW,GACX,UAAa,aACb,aAAgB,UAChB,SAAY,gDACZ,SAAY,EACZ,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,CACV,kBACA,eACF,EACA,YAAe,CACb,+BACF,EACA,QAAW,mDACX,SAAY,GACZ,MAAS,CACP,UACA,YACA,gBACF,EACA,OAAU,CAAC,CACb,EACA,CACE,KAAQ,mBACR,SAAY,CACV,iBACA,gCACF,EACA,KAAQ,iBACR,MAAS,UACT,MAAS,WACT,YAAe,2GACf,OAAU,CACR,CACE,KAAQ,OACR,UAAa,sDACb,KAAQ,OACR,UAAa,EACf,EACA,CACE,KAAQ,SACR,UAAa,4DACb,KAAQ,OACR,UAAa,EACf,EACA,CACE,KAAQ,cACR,KAAQ,MACV,EACA,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,iBACR,KAAQ,SACV,CACF,CACF,EACA,CACE,KAAQ,qBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,cACR,KAAQ,SACR,UAAa,IACb,UAAa,KACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,CACV,iBACA,qBACA,gCACF,EACA,KAAQ,SACR,MAAS,SACT,MAAS,UACT,uBAA0B,GAC1B,YAAe,gGACf,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,OACR,SAAY,SACZ,UAAa,MACb,UAAa,EACf,EACA,CACE,KAAQ,YACR,KAAQ,OACR,SAAY,SACZ,UAAa,KACf,EACA,CACE,KAAQ,iBACR,KAAQ,SACR,UAAa,OACb,UAAa,EACf,EACA,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,aACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,WACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,QACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,SACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,YACR,KAAQ,UACV,EACA,CACE,KAAQ,MACR,KAAQ,KACV,EACA,CACE,KAAQ,SACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,QACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,SACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,QACR,SAAY,QACZ,UAAa,cACb,KAAQ,OACR,QAAW,GACX,gBAAmB,EACrB,EACA,CACE,KAAQ,WACR,SAAY,QACZ,UAAa,mBACb,KAAQ,OACR,QAAW,GACX,gBAAmB,EACrB,EACA,CACE,KAAQ,WACR,SAAY,QACZ,UAAa,QACb,KAAQ,OACR,QAAW,GACX,gBAAmB,GACnB,iBAAoB,gBACtB,EACA,CACE,KAAQ,aACR,SAAY,QACZ,UAAa,QACb,KAAQ,OACR,QAAW,GACX,gBAAmB,GACnB,iBAAoB,kBACtB,EACA,CACE,KAAQ,WACR,SAAY,QACZ,UAAa,QACb,KAAQ,OACR,QAAW,GACX,gBAAmB,GACnB,iBAAoB,kBACtB,EACA,CACE,KAAQ,aACR,SAAY,QACZ,UAAa,YACb,KAAQ,OACR,QAAW,GACX,gBAAmB,GACnB,YAAe,8FACf,iBAAoB,aACtB,EACA,CACE,KAAQ,QACR,SAAY,QACZ,UAAa,YACb,KAAQ,OACR,QAAW,GACX,gBAAmB,EACrB,EACA,CACE,KAAQ,cACR,KAAQ,QACR,UAAa,uBACb,QAAW,GACX,UAAa,KACf,EACA,CACE,KAAQ,WACR,KAAQ,QACR,UAAa,oBACb,QAAW,GACX,UAAa,KACf,EACA,CACE,KAAQ,UACR,KAAQ,QACR,UAAa,mBACb,QAAW,EACb,CACF,CACF,EACA,CACE,KAAQ,aACR,SAAY,CACV,gBACA,cACA,gBACA,oBACF,EACA,YAAe,CACb,gCACF,EACA,MAAS,CACP,sBACF,EACA,KAAQ,SACR,MAAS,QACT,uBAA0B,GAC1B,YAAe,yNACf,MAAS,CACP,OACA,OACA,gBACF,EACA,OAAU,CACR,CACE,KAAQ,OACR,UAAa,oDACb,KAAQ,OACR,SAAY,GACZ,MAAS,GACT,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,MAAS,CACP,6BACF,EACA,OAAU,CACR,CACE,KAAQ,iBACR,KAAQ,SACR,UAAa,GACb,UAAa,IACf,EACA,CACE,KAAQ,cACR,KAAQ,OACR,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,CACV,mBACA,kBACF,EACA,gBAAmB,GACnB,YAAe,oIACf,OAAU,CACR,MAAS,CACP,OAAU,CACR,cACF,EACA,KAAQ,CACN,uBACA,oBACF,EACA,OAAU,CACR,uBACF,EACA,OAAU,CACR,uBACA,oBACF,EACA,MAAS,CACP,uBACF,CACF,CACF,EACA,MAAS,CACP,OACA,QACA,WACF,EACA,UAAa,OACb,UAAa,YACb,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,OACR,UAAa,YACb,UAAa,GACf,EACA,CACE,KAAQ,YACR,UAAa,oDACb,KAAQ,OACR,QAAW,SACX,UAAa,GACb,UAAa,IACf,EACA,CACE,KAAQ,aACR,KAAQ,SACR,UAAa,IACb,UAAa,IACf,EACA,CACE,KAAQ,OACR,KAAQ,SACR,UAAa,GACb,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,YACR,SAAY,CACV,gBACA,cACA,eACF,EACA,YAAe,CACb,sCACF,EACA,KAAQ,QACR,MAAS,OACT,uBAA0B,GAC1B,YAAe,2KACf,OAAU,CACR,CACE,KAAQ,OACR,UAAa,mDACb,KAAQ,OACR,MAAS,GACT,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,CACV,gBACA,cACA,eACF,EACA,YAAe,CACb,sCACF,EACA,KAAQ,SACR,MAAS,aACT,uBAA0B,GAC1B,YAAe,6KACf,OAAU,CACR,CACE,MAAS,OACT,KAAQ,OACR,UAAa,yDACb,KAAQ,OACR,MAAS,GACT,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,kBACR,UAAa,0DACb,KAAQ,OACR,UAAa,GACb,QAAW,SACb,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,cACR,KAAQ,SACR,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,GACZ,SAAY,CACV,mBACA,kBACF,EACA,OAAU,CACR,CACE,KAAQ,iBACR,KAAQ,MACV,EACA,CACE,KAAQ,WACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,gBACR,KAAQ,UACR,QAAW,EACb,EACA,CACE,KAAQ,OACR,KAAQ,MACV,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,aACR,KAAQ,SACV,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,SACR,UAAa,GACb,UAAa,KACf,EACA,CACE,KAAQ,UACR,KAAQ,SACR,UAAa,GACb,UAAa,KACf,EACA,CACE,KAAQ,UACR,KAAQ,UACR,UAAa,IACf,EACA,CACE,KAAQ,gBACR,KAAQ,OACR,SAAY,SACZ,UAAa,GACb,UAAa,IACf,EACA,CACE,KAAQ,kBACR,KAAQ,OACR,SAAY,SACZ,UAAa,GACb,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,yBACR,SAAY,GACZ,SAAY,CACV,iBACA,mBACA,iBACF,EACA,OAAU,CAAC,CACb,EACA,CACE,KAAQ,kBACR,SAAY,OACZ,QAAW,kDACX,OAAU,CACR,CACE,KAAQ,cACR,KAAQ,YACR,UAAa,IACf,EACA,CACE,KAAQ,eACR,KAAQ,YACR,MAAS,gBACT,UAAa,IACf,EACA,CACE,KAAQ,aACR,KAAQ,YACR,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,SACR,UAAa,cACb,KAAQ,QACR,QAAW,GACX,gBAAmB,EACrB,CACF,CACF,EACA,CACE,KAAQ,YACR,SAAY,CACV,iBACA,yBACA,qBACA,kBACA,gBACF,EACA,MAAS,OACT,KAAQ,cACR,MAAS,OACT,uBAA0B,GAC1B,UAAa,OACb,UAAa,YACb,MAAS,CACP,cACA,gBACF,EACA,YAAe,+FACf,OAAU,CACR,CACE,KAAQ,aACR,KAAQ,SACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,CACV,gBACA,kBACA,kBACF,EACA,MAAS,WACT,KAAQ,eACR,MAAS,UACT,YAAe,+IACf,OAAU,CACR,CACE,KAAQ,YACR,KAAQ,MACV,EACA,CACE,KAAQ,cACR,UAAa,sDACb,KAAQ,OACR,UAAa,EACf,EACA,CACE,KAAQ,SACR,UAAa,4DACb,KAAQ,OACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,CACV,cACA,kBACA,kBACA,mBACA,kBACF,EACA,QAAW,oDACX,KAAQ,eACR,MAAS,aACT,YAAe,mKACf,OAAU,CACR,MAAS,CACP,OAAU,CACR,cACF,EACA,KAAQ,CACN,uBACA,oBACF,EACA,OAAU,CACR,uBACF,EACA,OAAU,CACR,uBACA,oBACF,EACA,MAAS,CACP,uBACF,CACF,CACF,EACA,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,SACR,UAAa,GACb,UAAa,GACf,EACA,CACE,KAAQ,OACR,UAAa,cACb,KAAQ,QACR,QAAW,EACb,EACA,CACE,KAAQ,aACR,KAAQ,MACV,EACA,CACE,KAAQ,UACR,KAAQ,UACR,MAAS,EACX,EACA,CACE,KAAQ,uBACR,KAAQ,MACV,EACA,CACE,KAAQ,mBACR,KAAQ,MACV,EACA,CACE,KAAQ,O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,YACF,EACA,OAAU,CACR,MAAS,CACP,OAAU,CACR,cACF,EACA,KAAQ,CACN,uBACA,oBACF,EACA,OAAU,CACR,uBACF,EACA,OAAU,CACR,uBACA,oBACF,EACA,MAAS,CACP,uBACF,CACF,EACA,SAAY,CACV,KAAQ,CACN,SAAY,cACZ,aAAgB,iBAChB,YAAe,gLACjB,CACF,CACF,EACA,YAAe,0IACf,gBAAmB,GACnB,uBAA0B,GAC1B,MAAS,CACP,cACA,iBACA,KACA,UACA,gBACF,EACA,OAAU,CACR,CACE,KAAQ,WACR,UAAa,mBACb,SAAY,QACZ,QAAW,GACX,KAAQ,OACR,iBAAoB,YACtB,EACA,CACE,KAAQ,YACR,UAAa,mBACb,SAAY,QACZ,QAAW,GACX,KAAQ,OACR,iBAAoB,YACtB,EACA,CACE,KAAQ,yBACR,UAAa,iEACb,KAAQ,OACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,kBACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,cACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,kBACf,OAAU,CACR,MAAS,CACP,OAAU,CACR,sBACA,iBACA,cACA,mBACF,EACA,KAAQ,CACN,sBACA,iBACA,cACA,mBACF,CACF,CACF,CACF,CACF,CACF,EACA,CACE,KAAQ,oBACR,SAAY,OACZ,SAAY,CACV,gBACA,gBACA,iBACA,mBACA,kBACA,oBACF,EACA,OAAU,CACR,CACE,KAAQ,eACR,UAAa,QACb,KAAQ,QACR,YAAe,eACf,YAAe,kDACjB,EACA,CACE,KAAQ,WACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,eACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,gBACF,CACF,CACF,CACF,EACA,CACE,KAAQ,eACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,QACR,KAAQ,QACV,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,SAAY,CACV,kBACF,EACA,YAAe,sGACf,OAAU,CACR,CACE,KAAQ,WACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,eACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,sBACA,gBACF,CACF,CACF,CACF,EACA,CACE,KAAQ,eACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,WACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,eACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,sBACA,gBACF,CACF,CACF,CACF,EACA,CACE,KAAQ,eACR,KAAQ,SACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,uBACR,SAAY,CACV,oBACA,kBACA,gBACF,EACA,QAAW,uDACX,KAAQ,yBACR,MAAS,iBACT,YAAe,sKACf,OAAU,CACR,MAAS,CACP,OAAU,CACR,YACF,EACA,KAAQ,CACN,gBACF,EACA,OAAU,CACR,kBACA,uBACF,EACA,OAAU,CACR,uBACF,EACA,MAAS,CACP,uBACF,CACF,CACF,EACA,OAAU,CACR,CACE,KAAQ,WACR,UAAa,gBACb,SAAY,QACZ,KAAQ,MACV,EACA,CACE,KAAQ,iBACR,UAAa,+DACb,KAAQ,OACR,QAAW,UACX,UAAa,GACb,OAAU,CACR,MAAS,CACP,OAAU,CACR,YACA,iBACF,CACF,CACF,CACF,CACF,CACF,EACA,CACE,KAAQ,qBACR,SAAY,CACV,eACF,EACA,YAAe,CACb,sBACF,EACA,MAAS,CACP,OACA,YACF,EACA,YAAe,+CACf,OAAU,CACR,CACE,KAAQ,aACR,KAAQ,MACV,CACF,CACF,EACA,CACE,KAAQ,cACR,SAAY,CACV,iBACA,qBACA,kBACA,mBACA,iBACF,EACA,SAAY,kDACZ,MAAS,CACP,cACA,MACF,EACA,YAAe,oDACf,OAAU,CACR,CACE,KAAQ,eACR,KAAQ,SACR,SAAY,wDACZ,SAAY,GACZ,QAAW,EACb,EACA,CACE,KAAQ,OACR,UAAa,qDACb,KAAQ,OACR,QAAW,UACX,UAAa,EACf,EACA,CACE,KAAQ,OACR,KAAQ,MACV,EACA,CACE,KAAQ,WACR,KAAQ,OACR,SAAY,QACZ,UAAa,qBACb,UAAa,EACf,CAC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E,KAAQ,iBACR,KAAQ,OACR,SAAY,QACd,EACA,CACE,KAAQ,OACR,KAAQ,OACR,SAAY,QACd,EACA,CACE,KAAQ,eACR,KAAQ,OACR,SAAY,QACZ,UAAa,uBACb,QAAW,EACb,CACF,CACF,EACA,CACE,KAAQ,mBACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,qBACA,kBACA,kBACF,EACA,MAAS,CACP,KACA,WACA,UACA,WACA,OACF,EACA,YAAe,4IACf,KAAQ,SACR,MAAS,UACT,MAAS,WACT,uBAA0B,GAC1B,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,OACR,SAAY,QACZ,UAAa,YACb,QAAW,GACX,iBAAoB,eACtB,EACA,CACE,KAAQ,WACR,KAAQ,QACR,UAAa,YACb,QAAW,EACb,EACA,CACE,KAAQ,QACR,KAAQ,QACR,UAAa,iBACb,QAAW,EACb,EACA,CACE,KAAQ,eACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,kBACR,KAAQ,SACR,UAAa,GACf,EACA,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,mBACR,SAAY,CACV,iBACF,EACA,SAAY,GACZ,MAAS,CAAC,EACV,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,KACV,EACA,CACE,KAAQ,aACR,KAAQ,KACV,EACA,CACE,KAAQ,UACR,KAAQ,SACR,SAAY,wDACZ,QAAW,EACb,EACA,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,GACf,CACF,CACF,EACA,CACE,KAAQ,wBACR,SAAY,CACV,kBACA,kBACA,mBACA,yBACA,mBACF,EACA,MAAS,CACP,kBACA,sBACA,QACA,YACF,EACA,MAAS,CACP,sCACF,EACA,YAAe,yFACf,OAAU,CACR,CACE,KAAQ,kBACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,sBACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,cACF,CACF,CACF,CACF,EACA,CACE,KAAQ,sBACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,QACR,KAAQ,SACR,UAAa,EACf,CACF,CACF,EACA,CACE,KAAQ,kBACR,UAAa,GACb,QAAW,oDACX,OAAU,CACR,CACE,KAAQ,UACR,SAAY,QACZ,UAAa,wBACb,KAAQ,MACV,CACF,CACF,EACA,CACE,KAAQ,mBACR,cAAiB,CACf,SACF,EACA,SAAY,CAAC,EACb,MAAS,CAAC,EACV,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,QACV,EACA,CACE,KAAQ,UACR,KAAQ,KACV,EACA,CACE,KAAQ,eACR,KAAQ,QACV,EACA,CACE,KAAQ,OACR,KAAQ,QACV,EACA,CACE,KAAQ,QACR,KAAQ,KACV,EACA,CACE,KAAQ,aACR,KAAQ,KACV,EACA,CACE,KAAQ,UACR,KAAQ,QACV,CACF,CACF,EACA,CACE,KAAQ,qBACR,cAAiB,CACf,SACF,EACA,OAAU,CACR,CACE,KAAQ,KACR,KAAQ,QACV,EACA,CACE,KAAQ,OACR,UAAa,yDACb,KAAQ,OACR,UAAa,GACb,QAAW,SACb,EACA,CACE,KAAQ,YACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,gBACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,UACF,CACF,CACF,CACF,EACA,CACE,KAAQ,gBACR,KAAQ,QACV,EACA,CACE,KAAQ,gBACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,OACR,UAAa,QACb,KAAQ,QACR,QAAW,GACX,YAAe,WACf,OAAU,CACR,MAAS,CACP,KAAQ,CACN,UACF,CACF,CACF,CACF,EACA,CACE,KAAQ,WACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,UACR,KAAQ,MACV,CACF,CACF,EACA,CACE,KAAQ,sBACR,SAAY,CACV,oBACF,EACA,cAAiB,CACf,SACF,EACA,OAAU,CACR,CACE,KAAQ,eACR,UAAa,uDACb,KAAQ,OACR,UAAa,GACb,QAAW,SACb,CACF,CACF,EACA,CACE,KAAQ,YACR,cAAiB,CACf,WACF,EACA,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,QACV,EACA,CACE,KAAQ,YACR,KAAQ,QACV,EACA,CACE,KAAQ,uBACR,KAAQ,QACV,EACA,CACE,KAAQ,eACR,KAAQ,QACV,EACA,CACE,KAAQ,WACR,KAAQ,UACR,QAAW,EACb,EACA,CACE,KAAQ,QACR,KAAQ,OACR,SAAY,QACZ,UAAa,eACf,EACA,CACE,KAAQ,SACR,KAAQ,QACR,UAAa,eACf,CACF,CACF,EACA,CACE,KAAQ,gBACR,cAAiB,CACf,WACF,EACA,SAAY,CACV,oBACF,EACA,OAAU,CACR,CACE,KAAQ,WACR,KAAQ,QACV,EACA,CACE,KAAQ,OACR,KAAQ,MACR,QAAW,CACb,EACA,CACE,KAAQ,uBACR,KAAQ,QACV,EACA,CACE,KAAQ,eACR,KAAQ,QACV,EACA,CACE,KAAQ,SACR,KAAQ,OACR,SAAY,QACZ,UAAa,eACf,EACA,CACE,KAAQ,SACR,KAAQ,QACR,UAAa,eACf,CACF,CACF,EACA,CACE,KAAQ,iBACR,SAAY,CACV,iBACA,gCACF,EACA,KAAQ,YACR,MAAS,QACT,MAAS,SACT,YAAe,kCACf,OAAU,CACR,CACE,KAAQ,SACR,KAAQ,SACR,QAAW,OACX,MAAS,CACP,QACA,MACF,CACF,EACA,CACE,KAAQ,YACR,KAAQ,MACR,QAAW,EACb,EACA,CACE,KAAQ,cACR,KAAQ,QACR,UAAa,YACb,QAAW,EACb,EACA,CACE,KAAQ,UACR,KAAQ,SACR,QAAW,UACX,MAAS,CACP,UACA,mBACF,CACF,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,GACZ,SAAY,EACZ,QAAW,GACb,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,CACV,kBACA,kBACF,EACA,MAAS,aACT,KAAQ,OACR,MAAS,mBACT,uBAA0B,GAC1B,QAAW,iDACX,OAAU,8CACV,MAAS,CACP,SACF,EACA,YAAe,6OACf,OAAU,CACR,CACE,KAAQ,WACR,KAAQ,QACR,UAAa,aACb,QAAW,EACb,EACA,CACE,KAAQ,YACR,KAAQ,QACR,UAAa,aACb,QAAW,EACb,EACA,CACE,KAAQ,YACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,SACR,KAAQ,OACR,SAAY,QACd,EACA,CACE,KAAQ,SACR,KAAQ,OACR,SAAY,QACZ,UAAa,aACb,QAAW,GACX,iBAAoB,cACtB,EACA,CACE,KAAQ,QACR,KAAQ,QACR,UAAa,aACb,QAAW,GACX,iBAAoB,eACpB,UAAa,KACf,EACA,CACE,KAAQ,aACR,KAAQ,QACR,UAAa,kBACb,QAAW,GACX,UAAa,KACf,EACA,CACE,KAAQ,WACR,KAAQ,QACR,UAAa,gBACb,QAAW,GACX,UAAa,MACf,EACA,CACE,KAAQ,YACR,KAAQ,QACR,UAAa,iBACb,QAAW,EACb,EACA,CACE,KAAQ,QACR,KAAQ,QACR,UAAa,aACb,QAAW,GACX,UAAa,IACf,CACF,CACF,EACA,CACE,KAAQ,gBACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,kBACA,kBACF,EACA,MAAS,YACT,KAAQ,WACR,YAAe,mPACf,MAAS,WACT,OAAU,CACR,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,SACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,OACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,OACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,OACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,OACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,UACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,SACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,MACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,UACR,KAAQ,SACR,SAAY,KACZ,SAAY,IACZ,cAAiB,EACnB,CACF,CACF,EACA,CACE,KAAQ,eACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,kBACA,kBACF,EACA,MAAS,YACT,KAAQ,WACR,MAAS,UACT,MAAS,CACP,KACA,SACF,EACA,YAAe,wPACf,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,SACR,UAAa,EACb,QAAW,KACX,YAAe,wDACjB,EACA,CACE,KAAQ,kBACR,KAAQ,QACV,EACA,CACE,KAAQ,QACR,KAAQ,QACV,EACA,CACE,KAAQ,SACR,KAAQ,QACV,EACA,CACE,KAAQ,SACR,KAAQ,QACV,EACA,CACE,KAAQ,SACR,KAAQ,QACV,EACA,CACE,KAAQ,UACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,aACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,aACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,MACR,SAAY,EACZ,SAAY,IACZ,cAAiB,EACnB,EACA,CACE,KAAQ,aACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,WACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,kBACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,iBACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,aACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,EACnB,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,GACjB,YAAe,kDACjB,CACF,CACF,EACA,CACE,KAAQ,kBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,UACR,KAAQ,MACR,SAAY,EACZ,SAAY,IACZ,QAAW,IACX,cAAiB,EACnB,EACA,CACE,KAAQ,YACR,KAAQ,OACR,SAAY,QACZ,UAAa,eACb,QAAW,EACb,CACF,CACF,EACA,CACE,KAAQ,gBACR,SAAY,GACZ,OAAU,CACR,CACE,KAAQ,cACR,KAAQ,QACV,EACA,CACE,KAAQ,mBACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,cAAiB,GACjB,QAAW,EACb,EACA,CACE,KAAQ,QACR,KAAQ,SACR,SAAY,EACZ,cAAiB,EACnB,CACF,CACF,EACA,CACE,KAAQ,YACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,cACA,kBACA,eACA,mBACA,qBACA,kBACA,eACF,EACA,MAAS,QACT,KAAQ,WACR,MAAS,OACT,MAAS,CACP,KACA,UACA,MACF,EACA,uBAA0B,GAC1B,YAAe,4SACf,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,WACR,KAAQ,SACR,UAAa,GACb,UAAa,KACf,EACA,CACE,KAAQ,WACR,KAAQ,MACR,UAAa,MACf,EACA,CACE,KAAQ,UACR,UAAa,YACb,KAAQ,QACR,QAAW,EACb,EACA,CACE,KAAQ,QACR,KAAQ,QACR,UAAa,aACb,QAAW,EACb,EACA,CACE,KAAQ,kBACR,KAAQ,QACR,UAAa,aACb,QAAW,EACb,EACA,CACE,KAAQ,cACR,KAAQ,QACR,UAAa,aACb,QAAW,EACb,EACA,CACE,KAAQ,MACR,KAAQ,KACV,EACA,CACE,KAAQ,QACR,KAAQ,SACV,EACA,CACE,KAAQ,YACR,KAAQ,OACR,SAAY,SACZ,UAAa,KACf,EACA,CACE,KAAQ,QACR,KAAQ,OACR,SAAY,QACZ,UAAa,aACb,iBAAoB,aACpB,QAAW,GACX,UAAa,KACf,EACA,CACE,KAAQ,WACR,KAAQ,OACR,SAAY,QACZ,UAAa,aACb,iBAAoB,gBACpB,QAAW,GACX,UAAa,MACf,EACA,CACE,KAAQ,aACR,KAAQ,QACR,UAAa,sBACb,QAAW,GACX,UAAa,MACf,CACF,CACF,EACA,CACE,KAAQ,gBACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,WACF,EACA,MAAS,YACT,KAAQ,UACR,MAAS,WACT,uBAA0B,GAC1B,YAAe,yDACf,OAAU,CACR,CACE,KAAQ,SACR,KAAQ,SACR,UAAa,EACb,YAAe,sBACjB,EACA,CACE,KAAQ,SACR,KAAQ,SACR,UAAa,EACf,EACA,CACE,KAAQ,aACR,KAAQ,SACR,UAAa,GACb,YAAe,oBACjB,EACA,CACE,KAAQ,OACR,KAAQ,OACR,SAAY,QACd,EACA,CACE,KAAQ,QACR,UAAa,iDACb,KAAQ,OACR,UAAa,GACb,QAAW,MACb,EACA,CACE,KAAQ,WACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,OACA,OACA,OACA,OACA,QACA,QACA,SACA,OACA,MACA,QACA,QACA,MACA,OACA,QACA,OACA,SACA,MACA,UACA,OACA,QACA,WACA,QACA,SACA,YACA,OACA,QACA,OACA,OACA,MACA,MACA,MACA,QACA,QACA,KACF,CACF,CACF,CACF,EACA,CACE,KAAQ,eACR,aAAgB,CACd,gBACF,EACA,SAAY,CACV,cACA,kBACA,qBACA,kBACF,EACA,MAAS,UACT,KAAQ,SACR,MAAS,UACT,MAAS,CACP,KACA,UACA,MACF,EACA,uBAA0B,GAC1B,YAAe,gOACf,OAAU,CACR,CACE,KAAQ,OACR,KAAQ,SACR,YAAe,oFACjB,EACA,CACE,KAAQ,W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ACR,KAAQ,MACR,SAAY,EACZ,SAAY,GACZ,cAAiB,GACjB,UAAa,MACf,EACA,CACE,KAAQ,cACR,KAAQ,MACR,SAAY,GACZ,YAAe,2DACf,UAAa,MACf,EACA,CACE,KAAQ,cACR,KAAQ,MACR,SAAY,GACZ,YAAe,+FACf,UAAa,MACf,EACA,CACE,KAAQ,oBACR,KAAQ,SACR,SAAY,EACZ,SAAY,EACZ,YAAe,iHACf,cAAiB,GACjB,UAAa,MACf,EACA,CACE,KAAQ,qBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,mBACA,oBACA,kBACA,UACA,QACA,iBACA,kBACA,eACA,SACA,WACA,aACA,eACA,UACA,WACA,OACA,QACA,eACF,EACA,UAAa,MACf,EACA,CACE,KAAQ,qBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,mBACA,oBACA,kBACA,UACA,QACA,iBACA,kBACA,eACA,SACA,WACA,aACA,eACA,UACA,WACA,OACA,QACA,eACF,EACA,UAAa,MACf,EACA,CACE,KAAQ,sBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,OACA,gBACA,cACA,YACA,UACF,EACA,UAAa,MACf,EACA,CACE,KAAQ,sBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,OACA,gBACA,cACA,YACA,UACF,EACA,UAAa,MACf,EACA,CACE,KAAQ,iBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,SACA,QACF,EACA,UAAa,KACf,EACA,CACE,KAAQ,iBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,SACA,QACF,EACA,UAAa,KACf,EACA,CACE,KAAQ,oBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,QACA,QACA,SACA,OACA,QACA,OACA,OACA,UACA,YACA,SACA,QACA,QACA,MACA,SACF,EACA,UAAa,IACf,EACA,CACE,KAAQ,oBACR,KAAQ,OACR,SAAY,SACZ,MAAS,CACP,QACA,QACA,SACA,OACA,QACA,OACA,OACA,UACA,YACA,SACA,QACA,QACA,MACA,SACF,EACA,UAAa,IACf,EACA,CACE,KAAQ,iBA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",
  "names": ["cache", "principal", "sCurrentOrganization", "sBase", "sCache", "sResource", "sModelSvc", "sPrincipal", "sSearch", "sPathSvc", "sMake", "sList", "sStreamSvc", "sAuthZ", "sComm", "sCred", "sPol", "sCtl", "sReq", "sToken", "sAppr", "sScr", "sTagSvc", "getPrincipal", "o", "u", "p", "v2", "fH", "vParms", "b", "oU2", "sType", "vDef", "a", "s", "i", "sText", "sKey", "sIv", "enc", "f", "aH", "getCache", "cleanup", "get", "clearCache", "vType", "bLocalOnly", "oObj", "removeFromCache", "sObjId", "getFromCache", "sAct", "addToCache", "sId", "vObj", "newPrimaryCredential", "oAuthN", "post", "deleteObject", "del", "patchObject", "patch", "create", "updateBulk", "aObj", "evaluate", "executeScript", "urn", "executeScriptById", "sObjectId", "define", "searchCount", "q", "search", "compLabel", "newQuery", "m", "v", "z", "c", "name", "value", "fld", "afs", "r", "bCount", "type", "fc", "trace", "bEnable", "member", "sObjectType", "sField", "sActorType", "sActorId", "getApplicationProfile", "getImageTags", "applyImageTags", "getByObjectId", "getFullByObjectId", "getByUrn", "getByName", "sName", "bParent", "getByNameInGroupParent", "stream", "l", "count", "list", "sFields", "iStart", "iLength", "sK", "findTags", "findBy", "oSearch", "findByTag", "countByTag", "find", "sObjType", "sPath", "makeFind", "make", "bMake", "getDotPath", "path", "sAlt", "logout", "loginWithPassword", "sOrg", "cred", "login", "url", "x", "data", "getObjectAuthorization", "listSystemPermissions", "listSystemRoles", "listSystemPolicies", "permitSystem", "bView", "bEdit", "bDelete", "bCreate", "permit", "sPermId", "listMembers", "iCount", "countMembers", "getUserPersonObject", "res", "rej", "getUserObject", "sOType", "listUserRoles", "listEntitlementsForType", "mediaDataPath", "bThumb", "getIsRequestable", "getOwnerApprovalPolicy", "attachPolicy", "sPid", "n", "d", "Base64", "input", "output", "chr1", "chr2", "chr3", "enc1", "enc2", "enc3", "enc4", "string", "utftext", "am7model", "cat", "proto", "aP", "k", "catO", "model", "an", "om", "ftype", "field", "am", "sLType", "ignoreEmptyNull", "innerCall", "nfv", "emptyArray", "nullOrUndef", "ft", "sDP", "fieldDefVal", "defVal", "h", "mk", "e", "baseModel", "recurse", "ue", "af", "e2", "vrcache", "ru", "oru", "vr", "isStr", "nvr", "vri", "rules", "applyReplacement", "ir", "tir", "re", "err", "ri", "entity", "dateTimeDecorator", "dateTimeZDecorator", "numberDecorator", "rangeDecorator", "textListDecorator", "colorDecorator", "blobDecorator", "dec", "array", "r1", "form", "inst", "index", "arr", "report", "decorateInOut", "bIn", "df", "mf", "val", "pn", "op", "fv", "fh", "pent", "b1id", "color", "rgb", "hsl", "g", "ndf1", "cl", "min", "max", "delta", "text", "options", "warnings", "warning", "attr", "prop", "node", "aa", "sStart", "sEnd", "sA", "sC", "sS", "id", "ctx", "tags", "grp", "opath", "cnt", "obj", "set", "fav", "itype", "qr", "tag", "origin", "temp", "pg", "up", "listPathBase", "dir", "wsUrl", "event", "sTok", "iIter", "iter", "org", "tok", "msg", "c1", "message", "recipient", "schema", "recipientId", "dat", "newCredential", "currentCredential", "authReq", "startRecord", "recordCount", "sr", "rc", "modType", "handler", "bUp", "fConfirm", "fCancel", "images", "charInst", "galleryImages", "characterInstance", "profile", "portrait", "profileObjectId", "pq", "pqr", "existingIds", "img", "objj", "a1", "a2", "port", "t", "nt", "timeout", "items", "cfg", "closeBtn", "objectId", "viewPath", "sClass", "sIco", "sLabel", "fHandler", "params", "pages", "stem", "openItems", "object", "subType", "child", "newParent", "modType2", "parObj", "group", "start", "length", "g2", "og", "query", "mode", "alt", "key", "self", "obj2", "keyMatch", "prev", "idx", "dataURI", "mime", "binary", "groupId", "dialogUp", "dialogCfg", "chatInto", "ref", "aCCfg", "sessName", "pa", "loadPromptList", "ca", "loadChatList", "cname", "remoteEnt", "wset", "aCPs", "aC", "sq", "sess", "q2", "w", "endDialog", "setDialog", "showProgress", "updateSessionName", "acfg", "pcfg", "bRename", "chat", "prompt", "ycfg", "vcfg", "occfg", "opcfg", "sysName", "usrName", "chatSettings", "cinst", "summarize", "creq", "vectorize", "lastReimage", "loadSDConfig", "saveSDConfig", "config", "saveConfig", "excludeFields", "applySDConfig", "socialSharingMap", "socialSharingTags", "getOrCreateSharingTag", "tagName", "objectType", "newTag", "applySharingTag", "image", "wearLevelName", "sharingContext", "toggleSharingTag", "enable", "getCurrentWearLevel", "sto", "aq", "aqr", "app", "oids", "wears", "maxLevel", "maxLevelName", "lvl", "we", "levelIndex", "reimage", "tempApplyDefaults", "charConfigName", "charConfig", "cseed", "baseSeed", "wearLevel", "useSeed", "imgEntity", "od", "seed", "saveEntity", "appl", "lvls", "aL", "bL", "dressedDown", "lowestLevel", "nudeIdx", "includeNude", "totalImages", "sharedConfig", "ncfg", "loadDialog", "createDialog", "size", "entityType", "title", "fConf", "fCanc", "sizeCls", "mconf", "confirm", "sMessage", "cancelDialog", "dialog", "dnd", "blended", "blender", "filt", "b2", "actor", "cls", "ret", "dragGroup", "dragParent", "dragModType", "overParent", "dropGroup", "totalUpCount", "currentUpCount", "maxUpload", "files", "pb", "fileReader", "clearFlds", "uri", "formData", "fname", "xhr", "res2", "rej2", "aD", "oG", "oD", "handleDragLeave", "evt", "handleDragEnter", "handleDragOver", "handleDrop", "viewers", "pdfViewer", "inInst", "eventBus", "currentPage", "pageCount", "scale", "raster", "pdfDocument", "didInit", "pdfControls", "fp", "render", "zoom", "lp", "np", "pdfContainer", "loadPdf", "bits", "init", "pdfPageNum", "pdfScale", "container", "doc", "pdfPage", "viewport", "pdfPageView", "pdf", "dressUp", "dressCharacter", "dressApparel", "dressDown", "setApparelDescription", "wdesc", "describeWearable", "wear", "qual", "opac", "shin", "smoo", "col", "fab", "pat", "loc", "opacs", "shins", "vapp", "minLevel", "availMin", "ulevel", "maxLevelIdx", "newLevel", "setNarDescription", "nar", "pro", "am7olio", "forms", "dataM", "ctf", "tagM", "tagf", "cleanupTestVoice", "testVoice", "refId", "vprops", "sinst", "sdr", "sd", "aud", "apath", "amt", "pickProfile", "pe", "gp", "tp", "objectPage", "useName", "pickVoice", "narrate", "character", "gender", "age", "race", "profUrl", "nms", "char", "createCharacter", "cdir", "charN", "datName", "getProfUrl", "reader", "characterWizard", "rollCharacter", "getSystemPrompt", "prc", "prcr", "voice", "getDefaultValuesForField", "jsName", "getFormatForType", "format", "getActionView", "getValidationErrorLabel", "txt", "getFieldView", "ff", "annot", "getField", "props", "fprops", "useType", "ofld", "iprops", "vf", "el", "el2", "icon", "label", "basePath", "getBasePathByType", "worldView", "getTypeByPath", "subPath", "outT", "getPathForType", "viewQuery", "getViewFields", "oidf", "idf", "idv", "getFormFieldNames", "getFormField", "fo", "typeToModel", "ot", "showField", "show", "rctx", "showCount", "invert", "reqVal", "mat", "reqVals", "showTotal", "isBinary", "mt", "contentType", "am7view", "formatName", "renderFunction", "originalGetField", "originalFieldView", "attrs", "rendererType", "formName", "getFileTypeIcon", "mtIco", "ext", "getThumbnail", "ctl", "ico", "gridMode", "pp", "icoPath", "icoCls", "sty", "getIcon", "getFavoriteStyle", "isFavcls", "getPolarListItem", "dcls", "pagination", "supplData", "dndProp", "getPolarListView", "rset", "results", "defaultHeaderMap", "getHeaders", "map", "getHeadersView", "mod", "headers", "lbl", "selectHandler", "cw", "getCellStyle", "sortButton", "sico", "getTabularRow", "allTags", "maxVisible", "visibleTags", "remainingCount", "tagElements", "getFormattedValue", "ah", "lastFld", "um", "getTabularView", "table", "getGridListItem", "showInfo", "footer", "gridCellCls", "displayIndicators", "displayObjects", "pr", "getGridListView", "getCarouselItem", "uimarkers", "getCarouselView", "am7dec", "deleteChat", "force", "chatHandler", "getChatRequest", "requestName", "chatCfg", "promptCfg", "req", "chatReq", "makeChat", "sModel", "sServerUrl", "sServiceType", "icfg", "makePrompt", "aSystem", "am7chat", "gridPath", "deck", "userHand", "gameHand", "discard", "selectedCard", "previewCard", "cardView", "isLoading", "fullMode", "previewIndex", "USER_HAND_LIMIT", "GAME_HAND_LIMIT", "draggedCard", "dragSource", "dropTarget", "actionDeck", "actionHand", "actionHandIndex", "systemActionHand", "systemActionHandIndex", "playedActions", "systemPlayedActions", "actionDiscard", "actionPreview", "actionPreviewIndex", "selectedAction", "pendingInteraction", "itemDeck", "itemHand", "itemTray", "systemItems", "systemItemHandIndex", "itemDiscard", "itemPreviewIndex", "itemHandIndex", "apparelDeck", "apparelHand", "apparelTray", "systemApparel", "systemApparelHandIndex", "apparelDiscard", "apparelPreviewIndex", "apparelHandIndex", "selectedDetailCard", "selectedDetailType", "loadedNarrative", "loadedNarrativeCharId", "narrativeLoading", "activePile", "ACTION_CARD_TYPES", "chatDialogOpen", "chatSession", "chatMessages", "chatPending", "chatActor", "chatTarget", "currentSave", "savedGames", "saveDialogOpen", "saveDialogMode", "newSaveName", "activeTags", "CARD_WIDTH", "CARD_HEIGHT", "getAge", "getApparelDisplayName", "apparel", "getPortraitUrl", "shuffleArray", "shuffled", "j", "formatStatValue", "getStatColor", "pct", "getInstinctColor", "loadCharacters", "popDir", "tagMsg", "loadFullCharacter", "full", "sqr", "loadCharacterStore", "result", "store", "itemRef", "iq", "iqr", "item", "apparelRef", "loadItems", "itemDir", "loadApparel", "apparelDir", "generateApparelDescription", "wearOids", "wq", "wqr", "inuseWears", "CharacterCard", "vnode", "isSelected", "onClick", "cardClass", "renderCardContent", "renderStatsView", "renderTraitsView", "renderNarrativeView", "renderInstinctsView", "renderApparelView", "renderProfileView", "portraitUrl", "alignment", "trades", "openPortraitView", "generatePortrait", "stats", "statFields", "sf", "traits", "trait", "tname", "loadFullNarrative", "narrative", "hasNarrative", "generateNarrative", "instinct", "instinctFields", "displayVal", "leftPct", "widthPct", "outfitDesc", "dressCharacterUp", "dressCharacterDown", "handleDragStart", "card", "source", "handleDragEnd", "target", "handleDropOnUserHand", "drawn", "selectCard", "handleDropOnGameHand", "handleDropOnDiscard", "discardCard", "handleDropOnSelected", "handleDropOnActionHand", "action", "updateActionPreview", "handleDropOnPlayedActions", "interaction", "createInteractionFromAction", "handleDropOnItemHand", "handleDropOnApparelHand", "handleDropOnItemTray", "handleDropOnApparelTray", "handleDropOnSystemActionHand", "handleDropOnSystemItemHand", "handleDropOnSystemApparelHand", "handleUniversalDiscard", "cardName", "sourceHand", "sourceArray", "actionCard", "selectActionCard", "selectItemCard", "selectApparelCard", "renderMiniCard", "isHighlight", "cardType", "useResponsive", "borderClass", "isDragging", "typeIcon", "renderCardBack", "typeName", "DrawPile", "topCard", "shuffleDeck", "drawToUserHand", "previewPrevCard", "previewNextCard", "drawToGameHand", "UserHandPile", "isCharDropTarget", "isActionDropTarget", "isItemDropTarget", "isApparelDropTarget", "isPlayedDrop", "isDraggingAction", "executeAction", "cancelAction", "selectPlayedAction", "discardPlayedAction", "GameHandPile", "sysActionIdx", "sysItemIdx", "sysApparelIdx", "ActionDeckPile", "shuffleActionDeck", "reshuffleActionDeck", "prevActionPreview", "nextActionPreview", "renderItemCard", "renderApparelCard", "displayName", "renderItemStatistics", "activeProps", "hasConsumptionType", "hasReplenishmentType", "DiscardPile", "isDropTarget", "reshuffleDiscard", "ConsolidatedDecks", "renderDrawPile", "drawActionToHand", "drawItemToHand", "shuffleItemDeck", "reshuffleItemDeck", "drawApparelToHand", "shuffleApparelDeck", "reshuffleApparelDeck", "deckArray", "discardArray", "dragSourceType", "onDraw", "onShuffle", "onReshuffle", "colorMap", "deckCount", "discardCount", "nextItemPreview", "prevItemPreview", "nextApparelPreview", "prevApparelPreview", "CardViewTabs", "tabs", "tab", "isActive", "SelectedCardView", "renderDetailCardView", "openCharacterView", "refreshSelectedCard", "colors", "isInUserHand", "handArray", "handIndex", "detailTabs", "discardActionFromHand", "discardItemFromHand", "discardApparelFromHand", "randIdx", "hand", "discardFromUserHand", "discardFromGameHand", "discardSelectedCard", "selectHandCard", "toggleFullMode", "initActionDeck", "discardUsedAction", "discardItem", "discardApparel", "interactor", "talkAction", "openChatDialog", "createInteraction", "pending", "outcomes", "determineOutcome", "formatOutcome", "actionType", "roll", "actorStats", "interactorStats", "actorStat", "interactorStat", "threshold", "chatDir", "chatConfigs", "promptConfigs", "templateCfg", "actorFirst", "targetFirst", "chatConfigName", "fullTemplate", "newChatCfg", "reqDir", "reqQuery", "reqResult", "historyReq", "closeChatDialog", "sendChatMessage", "response", "ChatPanel", "inputMessage", "autoStartTimeout", "userStartedTyping", "lastMessageCount", "scrollToLastMessage", "msgs", "clearAutoStartTimeout", "setupAutoStartTimeout", "delay", "actorUrl", "targetUrl", "isUser", "isAssistant", "ChatDialog", "getGameState", "loadGameState", "state", "findChar", "rebuildAction", "saved", "template", "allChars", "allItems", "allApparel", "loadSavedGames", "saveDir", "saveGame", "stateJson", "existing", "saveInst", "loadGame", "save", "fullSave", "deleteGame", "newGame", "newDeal", "autoPlayTalkCards", "userTalkIdx", "talkCard", "sysTalkIdx", "userChar", "userStore", "gameChar", "gameStore", "openSaveDialog", "closeSaveDialog", "SaveGameDialog", "isCurrent", "getOuterView", "mainPanel", "toggleTag", "getFooter", "nudeActive", "cardGame", "advgrid", "status", "infoLabel", "infoStatus", "builderMode", "modeClear", "modeRoom", "modeCorridor", "changed", "modeSpawn", "groups", "communityData", "newGameData", "updateChanged", "toggleBuilder", "toggleModeClear", "toggleModeRoom", "toggleModeCorridor", "toggleSpawn", "buildCell", "y", "cell", "constructRegion", "getGroups", "generateMap", "generateRooms", "placeRoom", "pos", "findSpaceLocation", "randomVal", "iters", "maxiters", "collision", "mg", "placedRooms", "rw", "rh", "newMapCell", "statusCallback", "initLocation", "outB", "restoreMap", "initEvent", "ct", "cellType", "configureEvent", "pev", "pevC", "lastE", "randE", "oE", "cloc", "clocd", "initLoc", "getCell", "initEvt", "randomPerson", "pR", "randomPersons", "per", "newPlayerPerson", "initPopulation", "clone", "solicitInfo", "chooseInfo", "confirmInfo", "refreshInfo", "createNewGrid", "outCell", "dgrid", "refreshGrid", "gridView", "gridStyle", "colorPrep", "defCubeColor", "cubeClsC", "cubeStyleS", "cellTypeColor", "getCellTypeStyle", "cubeCls", "cubeStyle", "cellColorMap", "oneYearMs", "d1", "ms", "modelInfo", "ino", "aR", "modelGame", "getScoreCard", "modelPanel", "moveWest", "moveNorth", "moveSouth", "moveEast", "wait", "stop", "endGame", "udef", "keyControl", "shuffle", "saveGrid", "l1", "l2", "aLocs", "l3", "getCommands", "bldCommands", "tetris", "preview", "mesh", "previewStyle", "prevGrid", "prevColor", "evaluateGrid", "dg", "addPiece", "clock", "clearAllNodes", "down", "checkClearLine", "lineCount", "tryStart", "rotatePiece", "move", "moveLeft", "moveRight", "rotateLeft", "rotateRight", "drop", "commonWords", "randomizeCommonWords", "getWordColorClass", "word", "classes", "calculateTurnScore", "getInitialData", "coherenceScoreThreshold", "analyzing", "analyzeAndLockPhrases", "scanForCombinations", "phrasesToAnalyze", "combo", "resp", "scoredPhrase", "comboToLock", "p1Words", "p2Words", "owner", "phraseId", "wordInfo", "boardWord", "combinations", "row", "rIdx", "currentCombination", "cIdx", "handleEndOfRound", "combinationsThisRound", "survivingPhrases", "combosToEvaluate", "gameChat", "lastMessage", "newBoard", "nextAvailableRow", "originalWord", "finalPhraseStrings", "triggerEndGame", "switchTurn", "finalPhrases", "winner", "finalPrompt", "finalMessage", "endGameChat", "content", "chatName", "prepareChatConfig", "endPromptName", "prepareEndPrompt", "promptName", "preparePrompt", "chatRequestName", "endChatRequestName", "endPromptCfg", "startGame", "prepareWords", "startTimer", "resetGame", "setup", "togglePause", "exportBoardState", "exportedData", "jsonString", "textArea", "runAutopilot", "spendTurnPoints", "points", "handleRefreshWords", "playerNum", "player", "words", "handleCustomWord", "addCustomWord", "wordName", "newWord", "choice", "emptyCells", "wordToPlace", "wordIndex", "targetCell", "wordWithPlayer", "shiftWords", "direction", "rows", "cols", "allWords", "findEmptyAdjacent", "directions", "dr", "dc", "newRow", "newCol", "handleGridDragStart", "rowIndex", "colIndex", "payload", "targetRowIndex", "targetColIndex", "emptySpot", "bumpedWord", "handleTrashDrop", "wordToTrash", "leftWords", "slot", "rightWords", "isAutoRefresh", "wordTargetCount", "wordCount", "currentWords", "wordsPerType", "wordTypes", "wordDict", "typeCode", "allExistingNames", "getNewPlayerWords", "newWords", "picked", "assignWords", "playerList", "testEndGame", "wordGame", "crumbButtons", "showBreadcrumb", "modelBreadCrumb", "oL", "objType", "typeUdef", "crumbs", "aSp", "bBack", "bJoi", "bid", "menuCls", "btnCls", "disabled", "buildBreadCrumb", "contextMenuItemHandler", "configureContextMenus", "cleanupContextMenus", "setupDisplayState", "breadCrumb", "asideMenu", "button", "icoId", "fHold", "fWrapper", "clicky", "expandCategory", "expanded", "getCategories", "cats", "order", "de", "topMenu", "profileDimensions", "showFavButton", "trayExpanded", "shutOnEmpty", "sCls", "sAltIco", "profileContextButton", "xProf", "activeShuffle", "favGroup", "doPickShuffle", "filter", "bBlend", "loadFavGroup", "shuffleTray", "buttons", "workingBtns", "mid", "blendable", "blendy", "blendCls", "favButton", "blendButton", "backButton", "trayCls", "tray", "lastNot", "not", "notiActive", "mr", "panel", "panels", "modelPanelContents", "clickPanelItem", "base", "baseType", "getProtoCat", "ap", "renderPortraitField", "fieldName", "maxMode", "imgClass", "renderImageField", "buildMediaPath", "renderVideoField", "vidClass", "renderAudioField", "audClass", "renderTextField", "renderPDFField", "renderMarkdownField", "renderMessageContentField", "renderInnerObjectView", "attrsWithModel", "renderer", "renderObjectView", "renderCarouselControls", "entityName", "view", "updateChange", "renderFormView", "renderInnerFormView", "active", "objView", "objDat", "renderForm", "useCls", "getRowCount", "getMaxElementValue", "addFormRow", "setEntityBinding", "removeFormRow", "patterns", "getPatternType", "rule", "invalid", "validateForm", "oF", "getAppForm", "formVal", "pid", "isSupportedBinaryType", "out_bool", "entityMap", "saveForm", "xtr", "testEl", "testName", "ename", "updated", "modelRule", "rid", "rule2", "oDV", "aInc", "oP", "res3", "rej3", "s2", "crule", "modelElement", "element", "component", "patternId", "errCls", "modelElementContainer", "layout", "className", "labelClass", "formView", "els", "grid", "altCls", "rowE", "skipDel", "skipRow", "cells", "i2", "setApp", "setEntity", "bind", "vals", "getDefaultOffset", "ev", "e3", "evv", "navigation", "navigable", "nav", "eventPath", "menuPath", "len", "sMenuId", "navg", "buttonPath", "vQuery", "altClass", "sAltCls", "bF", "bN", "mnu", "ignoreList", "gid", "oMenu", "btn", "asideToggle", "asideGlass", "crumb", "newPaginationControl", "requesting", "embeddedMode", "newPagination", "containerType", "getSearchQuery", "getRequestFields", "qf", "handleList", "gq", "handleCount", "listRouter", "iPage", "updatePage", "navNext", "bRedrawOnly", "getPageUrl", "navPrev", "ttype", "uType", "fType", "modList", "flds", "stopPaginating", "updateList", "containerId", "navigateByParent", "bSystem", "sort", "usePage", "doFilter", "sFilt", "paginationControlBar", "pageButtons", "paginationButton", "bMore", "left", "right", "maxI", "style", "getPageState", "bEmbed", "designer", "designStyle", "designHtml", "caller", "toggled", "pickData", "pickDataObject", "codeMirror", "handlePickData", "insertObjectAtCaret", "frame", "oA", "oI", "sThumbUrl", "sUrl", "insertNodeAtCaret", "oNode", "sel", "range", "pickImage", "defAct", "opt", "transitionHandler", "refreshDesignSources", "alignSource", "setupDesigner", "designDocumentHeader", "designDocumentFooter", "writeFrame", "toggleStyle", "sStyle", "formatOptions", "fontOptions", "fontSizeOptions", "fontColorOptions", "fillColorOptions", "designDocumentDefContent", "bytes", "tarea", "cm", "annotations", "docType", "enableDesigner", "sSource", "getDesignField", "getDesigner", "getRichTextDesigner", "getCodeDesigner", "newTreeComponent", "treeMatrix", "autoExpand", "selectedNode", "originRole", "originPermission", "pendingRefresh", "olioMode", "checkOlio", "olio", "inlineType", "dlg", "inlineAdd", "mtx", "newGrp", "resetNode", "addNew", "scrollToLast", "deleteNode", "tmx", "refreshTree", "getTreeView", "tree", "buttonBar", "getTreeViewNode", "getMatrix", "bGroup", "nodeName", "fList", "fListType", "builtIn", "pathType", "expandNode", "selectNode", "getNestedTreeView", "bExpand", "nest", "rb", "bb", "n1", "n2", "altActive", "selId", "itemProps", "skipList", "pickerMode", "childPickerMode", "fieldPicker", "altEntity", "altPath", "pickerHandler", "useEntity", "setType", "preparePicker", "pv", "cancelPicker", "enablePicker", "bNoRefresh", "picker", "renderers", "inputAttrs", "selectAttrs", "selected", "optAttrs", "progressAttrs", "buttonHandler", "buttonContent", "buttonAttrs", "createAudioRecordButton", "applyDragAndDrop", "textareaAttrs", "buildThumbnailPath", "fieldClass", "dataUrl", "clickHandler", "modelKey", "ui", "currentIndex", "sharingTags", "navigate", "deleteImage", "setAsProfile", "imgTags", "hasTag", "openImageInNewTab", "currentImage", "currentTags", "navButtons", "tagsList", "printHandler", "valPick", "findVal", "pageCtx", "pickerName", "fieldView", "tableType", "tableForm", "tableFieldView", "tableField", "hasRenderer", "getRenderer", "register", "fn", "formFieldRenderers", "pickMember", "members", "addMember", "pickCtx", "deleteMember", "valuesState", "foreignData", "vProp", "act", "objectMembers", "memberObjects", "paftype", "pftype", "ptype", "pickEntity", "addEntity", "openEntity", "ent", "deleteEntity", "reparent", "parent", "children", "pickChild", "addChild", "deleteChild", "objectControls", "objectRequests", "membership", "editEntry", "cancelEntry", "deleteEntry", "ov", "newEntry", "ne", "checkEntry", "parentField", "entry", "einst", "fk", "aB", "tableEntry", "emojiLoadReq", "emojiDict", "emojiReq", "emojiDesc", "emojiCat", "emojiSubCat", "emojiResults", "searchEmojis", "findEmojis", "emojiMenuButton", "emojiCategories", "loadEmojiDict", "ejs", "itm", "emojiContextButton", "renderEmojiButton", "markdownEmojis", "ea", "extractEmojis", "desc", "findEmojiDesc", "findEmojiName", "edd", "ed", "emoji", "ad", "targetEmoji", "categoryName", "subCategories", "subCategoryName", "foundEmoji", "be", "rea", "ar", "et", "emojiRegex", "exportEmojis", "delim", "tsvContent", "category", "subCategory", "ems", "emojiChar", "keywords", "unicode", "audioMap", "audioSource", "visualizers", "recorder", "upNext", "newMagic8", "magic8", "clearMagic8", "audioMagic8", "preserveContent", "stopAudioSources", "clearAudioSource", "canvasTop", "canvasBottom", "configureMagic8", "prune", "aMsg", "messagesToProcess", "currentContent", "contentChanged", "sysProfileId", "usrProfileId", "actualIndex", "profId", "createAudioSource", "props1", "props2", "togglePlayMagic8", "currentAudio", "togglePlayAudioSource", "bgAudio", "bgAnim", "bgImg", "imgBase", "imgUrl", "imgCfg", "imageTransition", "getMagic8View", "sysUrl", "usrUrl", "gimg", "qg", "imageClasses", "dom", "drawSpiral", "drawMandala", "canvas", "width", "height", "centerX", "centerY", "animate", "pulse", "rotation", "hue", "petals", "layers", "layer", "radius", "petalLength", "petalWidth", "angle", "spiralSpeed", "pulseSpeed", "strokeColor", "newRecorder", "togglePlayAudio", "isStreamSilent", "bufferLength", "dataArray", "maxAmplitude", "amplitude", "recordWithVisualizer", "saveHandler", "mediaStream", "audioCtx", "analyzer", "chunks", "mediaRecorder", "silenceCount", "totalSilenceTime", "silenceStartTime", "isCurrentlySilent", "ab_b64", "buf", "getAudioBase64", "blob", "buff", "sendChunk", "chunk", "close", "b64", "checkSilence", "isSilent", "currentTime", "silenceDuration", "currentSilenceTime", "totalCurrentSilence", "toggleRecord", "audioBlob", "newAudioStream", "errorMsg", "stopRecording", "track", "extractText", "dataB64", "unconfigureAudio", "enabled", "configureVisualizer", "autoPlay", "oM", "getAudioMapForContainer", "audioMotion", "getRunningAudioSources", "configureAudio", "aM", "aud2", "autoStop", "noStart", "audio", "createAudioVisualizer", "profileId", "contId", "base64ToArrayBuffer", "base64", "cleanedBase64", "binaryString", "tmpAud", "audioContext", "audioBuffer", "sourceNode", "recording", "recordButton", "recordField", "recognition", "SpeechRecognition", "currentHandler", "finalTranscript", "baseText", "interimTranscript", "transcript", "toneCtx", "leftOsc", "rightOsc", "leftGain", "rightGain", "masterGain", "merger", "baseFreq", "minBeat", "maxBeat", "sweepDurationMin", "sweepInterval", "startBinauralSweep", "dcBlocker", "rampTime", "targetVolume", "startTime", "scheduleSweep", "stopBinauralSweep", "now", "halfCycle", "audioSourceControllers", "registerAudioSource", "controller", "unregisterAudioSource", "stopAllAudioSourceControllers", "except", "simpleHash", "str", "hash", "synthesizeAudio", "arrayBuffer", "createSourceNode", "play", "api", "pause", "resume", "togglePlayPause", "destroy", "AudioVisualizer", "tryCreateVisualizer", "currentAudioSource", "analyzerNode", "actualHeight", "cssClass", "SimpleAudioPlayer", "isPlaying", "vizElement", "Magic8Ball", "audioSource1", "audioSource2", "lastContentHash", "backgroundImages", "imageBaseGroupsLoaded", "hasAutoPlayedForHash", "getContentHash", "messages", "getOrCreateAudioSource", "role", "existingSource", "setupAudioSources", "shouldAutoPlay", "contentHash", "currentHash", "lastMsg", "useProfile", "isCapturing", "isInitialized", "videoEl", "deviceInit", "videoDevices", "selectedDeviceId", "API_ENDPOINT", "CAPTURE_INTERVAL_SECONDS", "captureIntervalId", "videoElement", "initializeAndFindDevices", "fCaptureHandler", "device", "pickCamera", "startCapture", "selectedLabel", "constraints", "captureAndSend", "capturing", "imageData", "camera", "mainPage", "nodeMain", "signInPage", "doLogin", "organizations", "toggleSpecify", "orgFieldDesigner", "organizationField", "authenticatedPage", "newListControl", "listPage", "wentBack", "carousel", "info", "listType", "baseListType", "listContainerId", "navContainerId", "navFilter", "embeddedController", "pickerCancel", "containerMode", "defaultRecordCount", "defaultIconRecordCount", "infiniteScroll", "showFooter", "showIconFooter", "systemList", "taggingInProgress", "taggingAbort", "textField", "plc", "fKeyHandler", "getSelected", "getSelectedIndices", "aRes", "aSel", "getType", "editItem", "editSelected", "deleteSelected", "contType", "bBucket", "applyTagsToList", "successCount", "errorCount", "closeSelected", "openSelected", "navigateUp", "navigateToPathId", "ltype", "byParent", "openSystemLibrary", "openOlio", "openFavorites", "openPath", "navigateDown", "listSystemType", "openItem", "selectResult", "toggleInfo", "toggleContainer", "toggleGrid", "bOff", "toggleCarousel", "toggleCarouselFull", "bForce", "toggleCarouselMax", "displayGrid", "getListController", "getCurrentResults", "moveCarousel", "moveCarouselTo", "checkScrollPagination", "displayList", "limit", "getOptionButton", "optButton", "disableUp", "getAdminButtons", "rs", "favSel", "getPickerButton", "getActionButtons", "getPageToggleButtons", "getGroupSearchButtons", "getOlioButtons", "oliSel", "getFavoriteButtons", "getActionButtonBar", "getListViewInner", "fdoh", "fdrh", "npath", "red", "getListView", "navListKey", "initParams", "update", "listFilter", "currentDefaultRecordCount", "cient", "newObjectPage", "pinst", "oinst", "tabIndex", "designMode", "callerIndex", "callerActive", "pendingResponse", "definition", "listView", "objectNew", "parentNew", "streamSeg", "parentProperty", "printJSONToWindow", "bu", "toggleDesignMode", "txtEl", "doUpdate", "syncText", "bpatch", "upatch", "puint", "uint", "bNew", "doCancel", "applyTags", "doCopy", "resetEntity", "doDelete", "buttonTab", "icoName", "switchTab", "getFormatForContentType", "postRender", "getFormCommands", "bSel", "bAdjust", "cmd", "func", "getFormCommandView", "getValuesForFormField", "hidden", "cmds", "getValuesForTableField", "rowModel", "rowClass", "cv", "rm", "modelField", "spans", "spans2", "modelFieldContainer", "getObjectProperty", "vVal", "altName", "altVal", "noChange", "altForm", "aom", "getPrimitive", "aname", "rendererCtx", "doFieldPicker", "doFieldOpen", "doFieldClear", "streamId", "rendered", "modelForm", "minst", "mo", "oid", "ooinst", "outF", "modelPicker", "pickList", "getForm", "cactive", "mForm", "cForm", "getFormTabs", "getObjectViewInner", "designable", "getObjectView", "primitive", "cobj", "bPNew", "setInst", "ldraw", "getMembershipContext", "getTableEntryContext", "gpath", "fact", "properties", "prq", "stype", "pname", "uname", "newNavigatorControl", "navigator", "treeView", "altView", "getNavigatorTopMenuView", "getSplitContainerView", "splitLeft", "getSplitLeftContainerView", "getSplitRightContainerView", "getResultsView", "getNavigatorBottomMenuView", "getNavigatorView", "newChatControl", "aPCfg", "aSess", "audioText", "newChatConfig", "hideThoughts", "editIndex", "editMode", "doClear", "clearEditMode", "pickSession", "doPeek", "newChatStream", "clearChat", "m1", "doStop", "doChat", "pushHistory", "faceProfile", "loadConfigList", "getHistory", "c2", "c3", "getChatTopMenuView", "vsess", "bDel", "openChatSettings", "toggleAudio", "handleFaceMetricCapture", "toggleProfile", "toggleCamera", "toggleThoughts", "editMessageHistory", "toggleEditMode", "pruneAll", "c1g", "c1l", "c2g", "c2l", "c1i", "c2i", "midx", "aidx", "amsg", "hasAutoPlayedThisSession", "align", "ectl", "ecls", "bectl", "pruneOut", "pruneToMark", "pruneTag", "pruneOther", "contentForHash", "setting", "setLbl", "mark", "end", "idx1", "idx2", "tdx1", "maxCheck", "check", "tdx2", "getChatBottomMenuView", "pendBar", "placeText", "msgProps", "handleAudioSave", "mimeType", "navKey", "lastCount", "oMsg", "dir2", "getChatView", "bPopSet", "game", "components", "getGameComponent", "parm", "keyHandler", "doSave", "getGameView", "comp", "particles", "particleColor", "PARTICLE_COUNT", "imageUrls", "canvasInitialized", "setupCanvas", "createParticle", "animateCanvas", "HypnoApp", "clues", "emotion", "raceBlendedColor", "raceTotalScore", "weight", "genderBlendedColor", "genderTotalScore", "initialData", "clue", "routes", "takeDown", "refreshApplication", "usr", "rt", "setContextRoles", "hasRole", "roles", "ctxRoles"]
}
